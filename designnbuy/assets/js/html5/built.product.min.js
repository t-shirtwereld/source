function touchHandler(a){var b=a.changedTouches,c=b[0],d="";switch(a.type){case"touchstart":d="mousedown";break;case"touchmove":d="mousemove";break;case"touchend":d="mouseup";break;default:return}var e=document.createEvent("MouseEvent");e.initMouseEvent(d,!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null),b.length<2&&c.target.dispatchEvent(e)}function hex_md5(a){return rstr2hex(rstr_md5(str2rstr_utf8(a)))}function hex_hmac_md5(a,b){return rstr2hex(rstr_hmac_md5(str2rstr_utf8(a),str2rstr_utf8(b)))}function md5_vm_test(){return"900150983cd24fb0d6963f7d28e17f72"==hex_md5("abc").toLowerCase()}function rstr_md5(a){return binl2rstr(binl_md5(rstr2binl(a),8*a.length))}function rstr_hmac_md5(a,b){var c=rstr2binl(a);c.length>16&&(c=binl_md5(c,8*a.length));for(var d=Array(16),e=Array(16),f=0;16>f;f++)d[f]=909522486^c[f],e[f]=1549556828^c[f];var g=binl_md5(d.concat(rstr2binl(b)),512+8*b.length);return binl2rstr(binl_md5(e.concat(g),640))}function rstr2hex(a){try{}catch(b){hexcase=0}for(var c,d=hexcase?"0123456789ABCDEF":"0123456789abcdef",e="",f=0;f<a.length;f++)c=a.charCodeAt(f),e+=d.charAt(c>>>4&15)+d.charAt(15&c);return e}function str2rstr_utf8(a){for(var b,c,d="",e=-1;++e<a.length;)b=a.charCodeAt(e),c=e+1<a.length?a.charCodeAt(e+1):0,b>=55296&&56319>=b&&c>=56320&&57343>=c&&(b=65536+((1023&b)<<10)+(1023&c),e++),127>=b?d+=String.fromCharCode(b):2047>=b?d+=String.fromCharCode(192|b>>>6&31,128|63&b):65535>=b?d+=String.fromCharCode(224|b>>>12&15,128|b>>>6&63,128|63&b):2097151>=b&&(d+=String.fromCharCode(240|b>>>18&7,128|b>>>12&63,128|b>>>6&63,128|63&b));return d}function rstr2binl(a){for(var b=Array(a.length>>2),c=0;c<b.length;c++)b[c]=0;for(var c=0;c<8*a.length;c+=8)b[c>>5]|=(255&a.charCodeAt(c/8))<<c%32;return b}function binl2rstr(a){for(var b="",c=0;c<32*a.length;c+=8)b+=String.fromCharCode(a[c>>5]>>>c%32&255);return b}function binl_md5(a,b){a[b>>5]|=128<<b%32,a[(b+64>>>9<<4)+14]=b;for(var c=1732584193,d=-271733879,e=-1732584194,f=271733878,g=0;g<a.length;g+=16){var h=c,i=d,j=e,k=f;c=md5_ff(c,d,e,f,a[g+0],7,-680876936),f=md5_ff(f,c,d,e,a[g+1],12,-389564586),e=md5_ff(e,f,c,d,a[g+2],17,606105819),d=md5_ff(d,e,f,c,a[g+3],22,-1044525330),c=md5_ff(c,d,e,f,a[g+4],7,-176418897),f=md5_ff(f,c,d,e,a[g+5],12,1200080426),e=md5_ff(e,f,c,d,a[g+6],17,-1473231341),d=md5_ff(d,e,f,c,a[g+7],22,-45705983),c=md5_ff(c,d,e,f,a[g+8],7,1770035416),f=md5_ff(f,c,d,e,a[g+9],12,-1958414417),e=md5_ff(e,f,c,d,a[g+10],17,-42063),d=md5_ff(d,e,f,c,a[g+11],22,-1990404162),c=md5_ff(c,d,e,f,a[g+12],7,1804603682),f=md5_ff(f,c,d,e,a[g+13],12,-40341101),e=md5_ff(e,f,c,d,a[g+14],17,-1502002290),d=md5_ff(d,e,f,c,a[g+15],22,1236535329),c=md5_gg(c,d,e,f,a[g+1],5,-165796510),f=md5_gg(f,c,d,e,a[g+6],9,-1069501632),e=md5_gg(e,f,c,d,a[g+11],14,643717713),d=md5_gg(d,e,f,c,a[g+0],20,-373897302),c=md5_gg(c,d,e,f,a[g+5],5,-701558691),f=md5_gg(f,c,d,e,a[g+10],9,38016083),e=md5_gg(e,f,c,d,a[g+15],14,-660478335),d=md5_gg(d,e,f,c,a[g+4],20,-405537848),c=md5_gg(c,d,e,f,a[g+9],5,568446438),f=md5_gg(f,c,d,e,a[g+14],9,-1019803690),e=md5_gg(e,f,c,d,a[g+3],14,-187363961),d=md5_gg(d,e,f,c,a[g+8],20,1163531501),c=md5_gg(c,d,e,f,a[g+13],5,-1444681467),f=md5_gg(f,c,d,e,a[g+2],9,-51403784),e=md5_gg(e,f,c,d,a[g+7],14,1735328473),d=md5_gg(d,e,f,c,a[g+12],20,-1926607734),c=md5_hh(c,d,e,f,a[g+5],4,-378558),f=md5_hh(f,c,d,e,a[g+8],11,-2022574463),e=md5_hh(e,f,c,d,a[g+11],16,1839030562),d=md5_hh(d,e,f,c,a[g+14],23,-35309556),c=md5_hh(c,d,e,f,a[g+1],4,-1530992060),f=md5_hh(f,c,d,e,a[g+4],11,1272893353),e=md5_hh(e,f,c,d,a[g+7],16,-155497632),d=md5_hh(d,e,f,c,a[g+10],23,-1094730640),c=md5_hh(c,d,e,f,a[g+13],4,681279174),f=md5_hh(f,c,d,e,a[g+0],11,-358537222),e=md5_hh(e,f,c,d,a[g+3],16,-722521979),d=md5_hh(d,e,f,c,a[g+6],23,76029189),c=md5_hh(c,d,e,f,a[g+9],4,-640364487),f=md5_hh(f,c,d,e,a[g+12],11,-421815835),e=md5_hh(e,f,c,d,a[g+15],16,530742520),d=md5_hh(d,e,f,c,a[g+2],23,-995338651),c=md5_ii(c,d,e,f,a[g+0],6,-198630844),f=md5_ii(f,c,d,e,a[g+7],10,1126891415),e=md5_ii(e,f,c,d,a[g+14],15,-1416354905),d=md5_ii(d,e,f,c,a[g+5],21,-57434055),c=md5_ii(c,d,e,f,a[g+12],6,1700485571),f=md5_ii(f,c,d,e,a[g+3],10,-1894986606),e=md5_ii(e,f,c,d,a[g+10],15,-1051523),d=md5_ii(d,e,f,c,a[g+1],21,-2054922799),c=md5_ii(c,d,e,f,a[g+8],6,1873313359),f=md5_ii(f,c,d,e,a[g+15],10,-30611744),e=md5_ii(e,f,c,d,a[g+6],15,-1560198380),d=md5_ii(d,e,f,c,a[g+13],21,1309151649),c=md5_ii(c,d,e,f,a[g+4],6,-145523070),f=md5_ii(f,c,d,e,a[g+11],10,-1120210379),e=md5_ii(e,f,c,d,a[g+2],15,718787259),d=md5_ii(d,e,f,c,a[g+9],21,-343485551),c=safe_add(c,h),d=safe_add(d,i),e=safe_add(e,j),f=safe_add(f,k)}return Array(c,d,e,f)}function md5_cmn(a,b,c,d,e,f){return safe_add(bit_rol(safe_add(safe_add(b,a),safe_add(d,f)),e),c)}function md5_ff(a,b,c,d,e,f,g){return md5_cmn(b&c|~b&d,a,b,e,f,g)}function md5_gg(a,b,c,d,e,f,g){return md5_cmn(b&d|c&~d,a,b,e,f,g)}function md5_hh(a,b,c,d,e,f,g){return md5_cmn(b^c^d,a,b,e,f,g)}function md5_ii(a,b,c,d,e,f,g){return md5_cmn(c^(b|~d),a,b,e,f,g)}function safe_add(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}function bit_rol(a,b){return a<<b|a>>>32-b}function correctWebPath(){for(var a=!1,b=webpath.split(","),c=0;c<b.length;c++)if(-1!=window.location.href.indexOf(b[c])){a=!0,webpath=b[c];break}return a}function loadConfigData(){var a=(new Date).getTime();$j.ajax({type:"POST",url:webpath+"designnbuy/pcstudio_config/getAllInitialData",cache:!1,data:{currentTime:a,postData:postData},success:function(a){handleConfigData(a)},error:function(){hideLoader()}})}function handleConfigData(a){"success"==a.status.toLowerCase()&&(tempData=a.data,updateSettingVariables(tempData),craeteTextAreaToStoreSVG(tempData),setInitialProdDesignArea(tempData),svgEditor.setConfig({dimensions:[design_area_width[1],design_area_height[1]],position:[parseFloat(pos_x[1]),parseFloat(pos_y[1])],canvas_expansion:0,showRulers:!1,initFill:{color:"#0000FF"},initStroke:{width:1,color:"#000000"},initBorder:{color:"#000000"},bkgd_color:"none",no_save_warning:!0,extensions:extensionArray,show_outside_canvas:0,lang:currentStore}),Smm.fontDirectory=mediapath+"fonts/",Smm.selectorId="font-selector",Smm.visible=!1,nameSmm.fontDirectory=mediapath+"fonts/",nameSmm.selectorId="name-font-selector",nameSmm.visible=!1,numberSmm.fontDirectory=mediapath+"fonts/",numberSmm.selectorId="number-font-selector",numberSmm.visible=!1,extensionArray.length&&svgEditor.init(),setProductDesignAreaValues(tempData),loadInitialProductData(tempData))}function updateSettingVariables(a){formkey="",productid=a.settings.productId,currentStore=a.settings.currentStore,savedPrintingMethod=$j.parseJSON(a.settings.savedPrintingMethod),isFront=a.settings.isFront,user=a.settings.user,preTemplate=a.settings.preTemplate,pretemplate_id=a.settings.pretemplate_id,savePreTemplate=a.settings.savePreTemplate,cart_id=a.settings.cart_id,cart_design_id=a.settings.cart_design_id,exitUrl=a.settings.exitUrl,backend_url=a.settings.backend_url,template_id=a.settings.template_id,formKey=a.settings.formKey,jspath=a.settings.jspath,cartUrl=a.settings.cartUrl,facebookAppId=a.settings.facebook,flickrAppId=a.settings.flickr,forgetpasswordURL=a.settings.forgotpassword,basepath=a.settings.basepath,mediapath=a.settings.mediapath,confignotfound=a.settings.confignotfound,qrCodePath=a.settings.qrCodePath,qrCodeLib=a.settings.qrCodeLib,removeuserImagesUrl=a.settings.removeuserImagesUrl,relatedSubCategoryUrl=a.settings.relatedSubCategoryUrl,relatedProductUrl=a.settings.relatedProductUrl,relatedClipartUrl=a.settings.relatedClipartUrl,relatedDesignartUrl=a.settings.relatedDesignideaUrl,relatedClipartPriceUrl=a.settings.relatedClipartPriceUrl,relatedDesignIdeaUrl=a.settings.relatedDesignIdeaUrl,productUrl=a.settings.productUrl,categoryUrl=a.settings.categoryUrl,helpDataUrl=a.settings.helpDataUrl,fontUrl=a.settings.fontUrl,clipartCategoryUrl=a.settings.clipartCategoryUrl,clipartSubCategoryUrl=a.settings.clipartSubCategoryUrl,productPriceUrl=a.settings.productPriceUrl,crossOriginalUploadUrl=a.settings.crossOriginalUploadUrl,loginUrl=a.settings.loginUrl,registrationUrl=a.settings.registrationUrl,loginCheckUrl=a.settings.loginCheckUrl,saveBase64Url=a.settings.saveBase64Url,saveDesignUrl=a.settings.saveDesignUrl,shareDesignUrl=a.settings.shareDesignUrl,generatePreviewPngUrl=a.settings.generatePreviewPngUrl,generateRootPngUrl=a.settings.generateRootPngUrl,previewPdfUrl=a.settings.previewPdfUrl,backgroundImageUrl=a.settings.backgroundImageUrl,addToCartUrl=a.settings.addToCartUrl,userImagesUrl=a.settings.userImagesUrl,welcomeMessageUrl=a.settings.welcomeMessageUrl,updateTopLinksUrl=a.settings.updateTopLinksUrl,topCartsUrl=a.settings.topCartsUrl,FBredirectURI=a.settings.FBredirectURI,uniqueid=a.settings.uniqueid,jsonfontList=$j.parseJSON(a.settings.fontlist),no_of_side=a.settings.no_of_side,first_font=a.settings.first_font,text_svg1=a.settings.text_svg1,text_svg2=a.settings.text_svg2,text_svg3=a.settings.text_svg3,text_svg4=a.settings.text_svg4,text_svg5=a.settings.text_svg5,text_svg6=a.settings.text_svg6,text_svg7=a.settings.text_svg7,text_svg8=a.settings.text_svg8,side_1=a.settings.side_1,side_2=a.settings.side_2,side_3=a.settings.side_3,side_4=a.settings.side_4,side_5=a.settings.side_5,side_6=a.settings.side_6,side_7=a.settings.side_7,side_8=a.settings.side_8,png_data=a.settings.png_data,filearray=new Array,added_images=a.settings.added_images,fonts_used=a.settings.fonts_used,configtotalprice=a.settings.configtotalprice,configselectedsize=a.settings.configselectedsize,configqtymessage=a.settings.configqtymessage,clipartsloaded=parseInt(a.settings.clipartsloaded),designIdeasloaded=a.settings.designIdeasloaded,curr_side_id=a.settings.curr_side_id,datauri=a.settings.datauri,productImageCan=a.settings.productImageCan,customizationCan=a.settings.customizationCan,priceInterval=a.settings.priceInterval,action=a.settings.action,shareType=a.settings.shareType,sideNameAry=a.settings.sideNameAry,toolType=a.settings.toolType,pickerMode=a.settings.pickerMode,printingMode=a.settings.printingMode,mobi_image_upload_url=a.settings.mobi_image_upload_url,resolutionMult=a.settings.imageDPI/96,"printable"==pickerMode?(firstColor=printableColorList[0].colorCode,borderColor=firstColor.substring(1)):borderColor="000",initialLoginCheck(!0)}function openHelpWindow(){window.open(helpDataUrl+"/"+postData.language_id,"Studio Help","width=1120,height=600,scrollbars=yes")}function craeteTextAreaToStoreSVG(a){var b=a.productdata.noofSides,c=Array("","","","","",""),d=1;$j.each(a.settings.init_data,function(a,b){c[d]=b,d++});for(var e="",d=1;b>=d;d++)e+='<textarea style="display:none;" id="textsvg_'+d+'" name="textsvg_'+d+'">'+c[d]+"</textarea> \n";if(parseInt(b)<8)for(var f=parseInt(b)+1;8>=f;f++)e+='<textarea style="display:none;" id="textsvg_'+f+'" name="textsvg_'+f+'"></textarea>';$j("#pages_data").html(e)}function setSVGCanvasImages(a){var b=a.settings.svgcanvas_images;$j.each(b,function(b,c){var d,e,f,g,h=new Image;h.src=c.imageurl,d=c.imagewidth+"px",e=c.imageheight+"px",1!=b&&(f="display:none;"),g="yes"==a.productdata.multiColor?"":"url(#colorMat)",newImage=document.createElementNS("http://www.w3.org/2000/svg","image"),svgedit.utilities.assignAttributes(newImage,{width:d,height:e,id:"img_"+b,"xlink:href":h.src,style:"pointer-events:none;"+f,"class":"main_image",filter:g}),$j("#productSvg").append($j(newImage)),updateMaskImage()})}function updateMaskImage(a){var b=findNodeWithTitleName(svgCanvas.getContentElem().childNodes,"Layer 1");if(a=a?a:curSide,maskImage.length&&b){if(""==a||void 0==a){selIndex=0;var c=1}else{selIndex=parseInt(a)-1;var c=a}var d=maskImage[selIndex];if(d&&""!=d&&void 0!=d){{var e;svgEditor.curConfig.dimensions}$j("#canvasMaskImageDef").length?e=svgEditor.canvas.getElem("canvasMaskImageDef"):(e=document.createElementNS("http://www.w3.org/2000/svg","mask"),svgedit.utilities.assignAttributes(e,{id:"canvasMaskImageDef",maskUnits:"objectBoundingBox",x:0,y:0}),svgEditor.canvas.findDefs().appendChild(e));var f,g=svgCanvas.getZoom();svgCanvas.getElem("canvasMaskImage")?f=svgEditor.canvas.getElem("canvasMaskImage"):(f=document.createElementNS("http://www.w3.org/2000/svg","image"),e.appendChild(f),svgedit.utilities.assignAttributes(f,{id:"canvasMaskImage",preserveAspectRatio:"none",style:"pointer-events:none"}));var h=parseFloat($j("#canvasBackground").attr("x"))/g,i=parseFloat($j("#canvasBackground").attr("y"))/g;f.setAttribute("x",-1*h),f.setAttribute("y",-1*i);var j=$j("#img_"+c).attr("width"),k=$j("#img_"+c).attr("height");f.setAttribute("width",j),f.setAttribute("height",k),f.setAttribute("preserveAspectRatio","none"),b.setAttribute("mask","url(#canvasMaskImageDef)"),svgEditor.canvas.setHref(f,d)}else b.setAttribute("mask","")}else b&&b.setAttribute("mask","")}function findNodeWithTitleName(a,b){for(var c=0;c<a.length;c++)if(1==a[c].nodeType)for(var d=a[c].childNodes,e=0;e<d.length;e++)if(1==d[e].nodeType&&"title"==d[e].tagName&&d[e].childNodes[0].nodeValue==b)return a[c];return null}function setInitialProdDesignArea(a){var b=a.productdata.Area,c=1,d="";$j.each(b,function(a,b){d=b.split(","),pos_x[c]=parseFloat(d[0])*multFactor,pos_y[c]=parseFloat(d[1])*multFactor,design_area_width[c]=parseFloat(d[2])*multFactor,design_area_height[c]=parseFloat(d[3])*multFactor})}function setProductDesignAreaValues(a){var b=a.productdata.Area,c=1,d="";$j.each(b,function(a,b){d=b.split(","),pos_x[c]=parseFloat(d[0])*multFactor,pos_y[c]=parseFloat(d[1])*multFactor,design_area_width[c]=parseFloat(d[2])*multFactor,design_area_height[c]=parseFloat(d[3])*multFactor,outputWidth[c]=d[4],outputHeight[c]=d[5],1==c&&svgCanvas.setSvgString(""!=$j("#textsvg_1").val()?$j("#textsvg_1").val():'<svg width="'+design_area_width[c]+'" height="'+design_area_height[c]+'" x="'+pos_x[c]+'" y="'+pos_y[c]+'" xmlns="http://www.w3.org/2000/svg"></svg>'),c++})}function loadData(){FontModule.init()}function updateFontScrillBar(){$j("#common-panel").addClass("cbp-spmenu-open"),$j("#font-selector-con").show(),$j("#tool_font_family").show(),$j("#font-selector-con").jScrollPane(),$j("#common-panel").removeClass("cbp-spmenu-open"),$j("#font-selector-con").hide(),$j("#tool_font_family").hide()}function updateNameNumberFontScrillBar(){$j("#common-panel").addClass("cbp-spmenu-open"),$j(".sambhavNameNum").show(),$j("#name-font-selector-con").show(),$j("#name-font-selector-con").jScrollPane(),$j("#number-font-selector-con").show(),$j("#number-font-selector-con").jScrollPane(),$j("#common-panel").removeClass("cbp-spmenu-open"),$j(".sambhavNameNum").hide(),$j("#name-font-selector-con").hide()}function loadDesignIdea(){$j("#designideaopt").empty(),$j("#designideacontainer").empty();var a=null;$j.each(tempData.designideas,function(b,c){null==a&&(a=c.id),$j("#designideaopt").append("<option id=design_cat_"+c.id+" value="+c.id+">"+c.name+"</option>")}),$j("#designideaopt").find("option").length>1?($j("#designideaopt").show(),designIdeaCallHandler($j($j("#designideaopt option")[0]).attr("value"))):$j("#designideaopt").hide()}function designIdeaCallHandler(a){return $j("#loaderImage").addClass("loader_pos"),showLoader(),("undefined"==typeof a||""==a)&&(a=""==$j("#designideaopt").val()?$j("#firstdesigncat").val():$j("#designideaopt").val()),a?void(cachedDesignidea[a]?(createDesignIdeaLI(cachedDesignidea[a]),hideLoader()):(0==tempData.designideas[a].designidea.length?$j("#designideacontainer").html(svgEditor.uiStrings.notification.noDataFound):(cachedDesignidea[a]=tempData.designideas[a].designidea,handleDesignIdeaLI(tempData.designideas[a].designidea)),$j("#loaderImage").removeClass("loader_pos"),hideLoader())):($j("#loaderImage").removeClass("loader_pos"),hideLoader(),void $j("#designideacontainer").html(svgEditor.uiStrings.notification.noDataFound))}function handleDesignIdeaLI(a){$j("#designideacontainer").empty(),$j.each(a,function(a,b){insertvalue="<li><a onclick=\"loadDesignIdeaONCanvas('"+b.svg+'\', \'load_svg\'); return false;" href="javascript:void(0);"><img  onload="ProductModule.productImageLoaded(this)" src="'+b.image+'" title="'+b.name+'" /><span>'+b.name+"</span></a></li>",$j("#designideacontainer").append(insertvalue)})}function compileTemplate(a){var b=$j(a).html();return Handlebars.compile(b)}function loadProductData(){showLoader(),currentTime=(new Date).getTime(),$j.ajaxSetup({cache:!1}),$j.ajax({type:"POST",url:productUrl,cache:!1,data:"pid="+productid+"&user="+user+"&formkey="+formkey+"&plateform="+postData.plateform+"&siteBaseUrl="+postData.siteBaseUrl+"&language_id="+postData.language_id+"&currentTime="+currentTime,success:function(a){if(productData=a.data.productdata,printingMethods=productData.printingMethods,jsonMaskImageUrls=productData.maskImages,overlayImageUrls=productData.overlayImages,configsku=productData.code,is_multicolor=productData.multiColor,no_of_side=productData.noofSides,productData.postData=productData.postData,0==isFront&&(0==preTemplate?no_of_side=1:$j("#addproduct").hide()),changeProductFlag){if($j("#current_product_colorid").val(""),$j("#current_product_colorhash").val(""),$j("#feColorMatrix").attr("values",""),"simple"!=productData.type&&"onlysize"!=productData.type){$j("#current_product_colorid").val(Object.keys(productData.allColors.color)[0]);var b=productData.allColors.color[Object.keys(productData.allColors.color)[0]];if($j("#current_product_colorhash").val(b.optionName),"yes"!=is_multicolor){var c=getMatrix($j("#current_product_colorhash").val());applyMatrixFilter(c)}}for(var d=1;d<=parseInt(no_of_side);d++){if(1==d){var e=productData.Area.side1Area.split(",");pos_x[d]=parseFloat(e[0]*multFactor).toFixed(2),pos_y[d]=parseFloat(e[1]*multFactor).toFixed(2),design_area_width[d]=parseFloat(e[2]*multFactor).toFixed(2),design_area_height[d]=parseFloat(e[3]*multFactor).toFixed(2),outputWidth[d]=parseFloat(e[4]).toFixed(2),outputHeight[d]=parseFloat(e[5]).toFixed(2)}else if(2==d){var f=productData.Area.side2Area.split(",");pos_x[d]=parseFloat(f[0]*multFactor).toFixed(2),pos_y[d]=parseFloat(f[1]*multFactor).toFixed(2),design_area_width[d]=parseFloat(f[2]*multFactor).toFixed(2),design_area_height[d]=parseFloat(f[3]*multFactor).toFixed(2),outputWidth[d]=parseFloat(f[4]).toFixed(2),outputHeight[d]=parseFloat(f[5]).toFixed(2)}else if(3==d){var g=productData.Area.side3Area.split(",");pos_x[d]=parseFloat(g[0]*multFactor).toFixed(2),pos_y[d]=parseFloat(g[1]*multFactor).toFixed(2),design_area_width[d]=parseFloat(g[2]*multFactor).toFixed(2),design_area_height[d]=parseFloat(g[3]*multFactor).toFixed(2),outputWidth[d]=parseFloat(g[4]).toFixed(2),outputHeight[d]=parseFloat(g[5]).toFixed(2)}else if(4==d){var h=productData.Area.side4Area.split(",");pos_x[d]=parseFloat(h[0]*multFactor).toFixed(2),pos_y[d]=parseFloat(h[1]*multFactor).toFixed(2),design_area_width[d]=parseFloat(h[2]*multFactor).toFixed(2),design_area_height[d]=parseFloat(h[3]*multFactor).toFixed(2),outputWidth[d]=parseFloat(h[4]).toFixed(2),outputHeight[d]=parseFloat(h[5]).toFixed(2)}else if(5==d){var h=productData.Area.side5Area.split(",");pos_x[d]=parseFloat(h[0]*multFactor).toFixed(2),pos_y[d]=parseFloat(h[1]*multFactor).toFixed(2),design_area_width[d]=parseFloat(h[2]*multFactor).toFixed(2),design_area_height[d]=parseFloat(h[3]*multFactor).toFixed(2),outputWidth[d]=parseFloat(h[4]).toFixed(2),outputHeight[d]=parseFloat(h[5]).toFixed(2)}else if(6==d){var h=productData.Area.side6Area.split(",");pos_x[d]=parseFloat(h[0]*multFactor).toFixed(2),pos_y[d]=parseFloat(h[1]*multFactor).toFixed(2),design_area_width[d]=parseFloat(h[2]*multFactor).toFixed(2),design_area_height[d]=parseFloat(h[3]*multFactor).toFixed(2),outputWidth[d]=parseFloat(h[4]).toFixed(2),outputHeight[d]=parseFloat(h[5]).toFixed(2)}else if(7==d){var h=productData.Area.side7Area.split(",");pos_x[d]=parseFloat(h[0]*multFactor).toFixed(2),pos_y[d]=parseFloat(h[1]*multFactor).toFixed(2),design_area_width[d]=parseFloat(h[2]*multFactor).toFixed(2),design_area_height[d]=parseFloat(h[3]*multFactor).toFixed(2),outputWidth[d]=parseFloat(h[4]).toFixed(2),outputHeight[d]=parseFloat(h[5]).toFixed(2)}else if(8==d){var h=productData.Area.side8Area.split(",");pos_x[d]=parseFloat(h[0]*multFactor).toFixed(2),pos_y[d]=parseFloat(h[1]*multFactor).toFixed(2),design_area_width[d]=parseFloat(h[2]*multFactor).toFixed(2),design_area_height[d]=parseFloat(h[3]*multFactor).toFixed(2),outputWidth[d]=parseFloat(h[4]).toFixed(2),outputHeight[d]=parseFloat(h[5]).toFixed(2)}if(""==$j("#textsvg_"+d).val())$j("#textsvg_"+d).val('<svg width="'+design_area_width[d]+'" height="'+design_area_height[d]+'" x="'+pos_x[d]+'" y="'+pos_y[d]+'" xmlns="http://www.w3.org/2000/svg"></svg>');else{var i=svgedit.utilities.text2xml($j("#textsvg_"+d).val());i.documentElement.setAttribute("width",design_area_width[d]),i.documentElement.setAttribute("height",design_area_height[d]),i.documentElement.setAttribute("x",pos_x[d]),i.documentElement.setAttribute("y",pos_y[d]),$j("#textsvg_"+d).val((new XMLSerializer).serializeToString(i))}}for(var d=parseInt(no_of_side);d>0;d--)curSide=d,svgCanvas.setSvgString($j("#textsvg_"+d).val()),svgCanvas.setResolution(design_area_width[d],design_area_height[d]),resizeAllElements(1)&&$j("#textsvg_"+d).val(svgCanvas.getSvgString());updateMaskImage();var j=svgCanvas.getElem("bleedHolder");j.setAttribute("x",svgCanvas.getContentElem().getAttribute("x")),j.setAttribute("y",svgCanvas.getContentElem().getAttribute("y")),designIdeasloaded=0,svgCanvas.getPrivateMethods().extensions.undoRedo&&(svgCanvas.getPrivateMethods().extensions.undoRedo.resetStack(),svgCanvas.getPrivateMethods().extensions.undoRedo.addToStack()),"0"==productData.name_number?$j("#addnamenumber").hide():$j("#addnamenumber").show()}changeProductFlag=!0,svgCanvas.getPrivateMethods().extensions.productPricing&&svgCanvas.getPrivateMethods().extensions.productPricing.createMethodFirstTime(!0),isReady&&createProductDesign(),console.log("3d Product"),1==productData.is_3d?svgCanvas.getPrivateMethods().extensions.threedpreview.initThreeD():$j(".preview_holder").css("background","none"),$j.isEmptyObject(nameNumberObject)||(nameNumberObject.removeSizeDropdown(),nameNumberObject.updateNameNumberSize(),nameNumberObject.manageFormElements&&nameNumberObject.manageFormElements())},error:function(){hideLoader()}})}function loadInitialProductData(a){if(productData=a.productdata,printingMethods=productData.printingMethods,jsonMaskImageUrls=productData.maskImages,overlayImageUrls=productData.overlayImages,configsku=productData.code,is_multicolor=productData.multiColor,no_of_side=productData.noofSides,productData.postData=productData.postData,0==isFront&&(0==preTemplate?no_of_side=1:$j("#addproduct").hide()),changeProductFlag=!0,svgCanvas.getPrivateMethods().extensions.productPricing&&svgCanvas.getPrivateMethods().extensions.productPricing.createMethodFirstTime(!0),0==extensionArray.length){var b="lang"in svgEditor.curPrefs?svgEditor.curPrefs.lang:null;svgEditor.putLocale(b),init()}}function setDefaultStroke(){var a=svgCanvas.getSelectedElems(),b=a[0];$j(b).find("path").each(function(){$j(this).attr("fill")&&"none"!=$j(this).attr("fill")&&$j(this).attr("stroke-width","0")})}function convertColor(){if("printable"==pickerMode){var a=svgCanvas.getSelectedElems(),b=a[0];$j(b).find(visElems).each(function(a){if($j(this).attr("fill")&&"none"!=$j(this).attr("fill")&&!alreadyInPrintable($j(this).attr("fill"))){var b=printableColorList[a].colorCode.toString();-1==b.indexOf("#")&&(b="#"+b),$j(this).attr("fill",b)}}),svgCanvas.clearSelection(),svgCanvas.addToSelection([b],!0)}}function alreadyInPrintable(a){var b=!1;return $j(printableColorList).each(function(){var c=this.colorCode.toString();-1==this.colorCode.indexOf("#")&&(c="#"+c),c.toUpperCase()==a.toUpperCase()&&(b=!0)}),b}function setAlign(a){($j("#text_align_left").hasClass("disabled")||$j("#text_align_center").hasClass("disabled")||$j("#text_align_right").hasClass("disabled"))&&"admin"!=user||$j.each(svgCanvas.getSelectedElems(),function(b,c){if("text"==c.nodeName){var d=$j(c).attr("text-anchor");if(d!=a){var e,f=svgedit.utilities.getBBox(c);$j(c).attr("text-anchor",a),"end"==a?e="start"==d?$j(c).attr("x")+f.width:$j(c).attr("x")+f.width/2:"start"==a?e="end"==d?$j(c).attr("x")-f.width:$j(c).attr("x")-f.width/2:"middle"==a&&(e="start"==d?$j(c).attr("x")+f.width/2:$j(c).attr("x")-f.width/2),$j(c).attr("x",e),reAlignSpan(c,a)}setAlignButton(a)}})}function getAlign(a){var b=a||svgCanvas.getSelectedElems()[0];return $j(b).attr("text-anchor")}function resetAlignButtons(){$j("#text_align_left").removeClass("push_button_pressed").addClass("tool_button"),$j("#text_align_center").removeClass("push_button_pressed").addClass("tool_button"),$j("#text_align_right").removeClass("push_button_pressed").addClass("tool_button")}function reAlignSpan(a,b,c){b||(b="start"),c||(c=$j(a).attr("x"));var d=$j(a).find("tspan");d.length>1&&$j.each(d,function(a,b){b.setAttribute("x",c)})}function setAlignButton(a){switch(resetAlignButtons(),a){case"start":$j("#text_align_left").addClass("push_button_pressed").removeClass("tool_button");break;case"middle":$j("#text_align_center").addClass("push_button_pressed").removeClass("tool_button");break;case"end":$j("#text_align_right").addClass("push_button_pressed").removeClass("tool_button")}}function selectionChange(a){for(var b=a?a.elems:svgCanvas.getSelectedElems(),c=0;c<b.length;c++)(null==b[c]||void 0==b[c])&&(b.splice(c,1),c--);if($j(".image_quality").hide(),$j("#imageeffectburow").hide(),b.length&&""!=b[0].id&&svgCanvas.getElem(b[0].id))if(manageCommonPanel(),1==b.length&&void 0!=b[0]){switch($j(".borderalignmentpanel").show(),b[0].tagName){case"text":disableFontStyle(b[0]),$j("#text").val(svgCanvas.getMultiTextContent(b[0])),setAlignButton(getAlign(b[0]));break;case"image":$j("#common_upper_open_panel").hide(),showQuality(b[0]),svgCanvas.selectorManager.requestSelector(b[0]).resize();break;case"g":b[0].childNodes.length==$j(b[0]).find("image").length&&($j("#tool_fill").css("display","none"),$j(".borderalignmentpanel").hide())}setPropertiesInpanel(b[0]),$j("#relativedropdown").hide()}else $j(".borderalignmentpanel").hide(),$j("#common-panel").addClass("cbp-spmenu-open"),$j("#relativedropdown").show(),$j(".clearfix").show(),b.length>=1&&($j(".sambhavNameNum").hide(),2==b.length&&svgCanvas.getPrivateMethods().extensions.nameNumber&&svgCanvas.getPrivateMethods().extensions.nameNumber.isNameSelected()&&svgCanvas.getPrivateMethods().extensions.nameNumber.isNumSelected()&&($j(".clearfix").hide(),$j(".sambhavNameNum").show()))}function showQuality(a){var b=svgCanvas.getHref(a);if(b){var c=0;if("svg"==getExtension(b))c=100;else{var d=a.getAttribute("origWidth"),e=a.getAttribute("origHeight"),f=d/e,g=a.getAttribute("width"),h=a.getAttribute("height");h>g?h=g/f:g=h*f;var i=outputWidth[curSide]*svgedit.units.getTypeMap()[productData.baseUnit],j=outputHeight[curSide]*svgedit.units.getTypeMap()[productData.baseUnit],k=i/design_area_width[curSide],l=j/design_area_height[curSide];if(g*=k,h*=l,Math.abs(g)<=d/resolutionMult&&Math.abs(h)<=e/resolutionMult){var m=Math.min(d/resolutionMult-Math.abs(g),e/resolutionMult-Math.abs(h)),n=Math.abs(m/(tempData.settings.imageDPI/2)*100)/2;c=Math.min(50+n,100)}else{var m=Math.max(Math.abs(g)-d/resolutionMult,Math.abs(h)-e/resolutionMult),n=Math.abs(m/(tempData.settings.imageDPI/2)*100)/2;c=Math.max(50-n,0)}}$j(".image_quality").show(),$j("#imageeffectburow").show(),$j(".upload-mathod").find("li").removeClass("active"),33>=c?$j(".upload-mathod").find("li.not-reco").addClass("active"):66>=c?$j(".upload-mathod").find("li.fair").addClass("active"):100>=c&&$j(".upload-mathod").find("li.luk-gud").addClass("active"),$j(".borderalignmentpanel").hide()}}function closeMe(a){$j(a.parentNode.parentNode.parentNode).hide()}function disableFontStyle(a){var b,c,d=a.getAttribute("font-family");b=fontData[d].bold,c=fontData[d].italic,0==b?($j("#tool_bold").addClass("disabled"),svgCanvas.setBold(!1)):$j("#tool_bold").removeClass("disabled"),0==c?($j("#tool_italic").addClass("disabled"),svgCanvas.setItalic(!1)):$j("#tool_italic").removeClass("disabled")}function initQrcode(){qrcodeFormSubmit=function(){var a="",b=""!=customer_id&&"undefined"!=typeof customer_id?customer_id:"0";$j("#qrcodeform *").filter(":input[type=text]:visible").each(function(){a+=$j(this).attr("name")+":"+$j(this).val()}),showLoader(),$j.ajax({type:"POST",url:qrCodeLib,cache:!1,data:"color="+$j("#qrcolorcode").val().substring(1)+"&data="+encodeURIComponent(a)+"&uniqueid="+uniqueid+"&toolType="+toolType+"&plateform="+postData.plateform+"&customer_id="+b+"&siteBaseUrl="+postData.siteBaseUrl+"&language_id="+postData.language_id,success:function(a){appendQRCode(a)},error:function(){hideLoader()}})}}function appendQRCode(a){a=$j.parseJSON(a);var b="<li class='imgloader'><div class='imageholder'><img onload='lazyLoaderImg(this)' class ='lazy' data='"+qrCodePath+a.imageName+"' src='"+qrCodePath+a.imageName+"' border='0'></div><div class='remove-image-sec'><button onclick='removeUserImages("+a.id+",this)' class='remove-image'><i class='fa fa-trash-o'></i></button></div><div class='place-image'><a onclick='loadImageONCanvas(this.rel,"+a.id+"); return false;' class ='place-stage-image' href='javascript:void(0); return false; ' target='_blank' rel='"+qrCodePath+a.imageName+"' ><i class='fa fa-share'></i></a></div></li>";$j("#flickerresult").append(b),hideLoader(),$j("#galleryBtn").trigger("click")}function changetheprofilename(){var a=$j("#socialmedia8 option:selected").text();$j("#profile8").attr("name",a)}function deleteqrcode(a){$j(".page").showLoading({addClass:"loading-indicator-bars"}),$j.ajax({type:"POST",url:deleteQrCodeUrl,cache:!1,data:"imagename="+a+"&plateform="+postData.plateform+"&siteBaseUrl="+postData.siteBaseUrl+"&language_id="+postData.language_id,success:function(){readqrfiles()},error:function(){hideLoader()}})}function changeqrform(){for(var a=document.getElementById("qrdatatype"),b=0;b<a.length;b++)if(a.options[b].value==$j("#qrdatatype").val()){var c="#qr"+a.options[b].value;$j(c).show()}else{var c="#qr"+a.options[b].value;$j(c).hide()}}function setHideOnClick(a){$j("html").bind("mouseup",{item:a},hideItem)}function getExtension(a){var b=a.split(".");return b[b.length-1]}function hideItem(a){a.data.item.hide(),$j("html").unbind("mouseup",hideItem)}function hideDdOnClick(a){$j("html").bind("mouseup",{item:a},hideDd)}function hideDd(a){a.data.item.removeClass("active"),$j("html").unbind("mouseup",hideDd)}function loadImageONCanvas(a,b){var c=svgCanvas.getZoom();if($j("#images-upload").hide(),$j(".qrcode-section").hide(),showLoader(),isLoaded=!0,svgCanvas.getPrivateMethods().extensions.photoCollage&&svgCanvas.getPrivateMethods().extensions.photoCollage.isSelected()){var d=svgCanvas.getPrivateMethods().extensions.photoCollage.imageObj(),e=d.parentNode;if(e&&"svg"!=getExtension(a)){var f=svgedit.utilities.getBBox(e),g=svgCanvas.getElem(e.id).childNodes[1];g&&g.setAttribute("stroke","none"),svgCanvas.setHref(d,a),$j(new Image).load(function(){var c=svgCanvas.getPrivateMethods().extensions.photoCollage.getProportionalWidthHeight(this.width,this.height,f.width,f.height);d.setAttribute("preserveAspectRatio","xMidYMid"),d.setAttribute("width",c[0]),d.setAttribute("height",c[1]),d.setAttribute("origWidth",this.width),d.setAttribute("origHeight",this.height),d.setAttribute("image_id",b),"admin"==user?(d.setAttribute("templateSrc",a+"#**#"+b),d.setAttribute("isAdminUploaded","true")):d.setAttribute("isAdminUploaded","false"),hideLoader(),productPricingExt.calculatePriceData()}).attr("src",a)}else $j.alert(svgEditor.uiStrings.notification.WrongImageWarning),hideLoader()}else{if(1!=svgCanvas.getSelectedElems().length||svgCanvas.getSelectedElems()[0].getAttribute("type")!=dnbBO.photoBox){initWidthToAddElem=$j("#canvasBackground").attr("width")/2/c,initHeightToAddElem=$j("#canvasBackground").attr("height")/2/c;var h=svgCanvas.addSvgElementFromJson({element:"image",attr:{x:$j("#canvasBackground").attr("width")/2/c-initWidthToAddElem/2,y:$j("#canvasBackground").attr("height")/2/c-initHeightToAddElem/2,width:0,height:0,preserveAspectRatio:"none",id:svgCanvas.getNextId(),image_id:b,style:"pointer-events:inherit"}});
return"admin"==user?(h.setAttribute("templateSrc",a+"#**#"+b),h.setAttribute("isAdminUploaded","true")):h.setAttribute("isAdminUploaded","false"),svgCanvas.clearSelection(),svgCanvas.addToSelection([h]),svgCanvas.setImageURL(a,b),h}var i=svgCanvas.getSelectedElems()[0];if(showLoader(),"svg"!=getExtension(a)&&2==i.childNodes.length){{var d=i.childNodes[0].childNodes[0],g=i.childNodes[1];Raphael.pathBBox(g.getAttribute("d"))}$j(new Image).load(function(){var c=svgCanvas.getPrivateMethods().extensions.imageEffect.getProportionalWidthHeight(this.width,this.height,d.getAttribute("width"),d.getAttribute("height"));d.setAttribute("preserveAspectRatio","none"),d.setAttribute("width",c[0]),d.setAttribute("height",c[1]),d.setAttribute("origWidth",this.width),d.setAttribute("origHeight",this.height),d.setAttribute("image_id",b),"admin"==user?(d.setAttribute("templateSrc",a+"#**#"+b),d.setAttribute("isAdminUploaded","true")):d.setAttribute("isAdminUploaded","false"),hideLoader(),productPricingExt.calculatePriceData(),"true"==i.getAttribute("lockTransform")&&svgCanvas.clearSelection(),svgCanvas.setHref(d,a),svgCanvas.getPrivateMethods().extensions.undoRedo&&svgCanvas.getPrivateMethods().extensions.undoRedo.addToStack()}).attr("src",a)}else $j.alert(svgEditor.uiStrings.notification.WrongImageWarning),hideLoader()}}function changeClipPathChildId(){for(var a=svgCanvas.findDefs(),b=a.getElementsByTagName("clipPath"),c=b.length;c--;)for(var d=b[c],e=d.childNodes.length;e--;)d.childNodes[e].id=svgCanvas.getNextId()}function loadDesignIdeaONCanvas(a,b){$j.confirm_custom(svgEditor.uiStrings.notification.srcapDesign,function(c){showLoader(!0),c&&svgEditor.clickClear_All(),svgEditor.processFile(base64_encode(file_get_contents(a)),b),changeClipPathChildId(),productPricingExt.calculatePriceData(),svgCanvas.runExtensions("elementChanged"),hideLoader()})}function loadDesignONCanvas(a){showLoader(!0),svgEditor.processFile(base64_encode(file_get_contents(a)),"load_svg"),changeClipPathChildId(),productPricingExt.calculatePriceData(),svgCanvas.runExtensions("elementChanged"),hideLoader(),$j("#navaart").css("display","none")}function loadClipartONCanvas(a,b,c){svgEditor.processFile(base64_encode(file_get_contents(a)),b,c),svgCanvas.getPrivateMethods().extensions.undoRedo&&svgCanvas.getPrivateMethods().extensions.undoRedo.isAddToStack(!1),svgCanvas.ungroupSelectedElement(),setDefaultStroke(),convertColor(),setClipArtId(c),setSizePosition(svgCanvas.getSelectedElems()[0]),svgCanvas.getPrivateMethods().extensions.undoRedo&&svgCanvas.getPrivateMethods().extensions.undoRedo.isAddToStack(!0),svgCanvas.runExtensions("elementChanged",{elems:svgCanvas.getSelectedElems()}),$j("#navaart").css("display","none")}function setClipArtId(a){var b=svgCanvas.getSelectedElems();""!=a&&$j(b).attr("clip-id",a)}function clipArtPriceCalculation(a){var b="g",c=[],d=svgedit.utilities.text2xml(a);globalvar=d;d.getElementsByTagName("g")[0];return $j(d).find(b).each(function(a,b){"text"!=b.getAttribute("type")&&c.push(b.getAttribute("clip-id"))}),c}function lazyLoaderImg(a){$j(a).attr("origWidth",a.naturalWidth),$j(a).attr("origHeight",a.naturalHeight);var b=new Image;if(b.src=a.getAttribute("data"),b.onload=imageLoaded.bind(a),"flickerresult"==a.parentNode.parentNode.id){var c=a.naturalWidth/a.naturalHeight;if(a.naturalWidth>a.naturalHeight){var d=(90-90/c)/2;a.setAttribute("style","width: 90px; height:auto; margin-top:"+d+"px")}}}function imageLoaded(){this.onload=null,this.src=this.getAttribute("data"),$j("#uploader").hide()}function empty_formdata(){$j("#first_name").val(""),$j("#last_name").val(""),$j("#reg_email_id").val(""),$j("#reg_password").val(""),$j("#conf_password").val(""),$j("#email_id").val(""),$j("#password").val("")}function close_login_form(){$j("#svg_login_window").hide(),empty_formdata(),$j("#error_msg").hide()}function confirm_product_load(a){return confirm(svgEditor.uiStrings.notification.changeProduct)?void(window.location.href=a):!1}function base64_encode(a){var b,c,d,e,f,g,h,i,j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",k=0,l=0,m="",n=[];if(!a)return a;do b=a.charCodeAt(k++),c=a.charCodeAt(k++),d=a.charCodeAt(k++),i=b<<16|c<<8|d,e=i>>18&63,f=i>>12&63,g=i>>6&63,h=63&i,n[l++]=j.charAt(e)+j.charAt(f)+j.charAt(g)+j.charAt(h);while(k<a.length);m=n.join("");var o=a.length%3;return(o?m.slice(0,o-3):m)+"===".slice(o||3)}function addnote(){$j("#addnotehidden").val($j("#addnote").val()),$j("#svg_add_note").hide()}function changeProduct(a){$j.confirm(svgEditor.uiStrings.notification.changeProduct,function(b){return b?($j(window).unbind("beforeunload"),void(window.location.href=a)):!1})}function showalert(a){$("#productchange").mb_open(),changeurl=a}function refreshpage(){window.location.href=changeurl}function hexToR(a){return parseInt(cutHex(a).substring(0,2),16)}function hexToG(a){return parseInt(cutHex(a).substring(2,4),16)}function hexToB(a){return parseInt(cutHex(a).substring(4,6),16)}function cutHex(a){return"#"==a.charAt(0)?a.substring(1,7):a}function getBrowserSize(){var a=0,b=0;return"number"==typeof window.innerWidth?(a=window.innerWidth,b=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(a=document.documentElement.clientWidth,b=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(a=document.body.clientWidth,b=document.body.clientHeight),[a,b]}function share(a,b,c,d,e){if("facebook"==e)var c="http://www.facebook.com/sharer.php?s=100&p[title]="+a+"&p[summary]="+b+"&p[url]="+c+d;else if("twitter"==e)var c="https://twitter.com/share?url=<a href='"+c+"' >My Design</a>";else if("pinterest"==e)var c="http://pinterest.com/pin/create/button/?url="+c+"&media="+d+"&description=My Design Created at doodleTogs.com&ref="+c;window.open(c,"Share Design","menubar=no,status=no,location=no,width=750,height=450,toolbar=no")}function pageload_changecolor(a,b,c){if(showLoader(),$j("#loaderImage").addClass("loader_pos"),$j("#objectinputsize ul").hide(),$j("#colorid_"+a).show(),$j("#current_product_colorid").val(a),$j("#current_product_colorhash").val(b),"yes"!=c){var d=getMatrix(b);applyMatrixFilter(d)}hideLoader(),$j("#loaderImage").removeClass("loader_pos")}function getMatrix(a){a=strPad(a,6,"0"),a=a.substr(1,6);var b=parseInt(a.substr(0,2),16),c=parseInt(a.substr(2,2),16),d=parseInt(a.substr(4,2),16),e=Number(b/255)+" 0 0 0 0 ";return e+="0 "+Number(c/255)+" 0 0 0 ",e+="0 0 "+Number(d/255)+" 0 0 ",e+="0 0 0 1 0"}function strPad(a,b,c,d){if(a.length>=b)return a;for(var e="",f=b-a.length,g=0;f>g;g++)e+=c;var h=d?e+a:a+e;return h.length>b&&(h=d?h.substr(h.length-b,h.length):h.substr(0,b)),h}function applyMatrixFilter(a){var b=document.getElementById("feColorMatrix");b.setAttributeNS(null,"type","matrix"),b.setAttributeNS(null,"values",a);for(var c=1;no_of_side>=c;c++){var d=document.getElementById("feColorMatrixIcon"+c);"undefined"!=typeof d&&null!=d&&(d.setAttributeNS(null,"type","matrix"),d.setAttributeNS(null,"values",a))}}function numeric_validation(a){if(a.target.getAttribute("maxlength")){var b=a.target.value;if(a.target.value=b.substr(0,2),parseInt(a.target.getAttribute("maxlength"))<a.target.value.length)return void a.preventDefault()}if(!(46==a.keyCode||8==a.keyCode||9==a.keyCode||27==a.keyCode||13==a.keyCode||65==a.keyCode&&a.ctrlKey===!0||a.keyCode>=35&&a.keyCode<=39))return a.shiftKey||(a.keyCode<48||a.keyCode>57)&&(a.keyCode<96||a.keyCode>105)?void a.preventDefault():void 0}function pageload_changecolor_admin(a,b){showLoader(),$j("#loaderImage").addClass("loader_pos"),$j("#objectinputsize ul").hide(),$j("#colorid_"+a).show(),$j("#current_product_colorid").val(a),$j("#current_product_colorhash").val(b),getMatrix(b),$j("#loaderImage").removeClass("loader_pos"),hideLoader()}function changecolor(a,b){$j("#loaderImage").addClass("loader_pos"),"undefined"==b&&(b="#FFFFFF");hexToR(b),hexToG(b),hexToB(b);$j("#current_product_colorid").val(a),$j("#current_product_colorhash").val(b),"onlycolor"!=productData.type&&($j("#objectinputsize ul").hide(),selectDefaultSize()),$j("#colorid_"+a).show();var c=getMatrix(b);applyMatrixFilter(c),$j.isEmptyObject(nameNumberObject)||(nameNumberObject.updateNameNumberSize(),nameNumberObject.manageFormElements&&nameNumberObject.manageFormElements()),1==isFront&&productPricingExt.getProductPrice&&productPricingExt.getProductPrice(),$j("#loaderImage").removeClass("loader_pos")}function selectDefaultSize(){var a=$j("#current_product_colorid").val(),b=!0;$j.each(productData.allColors.color[a].sizes,function(c,d){var e=parseInt($j("#size"+d.optionID+"_"+a).val());return e>0?($j("#size"+d.optionID+"_"+a).val(d.minQty),b=!1,!1):void 0}),b&&$j.each(productData.allColors.color[a].sizes,function(b,c){var d=parseInt($j("#size"+c.optionID+"_"+a).val());return 0==b&&0==d?($j("#size"+c.optionID+"_"+a).val(c.minQty),!1):void 0})}function changemulticolor(a){$j("#objectinputsize ul").hide(),$j("#colorid_"+a).show(),currentColorId=a,$j("#current_product_colorid").val(a);for(var b=1;no_of_side>=b;b++)$j("#sideButton_"+b+" ").length>0&&document.getElementById("img_"+b).setAttribute("xlink:href",productData.allColors.color[a].image[b]);$j.isEmptyObject(nameNumberObject)||nameNumberObject.manageFormElements&&nameNumberObject.manageFormElements(),productPricingExt.getProductPrice&&productPricingExt.getProductPrice()}function countcolor(){return 0}function getrelatedproductadmin(a){$j("#loaderImage").addClass("loader_pos"),showLoader(),("undefined"==typeof a||""==a)&&(a=$j("#prod_sub_type").val()),0==a?($j("#productconatiner").html(""),$j("#loaderImage").removeClass("loader_pos"),hideLoader()):$j.ajax({type:"POST",url:admin_product_url,cache:!1,data:"cat_id="+a+"&plateform="+postData.plateform+"&siteBaseUrl="+postData.siteBaseUrl+"&language_id="+postData.language_id,success:function(a){var b="";b=""==a?'<span id ="productnotfound" class="itemnotfound">'+svgEditor.uiStrings.notification.noDataFound+"</span>":a,$j("#productconatiner").html(b),$j("#loaderImage").removeClass("loader_pos"),hideLoader()}})}function getrelateddesignideaCategory(a){a=a||productid,$j("#designideaopt").empty(),$j("#designideacontainer").empty(),$j.ajax({type:"POST",url:designIdeaCategoryUrl,cache:!1,data:"pid="+a+"&plateform="+postData.plateform+"&siteBaseUrl="+postData.siteBaseUrl+"&language_id="+postData.language_id,dataType:"json",success:function(a){""==a?$j("#designideaopt").hide():($j.each(a,function(a,b){$j("#designideaopt").append("<option id=design_cat_"+a+" value="+a+">"+b+"</option>")}),$j("#designideaopt").find("option").length>1?$j("#designideaopt").show():$j("#designideaopt").hide())}})}function getrelateddesignidea(a){return $j("#loaderImage").addClass("loader_pos"),showLoader(),("undefined"==typeof a||""==a)&&(a=""==$j("#designideaopt").val()?$j("#firstdesigncat").val():$j("#designideaopt").val()),a?void(cachedDesignidea[a]?(createDesignIdeaLI(cachedDesignidea[a]),hideLoader()):$j.ajax({type:"POST",url:relatedDesignIdeaUrl,cache:!1,data:"cat_id="+a+"&printingMode="+printingMode+"&plateform="+postData.plateform+"&siteBaseUrl="+postData.siteBaseUrl+"&language_id="+postData.language_id,success:function(b){0==$j.parseJSON(b).length?$j("#designideacontainer").html(svgEditor.uiStrings.notification.noDataFound):(cachedDesignidea[a]=b,createDesignIdeaLI(b)),$j("#loaderImage").removeClass("loader_pos"),hideLoader()}})):($j("#loaderImage").removeClass("loader_pos"),hideLoader(),void $j("#designideacontainer").html(svgEditor.uiStrings.notification.noDataFound))}function createDesignIdeaLI(a){$j("#designideacontainer").empty(),$j.each(a,function(a,b){insertvalue="<li><a onclick=\"loadDesignIdeaONCanvas('"+b.svg+'\', \'load_svg\'); return false;" href="javascript:void(0);"><img  onload="ProductModule.productImageLoaded(this)" src="'+b.image+'" title="'+b.name+'" /><span>'+b.name+"</span></a></li>",$j("#designideacontainer").append(insertvalue)})}function decode64(a){var b,c,d,e,f,g=a,h="",i="",j="",k=0,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";g=g.replace(/[^A-Za-z0-9\+\/\=]/g,"");do d=l.indexOf(g.charAt(k++)),e=l.indexOf(g.charAt(k++)),f=l.indexOf(g.charAt(k++)),j=l.indexOf(g.charAt(k++)),b=d<<2|e>>4,c=(15&e)<<4|f>>2,i=(3&f)<<6|j,h+=String.fromCharCode(b),64!=f&&(h+=String.fromCharCode(c)),64!=j&&(h+=String.fromCharCode(i)),b=c=i="",d=e=f=j="";while(k<g.length);return unescape(h)}function getproductprice(){if("admin"!=user){{var a="",b="",c=$j("#current_product_colorid").val();productData.allColors.color[c]}$j.each(productData.allColors.color[c].sizes,function(d,e){var f=parseInt($j("#size"+e.optionID+"_"+c).val());f>0?(a+=parseInt(e.optionID)+",",b+=f+","):$j("#size"+e.optionID+"_"+c).val(0)}),a=a.substr(0,a.length-1),b=b.substr(0,b.length-1),$j.ajax({type:"POST",url:productPriceUrl,cache:!1,data:"colorid="+c+"&sizeidarrays="+a+"&productid="+productid+"&quantityarrays="+b+"&totalcolor="+countcolor()+"&plateform="+postData.plateform+"&siteBaseUrl="+postData.siteBaseUrl+"&language_id="+postData.language_id,success:function(a){var b;if(""==a)b='<span class="itemnotfound">'+svgEditor.uiStrings.notification.noDataFound+"</span>";else if(b=JSON.parse(a),b.bad,""==b.message)$j("#price").html(b.good),$j("#errornotinstock").hide(),$j("#addcart").show();else{var c=b.message;errorhtml='<div class="error-msg">'+c+"</div>",$j("#errornotinstock").show(),$j("#errornotinstock").html(errorhtml),$j("#addcart").hide(),$j("#price").html("")}}})}}function submit_login_scr(a){0==a?""==$j.trim($j("#email_id").val())||""==$j.trim($j("#password").val())?($j("#btn_login").removeAttr("disabled"),$j("#error_msg").show(),$j("#error_msg").html(svgEditor.uiStrings.notification.requiredDetailsAlert)):$j.ajax({type:"POST",url:loginUrl,cache:!1,data:"email_id="+$j("#email_id").val()+"&password="+$j("#password").val()+"&plateform="+postData.plateform+"&siteBaseUrl="+postData.siteBaseUrl+"&language_id="+postData.language_id,success:function(a){parseddata=JSON.parse(a),"true"!=parseddata.status?($j("#error_msg").show(),$j("#error_msg").html(parseddata.error)):(customer_id=parseddata.id,afterLoginSuccess(),close_login_form()),$j("#btn_login").removeAttr("disabled")},error:function(){$j("#btn_login").removeAttr("disabled")}}):1==a&&(""==$j.trim($j("#first_name").val())||""==$j.trim($j("#last_name").val())||""==$j.trim($j("#reg_email_id").val())||""==$j.trim($j("#reg_password").val())||""==$j.trim($j("#conf_password").val())?($j("#error_msg").show(),$j("#error_msg").html(svgEditor.uiStrings.notification.requiredDetailsAlert),$j("#btn_submit").removeAttr("disabled")):$j.ajax({type:"POST",url:registrationUrl,cache:!1,data:"firstname="+$j("#first_name").val()+"&lastname="+$j("#last_name").val()+"&email="+$j("#reg_email_id").val()+"&password="+$j("#reg_password").val()+"&confirmation="+$j("#conf_password").val()+"&plateform="+postData.plateform+"&siteBaseUrl="+postData.siteBaseUrl+"&language_id="+postData.language_id,success:function(a){parseddata=JSON.parse(a),"true"!=parseddata.status?($j("#error_msg").show(),$j("#error_msg").html(parseddata.error)):(customer_id=parseddata.id,afterLoginSuccess(),close_login_form()),$j("#btn_submit").removeAttr("disabled")},error:function(){$j("#btn_submit").removeAttr("disabled")}}))}function clickFunc(a){trace("id === "+a);var b=$j('#productmap li[value*="'+a+'"]'),c=[],d=""+a;c.push(d),$j(b).find("li").each(function(a,b){c.push(b.getAttribute("value"))}),ProductModule.getrelatedproduct(c)}function loadRelatedClipArt(a){var b=$j('#clipmap li[value*="'+a+'"]'),c=[],d=""+a;c.push(d),$j(b).find("li").each(function(a,b){c.push(b.getAttribute("value"))}),ClipArtModule.getrelatedClipArt(c)}function loadRelatedDesign(a){var b=$j('#designmap li[value*="'+a+'"]'),c=[],d=""+a;c.push(d),$j(b).find("li").each(function(a,b){c.push(b.getAttribute("value"))}),DesignArtModule.getrelatedDesign(c)}function submit_save_design_scr(){var a=$j.trim($j("#design_name").val());""==a?$j.alert(svgEditor.uiStrings.notification.specifyDesignName):($j("#svg_save_design_window").hide(),saveDesignData())}function saveDesignData(){getsvg_str(),png_data=[],curr_side_id=1,currentTime=(new Date).getTime(),generate_side()}function getUserImages(){var a=[];userImages||(""==customer_id||"undefined"===customer_id)&&"admin"!=user||($j("#flickerresult").children().length?(showLoader(),$j.each($j("#flickerresult").children().find("a"),function(b,c){var d=c.rel,e=d.split("uploadedImage/").pop(-1);a.push(e)}),$j.ajax({type:"POST",url:webpath+"designnbuy/pcstudio_media/upload",cache:!1,data:{isFront:1,images:a,customer_id:customer_id,plateform:postData.plateform,siteBaseUrl:postData.siteBaseUrl,language_id:postData.language_id},success:function(){loadUserImages(),hideLoader()},error:function(){$j.alert(svgEditor.uiStrings.notification.errorInConnection),hideLoader()}}),$j("#flickerresult").empty()):loadUserImages())}function loadUserImages(){$j.ajax({type:"POST",url:userImagesUrl,data:{customer_id:customer_id,plateform:postData.plateform,siteBaseUrl:postData.siteBaseUrl,language_id:postData.language_id,user:user},cache:!1,success:function(a){userImages=JSON.parse(a),$j.each(userImages,function(a,b){uploadCheckClass=""!=b.vectorname&&void 0!==b.vectorname?"uploadCheckTrue":"uploadCheckFalse";var c='<button title="'+svgEditor.uiStrings.elementLabel.uploadHDCaption+'" class="uploadHdButton" id="uploader_'+b.id+'" ><span class="uploadhd"><div class="uploadCheck '+uploadCheckClass+'" data-hd-id="'+b.id+'"></div><span class="caption">'+svgEditor.uiStrings.elementLabel.uploadHDCaption+"</span></span></button>",d=b.imageUrl.split(".");("svg"==d[d.length-1]||"admin"==user)&&(c="");var e='<li><img onload="lazyLoaderImg(this)" src="'+b.imageUrl+'" title="" class="lazy" /></a><div class="remove-image-sec"></button><button onclick="removeUserImages('+b.id+',this)" class="remove-image"> <i class="fa fa-trash-o"></i></button></div><div class="place-image"><a onclick="loadImageONCanvas(this.rel,'+b.id+'); return false;" class ="place-stage-image" href="javascript:void(0); return false; " target="_blank" rel="'+b.imageUrl+'" ><i class="fa fa-share"></i></a></div>'+c+"</li>";$j(e).appendTo($j("#flickerresult")),"svg"!=d[d.length-1]&&"admin"!=user&&initHDUploaders(b.id)}),hideLoader(),"gallery"==action&&($j("#images-upload").show(),$j("#galleryBtn").trigger("click"))},error:function(){$j.alert(svgEditor.uiStrings.notification.errorInConnection),hideLoader()}})}function removeUserImages(a,b){$j.confirm_custom(svgEditor.uiStrings.notification.imageDeleteWarn,function(c){if(c)if(showLoader(),""!=customer_id&&"undefined"!=typeof customer_id)$j.ajax({type:"POST",url:removeuserImagesUrl,cache:!1,data:"&userImageId="+a+"&plateform="+postData.plateform+"&siteBaseUrl="+postData.siteBaseUrl+"&language_id="+postData.language_id,success:function(c){"true"==c&&(""!=customer_id&&"undefined"!=typeof customer_id?(userImages="",$j("#flickerresult").empty(),getUserImages()):($j(b).parents("li").remove(),hideLoader(),$j("#galleryBtn").trigger("click")),removeUnusedImages(a))},error:function(){hideLoader()}});else{var d=$j(b).parents("li").find("a").attr("rel"),e=d.split("/");$j.ajax({type:"POST",url:removeuserImagesUrl,cache:!1,data:{userImageName:e[e.length-1],form_key:formkey},success:function(a){},error:function(){hideLoader()}}),$j(b).parents("li").remove(),hideLoader()}})}function removeUnusedImages(a){for(var b=1;no_of_side>=b;b++){var c=$j("#textsvg_"+b).val();if("undefined"!=typeof c&&""!=c){var d=svgedit.utilities.text2xml(c);removeUnusedImagesFromSide(d,a),$j("#textsvg_"+b).val((new XMLSerializer).serializeToString(d))}}if(removeUnusedImagesFromSide(svgCanvas.getContentElem(),a),svgCanvas.runExtensions("update"),svgCanvas.getPrivateMethods().extensions.undoRedo)for(var e=svgCanvas.getPrivateMethods().extensions.undoRedo.getStack(),b=1;b<=e.length;b++){var c=e[b];if("undefined"!=typeof c&&""!=c){var d=svgedit.utilities.text2xml(c);removeUnusedImagesFromSide(d,a),e[b]=(new XMLSerializer).serializeToString(d)}}}function showHelp(){window.open(basepath+"designnbuy/designtool/help/help-"+currentStore+"_product.html","Studio Help","width=1024,height=600,scrollbars=yes")}function save_share(a){action="save"==a?"save":"gallery"==a?"gallery":"share",shareType=a,initialLoginCheck()}function initialLoginCheck(a){$j.ajax({type:"POST",url:loginCheckUrl,cache:!1,data:"&plateform="+postData.plateform+"&siteBaseUrl="+postData.siteBaseUrl+"&language_id="+postData.language_id,success:function(b){if(response=JSON.parse(b),"true"==response.status){customer_id=response.id,$j("#btn_login_gallery").hide();var c=$j("#uploader").plupload("getUploader");c.settings.multipart_params.customer_id=customer_id}else customer_id="";a?(updateHeaderBlock(),getUserImages()):afterLoginSuccess()}})}function afterLoginSuccess(){if(""!=customer_id&&"undefined"!==customer_id){var a=$j("#uploader").plupload("getUploader");a.settings.multipart_params.customer_id=customer_id,"share"==action?share_image(shareType):"save"==action&&void 0!==postData.design_id&&"undefined"!==postData.design_id&&""!==postData.design_id?$j.confirm_custom(svgEditor.uiStrings.notification.designOverwriteWarn,function(a){a?($j("#design_name").val(postData.design_name),saveDesignData()):(postTempData=postData.design_id,postData.design_id="",$j("#svg_save_design_window").show())}):"save"==action?(postData.design_id="",$j("#svg_save_design_window").show()):"gallery"==action,$j("#btn_login_gallery").hide(),updateHeaderBlock(),getUserImages()}else $j("#svg_login_window").show()}function showLoginForHD(){$j("#svg_login_window").show(),action="uploadHD"}function updateHeaderBlock(){$j.ajax({url:welcomeMessageUrl,complete:function(a){"nopcommerce"==postData.plateform?($j("div.header-links-wrapper",parent.document).find(".header-links").empty(),$j("div.header-links-wrapper",parent.document).find(".header-links").html($j(a.responseText).html()),$j(".header",parent.document).on("mouseenter","#topcartlink",function(){$j("#flyout-cart",parent.document).addClass("active")}),$j(".header",parent.document).on("mouseleave","#topcartlink",function(){$j("#flyout-cart",parent.document).removeClass("active")}),$j(".header",parent.document).on("mouseenter","#flyout-cart",function(){$j("#flyout-cart",parent.document).addClass("active")}),$j(".header",parent.document).on("mouseleave","#flyout-cart",function(){$j("#flyout-cart",parent.document).removeClass("active")})):"prestashop"==postData.plateform?($j("header#header div.nav div.container div.row nav div.header_user_info",parent.document).remove(),$j("header#header div.nav div.container div.row nav",parent.document).prepend(a.responseText)):"magento"==postData.plateform?$j("p.welcome-msg",parent.document).html(a.responseText):$j("div.welcome",parent.document).html(a.responseText)}}),$j.ajax({url:updateTopLinksUrl,complete:function(a){"magento"==postData.plateform?$j("ul.links",parent.document).replaceWith(a.responseText):$j("#top-links",parent.document).html(a.responseText)}}),$j.ajax({url:topCartsUrl,complete:function(a){"magento"==postData.plateform?($j("div.top-cart-contain",parent.document).replaceWith(a.responseText),function(){$j(".top-cart-contain",parent.document).mouseenter(function(){$j(this).find(".top-cart-content",parent.document).stop(!0,!0).slideDown()}),$j(".top-cart-contain",parent.document).mouseleave(function(){$j(this).find(".top-cart-content",parent.document).stop(!0,!0).slideUp()})}($j)):$j("div.top-cart",parent.document).html(a.responseText)}})}function share_image(a){shareType=a,action="share",""!=customer_id&&"undefined"!==customer_id?(getsvg_str(),png_data=[],curr_side_id=1,currentTime=(new Date).getTime(),generate_side()):$j("#svg_login_window").show()}function getsvg_str(){var a=(svgEditor.canvas,svgCanvas.getContentElem());svgedit.browser.isIE()&&svgCanvas.sanitizeSvg(a);var b=$j(a).clone();b.attr("x",0),b.attr("y",0),$j("#textsvg_"+curSide).val(svgedit.browser.isWebkit()&&svgedit.browser.isMac()?svgCanvas.getSvgString():(new XMLSerializer).serializeToString(b[0]));for(var c=1;no_of_side>=c;c++)1==c?text_svg1=$j("#textsvg_1").val():2==c?text_svg2=$j("#textsvg_2").val():3==c?text_svg3=$j("#textsvg_3").val():4==c?text_svg4=$j("#textsvg_4").val():5==c?text_svg5=$j("#textsvg_5").val():6==c?text_svg6=$j("#textsvg_6").val():7==c?text_svg7=$j("#textsvg_7").val():8==c&&(text_svg8=$j("#textsvg_8").val())}function findDefs(a){var b=a.getElementsByTagNameNS(svgns,"defs");return b.length>0?b=b[0]:(b=document.createElementNS(svgns,"defs"),a.firstChild?a.insertBefore(b,a.firstChild.nextSibling):a.appendChild(b)),b}function previewImage(){svgCanvas.clearSelection(),zoomChange("100%"),getsvg_str(),$j(".preview_holder").empty(),str=$j("#product-image").html(),$j(str).attr("xmlns:xlink")||(str=str.replace("xlink=","xmlns:xlink="));for(var a=0,b=0;b<$j("#product-image").find("image").length;b++){var c="prev_img_"+b;$j("<div class = 'preview-image-slot' id='"+c+"' ></div>").appendTo($j(".preview_holder"));var d=pos_x[b+1],e=pos_y[b+1];text_svg=$j("#textsvg_"+(b+1)).val();var f=0;if(""!=text_svg){var g=svgedit.utilities.text2xml(text_svg);trace("newDoc.firstChild.childNodes");var h=g.firstChild;for(trace(h),f=0;f<h.childNodes.length;f++)if(1==h.childNodes[f].nodeType&&"g"==h.childNodes[f].tagName){trace("mask");var i=h.childNodes[f].getAttribute("mask");if(null!=i&&""!=i){i=i.replace(/"/g,""),i=i.substring(5,i.length-1),trace(i),h.childNodes[f].setAttribute("mask","url(#"+i+"_"+c+")");var j=g.getElementById(i);trace(j),j.setAttribute("id",i+"_"+c)}trace(h.childNodes[f].getAttribute("mask"))}$j(h).find("textPath").each(function(){var a=svgCanvas.getHref($j(this)[0]),b=g.getElementById(a.substring(1));svgCanvas.setHref($j(this)[0],a+"_"+c),b.setAttribute("id",a.substring(1)+"_"+c)}),$j(h).find("g").each(function(){var a=$j(this).attr("clip-path");if(a&&""!=a){a=a.replace(/"/g,""),a=a.substring(5,a.length-1);var b=g.getElementById(a);$j(this).attr("clip-path","url(#"+a+"_"+c+")"),b.setAttribute("id",a+"_"+c)}if("photobox"==this.getAttribute("type"))if("admin"==user||"true"!=this.childNodes[0].childNodes[0].getAttribute("isAdminUploaded")&&"true"!=this.childNodes[0].childNodes[0].getAttribute("isadminuploaded")||"true"==this.getAttribute("isvdp")){var a=$j(this.firstChild).attr("clip-path");if(a&&""!=a){a=a.replace(/"/g,""),a=a.substring(5,a.length-1);var b=g.getElementById(a);$j(this.firstChild).attr("clip-path","url(#"+a+"_"+c+")"),b.setAttribute("id",a+"_"+c)}}else this.parentNode.removeChild(this)});var k=g.getElementsByTagName("text");for(f=0;f<k.length;f++){var l=k[f].id,m=g.getElementById(l+"txtPathDef");if(m){k[f].setAttribute("id",l+"_"+c);var n=g.getElementById(l+"txtPath");n.setAttribute("id",n.id+"_"+c),n.setAttributeNS(ns,"xlink:href","#"+m.id+"_"+c),m.setAttribute("id",m.id+"_"+c)}}$j(h).find("image").each(function(){var a=$j(this).attr("filter");if(a&&""!=a){a=a.replace(/"/g,""),a=a.substring(5,a.length-1);var b=g.getElementById(a);$j(this).attr("filter","url(#"+a+"_"+c+")"),b&&b.setAttribute("id",a+"_"+c)}}),text_svg=(new XMLSerializer).serializeToString(g)}$j('<div style="position:absolute; left:'+d+"px; top:"+e+'px ">'+text_svg+"</div>").appendTo($j("#"+c)),$j("<div id='prod_"+c+"' >	"+str+"</div>").appendTo($j("#"+c)),$j("#prod_"+c).find("filter").attr("id","filter_"+c),images=$j("#prod_"+c).find("image").each(function(){$j(this).css("display","none"),""!=$j(this).attr("filter")&&$j(this).attr("filter","url(#filter_"+c+")"),$j(this).removeAttr("id"),$j(this).removeAttr("class")}),$j(images[b]).css("display","inline"),$j("#prod_"+c).find("svg").attr("width","400"),$j("#prod_"+c).find("svg").attr("height","485");var o=(400-parseFloat($j(images[b]).attr("width")))/2,p=(485-parseFloat($j(images[b]).attr("height")))/2;$j("#"+c).css("margin-top",p+"px"),$j("#"+c).css("margin-left",o+"px"),a+=o}var q=410*$j("#product-image").find("image").length+a+5;$j("#preview_window_container .preview_holder").css("width",q+"px")}function downloadPreview(){png_data=[],curr_side_id=1,action="preview",currentTime=(new Date).getTime(),generate_side()}function setSizePosition(a,b){b=b||4;var c,d=svgedit.utilities.getObjectBbox(a),e=svgCanvas.getZoom();c=parseFloat(design_area_width[curSide])/parseFloat(design_area_height[curSide])<=d.width/d.height?parseFloat(design_area_width[curSide])*getUnitVal()/d.width:parseFloat(design_area_height[curSide])*getUnitVal()/d.height,c/=b;var f=d.x*e,g=d.y*e;return a.setAttribute("transform","translate("+-1*f+","+-1*g+") scale("+c+") translate("+f+","+g+")"),svgCanvas.recalculateDimensions(a),svgCanvas.alignSelectedElements("c","page"),svgCanvas.alignSelectedElements("m","page"),c}function showSide(a,b){b=b||a.id.substring(a.id.indexOf("_")+1);var c=svgCanvas.getElem("text_cursor");if(c&&c.setAttribute("visibility","hidden"),trace("showSide function"),trace("curSide = "+curSide),trace("imageId = "+b),curSide==b)return!1;var d=svgCanvas.getZoom(),e=(svgEditor.curConfig.dimensions,svgEditor.canvas);$j(".main_image").hide(),$j("#img_"+b).show(),a&&$j("#textsvg_"+curSide).val(e.getSvgString()),curSide=b,svgCanvas.setSvgString(""==$j("#textsvg_"+b).val()?'<svg width="'+design_area_width[b]+'" height="'+design_area_height[b]+'" x="'+pos_x[b]+'" y="'+pos_y[b]+'" xmlns="http://www.w3.org/2000/svg"></svg>':$j("#textsvg_"+b).val()),zoomChange(100*d),updateMaskImage(),setSharePanel(),svgCanvas.runExtensions("pageChanged"),set_config_svg(design_area_width[curSide],design_area_height[curSide],pos_x[curSide],pos_y[curSide],curSide)}function createProductDesign(){showLoader(),maskImage=[],$j.each(productData.maskImages,function(a,b){maskImage.push(null!==b?b:null)});var a;a="yes"==productData.multiColor?values(void 0==productData.allColors.color[productData.postData.colorOptionId]?productData.allColors.color[Object.keys(productData.allColors.color)[0]].image:productData.allColors.color[productData.postData.colorOptionId].image):productData.productImages,ProductModule.getImages(a),ProductModule.createSidePanelIcon(),ProductModule.createPickColorPanelIcon(),ProductModule.createProductInfo(),1==isFront&&productPricingExt.createPrintingMethod&&(productPricingExt.createPrintingMethod(),productPricingExt.applyMinQuantity(),productPricingExt.getProductPrice()),updateMaskImage()}function addListeners(){$j("#cur_position").click(function(){$j("#position_opts").show()}),$j("#stroke_width").click(function(){$j("#stroke_dropdown-list").show()}),$j("#blur").click(function(){$j("#blur_dropdown-list").show()}),$j("#font_size").change(function(){svgCanvas.setFontSize($j("#font_size").val())}),$j("#tool_docprops_cancel").click(function(a){a.preventDefault(),$j("#svg_docprops").hide()}),$j("#info").click(function(a){a.preventDefault(),$j("#svg_docprops").show()}),$j("#info").one("click",function(){ProductModule.createProductInfo()}),$j("#Help").click(function(a){a.preventDefault(),showHelp()}),$j("#addcart").click(function(){insertaddtocartmessage(),$j("#cart_panel").show()}),$j("#tool_image_upload_cancel").click(function(a){a.preventDefault(),$j("#svg_image_upload").hide(),disableOther("addtimage"),$j("addtimage").addClass("active"),$j("#addtimage-panel").addClass("cbp-spmenu-open"),showHideImageGallery()}),$j("#tool_login_window_cancel").click(function(){$j("#svg_login_window").hide(),empty_formdata(),$j("#error_msg").hide()}),$j("#tool_save_design_window_cancel").click(function(){$j("#svg_save_design_window").hide(),$j("#design_name").val(""),postData.design_id=postTempData}),$j("#tool_facebook_window_cancel").click(function(){$j("#facebook_window").hide()}),$j("#tool_flickr_window_cancel").click(function(){$j("#flickr_window").hide()}),$j("#tool_picasa_window_cancel").click(function(){$j("#picasa_window").hide()}),$j("#tool_preview_window_cancel").click(function(){$j("#preview_window").hide(),$j(".preview_holder").empty()}),$j("#btn_cancel").click(function(){$j("#svg_login_window").hide(),empty_formdata(),$j("#error_msg").hide()}),$j("#btn_login").mousedown(function(){$j("#btn_login").attr("disabled","disabled"),submit_login_scr(0)
}),$j("#btn_login_gallery").mousedown(function(){$j("#images-upload").hide(),save_share("gallery")}),$j("#btn_submit").mousedown(function(){$j("#btn_submit").attr("disabled","disabled"),submit_login_scr(1)}),$j("#btn_save_design").mousedown(function(){submit_save_design_scr()}),$j("#tool_addnote_cancel").click(function(){$j("#svg_add_note").hide()}),$j("#tool_beforeaddtocart_cancel").click(function(){$j("#svg_beforeaddtocart").hide()}),$j("#designideaopt").change(function(){designIdeaCallHandler()}),$j("#tool_posleft, #tool_poscenter, #tool_posright, #tool_postop, #tool_posmiddle, #tool_posbottom, #tool_posw, #tool_posx, #tool_posy, #tool_posz, #tool_poso").on("mousedown",function(){var a=(parseFloat($j("#common-panel").css("left")),parseFloat($j("#common-panel").css("top")),this.id.replace("tool_pos","").charAt(0));"none"==$j("#tool_align_relative").css("display")?svgCanvas.alignSelectedElements(a,"page"):svgCanvas.alignSelectedElements(a,$j("#align_relative_to").val())}),$j("#inst_shape").click(function(){$j("#inst_shape_tooltip").toggle(),"none"==$j("#inst_shape_tooltip").css("display")}),$j("#exit_studio").click(function(){$j.confirm_custom(svgEditor.uiStrings.notification.designExit,function(a){a&&($j(window).unbind("beforeunload"),"1"==preTemplate?parent.document.location.href=exitUrl:document.location.href=exitUrl)})}),$j(".import_flickr").on("click",function(){$j("#flickr_window").show(),$j(".qrcode-section").hide(),$j("#flickerresult").show()}),$j(".import_picasa").on("click",function(){$j("#picasa_window").show(),$j(".qrcode-section").hide(),$j("#flickerresult").show()}),$j("#preview").on("click",function(){1==productData.is_3d?(svgCanvas.getPrivateMethods().extensions.threedpreview.previewImage(),$j("#downloadPreviewCaption").hide()):($j("#preview_window").show(),previewImage(),$j("#downloadPreviewCaption").show())}),$j("#inst").on("click",function(){$j("#design_tooltip").toggle()}),$j("#inst_text").on("click",function(){$j("#inst_text_tooltip").toggle()}),$j("#inst_image").on("click",function(){$j("#upload_info_window").show()}),$j("#inst_image_hd").on("click",function(){$j("#upload_info_hd_window").show()}),$j("#inst_image_format").on("click",function(){$j("#image_quality_window").show()}),$j("#text_align_left").click(function(){setAlign("start")}),$j("#text_align_center").click(function(){setAlign("middle")}),$j("#text_align_right").click(function(){setAlign("end")}),$j("#zoomButton").click(function(){$j("#zoomOptions").toggle(),setHideOnClick($j("#zoomOptions"))}),$j("#zoomOptions").find("li").mousedown(function(){var a=$j(this),b=a.attr("data-val");zoomChange(a.text(),b)}),$j("#save_template").click(function(){document.getElementById("save_template").disabled=!0,showLoader(),saveTemplate()}),$j("#upload_img_show_gallery").click(function(a){a.preventDefault(),disableOther("editpanel"),$j("#edit-panel").addClass("cbp-spmenu-open"),$j("#images_loaded").show()}),$j("#tool_choose_prod_close").mouseup(function(a){0==a.button&&($j("#addproduct-panel").removeClass("cbp-spmenu-open"),$j("#addproduct").removeClass("active"),$j(".canvas-heading").addClass("preview_portrait"))}),$j("#tool_pick_color_close").mouseup(function(a){0==a.button&&($j("#pickcolor-panel").removeClass("cbp-spmenu-open"),$j("#pickcolor").removeClass("active"),$j(".canvas-heading").addClass("preview_portrait"))}),$j("#tool_add_art_close").mouseup(function(a){0==a.button&&($j("#addart-panel").removeClass("cbp-spmenu-open"),$j("#addart").removeClass("active"),$j(".canvas-heading").addClass("preview_portrait"))}),$j("#tool_place_text_close").mouseup(function(a){0==a.button&&($j("#tool_font_family").hide(),$j("#addtext-panel").removeClass("cbp-spmenu-open"),$j("#common-panel").removeClass("cbp-spmenu-open"),$j("#addtext").removeClass("active"),$j(".canvas-heading").addClass("preview_portrait"))}),$j("#tool_add_image_close").mouseup(function(a){0==a.button&&($j("#addtimage-panel").removeClass("cbp-spmenu-open"),$j("#addtimage").removeClass("active"),$j(".canvas-heading").addClass("preview_portrait"))}),$j("#tool_add_shape_close").mouseup(function(a){0==a.button&&($j("#addshape-panel").removeClass("cbp-spmenu-open"),$j("#addshape").removeClass("active"),$j(".canvas-heading").addClass("preview_portrait"))}),$j("#tool_design_idea_close").mouseup(function(a){0==a.button&&($j("#desingidea").removeClass("active"),$j("#designidea-panel").removeClass("cbp-spmenu-open"),$j(".canvas-heading").addClass("preview_portrait"))}),$j("#tool_edit_close").mouseup(function(a){0==a.button&&($j("#edit-panel").removeClass("cbp-spmenu-open"),$j("#common-panel").removeClass("cbp-spmenu-open"),$j(".canvas-heading").addClass("preview_portrait"))}),$j("#pickcolor").mouseup(function(a){0==a.button&&(svgCanvas.clearSelection(!0),disableOther("pickcolor"),$j(this).addClass("active"),$j("#pickcolor-panel").addClass("cbp-spmenu-open"))}),$j("#addart").mouseup(function(a){0==a.button&&(svgCanvas.clearSelection(!0),disableOther("addart"),$j(this).addClass("active"),$j("#addart-panel").addClass("cbp-spmenu-open"))}),$j("#btnAddText").on("click",function(a){if(0==a.button){if(!$j("#text").val())return void $j.alert(svgEditor.uiStrings.notification.ADDTEXT_ALERT);start_x=752,start_y=377,started=!0;var b=svgCanvas.addSvgElementFromJson({element:"text",curStyles:!0,attr:{x:$j("#canvasBackground").attr("width")/2,y:$j("#canvasBackground").attr("height")/2,id:svgCanvas.getNextId(),fill:"#000000","stroke-width":"0","font-size":"24","font-family":first_font,"text-anchor":"middle","xml:space":"preserve",opacity:"1"}}),c=$j("#text").val().split("\n");c.length>1?svgCanvas.setMultiTextContent(b,$j("#text").val()):b.textContent=$j("#text").val(),svgCanvas.keep=!0,svgCanvas.selectOnly([b],!0),svgCanvas.runExtensions("elementChanged",{elems:[b]})}}),$j("#addtext").on("click",function(){svgCanvas.getSelectedElems().length&&svgCanvas.clearSelection(),$j("#text").val(""),disableOther("addtext"),$j("#addtext-panel").addClass("cbp-spmenu-open"),$j("#common-panel").addClass("cbp-spmenu-open"),$j(".group_ungroup").hide(),$j(".align_icons").hide(),$j("#btnAddText").show(),$j("#text_popup").show(),$j("#add_text").val(""),$j("#common-panel").removeClass("cbp-spmenu-open")}),$j("#addshape").mouseup(function(a){0==a.button&&(disableOther("addshape"),$j(this).addClass("active"),$j("#addshape-panel").addClass("cbp-spmenu-open"),$j("#tools_rect").hide())}),$j("#qrCode").mouseup(function(a){0==a.button&&(svgCanvas.clearSelection(!0),handleSocialMediaGallery(),disableOther("qrCode"),$j(this).addClass("active"),$j("#qr_color").trigger("mousedown"),$j("#websiteurl").val(""),$j("#websiteurl-error").hide(),$j(".qrcode-section").show(),$j("#uploader").hide(),$j("#flickerresult").hide(),$j("#gallery_warn_msg_con").hide())}),$j("#desingidea").mouseup(function(a){0==a.button&&(designIdeasloaded||(designIdeasloaded=1),svgCanvas.clearSelection(!0),disableOther("desingidea"),$j(this).addClass("active"),$j("#designidea-panel").addClass("cbp-spmenu-open"))}),$j("#inst_edit_panel").click(function(){$j("#design_tooltip_edit_panel").toggle(),"none"==$j("#design_tooltip_edit_panel").css("display")}),$j("#layerPanel").mouseup(function(a){0==a.button&&(svgCanvas.clearSelection(),disableOther("layerPanel"),$j("#layer-panel").addClass("cbp-spmenu-open"))}),$j("#addtocart_btn").mouseup(function(a){0==a.button&&(svgCanvas.clearSelection(!0),disableOther("addtocart"),$j("#addtocart-panel").addClass("cbp-spmenu-open"))}),$j("#alignPanel").mousedown(function(a){0!=a.button||$j("#alignPanel").hasClass("disabled")||$j("#alignPanel").hasClass("disabled")&&"admin"!=user||$j(".align_icons").show()}),$j("#prevColor").on("click",function(a){if(0==a.button){var b=parseInt($j("#pickcolor-panel .pickcolor-list").css("margin-left"));0>b?(b+=48,$j("#nextColor").removeClass("disabled")):$j("#prevColor").addClass("disabled"),$j("#pickcolor-panel .pickcolor-list").css("margin-left",b+"px")}}),$j("#nextColor").on("click",function(a){if(console.log(productData),0==a.button){var b=parseInt($j("#pickcolor-panel div .gallery .pickcolor-list").css("margin-left"));console.log("margin::"+b);var c=parseInt($j("#pickcolor-panel .gallery").css("width"));console.log("gallerywidth::"+c);var d=parseInt($j("#pickcolor-panel ").css("width"));console.log("itemwidth::"+d),b+d>c?(b-=48,$j("#prevColor").removeClass("disabled")):$j("#nextColor").addClass("disabled"),$j("#pickcolor-panel .pickcolor-list").css("margin-left",b+"px")}}),$j("#previousSide").on("click",function(a){if(0==a.button){var b=parseInt($j("#productSides").css("margin-left"));0>b?(b+=72,$j("#nextSide").removeClass("disabled")):$j("#previousSide").addClass("disabled"),$j("#productSides").css("margin-left",b+"px")}}),$j("#nextSide").on("click",function(a){if(0==a.button){var b=parseInt($j("#productSides").css("margin-left")),c=parseInt($j("#pickside-panel").css("width")),d=parseInt($j("#productSides").css("width"));b+d-72>c?(b-=72,$j("#previousSide").removeClass("disabled")):$j("#nextSide").addClass("disabled"),$j("#productSides").css("margin-left",b+"px")}}),$j("#products-settings").click(function(){$j("#addtocart-panel").css("right","0px"),$j(".search").css("right","-440px"),svgCanvas.getSelectedElems().length&&svgCanvas.clearSelection(),$j("#cart_panel").show(),$j("#svg_docprops").hide(),$j("#addtocart-panel").removeClass("disabled")}),$j("#forgetPasswordCaption").attr("href",forgetpasswordURL),$j("#pickcolor-panel").draggable(),$j("#common-panel").draggable({start:function(){},drag:function(){svgCanvas.getSelectedElems().length&&0==svgCanvas.getSelectedElems()[0].id.indexOf("svg_")?$j("#common-panel").css("width","447px"):$j("#common-panel").css("width","580px")},stop:function(){},containment:"#container_dt"}),$j("#tool_close").click(function(){$j("#common-panel").removeClass("cbp-spmenu-open")})}function manageColorPanel(){$j("#font-selector-con").hide(),$j("#textShapeDD").removeClass("active"),$j("#textShapeDD .shape_con").hide(),$j(".text-align").hide()}function closeColorPanel(){$j("#common_upper_open_panel").hide()}function closeQrColorPanel(){$j("#qr_colorpicker_con").hide()}function manageCommonPanel(){if(0!=svgCanvas.getSelectedElems().length){var a=$j(svgCanvas.getSelectedElems())[0].getBBox(),b=a.width/2,c=(a.height,$j(".main_dt").offset().top),d=$j(".main_dt").offset().left,e=$j("#common-panel").outerWidth()/2,f=$j("#common-panel").outerHeight(),g=30;$j(".align_icons").show(),"text"==$j(svgCanvas.getSelectedElems()).attr("type")&&(g=80);{parseInt($j(svgCanvas.getSelectedElems()).offset().left-e+b-d),parseInt($j(svgCanvas.getSelectedElems()).offset().top-(f+c+g))}$j("#common-panel").addClass("cbp-spmenu-open"),$j.isEmptyObject(nameNumberObject)||($j(".sambhavNameNum").hide(),("nameText"==$j(svgCanvas.getSelectedElems()).attr("id")||"numberText"==$j(svgCanvas.getSelectedElems()).attr("id"))&&($j(".clearfix").hide(),$j(".sambhavNameNum").show(),$j("#common-panel").css("width","530px"),$j("#textNameShapeDD .shape_con").hide(),$j("#textNumberShapeDD .shape_con").hide(),$j("#name-font-selector-con").hide(),$j("#number-font-selector-con").hide()))}}function addtocart(){getsvg_str(),png_data=[],curr_side_id=1,action="addtocart",currentTime=(new Date).getTime(),generate_side(),$j(".svgcanvas").hide()}function insertaddtocartmessage(){var a=productPriceData.good,b='<div class="clr"><label class="label">'+svgEditor.uiStrings.elementLabel.productSkuCaption+" :</label>"+configsku+"</div>",c="";if("configurable"==productData.type){{var d=$j("#current_product_colorid").val();productData.allColors.color[d]}if($j.each(productData.allColors.color[d].sizes,function(a,b){var c=parseInt($j("#size"+b.optionID+"_"+d).val());return c>0?(isqty_good="yes",!1):($j("#size"+b.optionID+"_"+d).val(0),void(isqty_good="not"))}),"not"==isqty_good)return $j("#addtocartmessage").html(configqtymessage),$j("#svg_beforeaddtocart").show(),$j(".proceedto").hide(),void hideLoader();b+='<div class="clr"><label class="label selected_size" >'+svgEditor.uiStrings.elementLabel.selectedColorCaption+" :</label>"+productData.allColors.color[d].colorName+"</div>",b+='<div class="clr"><label class="label selected_size" >'+svgEditor.uiStrings.elementLabel.selectedSizeCaption+" :</label>",b+='<ul class="multi_Size">';for(var e=productPriceData.colorSizeTotalPrice,f=Object.keys(e),g=productData.allColors.color[d].sizes,h=0;h<f.length;h++)for(var i=Object.keys(e[f[h]]),j=0;j<i.length;j++){var k=getObjectFromArray(g,"optionName",i[j])[0],l=parseInt($j("#size"+k.optionID+"_"+d).val());l&&(b+='<li><div class="size_name">'+i[j]+'</div><div class="size_price">'+e[f[h]][i[j]]+' </div><div class="size_number">'+l+"</div></li>")}b+="</ul>"}else if("onlysize"==productData.type){if($j.each(productData.allColors.size,function(a,b){var c=parseInt($j("#size"+b.optionID).val());return c>0?(isqty_good="yes",!1):($j("#size"+b.optionID).val(0),void(isqty_good="not"))}),"not"==isqty_good)return $j("#addtocartmessage").html(configqtymessage),$j("#svg_beforeaddtocart").show(),$j(".proceedto").hide(),void hideLoader();b+='<div class="clr"><label class="label selected_size" >'+svgEditor.uiStrings.elementLabel.selectedSizeCaption+" :</label>",b+='<ul class="multi_size">';for(var e=productPriceData.colorSizeTotalPrice,i=Object.keys(e),g=productData.allColors.size,j=0;j<i.length;j++){var k;$j.each(g,function(a,b){b.optionName==i[j]&&(k=b)});var l=parseInt($j("#size"+k.optionID).val());l&&(b+='<li><div class="size_name">'+i[j]+'</div><div class="size_price">'+e[i[j]]+' </div><div class="size_number">'+l+"</div></li>")}b+="</ul>"}else if("onlycolor"==productData.type){var l=parseInt($j("#quantity").val());if(isqty_good=l>0?"yes":"not","not"==isqty_good)return $j("#addtocartmessage").html(configqtymessage),$j("#svg_beforeaddtocart").show(),void hideLoader();var d=$j("#current_product_colorid").val();b+='<div class="clr"><label class="label selected_size" >'+svgEditor.uiStrings.elementLabel.selectedColorCaption+" :</label>"+productData.allColors.color[d].colorName+" - "+productPriceData.colorSizeTotalPrice[productData.allColors.color[d].colorName]+"</div>",b+='<div class="clr"><label class="label" >'+svgEditor.uiStrings.elementLabel.QuantityCaption+" :</label>"+l;for(var e=productPriceData.colorSizeTotalPrice,i=Object.keys(e),j=0;j<i.length;j++)c+=i[j]+" - "+e[i[j]]+"<br>"}else{var l=parseInt($j("#quantity").val());if(isqty_good=l>0?"yes":"not","not"==isqty_good)return $j("#addtocartmessage").html(configqtymessage),$j("#svg_beforeaddtocart").show(),void hideLoader();var e=productPriceData.colorSizeTotalPrice;b+='<div class="clr"><label class="label" >'+svgEditor.uiStrings.elementLabel.QuantityCaption+" :</label>"+l,b+='<div class="clr"><label class="label" >'+svgEditor.uiStrings.elementLabel.productPriceCaption+" :</label>"+e}if(svgCanvas.getPrivateMethods().extensions.productPricing){{var m=svgCanvas.getPrivateMethods().extensions.productPricing.getCurrentPrintingMethod();svgCanvas.getPrivateMethods().extensions.productPricing.getPricingLogicType(m.pricingLogic)}b+='<div class="clr borderTop"><label class="label">'+svgEditor.uiStrings.elementLabel.printingMethodCaption+" :</label>"+m.name+"</div>"}b+='<div class="clr"><label class="label">'+svgEditor.uiStrings.elementLabel.printingPriceCaption+" :</label>"+productPriceData.printingPrice+"</div>",b+='<div class="clr"><label class="label">'+svgEditor.uiStrings.elementLabel.clipartPriceCaption+" :</label>"+productPriceData.clipartPrice+"</div>",b+='<div class="clr"><label class="label">'+svgEditor.uiStrings.elementLabel.imageUploadPriceCaption+" :</label>"+productPriceData.imageUploadPrice+"</div>",$j.isEmptyObject(nameNumberObject)||(b+='<div class="clr"><label class="label">'+svgEditor.uiStrings.elementLabel.namePriceCaption+" :</label>"+productPriceData.namePrice+"</div>",b+='<div class="clr"><label class="label">'+svgEditor.uiStrings.elementLabel.numberPriceCaption+" :</label>"+productPriceData.numberPrice+"</div>"),b+='<div class="clr"><label class="label">'+svgEditor.uiStrings.elementLabel.artWorkSetupPriceCaption+" :</label>"+productPriceData.artWorkSetupPrice+"</div>",b+='<div class="clr borderTop"><label class="label">'+svgEditor.uiStrings.elementLabel.avgPrintPriceCaption+" :</label>"+productPriceData.avgPrintingPrice+"</div>",b+="</div>",b+='<div class="clr borderTop borderBottom"><label class="label">'+svgEditor.uiStrings.elementLabel.totalPriceCaption+" :</label>"+a+"</div>",$j("#addtocartmessage").html(b),$j("#svg_beforeaddtocart").show(),$j(".proceedto").show(),$j("#cartProceed").show(),$j("#back_to_cart").show(),hideLoader()}function backtocart(){$j("#back_to_cart").hide(),$j("#addtocart-panel").animate({right:"0px"}),$j(".search").animate({right:"-440px"}),$j("#cart_panel").show(),$j("#svg_docprops").hide(),$j("#addcart").show(),$j("#cartProceed").hide(),$j("#addtocart-panel").removeClass("disabled")}function setPropertiesInpanel(a){if(1===a.nodeType){a=a||svgCanvas.getSelectedElems()[0],setAlignButton(a.getAttribute("text-anchor"));var b=getStrokeStyle(a);$j("#border_style_0").removeClass("selected"),$j("#border_style_1").removeClass("selected"),$j("#border_style_2").removeClass("selected"),$j("#border_style_3").removeClass("selected"),b?"none"==b?$j("#border_style_0").addClass("selected"):"2,2"==b?$j("#border_style_1").addClass("selected"):"5,5"==b?$j("#border_style_2").addClass("selected"):"5,2,2,2"==b&&$j("#border_style_3").addClass("selected"):$j("#border_style_0").addClass("selected");var c;if(c="text"==a.getAttribute("type")?svgCanvas.getPrivateMethods().extensions.textShape.getTextStrokeWidth(a):getStrokeWidth(a),$j("#stroke_slider").slider("value",c),$j("#stroke_width").val(c),$j("#border_size_0").removeClass("selected"),$j("#border_size_1").removeClass("selected"),$j("#border_size_2").removeClass("selected"),$j("#border_size_3").removeClass("selected"),$j("#border_size_4").removeClass("selected"),$j("#border_size_5").removeClass("selected"),$j("#border_size_6").removeClass("selected"),$j("#border_size_"+c).addClass("selected"),"nameText"==a.id){var d=a.getAttribute("font-family");$j("#selectedNameFont").text(d),$j("#selectedNameFont")[0].setAttribute("style","font-family: "+d),$j("#name-font-selector li").removeClass("selected");var e;$j.each($j("#name-font-selector").find("li"),function(a,b){return b.getAttribute("font-name")==d?(e=b,!1):void 0}),$j(e).addClass("selected");var f=a.getAttribute("shapeId"),g=svgCanvas.getPrivateMethods().extensions.textShape.getShapeObject("id",f);$j("#textNameShapeDD .shape_con li").removeClass("selected"),$j('#textNameShapeDD .shape_con li[value="'+g.id+" name="+g.name+'"]').addClass("selected"),$j("#textNameShapeDD img")[0].setAttribute("src",jspath+g.image),$j("#fill_nameText svg rect").attr("fill",getFill(a))}else if("numberText"==a.id){var d=a.getAttribute("font-family");$j("#selectedNumberFont").text(d),$j("#selectedNumberFont")[0].setAttribute("style","font-family: "+d),$j("#number-font-selector li").removeClass("selected");var e;$j.each($j("#number-font-selector").find("li"),function(a,b){return b.getAttribute("font-name")==d?(e=b,!1):void 0}),$j(e).addClass("selected");var f=a.getAttribute("shapeId"),g=svgCanvas.getPrivateMethods().extensions.textShape.getShapeObject("id",f);$j("#textNumberShapeDD .shape_con li").removeClass("selected"),$j('#textNumberShapeDD .shape_con li[value="'+g.id+" name="+g.name+'"]').addClass("selected"),$j("#textNumberShapeDD img")[0].setAttribute("src",jspath+g.image),$j("#fill_numberText svg rect").attr("fill",getFill(a))}else if("text"==a.getAttribute("type")){$j("#text").val(addSpecialChar(a.getAttribute("text")));var d=a.getAttribute("font-family");$j("#selectedFont").text(d),$j("#selectedFont")[0].setAttribute("style","font-family: "+d),$j("#font-selector li").removeClass("selected");var e;$j.each($j("#font-selector").find("li"),function(a,b){return b.getAttribute("font-name")==d?(e=b,!1):void 0}),$j(e).addClass("selected"),svgCanvas.getPrivateMethods().extensions.textShape.updateBoldItalic(a.getAttribute("font-family")),$j("#tool_bold").removeClass("push_button_pressed"),svgCanvas.getPrivateMethods().extensions.textShape.hasBold&&"bold"==a.getAttribute("font-weight")&&$j("#tool_bold").addClass("push_button_pressed"),$j("#tool_italic").removeClass("push_button_pressed"),svgCanvas.getPrivateMethods().extensions.textShape.hasItalic&&"italic"==a.getAttribute("font-style")&&$j("#tool_italic").addClass("push_button_pressed"),$j(".currentFontSize").html(svgEditor.uiStrings.elementLabel.currentFontSize+": "+Math.round(100*a.getAttribute("font-size"))/100);var h=$j(".textFontSizePanel .shape_con").find("button");h.removeClass("selected");for(var i=0;i<h.length;i++)if(h[i].value==a.getAttribute("font-size")){$j(h[i]).addClass("selected");break}$j("#textShapeSlider").slider("value",a.getAttribute("shapeVal")),$j("#shapeValue").val(a.getAttribute("shapeVal")),$j("#lineSpaceSlider").slider("value",a.getAttribute("lineHeight")),$j("#lineHeight").val(a.getAttribute("lineHeight"));var f=a.getAttribute("shapeId"),g=svgCanvas.getPrivateMethods().extensions.textShape.getShapeObject("id",f);$j("#textShapeDD .shape_con li").removeClass("selected"),$j('#textShapeDD .shape_con li[value="'+g.id+" name="+g.name+'"]').addClass("selected"),$j("#textShapeDD img")[0].setAttribute("src",jspath+g.image)}}}function getFill(a){return a=a||svgCanvas.getSelectedElems()[0],a.childNodes.length?a.childNodes[0].getAttribute("fill")?a.childNodes[0].getAttribute("fill"):"#000000":a.getAttribute("fill")?a.getAttribute("fill"):"#000000"}function getStroke(a){return a=a||svgCanvas.getSelectedElems()[0],a.childNodes.length?getStroke(a.childNodes[0]):a.tagName&&"title"!=a.tagName&&a.hasAttribute("stroke")?a.getAttribute("stroke"):"#000000"}function getStrokeStyle(a){return a=a||svgCanvas.getSelectedElems()[0],a.childNodes.length?getStrokeStyle(a.childNodes[0]):a.tagName&&"title"!=a.tagName&&a.hasAttribute("stroke-dasharray")?a.getAttribute("stroke-dasharray"):"none"}function getStrokeWidth(a){if(a=a||svgCanvas.getSelectedElems()[0],a.childNodes.length){if(a.childNodes[0].tagName&&"text"==a.childNodes[0].getAttribute("type"))return svgCanvas.getPrivateMethods().extensions.textShape.getTextStrokeWidth(a.childNodes[0]);if(a.childNodes[0].tagName&&a.childNodes[0].hasAttribute("stroke-width"))return parseInt(a.childNodes[0].getAttribute("stroke-width"));if(a.childNodes[0].tagName&&a.childNodes[0].hasAttribute("stroke")){var b=a.childNodes[0].getAttribute("stroke");return"none"!=b&&"null"!=b?"1":"0"}return"0"}if(a.tagName&&a.hasAttribute("stroke-width"))return parseInt(a.getAttribute("stroke-width"));if(a.hasAttribute("stroke")){var b=a.getAttribute("stroke");return"none"!=b&&"null"!=b?"1":"0"}return"0"}function afteraddtocart(){showLoader(!0);var a,b=$j("#current_product_colorid").val(),c=0,d=0,e=(filearray,(new Date).getTime()),f=encodeURIComponent(JSON.stringify(nameNumberObject.getNameNumberData()));if("configurable"==productData.type)$j.each(productData.allColors.color[b].sizes,function(g,h){var i=(parseInt(h.optionID),parseInt($j("#size"+h.optionID+"_"+b).val()));a="magento"==postData.plateform?{designed_id:currentTime,side1_svg:filearray[0],side2_svg:filearray[1],side3_svg:filearray[2],side4_svg:filearray[3],side5_svg:filearray[4],side6_svg:filearray[5],side7_svg:filearray[6],side8_svg:filearray[7],side1_png:filearray[8],side2_png:filearray[9],side3_png:filearray[10],side4_png:filearray[11],side5_png:filearray[12],side6_png:filearray[13],side7_png:filearray[14],side8_png:filearray[15],qty:i,form_key:formKey,customization_unique_id:e,addtocartparam:JSON.stringify(h.addtocartparam),no_of_side:no_of_side,notes:encodeURIComponent($j("#addnote").val()),printingMethod:JSON.stringify(pricingData.printingMethod),plateform:postData.plateform,siteBaseUrl:postData.siteBaseUrl,language_id:postData.language_id,product:productid,cart_id:cart_id,cart_design_id:cart_design_id,selected_configurable_option:h.productID,totalname:nameNumberObject.getNameCount(),totalnumber:nameNumberObject.getNumberCount(),namenumData:f}:{designed_id:currentTime,side1_svg:filearray[0],side2_svg:filearray[1],side3_svg:filearray[2],side4_svg:filearray[3],side5_svg:filearray[4],side6_svg:filearray[5],side7_svg:filearray[6],side8_svg:filearray[7],side1_png:filearray[8],side2_png:filearray[9],side3_png:filearray[10],side4_png:filearray[11],side5_png:filearray[12],side6_png:filearray[13],side7_png:filearray[14],side8_png:filearray[15],qty:i,form_key:formKey,customization_unique_id:e,addtocartparam:JSON.stringify(h.addtocartparam),no_of_side:no_of_side,notes:encodeURIComponent($j("#addnote").val()),printingMethod:JSON.stringify(pricingData.printingMethod),plateform:postData.plateform,siteBaseUrl:postData.siteBaseUrl,language_id:postData.language_id,productid:productid,cart_id:cart_id,cart_design_id:cart_design_id,totalname:nameNumberObject.getNameCount(),totalnumber:nameNumberObject.getNumberCount(),namenumData:f},i>0&&(c++,$j.ajax({type:"POST",url:addToCartUrl,cache:!1,data:a,success:function(){d++,d==c&&(hideLoader(),$j(window).unbind("beforeunload"),window.top.location=cartUrl)}}))});else if("onlysize"==productData.type)$j.each(productData.allColors.size,function(b,g){var h=parseInt($j("#size"+g.optionID).val());a="magento"==postData.plateform?{designed_id:currentTime,side1_svg:filearray[0],side2_svg:filearray[1],side3_svg:filearray[2],side4_svg:filearray[3],side5_svg:filearray[4],side6_svg:filearray[5],side7_svg:filearray[6],side8_svg:filearray[7],side1_png:filearray[8],side2_png:filearray[9],side3_png:filearray[10],side4_png:filearray[11],side5_png:filearray[12],side6_png:filearray[13],side7_png:filearray[14],side8_png:filearray[15],qty:h,form_key:formKey,customization_unique_id:e,addtocartparam:JSON.stringify(g.addtocartparam),no_of_side:no_of_side,notes:encodeURIComponent($j("#addnote").val()),printingMethod:JSON.stringify(pricingData.printingMethod),plateform:postData.plateform,siteBaseUrl:postData.siteBaseUrl,language_id:postData.language_id,product:productid,cart_id:cart_id,cart_design_id:cart_design_id,selected_configurable_option:g.productID,totalname:nameNumberObject.getNameCount(),totalnumber:nameNumberObject.getNumberCount(),namenumData:f}:{designed_id:currentTime,side1_svg:filearray[0],side2_svg:filearray[1],side3_svg:filearray[2],side4_svg:filearray[3],side5_svg:filearray[4],side6_svg:filearray[5],side7_svg:filearray[6],side8_svg:filearray[7],side1_png:filearray[8],side2_png:filearray[9],side3_png:filearray[10],side4_png:filearray[11],side5_png:filearray[12],side6_png:filearray[13],side7_png:filearray[14],side8_png:filearray[15],qty:h,form_key:formKey,customization_unique_id:e,addtocartparam:JSON.stringify(g.addtocartparam),no_of_side:no_of_side,notes:encodeURIComponent($j("#addnote").val()),printingMethod:JSON.stringify(pricingData.printingMethod),plateform:postData.plateform,siteBaseUrl:postData.siteBaseUrl,language_id:postData.language_id,productid:productid,cart_id:cart_id,cart_design_id:cart_design_id,totalname:nameNumberObject.getNameCount(),totalnumber:nameNumberObject.getNumberCount(),namenumData:f},h>0&&(c++,$j.ajax({type:"POST",url:addToCartUrl,cache:!1,data:a,success:function(){d++,d==c&&(hideLoader(),$j(window).unbind("beforeunload"),window.top.location=cartUrl)}}))});else if("onlycolor"==productData.type){var g=parseInt($j("#quantity").val());a="magento"==postData.plateform?{designed_id:currentTime,side1_svg:filearray[0],side2_svg:filearray[1],side3_svg:filearray[2],side4_svg:filearray[3],side5_svg:filearray[4],side6_svg:filearray[5],side7_svg:filearray[6],side8_svg:filearray[7],side1_png:filearray[8],side2_png:filearray[9],side3_png:filearray[10],side4_png:filearray[11],side5_png:filearray[12],side6_png:filearray[13],side7_png:filearray[14],side8_png:filearray[15],qty:g,form_key:formKey,customization_unique_id:e,addtocartparam:JSON.stringify(productData.allColors.color[b].addtocartparam),no_of_side:no_of_side,notes:encodeURIComponent($j("#addnote").val()),printingMethod:JSON.stringify(pricingData.printingMethod),plateform:postData.plateform,siteBaseUrl:postData.siteBaseUrl,language_id:postData.language_id,product:productid,cart_id:cart_id,cart_design_id:cart_design_id,selected_configurable_option:productData.allColors.color[b].productID,totalname:nameNumberObject.getNameCount(),totalnumber:nameNumberObject.getNumberCount(),namenumData:f}:{designed_id:currentTime,side1_svg:filearray[0],side2_svg:filearray[1],side3_svg:filearray[2],side4_svg:filearray[3],side5_svg:filearray[4],side6_svg:filearray[5],side7_svg:filearray[6],side8_svg:filearray[7],side1_png:filearray[8],side2_png:filearray[9],side3_png:filearray[10],side4_png:filearray[11],side5_png:filearray[12],side6_png:filearray[13],side7_png:filearray[14],side8_png:filearray[15],qty:g,form_key:formKey,customization_unique_id:e,addtocartparam:JSON.stringify(productData.allColors.color[b].addtocartparam),no_of_side:no_of_side,notes:encodeURIComponent($j("#addnote").val()),printingMethod:JSON.stringify(pricingData.printingMethod),plateform:postData.plateform,siteBaseUrl:postData.siteBaseUrl,language_id:postData.language_id,productid:productid,cart_id:cart_id,cart_design_id:cart_design_id,totalname:nameNumberObject.getNameCount(),totalnumber:nameNumberObject.getNumberCount(),namenumData:f},g>0&&(c++,$j.ajax({type:"POST",url:addToCartUrl,cache:!1,data:a,success:function(){d++,d==c&&(hideLoader(),$j(window).unbind("beforeunload"),window.top.location=cartUrl)}}))}else{var g=parseInt($j("#quantity").val());a="magento"==postData.plateform?{designed_id:currentTime,side1_svg:filearray[0],side2_svg:filearray[1],side3_svg:filearray[2],side4_svg:filearray[3],side5_svg:filearray[4],side6_svg:filearray[5],side7_svg:filearray[6],side8_svg:filearray[7],side1_png:filearray[8],side2_png:filearray[9],side3_png:filearray[10],side4_png:filearray[11],side5_png:filearray[12],side6_png:filearray[13],side7_png:filearray[14],side8_png:filearray[15],qty:g,form_key:formKey,customization_unique_id:e,addtocartparam:JSON.stringify(productData.allColors.addtocartparam),no_of_side:no_of_side,notes:encodeURIComponent($j("#addnote").val()),printingMethod:JSON.stringify(pricingData.printingMethod),plateform:postData.plateform,siteBaseUrl:postData.siteBaseUrl,language_id:postData.language_id,product:productid,cart_id:cart_id,cart_design_id:cart_design_id,totalname:nameNumberObject.getNameCount(),totalnumber:nameNumberObject.getNumberCount(),namenumData:f}:{designed_id:currentTime,side1_svg:filearray[0],side2_svg:filearray[1],side3_svg:filearray[2],side4_svg:filearray[3],side5_svg:filearray[4],side6_svg:filearray[5],side7_svg:filearray[6],side8_svg:filearray[7],side1_png:filearray[8],side2_png:filearray[9],side3_png:filearray[10],side4_png:filearray[11],side5_png:filearray[12],side6_png:filearray[13],side7_png:filearray[14],side8_png:filearray[15],qty:g,form_key:formKey,customization_unique_id:e,addtocartparam:JSON.stringify(productData.allColors.addtocartparam),no_of_side:no_of_side,notes:encodeURIComponent($j("#addnote").val()),printingMethod:JSON.stringify(pricingData.printingMethod),plateform:postData.plateform,siteBaseUrl:postData.siteBaseUrl,language_id:postData.language_id,productid:productid,cart_id:cart_id,cart_design_id:cart_design_id,totalname:nameNumberObject.getNameCount(),totalnumber:nameNumberObject.getNumberCount(),namenumData:f},g>0&&$j.ajax({type:"POST",url:addToCartUrl,cache:!1,data:a,success:function(){hideLoader(),$j(window).unbind("beforeunload"),window.top.location=cartUrl}})}}function livePrice(){clearTimeout(priceInterval),productPricingExt.getProductPrice&&(priceInterval=setTimeout(productPricingExt.getProductPrice(),1e3))}function set_config_svg(a,b,c,d,e){trace("x = "+c),trace("y = "+d),width_x=$j("#img_"+e).attr("width"),height_y=$j("#img_"+e).attr("height"),svgEditor.setConfig({dimensions:[a,b],position:[c,d]});var f=svgCanvas.getZoom(),g=400*f,h=485*f;c*=f,d*=f,$j("#svgcanvas").css("width",g),$j("#svgcanvas").css("height",h),$j("#svgroot").css("width",g),$j("#svgroot").css("height",h),$j("#canvasBackground").attr("x",c),$j("#canvasBackground").attr("y",d),$j("#svgroot").attr("x",c),$j("#svgroot").attr("y",d),$j("#svgcontent").attr("x",c),$j("#svgcontent").attr("y",d),$j("#selectorParentGroup").attr("transform","translate("+c+","+d+")"),$j("#svgcanvas").css("width",parseFloat($j("#img_1").attr("width"))*f)
}function elementOperator(){var a=svgCanvas.addSvgElementFromJson({element:"g",attr:{id:"OperatorG"}}),b=svgCanvas.addSvgElementFromJson({element:"rect",attr:{x:0,y:0,width:"100",height:"30",id:"copyRect",opacity:1,style:"pointer-events:none",stroke:"#000000"}});$j("#svgroot").append(a),a.appendChild(b)}function getVisibleSide(){var a;return $j(".main_image").each(function(){"inline"==$j(this).css("display")&&(a=$j(this))}),a}function setSharePanel(){reInitScroll()}function getDefaultColor(){return"full"==pickerMode.toString().toLowerCase()?"#000000":printableColorList[0].colorCode.indexOf("#")>-1?printableColorList[0].colorCode:"#"+printableColorList[0].colorCode}function addLineOnCanvas(){var a=svgCanvas.getZoom(),b=$j("#canvasBackground").attr("width")/2/a,c=$j("#canvasBackground").attr("height")/2/a,d=svgCanvas.addSvgElementFromJson({element:"line",attr:{x1:b/2,y1:c,x2:b+b/2,y2:c,stroke:getDefaultColor(),"stroke-width":2,id:svgCanvas.getNextId(),opacity:1,fill:"none",style:"pointer-events:inherit"}});svgCanvas.clearSelection(),svgCanvas.addToSelection([d],!0),svgCanvas.runExtensions("elementAdded",{elems:[d]})}function addCircleOnCanvas(){var a=svgCanvas.getZoom(),b=$j("#canvasBackground").attr("width")/2/a,c=$j("#canvasBackground").attr("height")/2/a,d=Math.min(b,c),e=svgCanvas.addSvgElementFromJson({element:"circle",attr:{cx:b,cy:c,r:d/2,stroke:getDefaultColor(),"stroke-width":1,id:svgCanvas.getNextId(),opacity:1,fill:getDefaultColor(),style:"pointer-events:inherit"}});svgCanvas.clearSelection(),svgCanvas.addToSelection([e],!0),svgCanvas.runExtensions("elementAdded",{elems:[e]})}function addEllipseOnCanvas(){var a=svgCanvas.getZoom(),b=$j("#canvasBackground").attr("width")/2/a,c=$j("#canvasBackground").attr("height")/2/a,d=Math.min(b,c),e=svgCanvas.addSvgElementFromJson({element:"ellipse",attr:{cx:b,cy:c,rx:d/2,ry:d/4,stroke:getDefaultColor(),"stroke-width":1,id:svgCanvas.getNextId(),opacity:1,"fill-opacity":1,fill:getDefaultColor(),style:"pointer-events:inherit"}});svgCanvas.clearSelection(),svgCanvas.addToSelection([e],!0),svgCanvas.runExtensions,svgCanvas.runExtensions("elementAdded",{elems:[e]})}function addRectOnCanvas(){var a=svgCanvas.getZoom();initWidthToAddElem=$j("#canvasBackground").attr("width")/2/a,initHeightToAddElem=$j("#canvasBackground").attr("height")/2/a;var b=svgCanvas.addSvgElementFromJson({element:"rect",attr:{x:$j("#canvasBackground").attr("width")/2/a-initWidthToAddElem/2,y:$j("#canvasBackground").attr("height")/2/a-initHeightToAddElem/4,width:initWidthToAddElem,height:initHeightToAddElem/2,stroke:getDefaultColor(),"stroke-width":1,id:svgCanvas.getNextId(),opacity:1,"fill-opacity":1,fill:getDefaultColor(),style:"pointer-events:inherit"}});svgCanvas.clearSelection(),svgCanvas.addToSelection([b]),svgCanvas.runExtensions("elementAdded",{elems:[b]})}function addSquareOnCanvas(){var a=svgCanvas.getZoom();initWidthToAddElem=$j("#canvasBackground").attr("width")/2/a,initHeightToAddElem=$j("#canvasBackground").attr("height")/2/a;var b=Math.min(initWidthToAddElem,initHeightToAddElem),c=svgCanvas.addSvgElementFromJson({element:"rect",attr:{x:initWidthToAddElem-b/2,y:initHeightToAddElem-b/2,width:b,height:b,stroke:getDefaultColor(),"stroke-width":1,id:svgCanvas.getNextId(),opacity:1,"fill-opacity":1,fill:getDefaultColor(),style:"pointer-events:inherit"}});svgCanvas.clearSelection(),svgCanvas.addToSelection([c]),svgCanvas.runExtensions("elementAdded",{elems:[c]})}function showHideImageGallery(){$j("#flickerresult").children().length?$j("#images_loaded").show():$j("#images_loaded").hide()}function disableFeatures(a){var b,c=0;"admin"==user&&(tempData.configurefeature=["1","1","1","1","1","1","1","1","1","1","1"]);var d=["addtext","addartpopup","upload_img_show","social_share","qrCode","textShapeDiv","social_import","advance_img_upload","shapes","preload_template","name_number","show_clipart_tab","show_designidea_tab"],e=!0;e||(tempData.configurefeature[4]="0",tempData.configurefeature[5]="0",tempData.configurefeature[6]="0",tempData.configurefeature[7]="0",tempData.configurefeature[10]="0");do{switch(b=a?d[d.indexOf(a)]:d[c]){case"addtext":"1"==tempData.configurefeature[c]?$j("#addtext").removeClass("disabled"):$j("#addtext").addClass("disabled"),"1"!=tempData.configurefeature[c]&&$j("#addtext").off("click");break;case"addartpopup":"1"==tempData.configurefeature[c]?$j("#addartpopup").removeClass("disabled"):$j("#addartpopup").addClass("disabled"),"1"!=tempData.configurefeature[c]&&$j("#addartpopup").off("click");break;case"upload_img_show":"1"!=tempData.configurefeature[c]&&$j("#addimgbtn").addClass("disabled");break;case"social_share":"1"!=tempData.configurefeature[c]&&($j("#facebook_share").remove(),$j("#twitter_share").remove(),$j("#pinterest_share").remove());break;case"qrCode":"1"!=tempData.configurefeature[c]&&$j("#qrCode").remove();break;case"textShapeDiv":"1"!=tempData.configurefeature[c]&&($j("#textShapeDD").hide(),$j("#textShapeDD ul li:not(:first)").remove(),$j("#textNameShapeDD").hide(),$j("#textNameShapeDD ul li:not(:first)").remove(),$j("#textNumberShapeDD").hide(),$j("#textNumberShapeDD ul li:not(:first)").remove());break;case"social_import":"1"!=tempData.configurefeature[c]&&($j("#import_flickr_btn").remove(),$j("#import_picasa_btn").remove(),$j("#import_instagram_btn").remove());break;case"advance_img_upload":break;case"shapes":"1"!=tempData.configurefeature[c]&&$j("#tools_left").remove();break;case"preload_template":break;case"name_number":"0"==productData.name_number&&$j("#addnamenumber").hide();break;case"show_clipart_tab":"1"!=tempData.configurefeature[c]&&($j("#chooseartpopup").remove(),"1"==tempData.configurefeature[c+1]&&$j("#navaart").hide());break;case"show_designidea_tab":"1"!=tempData.configurefeature[c]&&$j("#choosedesignpopup").remove()}c++,a&&(c=tempData.configurefeature.length)}while(c<tempData.configurefeature.length);0==$j("#chooseartpopup").length&&0==$j("#choosedesignpopup").length&&($j("#navaart").find(".popup-content").remove(),$j(".clipart-container").css("min-height","90px"),$j(".clipart-container").css("width","331px"),$j("#tools_left").css("margin","0"))}function setPluploadConfig(){var a=$j("#uploader").plupload("getUploader");a.settings.multipart_params.customer_id=customer_id,a.settings.multipart_params.isFront=isFront;var b="1"==tempData.configurefeature[7]?"jpg,jpeg,png,ai,eps,psd,pdf,cdr,ps":"jpg,jpeg,png";a.setOption("filters",[{title:"Image files",extensions:b}]),a.settings.filters.max_img_resolution=1e4,a.settings.filters.max_file_size="150mb",a.settings.filters.prevent_duplicates=!1,a.refresh()}function init(){loadData(),svgCanvas.getPrivateMethods().extensions.undoRedo&&svgCanvas.getPrivateMethods().extensions.undoRedo.isAddToStack(!1),ImportTemplate.initiateEditor(),setPluploadConfig(),addListeners(),$j("#stroke_color svg rect").attr("opacity",0),$j("#addproduct").trigger("mousedown"),$j("#position_opts").show(),$j("#tools_bottom_2").hide(),document.getElementById("svgroot").addEventListener("touchmove",function(a){a.preventDefault()},!1),$j("#selected_panel, #g_panel, #rect_panel, #circle_panel, #ellipse_panel, #line_panel, #text_panel, #image_panel, #container_panel, #use_panel, #a_panel").hide(),svgEditor.processFile=function(a,b){if("import_img"!=b)var c=decode64(a);switch(objectLockExt.removeMouseEvent&&(objectLockExt.useLock=!1),svgCanvas.getPrivateMethods().extensions.undoRedo&&svgCanvas.getPrivateMethods().extensions.undoRedo.isAddToStack(!1),svgCanvas.getPrivateMethods().extensions.productPricing&&svgCanvas.getPrivateMethods().extensions.productPricing.isCalculate(!1),b){case"load_svg":productOverlayImageExt&&productOverlayImageExt.updateOverlayImage(),svgCanvas.setDesignIdea(c),svgEditor.updateCanvas(),svgCanvas.ungroupSelectedElement(),svgCanvas.ungroupSelectedElement(),svgCanvas.ungroupSelectedElement(),svgCanvas.clearSelection(),svgEditor.updateCanvas(),productPricingExt.calculatePriceData&&productPricingExt.calculatePriceData(!0);break;case"import_svg":svgCanvas.importSvgString(c),svgEditor.updateCanvas();break;case"import_img":svgCanvas.setGoodImage(a)}objectLockExt.removeMouseEvent&&(objectLockExt.useLock=!0,objectLockExt.removeMouseEvent(svgCanvas.getVisibleElements())),svgCanvas.getPrivateMethods().extensions.undoRedo&&svgCanvas.getPrivateMethods().extensions.undoRedo.isAddToStack(!0),svgCanvas.getPrivateMethods().extensions.productPricing&&svgCanvas.getPrivateMethods().extensions.productPricing.isCalculate(!0),updateMaskImage()},""!=$j("#textsvg_1").val()&&svgEditor.canvas.setSvgString($j("#textsvg_1").val()),$j(window).bind("beforeunload",function(){return 0!==svgCanvas.undoMgr.getUndoStackSize()?svgEditor.uiStrings.notification.unsavedChanges:void 0}),FacebookImport(),flickrImport(),picasaImport(),InstagramImport(),LocalImport(),setSharePanel(!0),$j("#ihavetheright").checked=!1,initQrcode(),changeqrform(),zoomChange("100%"),"admin"!=user&&(disableOther("addtocart"),$j("#addtocart-panel").addClass("cbp-spmenu-open")),updateDesignAreaLabel(),Object.keys(productData).length>0&&(createProductDesign(),$j.isEmptyObject(nameNumberObject)||nameNumberObject.removeSizeDropdown()),$j("#tool_fhellipse, #tool_fhrect").hide(),$j("#tools_rect_show, #tools_ellipse_show").unbind(),$j("#tools_rect_show").on("click",function(){$j(".tools_flyout").hide(),$j("#tools_rect").show(),$j("#tools_ellipse_show").removeAttr("class").addClass("tool_button flyout_current"),$j("#tools_rect_show").removeAttr("class").addClass("flyout_current tool_button_current tool_rect")}),$j("#tool_rect, #tool_square").unbind(),$j("#tool_rect").on("mousedown",function(){svgCanvas.setMode("select"),addRectOnCanvas()}),$j("#tool_square").on("mousedown",function(){svgCanvas.setMode("select"),addSquareOnCanvas()}),$j("#tools_ellipse_show").on("click",function(){$j(".tools_flyout").hide(),$j("#tools_ellipse").show(),$j("#tools_rect_show").removeAttr("class").addClass("tool_button flyout_current"),$j("#tools_ellipse_show").removeAttr("class").addClass("flyout_current tool_button_current tool_rect")}),$j("#tool_ellipse, #tool_circle").unbind(),$j("#tool_ellipse").on("mousedown",function(){svgCanvas.setMode("select"),addEllipseOnCanvas()}),$j("#tool_circle").on("mousedown",function(){svgCanvas.setMode("select"),addCircleOnCanvas()}),$j("#tool_line").unbind(),$j("#tool_line").on("mousedown",function(){svgCanvas.setMode("select"),addLineOnCanvas()}),$j("#tool_fhpath").unbind(),$j("#tool_fhpath").on("mousedown",function(){svgCanvas.setMode("fhpath"),$j("#navaart").css("display","none")}),$j("#flickerresult").bind("DOMNodeInserted DOMNodeRemoved",function(){showHideImageGallery()}),createScrollPane(),svgCanvas.runExtensions("toolReady"),$j("#addimgbtn").bind("click",function(){svgCanvas.getSelectedElems().length&&svgCanvas.clearSelection(),handleSocialMediaGallery(),$j("#images_loaded").show(),$j("#images-upload").show(),$j("#flickerresult").show(),$j(".qrcode-section").hide(),$j("#uploader").hide(),$j("#gallery_warn_msg_con").hide(),$j("#media_btnCon").show(),$j("#uploadInstLabel").show(),$j("#flickerresult").children().length>0||$j("#gallery_warn_msg_con").show(),svgCanvas.getPrivateMethods().extensions.photoCollage&&svgCanvas.getPrivateMethods().extensions.photoCollage.imageObj(!0)}),$j("#galleryBtn").bind("click",function(){handleSocialMediaGallery(),$j("#flickerresult").show(),$j("#flickerresult").children().length>0?$j("#gallery_warn_msg_con").hide():$j("#gallery_warn_msg_con").show()}),$j("#change_prosett").bind("click",function(){}),$j("#info").bind("click",function(){svgCanvas.getSelectedElems().length&&svgCanvas.clearSelection(),$j("#svg_docprops").show()}),$j("#addproduct").bind("click",function(){svgCanvas.getSelectedElems().length&&svgCanvas.clearSelection(),$j("#change-products-setting").show()}),$j("#text").bind("click",function(){manageColorPanel(),$j("#common_upper_open_panel").hide()}),$j("#upload_img_show").bind("click",function(){handleSocialMediaGallery(),showUploadPopup?$j("#uploader").show():($j("#uploader_buttons input[type=file]").trigger("click"),$j("#flickerresult").show()),$j(".plupload_message").remove()}),$j("#import_flickr_btn").bind("click",function(){handleSocialMediaGallery(),$j("#flickr_window").show()}),$j("#import_picasa_btn").bind("click",function(){handleSocialMediaGallery(),$j("#picasa_window").show()});var a;$j("#hex_col_code, #red_col_code, #green_col_code, #blue_col_code, #cyan_col_code, #magenta_col_code, #yellow_col_code, #black_col_code").keyup(function(b){clearTimeout(a),a=setTimeout(updateColors,500,b)}),$j("#rgbTabCaption,#cmykTabCaption").bind("click",function(a){$j("#rgbTabCon,#cmykTabCon").hide(),$j("#rgbTabCaption,#cmykTabCaption").removeClass("active"),"rgbTabCaption"==a.target.id?($j("#rgbTabCon").show(),$j("#rgbTabCaption").addClass("active")):($j("#cmykTabCon").show(),$j("#cmykTabCaption").addClass("active"))}),$j.isEmptyObject(nameNumberObject)||(nameNumberObject.updateNameNumberSize(),nameNumberObject.checkNameNumberSides(),postData.namenumData&&nameNumberObject.addNameNumberData()),disableFeatures(),"true"==tempData.settings.missing_images&&$j.alert(svgEditor.uiStrings.notification.missingImagesInDesignEdit),svgCanvas.getPrivateMethods().extensions.undoRedo&&(svgCanvas.getPrivateMethods().extensions.undoRedo.isAddToStack(!0),""!=$j("#textsvg_1").val()&&svgCanvas.getPrivateMethods().extensions.undoRedo.addToStack()),this.focus(),1==productData.is_3d?svgCanvas.getPrivateMethods().extensions.threedpreview.initThreeD():$j(".preview_holder").css("background","none")}function updateColors(a){"hex_col_code"==a.target.id?($j.farbtastic("#colorpicker").setColor("#"+a.target.value),updateColorElements("#"+a.target.value)):"red_col_code"==a.target.id||"green_col_code"==a.target.id||"blue_col_code"==a.target.id?updateColorHexCode():updateColorHexCodeFromCMYK()}function componentToHex(a){var b=a.toString(16);return 1==b.length?"0"+b:b}function rgbToHex(a,b,c){return componentToHex(a)+componentToHex(b)+componentToHex(c)}function rgb2cmyk(a,b,c){var d=0,e=0,f=0,g=0;if(0==a&&0==b&&0==c)return g=1,[0,0,0,100];d=1-a/255,e=1-b/255,f=1-c/255;var h=Math.min(d,Math.min(e,f));return d=(d-h)/(1-h),e=(e-h)/(1-h),f=(f-h)/(1-h),g=h,d=Math.round(100*d),e=Math.round(100*e),f=Math.round(100*f),g=Math.round(100*g),[d,e,f,g]}function cmyk2rgb(a,b,c,d,e){a/=100,b/=100,c/=100,d/=100,a=a*(1-d)+d,b=b*(1-d)+d,c=c*(1-d)+d;var f=1-a,g=1-b,h=1-c;return e||(f=Math.round(255*f),g=Math.round(255*g),h=Math.round(255*h)),{r:f,g:g,b:h}}function updateColorElements(a){R=isNaN(hexToR(a))?0:hexToR(a),G=isNaN(hexToG(a))?0:hexToG(a),B=isNaN(hexToB(a))?0:hexToB(a),$j("#red_col_code").val(R),$j("#green_col_code").val(G),$j("#blue_col_code").val(B);var b=rgb2cmyk(R,G,B);$j("#cyan_col_code").val(b[0]),$j("#magenta_col_code").val(b[1]),$j("#yellow_col_code").val(b[2]),$j("#black_col_code").val(b[3])}function updateColorHexCode(){var a=rgbToHex(1*$j("#red_col_code").val(),1*$j("#green_col_code").val(),1*$j("#blue_col_code").val());$j.farbtastic("#colorpicker").setColor("#"+a),$j("#hex_col_code").val(a)}function updateColorHexCodeFromCMYK(){var a=cmyk2rgb(1*$j("#cyan_col_code").val(),1*$j("#magenta_col_code").val(),1*$j("#yellow_col_code").val(),1*$j("#black_col_code").val()),b=rgbToHex(a.r,a.g,a.b);$j.farbtastic("#colorpicker").setColor("#"+b),$j("#hex_col_code").val(b)}function handleTextPanel(a){$j("#common_upper_open_panel").hide(),$j(".text-align").hide(),$j(".text-lineSpace").hide(),$j("#bordercontrolls").hide(),$j(".border_colorpicker").css("left","60px"),$j("#textalignment").removeClass("active"),$j("#textLineSpace").removeClass("active"),$j(".textFontSizePanel .shape_con").hide(),"fontBox"!=a&&($j("#font-selector-con").hide(),$j("#font-box").removeClass("active")),"textShape"!=a&&($j("#textShapeDD").removeClass("active"),$j("#textShapeDD .shape_con").hide())}function handleSocialMediaGallery(){$j("#uploader").hide(),$j("#flickr_window").hide(),$j("#picasa_window").hide(),$j("#instagram_window").hide(),$j("#flickerresult").hide(),$j(".qrcode-section").hide()}function changeqrform(){for(var a=document.getElementById("qrdatatype"),b=0;b<a.length;b++)if(a.options[b].value==$j("#qrdatatype").val()){var c="#qr"+a.options[b].value;$j(c).show()}else{var c="#qr"+a.options[b].value;$j(c).hide()}}function getUnitVal(){return svgedit.units.getTypeMap()[svgEditor.curConfig.baseUnit]}function zoomChange(a,b){b?svgCanvas.zoomChanged(window,b):svgCanvas.changeZoom({value:parseInt(a)});var c=svgCanvas.getZoom(),d=400*c,e=485*c;$j("#product-image svg").attr("width",d+"px"),$j("#product-image svg").attr("height",e+"px"),$j("#workarea").css("overflow","auto");var f=svgCanvas.getElem("bleedHolder");f.setAttribute("x",svgCanvas.getContentElem().getAttribute("x")),f.setAttribute("y",svgCanvas.getContentElem().getAttribute("y")),reInitScroll(),svgCanvas.runExtensions("zoomChanged")}function saveTemplate(){getsvg_str(),preTemplate?(png_data=[],curr_side_id=1,action="savePreTemplate",currentTime=(new Date).getTime(),generate_side(),$j(".svgcanvas").hide()):"undefined"!=typeof text_svg1&&$j.ajax({type:"POST",url:backend_url,cache:!1,data:"template_id="+template_id+"&product_id="+productid+"&form_key="+formkey+"&save_str="+encodeURIComponent(text_svg1)+"&plateform="+postData.plateform+"&siteBaseUrl="+postData.siteBaseUrl+"&language_id="+postData.language_id,success:function(){$j.confirm_custom(svgEditor.uiStrings.notification.templateSaved,function(a){a&&($j(window).unbind("beforeunload"),document.location.href=exitUrl)}),document.getElementById("save_template").disabled=!1,hideLoader()},error:function(){$j.alert(svgEditor.uiStrings.notification.errorInConnection)}})}function convertSvgDimentionToPx(a){if(""!==a&&void 0!==a){var b=svgedit.utilities.text2xml(a),c=b.documentElement.getAttribute("width"),d=b.documentElement.getAttribute("height");b.documentElement.setAttribute("viewBox","0 0 "+parseFloat(c)+" "+parseFloat(d)),a=(new XMLSerializer).serializeToString(b)}return a}function generate_side(){if(zoomChange("100%"),showLoader(!0),curr_side_id>no_of_side){if($j(".svgcanvas").show(),"addtocart"==action&&(text_svg1=convertSvgDimentionToPx(text_svg1),text_svg2=convertSvgDimentionToPx(text_svg2),text_svg3=convertSvgDimentionToPx(text_svg3),text_svg4=convertSvgDimentionToPx(text_svg4),text_svg5=convertSvgDimentionToPx(text_svg5),text_svg6=convertSvgDimentionToPx(text_svg6),text_svg7=convertSvgDimentionToPx(text_svg7),text_svg8=convertSvgDimentionToPx(text_svg8)),"undefined"!=typeof text_svg1||"undefined"!=typeof text_svg2||"undefined"!=typeof text_svg3||"undefined"!=typeof text_svg4||"undefined"!=typeof text_svg5||"undefined"!=typeof text_svg6||"undefined"!=typeof text_svg7||"undefined"!=typeof text_svg8)if("addtocart"==action)$j.ajax({type:"POST",url:saveBase64Url,cache:!1,data:"svg_1="+encodeURIComponent(text_svg1)+"&svg_2="+encodeURIComponent(text_svg2)+"&svg_3="+encodeURIComponent(text_svg3)+"&svg_4="+encodeURIComponent(text_svg4)+"&svg_5="+encodeURIComponent(text_svg5)+"&svg_6="+encodeURIComponent(text_svg6)+"&svg_7="+encodeURIComponent(text_svg7)+"&svg_8="+encodeURIComponent(text_svg8)+"&png_data1="+png_data[0]+"&png_data2="+png_data[1]+"&png_data3="+png_data[2]+"&png_data4="+png_data[3]+"&png_data5="+png_data[4]+"&png_data6="+png_data[5]+"&png_data7="+png_data[6]+"&png_data8="+png_data[7]+"&fonts_used="+fonts_used+"&currentTime="+currentTime+"&sideNameAry="+sideNameAry+"&plateform="+postData.plateform+"&siteBaseUrl="+postData.siteBaseUrl+"&language_id="+postData.language_id,success:function(a){filenameobj=$j.parseJSON(a),trace("filenameobj = "+filenameobj);var b=0;for(x in filenameobj)filearray[b]=filenameobj[x],b++;hideLoader(),afteraddtocart()},error:function(){$j.alert(svgEditor.uiStrings.notification.errorInConnection),hideLoader()}});else if("save"==action){var a,b,c=$j.trim($j("#design_name").val()),d=$j("#current_product_colorid").val();"configurable"==productData.type?$j.each(productData.allColors.color[d].sizes,function(c,e){a=parseInt(e.optionID);var f=parseInt($j("#size"+e.optionID+"_"+d).val());return f>0?(b=JSON.stringify(e.addtocartparam),!1):void 0}):"onlysize"==productData.type?$j.each(productData.allColors.size,function(a,c){var d=parseInt($j("#size"+c.optionID).val());return d>0?(b=JSON.stringify(c.addtocartparam),!1):void 0}):b=JSON.stringify("onlycolor"==productData.type?productData.allColors.color[d].addtocartparam:productData.allColors.addtocartparam),$j.ajax({type:"POST",url:saveDesignUrl,cache:!1,data:"svg_1="+encodeURIComponent(text_svg1)+"&svg_2="+encodeURIComponent(text_svg2)+"&svg_3="+encodeURIComponent(text_svg3)+"&svg_4="+encodeURIComponent(text_svg4)+"&svg_5="+encodeURIComponent(text_svg5)+"&svg_6="+encodeURIComponent(text_svg6)+"&svg_7="+encodeURIComponent(text_svg7)+"&svg_8="+encodeURIComponent(text_svg8)+"&png_data1="+png_data[0]+"&png_data2="+png_data[1]+"&png_data3="+png_data[2]+"&png_data4="+png_data[3]+"&png_data5="+png_data[4]+"&png_data6="+png_data[5]+"&png_data7="+png_data[6]+"&png_data8="+png_data[7]+"&fonts_used="+fonts_used+"&currentTime="+currentTime+"&sideNameAry="+sideNameAry+"&cust_id="+customer_id+"&design_name="+encodeURIComponent(c)+"&printingMethod="+JSON.stringify(pricingData.printingMethod)+"&no_of_side="+no_of_side+"&addtocartparam="+b+"&color_id="+d+"&size_id="+a+"&design_id="+postData.design_id+"&plateform="+postData.plateform+"&siteBaseUrl="+postData.siteBaseUrl+"&language_id="+postData.language_id+"&namenumData="+JSON.stringify(nameNumberObject.getNameNumberData()),success:function(a){$j("#design_name").val("");var b=$j.parseJSON(a);postData.design_id=b.design_id,postData.design_name=b.design_name,$j.alert(svgEditor.uiStrings.notification.designSaved),hideLoader()},error:function(){$j.alert(svgEditor.uiStrings.notification.errorInConnection),hideLoader()}})}else if("share"==action){var e,a,b,c="Shared design",d=$j("#current_product_colorid").val();"configurable"==productData.type?$j.each(productData.allColors.color[d].sizes,function(c,e){a=parseInt(e.optionID);var f=parseInt($j("#size"+e.optionID+"_"+d).val());return f>0?(b=JSON.stringify(e.addtocartparam),!1):void 0}):"onlysize"==productData.type?$j.each(productData.allColors.size,function(a,c){var d=parseInt($j("#size"+c.optionID).val());return d>0?(b=JSON.stringify(c.addtocartparam),!1):void 0}):b=JSON.stringify("onlycolor"==productData.type?productData.allColors.color[d].addtocartparam:productData.allColors.addtocartparam),$j.ajax({type:"POST",url:shareDesignUrl,cache:!1,data:"svg_1="+encodeURIComponent(text_svg1)+"&svg_2="+encodeURIComponent(text_svg2)+"&svg_3="+encodeURIComponent(text_svg3)+"&svg_4="+encodeURIComponent(text_svg4)+"&svg_5="+encodeURIComponent(text_svg5)+"&svg_6="+encodeURIComponent(text_svg6)+"&svg_7="+encodeURIComponent(text_svg7)+"&svg_8="+encodeURIComponent(text_svg8)+"&png_data1="+png_data[0]+"&png_data2="+png_data[1]+"&png_data3="+png_data[2]+"&png_data4="+png_data[3]+"&png_data5="+png_data[4]+"&png_data6="+png_data[5]+"&png_data7="+png_data[6]+"&png_data8="+png_data[7]+"&fonts_used="+fonts_used+"&currentTime="+currentTime+"&sideNameAry="+sideNameAry+"&cust_id="+customer_id+"&design_name="+encodeURIComponent(c)+"&printingMethod="+JSON.stringify(pricingData.printingMethod)+"&no_of_side="+no_of_side+"&addtocartparam="+b+"&color_id="+d+"&size_id="+a+"&plateform="+postData.plateform+"&siteBaseUrl="+postData.siteBaseUrl+"&language_id="+postData.language_id+"&namenumData="+JSON.stringify(nameNumberObject.getNameNumberData()),success:function(a){if(filenameobj=$j.parseJSON(a),e=filenameobj.file_path+filenameobj.side1_png,ref_url=filenameobj.design_id,"facebook"==shareType)var b="https://www.facebook.com/dialog/feed?app_id="+encodeURIComponent(facebookAppId)+"&display=popup&name="+encodeURIComponent(c)+"&caption="+encodeURIComponent(c)+"&description="+encodeURIComponent(c)+"&link="+encodeURIComponent(ref_url)+"&redirect_uri="+encodeURIComponent(FBredirectURI)+"&picture="+encodeURIComponent(e);else if("twitter"==shareType)var b="https://twitter.com/share?url="+encodeURIComponent(ref_url)+"&text=My Design&tw_p=tweetbutton";else if("pinterest"==shareType)var b="http://pinterest.com/pin/create/button/?url="+encodeURIComponent(ref_url)+"&media="+encodeURIComponent(e)+"&description=My Design&ref="+encodeURIComponent(ref_url);window.open(b,"Share Design","menubar=no,status=no,location=no,width=750,height=450,toolbar=no"),hideLoader()},error:function(){$j.alert(svgEditor.uiStrings.notification.errorInConnection),hideLoader()}})}else if("preview"==action){var f=document.createElement("form");f.target="Map",f.method="POST",f.action=previewPdfUrl;var g=document.createElement("input");g.type="hidden",g.name="png_data1",g.value=png_data[0],f.appendChild(g);var h=document.createElement("input");h.type="hidden",h.name="png_data2",h.value=png_data[1],f.appendChild(h);var i=document.createElement("input");i.type="hidden",i.name="png_data3",i.value=png_data[2],f.appendChild(i);var j=document.createElement("input");j.type="hidden",j.name="png_data4",j.value=png_data[3],f.appendChild(j);var k=document.createElement("input");k.type="hidden",k.name="png_data5",k.value=png_data[4],f.appendChild(k);var l=document.createElement("input");l.type="hidden",l.name="png_data6",l.value=png_data[5],f.appendChild(l);var m=document.createElement("input");m.type="hidden",m.name="png_data7",m.value=png_data[6],f.appendChild(m);var n=document.createElement("input");n.type="hidden",n.name="png_data8",n.value=png_data[7],f.appendChild(n);var o=document.createElement("input");o.type="hidden",o.name="curTime",o.value=currentTime,f.appendChild(o),document.body.appendChild(f),f.submit(),svgedit.browser.isIE()&&$j("#sideButton_2").length&&($j("#sideButton_2").trigger("mousedown"),$j("#sideButton_1").trigger("mousedown")),hideLoader()}else if("savePreTemplate"==action){var a,b,c=$j.trim($j("#design_name").val()),d=$j("#current_product_colorid").val();"configurable"==productData.type?$j.each(productData.allColors.color[d].sizes,function(c,e){a=parseInt(e.optionID);parseInt($j("#size"+e.optionID+"_"+d).val());return b=JSON.stringify(e.addtocartparam),!1}):"onlysize"==productData.type?$j.each(productData.allColors.size,function(a,c){var d=parseInt($j("#size"+c.optionID).val());return d>0?(b=JSON.stringify(c.addtocartparam),!1):void 0}):b=JSON.stringify("onlycolor"==productData.type?productData.allColors.color[d].addtocartparam:productData.allColors.addtocartparam),$j.ajax({type:"POST",url:savePreTemplate,cache:!1,data:"svg_1="+encodeURIComponent(text_svg1)+"&svg_2="+encodeURIComponent(text_svg2)+"&svg_3="+encodeURIComponent(text_svg3)+"&svg_4="+encodeURIComponent(text_svg4)+"&svg_5="+encodeURIComponent(text_svg5)+"&svg_6="+encodeURIComponent(text_svg6)+"&svg_7="+encodeURIComponent(text_svg7)+"&svg_8="+encodeURIComponent(text_svg8)+"&png_data1="+png_data[0]+"&png_data2="+png_data[1]+"&png_data3="+png_data[2]+"&png_data4="+png_data[3]+"&png_data5="+png_data[4]+"&png_data6="+png_data[5]+"&png_data7="+png_data[6]+"&png_data8="+png_data[7]+"&fonts_used="+fonts_used+"&sideNameAry="+sideNameAry+"&currentTime="+currentTime+"&no_of_side="+no_of_side+"&addtocartparam="+b+"&color_id="+d+"&size_id="+a+"&pretemplate_id="+pretemplate_id+"&plateform="+postData.plateform+"&siteBaseUrl="+postData.siteBaseUrl+"&language_id="+postData.language_id,success:function(a){$j.confirm_custom(svgEditor.uiStrings.notification.templateSaved,function(a){a&&($j(window).unbind("beforeunload"),parent.document.location.href=exitUrl)}),document.getElementById("save_template").disabled=!1,hideLoader(),postData.pretemplate_id=$j.parseJSON(a).pretemplate_id},error:function(){$j.alert(svgEditor.uiStrings.notification.errorInConnection),hideLoader()}})}curr_side_id=1,svgCanvas.setSvgString($j("#textsvg_"+curSide).val()),set_config_svg(design_area_width[curSide],design_area_height[curSide],pos_x[curSide],pos_y[curSide],curSide),$j(".main_image").hide(),$j("#img_"+curSide).show()}else{$j("#export_canvas").length||$j("<canvas>",{id:"export_canvas"}).hide().appendTo("body"),customizationCan||(customizationCan=document.createElement("canvas")),text_svg=$j("#textsvg_"+curr_side_id).val(),!$j(text_svg).attr("xmlns:xlink"),trace("text_svg = "+text_svg),updateMaskImage();var p=parseInt(curr_side_id)-1;generatePNG(text_svg,totalSides[p],currentTime,"design_image")}}function generatePNG(a,b,c,d){$j.ajax({type:"POST",url:generatePreviewPngUrl,cache:!1,data:"svg="+encodeURIComponent(a)+"&side="+b+"&image_type="+d+"&plateform="+postData.plateform+"&siteBaseUrl="+postData.siteBaseUrl+"&language_id="+postData.language_id+"&current_time="+c,success:function(a){"design_image"==d?(designImage=a,completeCustomization()):"product_image"==d&&completeProductImage(a)},error:function(){$j.alert(svgEditor.uiStrings.notification.errorInConnection),hideLoader()}})}function completeCustomization(){$j(".main_image").hide(),$j("#img_"+curr_side_id).show(),productImageSvgStr=document.getElementById("product-image").innerHTML.trim(),$j(".main_image").hide(),$j("#img_"+curSide).show(),!$j(productImageSvgStr).attr("xmlns:xlink"),productImageSvgStr=productImageSvgStr.replace(/url\(\"/g,"url("),productImageSvgStr=productImageSvgStr.replace(/\"\)/g,")");var a=parseInt(curr_side_id)-1;generatePNG(productImageSvgStr,totalSides[a],currentTime,"product_image")}function completeProductImage(a){productImageCanvas||(productImageCanvas=document.createElement("canvas")),mycontext=productImageCanvas.getContext("2d");var b=new Image;b.onload=function(){productImageCanvas.width=b.width,productImageCanvas.height=b.height,mycontext.drawImage(b,0,0,b.width,b.height),mycontext.globalCompositeOperation="source-atop";var a=new Image;a.onload=function(){mycontext.drawImage(a,pos_x[curr_side_id],pos_y[curr_side_id],design_area_width[curr_side_id],design_area_height[curr_side_id]),png_data[curr_side_id-1]=productImageCanvas.toDataURL("image/png"),curr_side_id++,productImageCanvas.getContext("2d").clearRect(0,0,productImageCanvas.width,productImageCanvas.height),generate_side()},a.src=designImage},b.src=a}function svgLoaded(a){var b=a.target;mycanvas=document.getElementById("final_"+curr_side_id+"_canvas"),mycontext=mycanvas.getContext("2d"),set_config_svg(design_area_width[curr_side_id],design_area_height[curr_side_id],pos_x[curr_side_id],pos_y[curr_side_id],curr_side_id);var c=svgEditor.curConfig.dimensions;mycontext.drawImage(b,pos_x[curr_side_id],pos_y[curr_side_id],c[0],c[1]),png_data[curr_side_id-1]=mycanvas.toDataURL("image/png"),curr_side_id++,generate_side()}function updateDesignAreaLabel(){var a,b=svgCanvas.getElem("bleedHolder"),c=svgCanvas.getElem("DaLabel");c?a=svgCanvas.getElem("DaLabelBg"):(c=document.createElementNS("http://www.w3.org/2000/svg","text"),a=document.createElementNS("http://www.w3.org/2000/svg","rect")),b.appendChild(a),b.appendChild(c),svgedit.utilities.assignAttributes(c,{id:"DaLabel",x:3,y:11,opacity:1,fill:"#FFFFFF",style:"pointer-events:none"}),c.textContent=svgEditor.uiStrings.elementLabel.DesignAreaLabel,bbox=svgedit.utilities.getBBox(c),svgedit.utilities.assignAttributes(a,{id:"DaLabelBg",x:0,y:0,width:bbox.width+5,height:bbox.height,stroke:"none","stroke-width":1,opacity:1,fill:"#000000",style:"pointer-events:none"})}function createScrollPane(){svgedit.browser.isTouch()&&($j("#workarea").unbind("scroll"),$j("#workarea").bind("jsp-scroll-x",function(){}).bind("jsp-scroll-y",function(){}).jScrollPane())}function FacebookImport(){!function(){function a(){showLoader(!0),Facebook.authorize().done(b)}function b(){FB.api("/me/albums",function(a){return a.error?void hideLoader():(h.empty(),a.data&&!a.data.length?d("/me/photos"):(a.data.forEach(function(a){jQuery("#facebook_select").append(jQuery("<option>",{value:a.id,text:a.name}))}),void d("/"+a.data[0].id+"/photos")))})}function c(a){return d(""===a?"/me/photos":"/"+a+"/photos")}function d(a,b){showLoader(!0),FB.api(a,function(c){if(hideLoader(),c.error&&2500===c.error.code){if(b)return;return jQuery.when(Facebook.authorize()).done(function(){d(a,!0)})}g.empty(),(!c.data||c.data.length)&&(j=c.paging.previous,k=c.paging.next,c.data.forEach(function(a){images=$j('<div class="photo"/>').append($j('<img src="'+jspath+'images/loading.gif" data="'+a.source+'" onload="lazyLoaderImg(this)">')),$j(".fb_holder").append(images)
}),f.show(),l=!0)})}function e(){f.hide(),Util.crossOriginUpload(this.src).done(function(a){showLoader(!0),canvasImport(a)})}$container=jQuery("div.social-media-import-section"),$uploader=$container.find("div.uploader");var f,g,h,i,j,k,l;return i=$container.find("a.import_fb"),f=jQuery("#facebook_window"),g=f.find("div.fb_holder"),h=f.find("select"),g.on("click","img",e),jQuery(document).on("change","#facebook_select",function(){c(this.value)}),i.on("mouseup",function(){i.hasClass("disabled")||a()}),{}}()}function flickrImport(){function a(a){a=$j("#flickr_pager"),a.append("<br />Page "+$j("input:eq(0)",a).val()+" of "+$j("input:eq(1)",a).val());var b=1==parseInt($j("input:eq(0)",a).val())?' style="display:none;"':"";$j('<a class="end-page" href="prev"'+b+">&larr; "+svgEditor.uiStrings.elementLabel.PREV+"</a>").css("margin","0 6px").click(function(){return pagedFlickr(parseInt($j("input:eq(0)",a).val())-1),!1}).appendTo(a);var c=parseInt($j("input:eq(0)",a).val())==parseInt($j("input:eq(1)",a).val())?' style="display:none;"':"";$j('<a class="start-page" href="next"'+c+">"+svgEditor.uiStrings.elementLabel.NEXT+" &rarr;</a>").css("margin","0 6px").click(function(){return pagedFlickr(parseInt($j("input:eq(0)",a).val())+1),!1}).appendTo(a)}function b(){$flickrWindow.hide(),Util.crossOriginUpload(this.src).done(function(a){showLoader(!0),canvasImport(a)})}var c;$flickrWindow=jQuery("#flickr_window"),$holder=$flickrWindow.find("div.flickr_holder"),$holder.on("click","img",b),$j("#flicker_go").click(function(){var a=$j.Event("keypress");a.which=13,$j("#flicker_import").focus(),$j("#flicker_import").trigger(a)}),$j("#flicker_import").keypress(function(a){if(13==a.which){if($j('<div id="import_error"/>').appendTo("#flickr_window_container"),$j("#import_error").empty(),$j("div.flickr_holder").empty(),c=this.value,""==c)return $j("div.flickr_holder").empty(),$j("#flickr_pager").empty(),void $j("div.flickr_holder").append(svgEditor.uiStrings.notification.imageImportEnterKeyword);pagedFlickr(1)}}),this.pagedFlickr=function(b){$j("#flickr_pager").empty(),showLoader(!0),$j("div.flickr_holder").empty(),$j("ul",$j(".flickr_holder")).remove(),$j(".flickr_holder").flickr({api_key:flickrAppId,type:"search",text:c,tags:c,per_page:20,page:b,callback:a})}}function showLoader(){$j("#loaderImage").show(),$j("#loaderImage-overlay").show()}function hideLoader(){$j("#loaderImage").hide(),$j("#loaderImage-overlay").hide()}function picasaImport(){!function(){function a(){b.hide(),Util.crossOriginUpload(this.src).done(function(a){showLoader(!0),canvasImport(a)})}var b=jQuery("#picasa_window");b.find(".picasa_holder").on("click","img",a),$j("#picasa_go").click(function(){$j("#import_error").empty(),$j('<div id="import_error"/>').appendTo("#picasa_window_container");var a=$j.Event("keypress");a.which=13,$j("#picasa_import").focus(),$j("#picasa_import").trigger(a)}),$j("#picasa_import").keypress(function(a){if(13==a.which){showLoader(!0),$j("#import_error").empty(),$j('<div id="import_error"/>').appendTo("#picasa_window_container"),$j("div.picasa_holder").empty();var b=this.value;if(""==b)return hideLoader(),$j("div.picasa_holder").empty(),void $j("div.picasa_holder").append(svgEditor.uiStrings.notification.imageImportEnterKeyword);$j(".picasa_holder").jqig({username:b,pagination:{enable:!0,position:"top",imgPerPage:10},labels:{paginationNext:svgEditor.uiStrings.elementLabel.NEXT+" &rarr;",paginationPrevious:"&larr; "+svgEditor.uiStrings.elementLabel.PREV,paginationMore:"..."},thumbsize:144,enableImageCaption:!0})}})}()}function LocalImport(){!function(){$container=$j("#images-upload"),$button=$container.find("#upload_img_show"),$button.attr("disabled","disabled"),$button.css("cursor","default"),$container.find("#ihavetheright").change(function(){$j(this).is(":checked")?($button.removeAttr("disabled"),$button.css("cursor","pointer")):($button.attr("disabled","disabled"),$button.css("cursor","default"))})}()}function setSharePanel(){reInitScroll()}function reInitScroll(){if(svgedit.browser.isTouch()){var a=$j("#workarea"),b=a.data("jsp");void 0!=b&&(b.scrollTo(0,0),setTimeout(b.reinitialise,200))}}function disableOther(a){$j(".canvas-heading").removeClass("preview_portrait"),"addproduct"!==a&&($j("#addproduct-panel").removeClass("cbp-spmenu-open"),$j("#addproduct").removeClass("active")),"addart"!==a&&($j("#addart-panel").removeClass("cbp-spmenu-open"),$j("#addart").removeClass("active"),$j("#textShapeDD").removeClass("active")),"layerPanel"!==a&&$j("#layer-panel").removeClass("cbp-spmenu-open"),"addtocart"!==a&&$j("#addtocart-panel").removeClass("cbp-spmenu-open"),"addtext"!==a&&($j("#addtext-panel").removeClass("cbp-spmenu-open"),$j("#addtext").removeClass("active"),$j("#common-panel").removeClass("cbp-spmenu-open")),"addtimage"!==a&&($j("#addtimage-panel").removeClass("cbp-spmenu-open"),$j("#addtimage").removeClass("active")),"addshape"!==a&&($j("#addshape-panel").removeClass("cbp-spmenu-open"),$j("#addshape").removeClass("active"),$j("#common-panel").removeClass("cbp-spmenu-open")),"desingidea"!==a&&($j("#designidea-panel").removeClass("cbp-spmenu-open"),$j("#desingidea").removeClass("active")),"qrCode"!==a&&($j("#qrcode-panel").removeClass("cbp-spmenu-open"),$j("#qrCode").removeClass("active")),"editpanel"!==a&&$j("#edit-panel").removeClass("cbp-spmenu-open"),$j("#design_tooltip").hide(),$j("#inst_text_tooltip").hide(),$j("#inst_image_tooltip").hide(),$j("#inst_shape_tooltip").hide(),$j("#tool_font_family").hide(),$j("#text_size_box").hide(),$j("#design_tooltip_edit_panel").hide(),$j("#color_picker").hide()}function values(a){var b=[];for(var c in a)b.push(a[c]);return b}function getObjectFromArray(a,b,c){return a.filter(function(a){return a[b]==c})}function resizeAllElements(a){for(var b=[],c=[],d=[],e=[],f=svgCanvas.getPrivateMethods().extensions.LayerPanel.getAllObjects(),g=0;g<f.length;g++){if("true"==f[g].getAttribute("lock")){var h={obj:f[g],attr:"lock"};c.push(h),f[g].setAttribute("lock","false")}if("none"==f[g].getAttribute("display")){var i={obj:f[g],attr:"display"};d.push(i),f[g].setAttribute("display","inline")}}if(svgCanvas.selectAllInCurrentLayer(),svgCanvas.getPrivateMethods().extensions.nameNumber&&(svgCanvas.getElem("nameText")&&svgCanvas.removeFromSelection([svgCanvas.getElem("nameText")]),svgCanvas.getElem("numberText")&&svgCanvas.removeFromSelection([svgCanvas.getElem("numberText")])),svgCanvas.getSelectedElems().length){for(var j=svgCanvas.getSelectedElems(),g=0;g<j.length;g++){var k=svgCanvas.getRotationAngle(j[g]);if(k){var l={obj:j[g],elemAngle:k};b.push(l),svgCanvas.setRotationAngle(0,!0,j[g])}if("true"==j[g].getAttribute("lockEdit")){var h={obj:j[g],attr:"lockEdit"};c.push(h),j[g].setAttribute("lockEdit","false")}if("true"==j[g].getAttribute("lockTransform")){var h={obj:j[g],attr:"lockTransform"};c.push(h),j[g].setAttribute("lockTransform","false")}"photobox"==j[g].getAttribute("type")&&svgCanvas.getPrivateMethods().extensions.imageEffect&&e.push(j[g].childNodes[0])}if(svgCanvas.groupSelectedElements(),setSizePosition(svgCanvas.getSelectedElems()[0],a),svgCanvas.ungroupSelectedElement(),svgCanvas.clearSelection(),b.length)for(var g=0;g<b.length;g++)svgCanvas.setRotationAngle(b[g].elemAngle,!0,b[g].obj);if(c.length)for(var g=0;g<c.length;g++)c[g].obj.setAttribute(c[g].attr,"true");if(d.length)for(var g=0;g<d.length;g++)d[g].obj.setAttribute(d[g].attr,"none");if(e.length){console.log("photoboxes"),console.log(e);for(var g=0;g<e.length;g++)svgCanvas.getPrivateMethods().extensions.imageEffect.updateClipPath(e[g])}return svgCanvas.getPrivateMethods().extensions.imageEffect&&svgCanvas.getPrivateMethods().extensions.imageEffect.updateAllClipPath(),!0}return!1}function removeSpecialChar(a){return a=a.replace(/"/g,"quote:"),a=a.replace(/'/g,"quotes:"),a=a.replace(/&/g,"amp:"),a=a.replace(/\n/g,"@##@#@")}function addSpecialChar(a){return a=a.replace(/quotes:/g,"'"),a=a.replace(/quote:/g,'"'),a=a.replace(/amp:/g,"&"),a=a.replace(/@##@#@/g,"\n")}function removeExtraSpace(a){return a.replace(/\s{2,}/g," ")}function rtrim(a,b){b=b?(b+"").replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,"\\$1"):" \\s ";var c=new RegExp("["+b+"]+$","g");return(a+"").replace(c,"")}function file_get_contents(a,b,c,d,e){var f,g=[],h=[],i=0,j=0,k="",l=-1,m=0,n=null,o=!1,p=function(a){return""!==a.substring(1)};this.php_js=this.php_js||{},this.php_js.ini=this.php_js.ini||{};var q=this.php_js.ini;c=c||this.php_js.default_streams_context||null,b||(b=0);var r={FILE_USE_INCLUDE_PATH:1,FILE_TEXT:32,FILE_BINARY:64};if("number"==typeof b)m=b;else for(b=[].concat(b),j=0;j<b.length;j++)r[b[j]]&&(m|=r[b[j]]);if(m&r.FILE_BINARY&&m&r.FILE_TEXT)throw"You cannot pass both FILE_BINARY and FILE_TEXT to file_get_contents()";if(m&r.FILE_USE_INCLUDE_PATH&&q.include_path&&q.include_path.local_value){var s=-1!==q.include_path.local_value.indexOf("/")?"/":"\\";a=q.include_path.local_value+s+a}else/^(https?|file):/.test(a)||(k=this.window.location.href,l=0===a.indexOf("/")?k.indexOf("/",8)-1:k.lastIndexOf("/"),a=k.slice(0,l+1)+a);if(c){var t=c.stream_options&&c.stream_options.http;o=!!t}if(!c||o){var u=this.window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest;if(!u)throw new Error("XMLHttpRequest not supported");var v=o?t.method:"GET",w=!!(c&&c.stream_params&&c.stream_params["phpjs.async"]);if(q["phpjs.ajaxBypassCache"]&&q["phpjs.ajaxBypassCache"].local_value&&(a+=(null==a.match(/\?/)?"?":"&")+(new Date).getTime()),console.log("async = "),console.log(w),u.open(v,a,!1),w){var x=c.stream_params.notification;"function"==typeof x&&(u.onreadystatechange=function(a){var b,c={responseText:u.responseText,responseXML:u.responseXML,status:u.status,statusText:u.statusText,readyState:u.readyState,evt:a};switch(u.readyState){case 0:x.call(c,0,0,"",0,0,0);break;case 1:x.call(c,0,0,"",0,0,0);break;case 2:x.call(c,0,0,"",0,0,0);break;case 3:b=2*u.responseText.length,x.call(c,7,0,"",0,b,0);break;case 4:u.status>=200&&u.status<400?(b=2*u.responseText.length,x.call(c,8,0,"",u.status,b,0)):403===u.status?x.call(c,10,2,"",u.status,0,0):x.call(c,9,2,"",u.status,0,0);break;default:throw"Unrecognized ready state for file_get_contents()"}})}if(o){var y=t.header&&t.header.split(/\r?\n/),z=!1;for(j=0;j<y.length;j++){var A=y[j],B=A.search(/:\s*/),C=A.substring(0,B);u.setRequestHeader(C,A.substring(B+1)),"User-Agent"===C&&(z=!0)}if(!z){var D=t.user_agent||q.user_agent&&q.user_agent.local_value;D&&u.setRequestHeader("User-Agent",D)}n=t.content||null}if(m&r.FILE_TEXT){var E="text/html";if(t&&t["phpjs.override"])E=t["phpjs.override"];else{var F=q["unicode.stream_encoding"]&&q["unicode.stream_encoding"].local_value||"UTF-8";t&&t.header&&/^content-type:/im.test(t.header)&&(E=t.header.match(/^content-type:\s*(.*)$/im)[1]),/;\s*charset=/.test(E)||(E+="; charset="+F)}u.overrideMimeType(E)}else m&r.FILE_BINARY&&u.overrideMimeType("text/plain; charset=x-user-defined");try{t&&t["phpjs.sendAsBinary"]?u.sendAsBinary(n):u.send(n)}catch(G){return!1}if(f=u.getAllResponseHeaders()){for(f=f.split("\n"),i=0;i<f.length;i++)p(f[i])&&h.push(f[i]);for(f=h,j=0;j<f.length;j++)g[j]=f[j];this.$http_response_header=g}return d||e?e?u.responseText.substr(d||0,e):u.responseText.substr(d):u.responseText}return!1}function DropDown(a){this.dd=a,this.placeholder=this.dd.children("span"),this.opts=this.dd.find("ul.dropdown > li"),this.val="",this.index=-1,this.initEvents()}!function(){"use strict";"SVGPathSeg"in window||(window.SVGPathSeg=function(a,b,c){this.pathSegType=a,this.pathSegTypeAsLetter=b,this._owningPathSegList=c},SVGPathSeg.PATHSEG_UNKNOWN=0,SVGPathSeg.PATHSEG_CLOSEPATH=1,SVGPathSeg.PATHSEG_MOVETO_ABS=2,SVGPathSeg.PATHSEG_MOVETO_REL=3,SVGPathSeg.PATHSEG_LINETO_ABS=4,SVGPathSeg.PATHSEG_LINETO_REL=5,SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS=6,SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL=7,SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS=8,SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL=9,SVGPathSeg.PATHSEG_ARC_ABS=10,SVGPathSeg.PATHSEG_ARC_REL=11,SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS=12,SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL=13,SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS=14,SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL=15,SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS=16,SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL=17,SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS=18,SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL=19,SVGPathSeg.prototype._segmentChanged=function(){this._owningPathSegList&&this._owningPathSegList.segmentChanged(this)},window.SVGPathSegClosePath=function(a){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CLOSEPATH,"z",a)},SVGPathSegClosePath.prototype=Object.create(SVGPathSeg.prototype),SVGPathSegClosePath.prototype.toString=function(){return"[object SVGPathSegClosePath]"},SVGPathSegClosePath.prototype._asPathString=function(){return this.pathSegTypeAsLetter},SVGPathSegClosePath.prototype.clone=function(){return new SVGPathSegClosePath(void 0)},window.SVGPathSegMovetoAbs=function(a,b,c){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_MOVETO_ABS,"M",a),this._x=b,this._y=c},SVGPathSegMovetoAbs.prototype=Object.create(SVGPathSeg.prototype),SVGPathSegMovetoAbs.prototype.toString=function(){return"[object SVGPathSegMovetoAbs]"},SVGPathSegMovetoAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},SVGPathSegMovetoAbs.prototype.clone=function(){return new SVGPathSegMovetoAbs(void 0,this._x,this._y)},Object.defineProperty(SVGPathSegMovetoAbs.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegMovetoAbs.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a,this._segmentChanged()},enumerable:!0}),window.SVGPathSegMovetoRel=function(a,b,c){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_MOVETO_REL,"m",a),this._x=b,this._y=c},SVGPathSegMovetoRel.prototype=Object.create(SVGPathSeg.prototype),SVGPathSegMovetoRel.prototype.toString=function(){return"[object SVGPathSegMovetoRel]"},SVGPathSegMovetoRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},SVGPathSegMovetoRel.prototype.clone=function(){return new SVGPathSegMovetoRel(void 0,this._x,this._y)},Object.defineProperty(SVGPathSegMovetoRel.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegMovetoRel.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoAbs=function(a,b,c){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_LINETO_ABS,"L",a),this._x=b,this._y=c},SVGPathSegLinetoAbs.prototype=Object.create(SVGPathSeg.prototype),SVGPathSegLinetoAbs.prototype.toString=function(){return"[object SVGPathSegLinetoAbs]"},SVGPathSegLinetoAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},SVGPathSegLinetoAbs.prototype.clone=function(){return new SVGPathSegLinetoAbs(void 0,this._x,this._y)},Object.defineProperty(SVGPathSegLinetoAbs.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegLinetoAbs.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoRel=function(a,b,c){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_LINETO_REL,"l",a),this._x=b,this._y=c},SVGPathSegLinetoRel.prototype=Object.create(SVGPathSeg.prototype),SVGPathSegLinetoRel.prototype.toString=function(){return"[object SVGPathSegLinetoRel]"},SVGPathSegLinetoRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},SVGPathSegLinetoRel.prototype.clone=function(){return new SVGPathSegLinetoRel(void 0,this._x,this._y)},Object.defineProperty(SVGPathSegLinetoRel.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegLinetoRel.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoCubicAbs=function(a,b,c,d,e,f,g){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS,"C",a),this._x=b,this._y=c,this._x1=d,this._y1=e,this._x2=f,this._y2=g},SVGPathSegCurvetoCubicAbs.prototype=Object.create(SVGPathSeg.prototype),SVGPathSegCurvetoCubicAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicAbs]"},SVGPathSegCurvetoCubicAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y},SVGPathSegCurvetoCubicAbs.prototype.clone=function(){return new SVGPathSegCurvetoCubicAbs(void 0,this._x,this._y,this._x1,this._y1,this._x2,this._y2)},Object.defineProperty(SVGPathSegCurvetoCubicAbs.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegCurvetoCubicAbs.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegCurvetoCubicAbs.prototype,"x1",{get:function(){return this._x1},set:function(a){this._x1=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegCurvetoCubicAbs.prototype,"y1",{get:function(){return this._y1},set:function(a){this._y1=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegCurvetoCubicAbs.prototype,"x2",{get:function(){return this._x2},set:function(a){this._x2=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegCurvetoCubicAbs.prototype,"y2",{get:function(){return this._y2},set:function(a){this._y2=a,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoCubicRel=function(a,b,c,d,e,f,g){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL,"c",a),this._x=b,this._y=c,this._x1=d,this._y1=e,this._x2=f,this._y2=g},SVGPathSegCurvetoCubicRel.prototype=Object.create(SVGPathSeg.prototype),SVGPathSegCurvetoCubicRel.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicRel]"},SVGPathSegCurvetoCubicRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y},SVGPathSegCurvetoCubicRel.prototype.clone=function(){return new SVGPathSegCurvetoCubicRel(void 0,this._x,this._y,this._x1,this._y1,this._x2,this._y2)},Object.defineProperty(SVGPathSegCurvetoCubicRel.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegCurvetoCubicRel.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegCurvetoCubicRel.prototype,"x1",{get:function(){return this._x1},set:function(a){this._x1=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegCurvetoCubicRel.prototype,"y1",{get:function(){return this._y1},set:function(a){this._y1=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegCurvetoCubicRel.prototype,"x2",{get:function(){return this._x2},set:function(a){this._x2=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegCurvetoCubicRel.prototype,"y2",{get:function(){return this._y2},set:function(a){this._y2=a,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoQuadraticAbs=function(a,b,c,d,e){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS,"Q",a),this._x=b,this._y=c,this._x1=d,this._y1=e},SVGPathSegCurvetoQuadraticAbs.prototype=Object.create(SVGPathSeg.prototype),SVGPathSegCurvetoQuadraticAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticAbs]"},SVGPathSegCurvetoQuadraticAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x+" "+this._y},SVGPathSegCurvetoQuadraticAbs.prototype.clone=function(){return new SVGPathSegCurvetoQuadraticAbs(void 0,this._x,this._y,this._x1,this._y1)},Object.defineProperty(SVGPathSegCurvetoQuadraticAbs.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegCurvetoQuadraticAbs.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegCurvetoQuadraticAbs.prototype,"x1",{get:function(){return this._x1},set:function(a){this._x1=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegCurvetoQuadraticAbs.prototype,"y1",{get:function(){return this._y1},set:function(a){this._y1=a,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoQuadraticRel=function(a,b,c,d,e){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL,"q",a),this._x=b,this._y=c,this._x1=d,this._y1=e},SVGPathSegCurvetoQuadraticRel.prototype=Object.create(SVGPathSeg.prototype),SVGPathSegCurvetoQuadraticRel.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticRel]"},SVGPathSegCurvetoQuadraticRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x+" "+this._y},SVGPathSegCurvetoQuadraticRel.prototype.clone=function(){return new SVGPathSegCurvetoQuadraticRel(void 0,this._x,this._y,this._x1,this._y1)},Object.defineProperty(SVGPathSegCurvetoQuadraticRel.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegCurvetoQuadraticRel.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegCurvetoQuadraticRel.prototype,"x1",{get:function(){return this._x1},set:function(a){this._x1=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegCurvetoQuadraticRel.prototype,"y1",{get:function(){return this._y1},set:function(a){this._y1=a,this._segmentChanged()},enumerable:!0}),window.SVGPathSegArcAbs=function(a,b,c,d,e,f,g,h){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_ARC_ABS,"A",a),this._x=b,this._y=c,this._r1=d,this._r2=e,this._angle=f,this._largeArcFlag=g,this._sweepFlag=h},SVGPathSegArcAbs.prototype=Object.create(SVGPathSeg.prototype),SVGPathSegArcAbs.prototype.toString=function(){return"[object SVGPathSegArcAbs]"},SVGPathSegArcAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._r1+" "+this._r2+" "+this._angle+" "+(this._largeArcFlag?"1":"0")+" "+(this._sweepFlag?"1":"0")+" "+this._x+" "+this._y},SVGPathSegArcAbs.prototype.clone=function(){return new SVGPathSegArcAbs(void 0,this._x,this._y,this._r1,this._r2,this._angle,this._largeArcFlag,this._sweepFlag)},Object.defineProperty(SVGPathSegArcAbs.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegArcAbs.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegArcAbs.prototype,"r1",{get:function(){return this._r1},set:function(a){this._r1=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegArcAbs.prototype,"r2",{get:function(){return this._r2},set:function(a){this._r2=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegArcAbs.prototype,"angle",{get:function(){return this._angle},set:function(a){this._angle=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegArcAbs.prototype,"largeArcFlag",{get:function(){return this._largeArcFlag},set:function(a){this._largeArcFlag=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegArcAbs.prototype,"sweepFlag",{get:function(){return this._sweepFlag},set:function(a){this._sweepFlag=a,this._segmentChanged()},enumerable:!0}),window.SVGPathSegArcRel=function(a,b,c,d,e,f,g,h){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_ARC_REL,"a",a),this._x=b,this._y=c,this._r1=d,this._r2=e,this._angle=f,this._largeArcFlag=g,this._sweepFlag=h},SVGPathSegArcRel.prototype=Object.create(SVGPathSeg.prototype),SVGPathSegArcRel.prototype.toString=function(){return"[object SVGPathSegArcRel]"},SVGPathSegArcRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._r1+" "+this._r2+" "+this._angle+" "+(this._largeArcFlag?"1":"0")+" "+(this._sweepFlag?"1":"0")+" "+this._x+" "+this._y},SVGPathSegArcRel.prototype.clone=function(){return new SVGPathSegArcRel(void 0,this._x,this._y,this._r1,this._r2,this._angle,this._largeArcFlag,this._sweepFlag)},Object.defineProperty(SVGPathSegArcRel.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegArcRel.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegArcRel.prototype,"r1",{get:function(){return this._r1},set:function(a){this._r1=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegArcRel.prototype,"r2",{get:function(){return this._r2},set:function(a){this._r2=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegArcRel.prototype,"angle",{get:function(){return this._angle},set:function(a){this._angle=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegArcRel.prototype,"largeArcFlag",{get:function(){return this._largeArcFlag},set:function(a){this._largeArcFlag=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegArcRel.prototype,"sweepFlag",{get:function(){return this._sweepFlag},set:function(a){this._sweepFlag=a,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoHorizontalAbs=function(a,b){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS,"H",a),this._x=b},SVGPathSegLinetoHorizontalAbs.prototype=Object.create(SVGPathSeg.prototype),SVGPathSegLinetoHorizontalAbs.prototype.toString=function(){return"[object SVGPathSegLinetoHorizontalAbs]"},SVGPathSegLinetoHorizontalAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x},SVGPathSegLinetoHorizontalAbs.prototype.clone=function(){return new SVGPathSegLinetoHorizontalAbs(void 0,this._x)},Object.defineProperty(SVGPathSegLinetoHorizontalAbs.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoHorizontalRel=function(a,b){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL,"h",a),this._x=b},SVGPathSegLinetoHorizontalRel.prototype=Object.create(SVGPathSeg.prototype),SVGPathSegLinetoHorizontalRel.prototype.toString=function(){return"[object SVGPathSegLinetoHorizontalRel]"},SVGPathSegLinetoHorizontalRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x},SVGPathSegLinetoHorizontalRel.prototype.clone=function(){return new SVGPathSegLinetoHorizontalRel(void 0,this._x)},Object.defineProperty(SVGPathSegLinetoHorizontalRel.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoVerticalAbs=function(a,b){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS,"V",a),this._y=b},SVGPathSegLinetoVerticalAbs.prototype=Object.create(SVGPathSeg.prototype),SVGPathSegLinetoVerticalAbs.prototype.toString=function(){return"[object SVGPathSegLinetoVerticalAbs]"},SVGPathSegLinetoVerticalAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._y},SVGPathSegLinetoVerticalAbs.prototype.clone=function(){return new SVGPathSegLinetoVerticalAbs(void 0,this._y)},Object.defineProperty(SVGPathSegLinetoVerticalAbs.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoVerticalRel=function(a,b){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL,"v",a),this._y=b},SVGPathSegLinetoVerticalRel.prototype=Object.create(SVGPathSeg.prototype),SVGPathSegLinetoVerticalRel.prototype.toString=function(){return"[object SVGPathSegLinetoVerticalRel]"},SVGPathSegLinetoVerticalRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._y},SVGPathSegLinetoVerticalRel.prototype.clone=function(){return new SVGPathSegLinetoVerticalRel(void 0,this._y)},Object.defineProperty(SVGPathSegLinetoVerticalRel.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoCubicSmoothAbs=function(a,b,c,d,e){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS,"S",a),this._x=b,this._y=c,this._x2=d,this._y2=e},SVGPathSegCurvetoCubicSmoothAbs.prototype=Object.create(SVGPathSeg.prototype),SVGPathSegCurvetoCubicSmoothAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicSmoothAbs]"},SVGPathSegCurvetoCubicSmoothAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y},SVGPathSegCurvetoCubicSmoothAbs.prototype.clone=function(){return new SVGPathSegCurvetoCubicSmoothAbs(void 0,this._x,this._y,this._x2,this._y2)},Object.defineProperty(SVGPathSegCurvetoCubicSmoothAbs.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegCurvetoCubicSmoothAbs.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegCurvetoCubicSmoothAbs.prototype,"x2",{get:function(){return this._x2},set:function(a){this._x2=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegCurvetoCubicSmoothAbs.prototype,"y2",{get:function(){return this._y2},set:function(a){this._y2=a,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoCubicSmoothRel=function(a,b,c,d,e){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL,"s",a),this._x=b,this._y=c,this._x2=d,this._y2=e},SVGPathSegCurvetoCubicSmoothRel.prototype=Object.create(SVGPathSeg.prototype),SVGPathSegCurvetoCubicSmoothRel.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicSmoothRel]"},SVGPathSegCurvetoCubicSmoothRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y},SVGPathSegCurvetoCubicSmoothRel.prototype.clone=function(){return new SVGPathSegCurvetoCubicSmoothRel(void 0,this._x,this._y,this._x2,this._y2)},Object.defineProperty(SVGPathSegCurvetoCubicSmoothRel.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegCurvetoCubicSmoothRel.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegCurvetoCubicSmoothRel.prototype,"x2",{get:function(){return this._x2},set:function(a){this._x2=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegCurvetoCubicSmoothRel.prototype,"y2",{get:function(){return this._y2},set:function(a){this._y2=a,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoQuadraticSmoothAbs=function(a,b,c){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS,"T",a),this._x=b,this._y=c},SVGPathSegCurvetoQuadraticSmoothAbs.prototype=Object.create(SVGPathSeg.prototype),SVGPathSegCurvetoQuadraticSmoothAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticSmoothAbs]"},SVGPathSegCurvetoQuadraticSmoothAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},SVGPathSegCurvetoQuadraticSmoothAbs.prototype.clone=function(){return new SVGPathSegCurvetoQuadraticSmoothAbs(void 0,this._x,this._y)},Object.defineProperty(SVGPathSegCurvetoQuadraticSmoothAbs.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegCurvetoQuadraticSmoothAbs.prototype,"y",{get:function(){return this._y
},set:function(a){this._y=a,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoQuadraticSmoothRel=function(a,b,c){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL,"t",a),this._x=b,this._y=c},SVGPathSegCurvetoQuadraticSmoothRel.prototype=Object.create(SVGPathSeg.prototype),SVGPathSegCurvetoQuadraticSmoothRel.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticSmoothRel]"},SVGPathSegCurvetoQuadraticSmoothRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},SVGPathSegCurvetoQuadraticSmoothRel.prototype.clone=function(){return new SVGPathSegCurvetoQuadraticSmoothRel(void 0,this._x,this._y)},Object.defineProperty(SVGPathSegCurvetoQuadraticSmoothRel.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a,this._segmentChanged()},enumerable:!0}),Object.defineProperty(SVGPathSegCurvetoQuadraticSmoothRel.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a,this._segmentChanged()},enumerable:!0}),SVGPathElement.prototype.createSVGPathSegClosePath=function(){return new SVGPathSegClosePath(void 0)},SVGPathElement.prototype.createSVGPathSegMovetoAbs=function(a,b){return new SVGPathSegMovetoAbs(void 0,a,b)},SVGPathElement.prototype.createSVGPathSegMovetoRel=function(a,b){return new SVGPathSegMovetoRel(void 0,a,b)},SVGPathElement.prototype.createSVGPathSegLinetoAbs=function(a,b){return new SVGPathSegLinetoAbs(void 0,a,b)},SVGPathElement.prototype.createSVGPathSegLinetoRel=function(a,b){return new SVGPathSegLinetoRel(void 0,a,b)},SVGPathElement.prototype.createSVGPathSegCurvetoCubicAbs=function(a,b,c,d,e,f){return new SVGPathSegCurvetoCubicAbs(void 0,a,b,c,d,e,f)},SVGPathElement.prototype.createSVGPathSegCurvetoCubicRel=function(a,b,c,d,e,f){return new SVGPathSegCurvetoCubicRel(void 0,a,b,c,d,e,f)},SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticAbs=function(a,b,c,d){return new SVGPathSegCurvetoQuadraticAbs(void 0,a,b,c,d)},SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticRel=function(a,b,c,d){return new SVGPathSegCurvetoQuadraticRel(void 0,a,b,c,d)},SVGPathElement.prototype.createSVGPathSegArcAbs=function(a,b,c,d,e,f,g){return new SVGPathSegArcAbs(void 0,a,b,c,d,e,f,g)},SVGPathElement.prototype.createSVGPathSegArcRel=function(a,b,c,d,e,f,g){return new SVGPathSegArcRel(void 0,a,b,c,d,e,f,g)},SVGPathElement.prototype.createSVGPathSegLinetoHorizontalAbs=function(a){return new SVGPathSegLinetoHorizontalAbs(void 0,a)},SVGPathElement.prototype.createSVGPathSegLinetoHorizontalRel=function(a){return new SVGPathSegLinetoHorizontalRel(void 0,a)},SVGPathElement.prototype.createSVGPathSegLinetoVerticalAbs=function(a){return new SVGPathSegLinetoVerticalAbs(void 0,a)},SVGPathElement.prototype.createSVGPathSegLinetoVerticalRel=function(a){return new SVGPathSegLinetoVerticalRel(void 0,a)},SVGPathElement.prototype.createSVGPathSegCurvetoCubicSmoothAbs=function(a,b,c,d){return new SVGPathSegCurvetoCubicSmoothAbs(void 0,a,b,c,d)},SVGPathElement.prototype.createSVGPathSegCurvetoCubicSmoothRel=function(a,b,c,d){return new SVGPathSegCurvetoCubicSmoothRel(void 0,a,b,c,d)},SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticSmoothAbs=function(a,b){return new SVGPathSegCurvetoQuadraticSmoothAbs(void 0,a,b)},SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticSmoothRel=function(a,b){return new SVGPathSegCurvetoQuadraticSmoothRel(void 0,a,b)}),"SVGPathSegList"in window||(window.SVGPathSegList=function(a){this._pathElement=a,this._list=this._parsePath(this._pathElement.getAttribute("d")),this._mutationObserverConfig={attributes:!0,attributeFilter:["d"]},this._pathElementMutationObserver=new MutationObserver(this._updateListFromPathMutations.bind(this)),this._pathElementMutationObserver.observe(this._pathElement,this._mutationObserverConfig)},Object.defineProperty(SVGPathSegList.prototype,"numberOfItems",{get:function(){return this._checkPathSynchronizedToList(),this._list.length},enumerable:!0}),Object.defineProperty(SVGPathElement.prototype,"pathSegList",{get:function(){return this._pathSegList||(this._pathSegList=new SVGPathSegList(this)),this._pathSegList},enumerable:!0}),Object.defineProperty(SVGPathElement.prototype,"normalizedPathSegList",{get:function(){return this.pathSegList},enumerable:!0}),Object.defineProperty(SVGPathElement.prototype,"animatedPathSegList",{get:function(){return this.pathSegList},enumerable:!0}),Object.defineProperty(SVGPathElement.prototype,"animatedNormalizedPathSegList",{get:function(){return this.pathSegList},enumerable:!0}),SVGPathSegList.prototype._checkPathSynchronizedToList=function(){this._updateListFromPathMutations(this._pathElementMutationObserver.takeRecords())},SVGPathSegList.prototype._updateListFromPathMutations=function(a){if(this._pathElement){var b=!1;a.forEach(function(a){"d"==a.attributeName&&(b=!0)}),b&&(this._list=this._parsePath(this._pathElement.getAttribute("d")))}},SVGPathSegList.prototype._writeListToPath=function(){this._pathElementMutationObserver.disconnect(),this._pathElement.setAttribute("d",SVGPathSegList._pathSegArrayAsString(this._list)),this._pathElementMutationObserver.observe(this._pathElement,this._mutationObserverConfig)},SVGPathSegList.prototype.segmentChanged=function(){this._writeListToPath()},SVGPathSegList.prototype.clear=function(){this._checkPathSynchronizedToList(),this._list.forEach(function(a){a._owningPathSegList=null}),this._list=[],this._writeListToPath()},SVGPathSegList.prototype.initialize=function(a){return this._checkPathSynchronizedToList(),this._list=[a],a._owningPathSegList=this,this._writeListToPath(),a},SVGPathSegList.prototype._checkValidIndex=function(a){if(isNaN(a)||0>a||a>=this.numberOfItems)throw"INDEX_SIZE_ERR"},SVGPathSegList.prototype.getItem=function(a){return this._checkPathSynchronizedToList(),this._checkValidIndex(a),this._list[a]},SVGPathSegList.prototype.insertItemBefore=function(a,b){return this._checkPathSynchronizedToList(),b>this.numberOfItems&&(b=this.numberOfItems),a._owningPathSegList&&(a=a.clone()),this._list.splice(b,0,a),a._owningPathSegList=this,this._writeListToPath(),a},SVGPathSegList.prototype.replaceItem=function(a,b){return this._checkPathSynchronizedToList(),a._owningPathSegList&&(a=a.clone()),this._checkValidIndex(b),this._list[b]=a,a._owningPathSegList=this,this._writeListToPath(),a},SVGPathSegList.prototype.removeItem=function(a){this._checkPathSynchronizedToList(),this._checkValidIndex(a);var b=this._list[a];return this._list.splice(a,1),this._writeListToPath(),b},SVGPathSegList.prototype.appendItem=function(a){return this._checkPathSynchronizedToList(),a._owningPathSegList&&(a=a.clone()),this._list.push(a),a._owningPathSegList=this,this._writeListToPath(),a},SVGPathSegList._pathSegArrayAsString=function(a){var b="",c=!0;return a.forEach(function(a){c?(c=!1,b+=a._asPathString()):b+=" "+a._asPathString()}),b},SVGPathSegList.prototype._parsePath=function(a){if(!a||0==a.length)return[];var b=this,c=function(){this.pathSegList=[]};c.prototype.appendSegment=function(a){this.pathSegList.push(a)};var d=function(a){this._string=a,this._currentIndex=0,this._endIndex=this._string.length,this._previousCommand=SVGPathSeg.PATHSEG_UNKNOWN,this._skipOptionalSpaces()};d.prototype._isCurrentSpace=function(){var a=this._string[this._currentIndex];return" ">=a&&(" "==a||"\n"==a||"	"==a||"\r"==a||"\f"==a)},d.prototype._skipOptionalSpaces=function(){for(;this._currentIndex<this._endIndex&&this._isCurrentSpace();)this._currentIndex++;return this._currentIndex<this._endIndex},d.prototype._skipOptionalSpacesOrDelimiter=function(){return this._currentIndex<this._endIndex&&!this._isCurrentSpace()&&","!=this._string.charAt(this._currentIndex)?!1:(this._skipOptionalSpaces()&&this._currentIndex<this._endIndex&&","==this._string.charAt(this._currentIndex)&&(this._currentIndex++,this._skipOptionalSpaces()),this._currentIndex<this._endIndex)},d.prototype.hasMoreData=function(){return this._currentIndex<this._endIndex},d.prototype.peekSegmentType=function(){var a=this._string[this._currentIndex];return this._pathSegTypeFromChar(a)},d.prototype._pathSegTypeFromChar=function(a){switch(a){case"Z":case"z":return SVGPathSeg.PATHSEG_CLOSEPATH;case"M":return SVGPathSeg.PATHSEG_MOVETO_ABS;case"m":return SVGPathSeg.PATHSEG_MOVETO_REL;case"L":return SVGPathSeg.PATHSEG_LINETO_ABS;case"l":return SVGPathSeg.PATHSEG_LINETO_REL;case"C":return SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS;case"c":return SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL;case"Q":return SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS;case"q":return SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL;case"A":return SVGPathSeg.PATHSEG_ARC_ABS;case"a":return SVGPathSeg.PATHSEG_ARC_REL;case"H":return SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS;case"h":return SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL;case"V":return SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS;case"v":return SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL;case"S":return SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS;case"s":return SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL;case"T":return SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS;case"t":return SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL;default:return SVGPathSeg.PATHSEG_UNKNOWN}},d.prototype._nextCommandHelper=function(a,b){return("+"==a||"-"==a||"."==a||a>="0"&&"9">=a)&&b!=SVGPathSeg.PATHSEG_CLOSEPATH?b==SVGPathSeg.PATHSEG_MOVETO_ABS?SVGPathSeg.PATHSEG_LINETO_ABS:b==SVGPathSeg.PATHSEG_MOVETO_REL?SVGPathSeg.PATHSEG_LINETO_REL:b:SVGPathSeg.PATHSEG_UNKNOWN},d.prototype.initialCommandIsMoveTo=function(){if(!this.hasMoreData())return!0;var a=this.peekSegmentType();return a==SVGPathSeg.PATHSEG_MOVETO_ABS||a==SVGPathSeg.PATHSEG_MOVETO_REL},d.prototype._parseNumber=function(){var a=0,b=0,c=1,d=0,e=1,f=1,g=this._currentIndex;if(this._skipOptionalSpaces(),this._currentIndex<this._endIndex&&"+"==this._string.charAt(this._currentIndex)?this._currentIndex++:this._currentIndex<this._endIndex&&"-"==this._string.charAt(this._currentIndex)&&(this._currentIndex++,e=-1),this._currentIndex==this._endIndex||(this._string.charAt(this._currentIndex)<"0"||this._string.charAt(this._currentIndex)>"9")&&"."!=this._string.charAt(this._currentIndex))return void 0;for(var h=this._currentIndex;this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)>="0"&&this._string.charAt(this._currentIndex)<="9";)this._currentIndex++;if(this._currentIndex!=h)for(var i=this._currentIndex-1,j=1;i>=h;)b+=j*(this._string.charAt(i--)-"0"),j*=10;if(this._currentIndex<this._endIndex&&"."==this._string.charAt(this._currentIndex)){if(this._currentIndex++,this._currentIndex>=this._endIndex||this._string.charAt(this._currentIndex)<"0"||this._string.charAt(this._currentIndex)>"9")return void 0;for(;this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)>="0"&&this._string.charAt(this._currentIndex)<="9";)d+=(this._string.charAt(this._currentIndex++)-"0")*(c*=.1)}if(this._currentIndex!=g&&this._currentIndex+1<this._endIndex&&("e"==this._string.charAt(this._currentIndex)||"E"==this._string.charAt(this._currentIndex))&&"x"!=this._string.charAt(this._currentIndex+1)&&"m"!=this._string.charAt(this._currentIndex+1)){if(this._currentIndex++,"+"==this._string.charAt(this._currentIndex)?this._currentIndex++:"-"==this._string.charAt(this._currentIndex)&&(this._currentIndex++,f=-1),this._currentIndex>=this._endIndex||this._string.charAt(this._currentIndex)<"0"||this._string.charAt(this._currentIndex)>"9")return void 0;for(;this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)>="0"&&this._string.charAt(this._currentIndex)<="9";)a*=10,a+=this._string.charAt(this._currentIndex)-"0",this._currentIndex++}var k=b+d;return k*=e,a&&(k*=Math.pow(10,f*a)),g==this._currentIndex?void 0:(this._skipOptionalSpacesOrDelimiter(),k)},d.prototype._parseArcFlag=function(){if(this._currentIndex>=this._endIndex)return void 0;var a=!1,b=this._string.charAt(this._currentIndex++);if("0"==b)a=!1;else{if("1"!=b)return void 0;a=!0}return this._skipOptionalSpacesOrDelimiter(),a},d.prototype.parseSegment=function(){var a=this._string[this._currentIndex],c=this._pathSegTypeFromChar(a);if(c==SVGPathSeg.PATHSEG_UNKNOWN){if(this._previousCommand==SVGPathSeg.PATHSEG_UNKNOWN)return null;if(c=this._nextCommandHelper(a,this._previousCommand),c==SVGPathSeg.PATHSEG_UNKNOWN)return null}else this._currentIndex++;switch(this._previousCommand=c,c){case SVGPathSeg.PATHSEG_MOVETO_REL:return new SVGPathSegMovetoRel(b,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_MOVETO_ABS:return new SVGPathSegMovetoAbs(b,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_REL:return new SVGPathSegLinetoRel(b,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_ABS:return new SVGPathSegLinetoAbs(b,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL:return new SVGPathSegLinetoHorizontalRel(b,this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS:return new SVGPathSegLinetoHorizontalAbs(b,this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL:return new SVGPathSegLinetoVerticalRel(b,this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS:return new SVGPathSegLinetoVerticalAbs(b,this._parseNumber());case SVGPathSeg.PATHSEG_CLOSEPATH:return this._skipOptionalSpaces(),new SVGPathSegClosePath(b);case SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL:var d={x1:this._parseNumber(),y1:this._parseNumber(),x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoCubicRel(b,d.x,d.y,d.x1,d.y1,d.x2,d.y2);case SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS:var d={x1:this._parseNumber(),y1:this._parseNumber(),x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoCubicAbs(b,d.x,d.y,d.x1,d.y1,d.x2,d.y2);case SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL:var d={x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoCubicSmoothRel(b,d.x,d.y,d.x2,d.y2);case SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS:var d={x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoCubicSmoothAbs(b,d.x,d.y,d.x2,d.y2);case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL:var d={x1:this._parseNumber(),y1:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoQuadraticRel(b,d.x,d.y,d.x1,d.y1);case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS:var d={x1:this._parseNumber(),y1:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoQuadraticAbs(b,d.x,d.y,d.x1,d.y1);case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL:return new SVGPathSegCurvetoQuadraticSmoothRel(b,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS:return new SVGPathSegCurvetoQuadraticSmoothAbs(b,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_ARC_REL:var d={x1:this._parseNumber(),y1:this._parseNumber(),arcAngle:this._parseNumber(),arcLarge:this._parseArcFlag(),arcSweep:this._parseArcFlag(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegArcRel(b,d.x,d.y,d.x1,d.y1,d.arcAngle,d.arcLarge,d.arcSweep);case SVGPathSeg.PATHSEG_ARC_ABS:var d={x1:this._parseNumber(),y1:this._parseNumber(),arcAngle:this._parseNumber(),arcLarge:this._parseArcFlag(),arcSweep:this._parseArcFlag(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegArcAbs(b,d.x,d.y,d.x1,d.y1,d.arcAngle,d.arcLarge,d.arcSweep);default:throw"Unknown path seg type."}};var e=new c,f=new d(a);if(!f.initialCommandIsMoveTo())return[];for(;f.hasMoreData();){var g=f.parseSegment();if(!g)return[];e.appendSegment(g)}return e.pathSegList})}();var svgedit=svgedit||{};!function(){svgedit.browser||(svgedit.browser={});var a=function(){return!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect}();if(svgedit.browser.supportsSvg=function(){return a},svgedit.browser.supportsSvg()){var b="http://www.w3.org/2000/svg",c=navigator.userAgent,d=document.createElementNS(b,"svg"),e=!!window.opera,f=c.indexOf("AppleWebKit")>=0,g=c.indexOf("Gecko/")>=0,h=c.indexOf("MSIE")>=0||!!c.match(/Trident.*rv[ :]*11\./),i=c.indexOf("Chrome/")>=0,j=c.indexOf("Windows")>=0,k=c.indexOf("Macintosh")>=0,l=function(){return!!d.querySelector}(),m=function(){return!!document.evaluate}(),n=function(){var a=document.createElementNS(b,"path");a.setAttribute("d","M0,0 10,10");var c=a.pathSegList,d=a.createSVGPathSegLinetoAbs(5,5);try{return c.replaceItem(d,0),!0}catch(e){}return!1}(),o=function(){var a=document.createElementNS(b,"path");a.setAttribute("d","M0,0 10,10");var c=a.pathSegList,d=a.createSVGPathSegLinetoAbs(5,5);try{return c.insertItemBefore(d,0),!0}catch(e){}return!1}(),p=function(){var a=document.createElementNS(b,"svg"),c=document.createElementNS(b,"svg");document.documentElement.appendChild(a),c.setAttribute("x",5),a.appendChild(c);var d=document.createElementNS(b,"text");d.textContent="a",c.appendChild(d);var e=d.getStartPositionOfChar(0).x;return document.documentElement.removeChild(a),0===e}(),q=function(){var a=document.createElementNS(b,"svg");document.documentElement.appendChild(a);var c=document.createElementNS(b,"path");c.setAttribute("d","M0,0 C0,0 10,10 10,0"),a.appendChild(c);var d=c.getBBox();return document.documentElement.removeChild(a),d.height>4&&d.height<5}(),r=function(){var a=document.createElementNS(b,"svg");document.documentElement.appendChild(a);var c=document.createElementNS(b,"path");c.setAttribute("d","M0,0 10,0");var d=document.createElementNS(b,"path");d.setAttribute("d","M5,0 15,0");var e=document.createElementNS(b,"g");e.appendChild(c),e.appendChild(d),a.appendChild(e);var f=e.getBBox();return document.documentElement.removeChild(a),15==f.width}(),s=function(){return e}(),t=function(){var a=document.createElementNS(b,"rect");a.setAttribute("x",.1);var c=a.cloneNode(!1),d=-1==c.getAttribute("x").indexOf(",");return d||$j.alert("NOTE: This version of Opera is known to contain bugs in SVG-edit.\n		Please upgrade to the <a href='http://opera.com'>latest version</a> in which the problems have been fixed."),d}(),u=function(){var a=document.createElementNS(b,"rect");return a.setAttribute("style","vector-effect:non-scaling-stroke"),"non-scaling-stroke"===a.style.vectorEffect}(),v=function(){var a=document.createElementNS(b,"rect"),c=a.transform.baseVal,e=d.createSVGTransform();return c.appendItem(e),c.getItem(0)==e}();svgedit.browser.isOpera=function(){return e},svgedit.browser.isWebkit=function(){return f},svgedit.browser.isGecko=function(){return g},svgedit.browser.isIE=function(){return h},svgedit.browser.isChrome=function(){return i},svgedit.browser.isWindows=function(){return j},svgedit.browser.isMac=function(){return k},svgedit.browser.isIOS=function(){var a=!1,b=navigator.platform;return("iPad"===b||"iPhone"===b||"iPod"===b)&&(a=!0),a},svgedit.browser.IOSVersion=function(){var a=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return[parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3]||0,10)]},svgedit.browser.isTouch=function(){try{return document.createEvent("TouchEvent"),!0}catch(a){return!1}},svgedit.browser.supportsSelectors=function(){return l},svgedit.browser.supportsXpath=function(){return m},svgedit.browser.supportsPathReplaceItem=function(){return n},svgedit.browser.supportsPathInsertItemBefore=function(){return o},svgedit.browser.supportsPathBBox=function(){return q},svgedit.browser.supportsHVLineContainerBBox=function(){return r},svgedit.browser.supportsGoodTextCharPos=function(){return p},svgedit.browser.supportsEditableText=function(){return s},svgedit.browser.supportsGoodDecimals=function(){return t},svgedit.browser.supportsNonScalingStroke=function(){return u},svgedit.browser.supportsNativeTransformLists=function(){return v}}else window.location="browser-not-supported.html"}();var svgedit=svgedit||{};!function(){function a(a){var b=a.matrix,c="";switch(a.type){case 1:c="matrix("+[b.a,b.b,b.c,b.d,b.e,b.f].join(",")+")";break;case 2:c="translate("+b.e+","+b.f+")";break;case 3:c=b.a==b.d?"scale("+b.a+")":"scale("+b.a+","+b.d+")";break;case 4:var d=0,e=0;if(0!=a.angle){var f=1-b.a;e=(f*b.f+b.b*b.e)/(f*f+b.b*b.b),d=(b.e-b.b*e)/f}c="rotate("+a.angle+" "+d+","+e+")"}return c}svgedit.transformlist||(svgedit.transformlist={});var b=document.createElementNS("http://www.w3.org/2000/svg","svg"),c={};svgedit.transformlist.SVGTransformList=function(d){this._elem=d||null,this._xforms=[],this._update=function(){for(var c="",d=(b.createSVGMatrix(),0);d<this.numberOfItems;++d){var e=this._list.getItem(d);c+=a(e)+" "}this._elem.setAttribute("transform",c)},this._list=this,this._init=function(){var a=this._elem.getAttribute("transform");if(a)for(var c=/\s*((scale|matrix|rotate|translate)\s*\(.*?\))\s*,?\s*/,d=!0;d;)if(d=a.match(c),a=a.replace(c,""),d&&d[1]){var e=d[1],f=e.split(/\s*\(/),g=f[0],h=f[1].match(/\s*(.*?)\s*\)/);h[1]=h[1].replace(/(\d)-/g,"$1 -");var i=h[1].split(/[, ]+/),j="abcdef".split(""),k=b.createSVGMatrix();$j.each(i,function(a,b){i[a]=parseFloat(b),"matrix"==g&&(k[j[a]]=i[a])});var l=b.createSVGTransform(),m="set"+g.charAt(0).toUpperCase()+g.slice(1),n="matrix"==g?[k]:i;"scale"==g&&1==n.length?n.push(n[0]):"translate"==g&&1==n.length?n.push(0):"rotate"==g&&1==n.length&&(n.push(0),n.push(0)),l[m].apply(l,n),this._list.appendItem(l)}},this._removeFromOtherLists=function(a){if(a){var b=!1;for(var d in c){for(var e=c[d],f=0,g=e._xforms.length;g>f;++f)if(e._xforms[f]==a){b=!0,e.removeItem(f);break}if(b)break}}},this.numberOfItems=0,this.clear=function(){this.numberOfItems=0,this._xforms=[]},this.initialize=function(a){this.numberOfItems=1,this._removeFromOtherLists(a),this._xforms=[a]},this.getItem=function(a){if(a<this.numberOfItems&&a>=0)return this._xforms[a];throw{code:1}},this.insertItemBefore=function(a,b){var c=null;if(b>=0)if(b<this.numberOfItems){this._removeFromOtherLists(a);for(var d=new Array(this.numberOfItems+1),e=0;b>e;++e)d[e]=this._xforms[e];d[e]=a;for(var f=e+1;e<this.numberOfItems;++f,++e)d[f]=this._xforms[e];this.numberOfItems++,this._xforms=d,c=a,this._list._update()}else c=this._list.appendItem(a);return c},this.replaceItem=function(a,b){var c=null;return b<this.numberOfItems&&b>=0&&(this._removeFromOtherLists(a),this._xforms[b]=a,c=a,this._list._update()),c},this.removeItem=function(a){if(a<this.numberOfItems&&a>=0){for(var b=this._xforms[a],c=new Array(this.numberOfItems-1),d=0;a>d;++d)c[d]=this._xforms[d];for(var e=d;e<this.numberOfItems-1;++e,++d)c[e]=this._xforms[d+1];return this.numberOfItems--,this._xforms=c,this._list._update(),b}throw{code:1}},this.appendItem=function(a){return this._removeFromOtherLists(a),this._xforms.push(a),this.numberOfItems++,this._list._update(),a}},svgedit.transformlist.resetListMap=function(){c={}},svgedit.transformlist.removeElementFromListMap=function(a){a.id&&c[a.id]&&delete c[a.id]},svgedit.transformlist.getTransformList=function(a){return a.transform?a.transform.baseVal:a.gradientTransform?a.gradientTransform.baseVal:a.patternTransform?a.patternTransform.baseVal:null}}();var svgedit=svgedit||{};!function(){svgedit.math||(svgedit.math={});var a=1e-14,b=document.createElementNS("http://www.w3.org/2000/svg","svg");svgedit.math.transformPoint=function(a,b,c){return{x:c.a*a+c.c*b+c.e,y:c.b*a+c.d*b+c.f}},svgedit.math.isIdentity=function(a){return 1===a.a&&0===a.b&&0===a.c&&1===a.d&&0===a.e&&0===a.f},svgedit.math.matrixMultiply=function(){for(var b=arguments,c=b.length,d=b[c-1];c-->1;){var e=b[c-1];d=e.multiply(d)}return Math.abs(d.a)<a&&(d.a=0),Math.abs(d.b)<a&&(d.b=0),Math.abs(d.c)<a&&(d.c=0),Math.abs(d.d)<a&&(d.d=0),Math.abs(d.e)<a&&(d.e=0),Math.abs(d.f)<a&&(d.f=0),d},svgedit.math.hasMatrixTransform=function(a){if(!a)return!1;for(var b=a.numberOfItems;b--;){var c=a.getItem(b);if(1==c.type&&!svgedit.math.isIdentity(c.matrix))return!0}return!1},svgedit.math.transformBox=function(a,b,c,d,e){var f={x:a,y:b},g={x:a+c,y:b},h={x:a+c,y:b+d},i={x:a,y:b+d},j=svgedit.math.transformPoint;f=j(f.x,f.y,e);var k=f.x,l=f.x,m=f.y,n=f.y;return g=j(g.x,g.y,e),k=Math.min(k,g.x),l=Math.max(l,g.x),m=Math.min(m,g.y),n=Math.max(n,g.y),i=j(i.x,i.y,e),k=Math.min(k,i.x),l=Math.max(l,i.x),m=Math.min(m,i.y),n=Math.max(n,i.y),h=j(h.x,h.y,e),k=Math.min(k,h.x),l=Math.max(l,h.x),m=Math.min(m,h.y),n=Math.max(n,h.y),{tl:f,tr:g,bl:i,br:h,aabox:{x:k,y:m,width:l-k,height:n-m}}},svgedit.math.transformListToTransform=function(a,c,d){if(null==a)return b.createSVGTransformFromMatrix(b.createSVGMatrix());var c=void 0==c?0:c,d=void 0==d?a.numberOfItems-1:d;if(c=parseInt(c),d=parseInt(d),c>d){var e=d;d=c,c=e}for(var f=b.createSVGMatrix(),g=c;d>=g;++g){var h=g>=0&&g<a.numberOfItems?a.getItem(g).matrix:b.createSVGMatrix();f=svgedit.math.matrixMultiply(f,h)}return b.createSVGTransformFromMatrix(f)},svgedit.math.getMatrix=function(a){var b=svgedit.transformlist.getTransformList(a);return svgedit.math.transformListToTransform(b).matrix},svgedit.math.snapToAngle=function(a,b,c,d){var e=Math.PI/4,f=c-a,g=d-b,h=Math.atan2(g,f),i=Math.sqrt(f*f+g*g),j=Math.round(h/e)*e,k=a+i*Math.cos(j),l=b+i*Math.sin(j);return{x:k,y:l,a:j}},svgedit.math.rectsIntersect=function(a,b){return b.x<a.x+a.width&&b.x+b.width>a.x&&b.y<a.y+a.height&&b.y+b.height>a.y}}();var svgedit=svgedit||{};!function(){svgedit.units||(svgedit.units={});var a=["x","x1","cx","rx","width"],b=["y","y1","cy","ry","height"],c=$j.merge(["r","radius"],a);$j.merge(c,b);var d,e={px:1};svgedit.units.init=function(a){d=a;var b="http://www.w3.org/2000/svg",c=document.createElementNS(b,"svg");document.body.appendChild(c);var f=document.createElementNS(b,"rect");f.setAttribute("width","1em"),f.setAttribute("height","1ex"),f.setAttribute("x","1in"),c.appendChild(f);var g=f.getBBox();document.body.removeChild(c);var h=g.x;e.em=g.width,e.ex=g.height,e["in"]=h,e.cm=h/2.54,e.mm=h/25.4,e.pt=h/72,e.pc=h/6,e["%"]=0},svgedit.units.getTypeMap=function(){return e},svgedit.units.shortFloat=function(a){var b=d.getRoundDigits();return isNaN(a)?$j.isArray(a)?svgedit.units.shortFloat(a[0])+","+svgedit.units.shortFloat(a[1]):parseFloat(a).toFixed(b)-0:+(+a).toFixed(b)},svgedit.units.convertUnit=function(a,b){return b=b||d.getBaseUnit(),svgedit.units.shortFloat(a/e[b])},svgedit.units.setUnitAttr=function(a,b,c){if(!isNaN(c)){a.getAttribute(b)}a.setAttribute(b,c)};var f={line:["x1","x2","y1","y2"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],foreignObject:["x","y","width","height"],rect:["x","y","width","height"],image:["x","y","width","height"],use:["x","y","width","height"],text:["x","y"]};svgedit.units.convertAttrs=function(a){var b=a.tagName,c=d.getBaseUnit(),g=f[b];if(g)for(var h=g.length,i=0;h>i;i++){var j=g[i],k=a.getAttribute(j);k&&(isNaN(k)||a.setAttribute(j,k/e[c]+c))}},svgedit.units.convertToNum=function(c,f){if(!isNaN(f))return f-0;if("%"===f.substr(-1)){var g=f.substr(0,f.length-1)/100,h=d.getWidth(),i=d.getHeight();return a.indexOf(c)>=0?g*h:b.indexOf(c)>=0?g*i:g*Math.sqrt(h*h+i*i)/Math.sqrt(2)}var j=f.substr(-2),g=f.substr(0,f.length-2);return g*e[j]},svgedit.units.isValidUnit=function(a,b,f){var g=!1;if(c.indexOf(a)>=0)isNaN(b)?(b=b.toLowerCase(),$j.each(e,function(a){if(!g){var c=new RegExp("^-?[\\d\\.]+"+a+"$");c.test(b)&&(g=!0)}})):g=!0;else{if("id"==a){var h=!1;try{var i=d.getElement(b);h=null==i||i===f}catch(j){}return h}g=!0}return g}}();var svgedit=svgedit||{};!function(){function a(a){var b=a.getAttribute("clip-path");if(b&&""!=b){b=b.replace(/"/g,"");var c=b.substring(5,b.indexOf(")")),d=svgCanvas.getElem(c)||$j("#"+c)[0],e=d.childNodes[0].getAttribute("d");if(e)return Raphael.pathBBox(e)}if("photobox"==a.getAttribute("type")){var b=a.childNodes[0].getAttribute("clip-path");if(b&&""!=b){b=b.replace(/"/g,"");var c=b.substring(5,b.indexOf(")")),d=svgCanvas.getElem(c)||$j("#"+c)[0],e=d.childNodes[0].getAttribute("d");return Raphael.pathBBox(e)}}if(svgedit.browser.supportsHVLineContainerBBox())try{return a.getBBox()}catch(f){}var g=$j.data(a,"ref"),h=null;if(g){var i=$j(g).children().clone().attr("visibility","hidden");$j(k).append(i),h=i.filter("line, path")}else h=$j(a).find("line, path");var j=!1;if(h.length)if(h.each(function(){var a=this.getBBox();a.width&&a.height||(j=!0)}),j){var l=g?i:$j(a).children();ret=getStrokedBBox(l)}else ret=a.getBBox();else ret=a.getBBox();return g&&i.remove(),ret}svgedit.utilities||(svgedit.utilities={});var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="http://www.w3.org/2000/svg",d="http://www.w3.org/1999/xlink",e="http://www.w3.org/XML/1998/namespace",f="a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use",g=f.split(","),h=null,i=null,j=null,k=null;svgedit.utilities.init=function(a){h=a,i=a.getDOMDocument(),j=a.getDOMContainer(),k=a.getSVGRoot()},svgedit.utilities.toXml=function(a){return $j("<p/>").text(a).html()},svgedit.utilities.fromXml=function(a){return $j("<p/>").html(a).text()},svgedit.utilities.encode64=function(a){if(a=svgedit.utilities.convertToXMLReferences(a),window.btoa)return window.btoa(a);var c,d,e,f,g,h,i,j=new Array(4*Math.floor((a.length+2)/3)),k=0,l=0;do c=a.charCodeAt(k++),d=a.charCodeAt(k++),e=a.charCodeAt(k++),f=c>>2,g=(3&c)<<4|d>>4,h=(15&d)<<2|e>>6,i=63&e,isNaN(d)?h=i=64:isNaN(e)&&(i=64),j[l++]=b.charAt(f),j[l++]=b.charAt(g),j[l++]=b.charAt(h),j[l++]=b.charAt(i);while(k<a.length);return j.join("")},svgedit.utilities.decode64=function(a){if(window.atob)return window.atob(a);var c,d,e,f,g,h="",i="",j="",k=0;a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");do e=b.indexOf(a.charAt(k++)),f=b.indexOf(a.charAt(k++)),g=b.indexOf(a.charAt(k++)),j=b.indexOf(a.charAt(k++)),c=e<<2|f>>4,d=(15&f)<<4|g>>2,i=(3&g)<<6|j,h+=String.fromCharCode(c),64!=g&&(h+=String.fromCharCode(d)),64!=j&&(h+=String.fromCharCode(i)),c=d=i="",e=f=g=j="";while(k<a.length);return unescape(h)},svgedit.utilities.convertToXMLReferences=function(a){for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);128>d?b+=a[c]:d>127&&(b+="&#"+d+";")}return b},svgedit.utilities.text2xml=function(a){a.indexOf("<svg:svg")>=0&&(a=a.replace(/<(\/?)svg:/g,"<$1").replace("xmlns:svg","xmlns"));var b;try{var c=window.DOMParser?new DOMParser:new ActiveXObject("Microsoft.XMLDOM");c.async=!1}catch(d){throw new Error("XML Parser could not be instantiated")}try{b=c.loadXML?c.loadXML(a)?c:!1:c.parseFromString(a,"text/xml")}catch(d){throw new Error("Error parsing XML string")}return b},svgedit.utilities.bboxToObj=function(a){return{x:a.x,y:a.y,width:a.width,height:a.height}},svgedit.utilities.walkTree=function(a,b){if(a&&1==a.nodeType){b(a);for(var c=a.childNodes.length;c--;)svgedit.utilities.walkTree(a.childNodes.item(c),b)}},svgedit.utilities.walkTreePost=function(a,b){if(a&&1==a.nodeType){for(var c=a.childNodes.length;c--;)svgedit.utilities.walkTree(a.childNodes.item(c),b);b(a)}},svgedit.utilities.getUrlFromAttr=function(a){if(a){if(0===a.indexOf('url("'))return a.substring(5,a.indexOf('"',6));if(0===a.indexOf("url('"))return a.substring(5,a.indexOf("'",6));if(0===a.indexOf("url("))return a.substring(4,a.indexOf(")"))}return null},svgedit.utilities.getHref=function(a){return a.getAttributeNS(d,"href")},svgedit.utilities.setHref=function(a,b){a.setAttributeNS(d,"xlink:href",b)},svgedit.utilities.findDefs=function(a){var a=h.getSVGContent().documentElement,b=a.getElementsByTagNameNS(c,"defs");return b=b.length>0?b[0]:a.insertBefore(a.ownerDocument.createElementNS(c,"defs"),a.firstChild.nextSibling)},svgedit.utilities.getPathBBox=function(a){for(var b=a.pathSegList,c=b.numberOfItems,d=[[],[]],e=b.getItem(0),f=[e.x,e.y],g=0;c>g;g++){var h=b.getItem(g);if("undefined"!=typeof h.x)if(d[0].push(f[0]),d[1].push(f[1]),h.x1){for(var i=[h.x1,h.y1],j=[h.x2,h.y2],k=[h.x,h.y],l=0;2>l;l++){var m=function(a){return Math.pow(1-a,3)*f[l]+3*Math.pow(1-a,2)*a*i[l]+3*(1-a)*Math.pow(a,2)*j[l]+Math.pow(a,3)*k[l]},n=6*f[l]-12*i[l]+6*j[l],o=-3*f[l]+9*i[l]-9*j[l]+3*k[l],p=3*i[l]-3*f[l];if(0!=o){var q=Math.pow(n,2)-4*p*o;
if(!(0>q)){var r=(-n+Math.sqrt(q))/(2*o);r>0&&1>r&&d[l].push(m(r));var s=(-n-Math.sqrt(q))/(2*o);s>0&&1>s&&d[l].push(m(s))}}else{if(0==n)continue;var t=-p/n;t>0&&1>t&&d[l].push(m(t))}}f=k}else d[0].push(h.x),d[1].push(h.y)}var u=Math.min.apply(null,d[0]),v=Math.max.apply(null,d[0])-u,w=Math.min.apply(null,d[1]),x=Math.max.apply(null,d[1])-w;return{x:u,y:w,width:v,height:x}},svgedit.utilities.getObjectBbox=function(a){var b=svgedit.utilities.getBBox($j(a)[0]),c=svgCanvas.getTransformList(a),d=1,e=1;if(c&&c.numberOfItems&&c[0])for(var f=c.numberOfItems,g=0;f>g;g++)c[g]&&4!=c[g].type&&(d*=Math.abs(c[g].matrix.a),e*=Math.abs(c[g].matrix.d));else if(a.getAttribute("transform")&&""!=a.getAttribute("transform")){var h=svgedit.utilities.getMatrix(a.getAttribute("transform"));d*=Math.abs(h[0]),e*=Math.abs(h[3])}var i=new Object;return i.x=b.x,i.y=b.y,i.width=b.width*d,i.height=b.height*e,i},svgedit.utilities.getMatrix=function(a){var b="1 0 0 1 0 0",c=b.split(" "),d=0;if(a.indexOf("matrix(")>-1)for(;a.indexOf("matrix(",d)>=0;){d=a.indexOf("matrix(",d),d+=7;var e=a.substring(d,a.indexOf(")",d)),f=e.split(" ");c[0]*=f[0],c[3]*=f[3]}return c},svgedit.utilities.getBBox=function(b){var c=b||h.geSelectedElements()[0];if(1!=b.nodeType)return null;var d=null,e=c.nodeName;switch(e){case"tspan":case"text":if(""===c.textContent)c.textContent="a",d=c.getBBox(),c.textContent="";else try{d=c.getBBox()}catch(f){}break;case"path":if(svgedit.browser.supportsPathBBox())try{d=c.getBBox()}catch(f){}else d=svgedit.utilities.getPathBBox(c);break;case"g":case"a":d=a(c);break;default:if("use"===e&&(d=a(c,!0)),"use"===e){d||(d=c.getBBox());var i={};i.width=d.width,i.height=d.height,i.x=d.x+parseFloat(c.getAttribute("x")||0),i.y=d.y+parseFloat(c.getAttribute("y")||0),d=i}else if(~g.indexOf(e))try{d=c.getBBox()}catch(f){var j=$j(c).closest("foreignObject");if(j.length)try{d=j[0].getBBox()}catch(f){d=null}else d=null}}if(d)d=svgedit.utilities.bboxToObj(d);else{var k=$j(c).closest("defs");if(k.length)try{var l=c.cloneNode(!0);svgCanvas.getContentElem().appendChild(l),d=svgedit.utilities.getBBox(l),svgCanvas.getContentElem().removeChild(l)}catch(f){d=null}}return d},svgedit.utilities.getRotationAngle=function(a,b){var c=a||h.getSelectedElements()[0],d=svgedit.transformlist.getTransformList(c);if(!d)return 0;for(var e=d.numberOfItems,f=0;e>f;++f){var g=d.getItem(f);if(4==g.type)return b?g.angle*Math.PI/180:g.angle}return 0},svgedit.utilities.getElem=function(a){return $j(k).find("[id="+a+"]")[0]},svgedit.utilities.assignAttributes=function(a,b,c,f){c||(c=0);for(var g in b){var h="xml:"===g.substr(0,4)?e:"xlink:"===g.substr(0,6)?d:null;h?a.setAttributeNS(h,g,b[g]):f?svgedit.units.setUnitAttr(a,g,b[g]):a.setAttribute(g,b[g])}},svgedit.utilities.cleanupElement=function(a){var b=k.suspendRedraw(60),c={"fill-opacity":1,"stop-opacity":1,opacity:1,stroke:"none","stroke-dasharray":"none","stroke-linejoin":"miter","stroke-linecap":"butt","stroke-opacity":1,"stroke-width":1,rx:0,ry:0};for(var d in c){var e=c[d];a.getAttribute(d)==e&&a.removeAttribute(d)}k.unsuspendRedraw(b)}}();var svgedit=svgedit||{};!function(){svgedit.sanitize||(svgedit.sanitize={});var a="http://www.w3.org/1999/xlink",b="http://www.w3.org/XML/1998/namespace",c="http://www.w3.org/2000/xmlns/",d="http://svg-edit.googlecode.com",e="http://www.w3.org/1999/xhtml",f="http://www.w3.org/1998/Math/MathML",g={};g[a]="xlink",g[b]="xml",g[c]="xmlns",g[d]="se",g[e]="xhtml",g[f]="mathml";var h={};$j.each(g,function(a,b){h[b]=a});var i=",circle,clipPath,defs,desc,ellipse,g,image,line,mask,polygon,polyline,path,rect,svg,symbol,text,title,tspan,use,",j={a:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","id","mask","opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","xlink:href","xlink:title"],circle:["class","display","clip-path","clip-rule","cx","cy","fill","fill-opacity","fill-rule","filter","id","mask","opacity","r","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","lock","lockTransform","lockEdit","type"],clipPath:["class","display","clipPathUnits","id"],defs:[],style:["type"],desc:[],ellipse:["class","display","clip-path","clip-rule","cx","cy","fill","fill-opacity","fill-rule","filter","id","mask","opacity","requiredFeatures","rx","ry","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","lock","lockTransform","lockEdit","type"],feGaussianBlur:["class","color-interpolation-filters","in","id","requiredFeatures","stdDeviation"],feOffset:["class","id","dx","dy","result"],feFlood:["class","id","flood-color","result"],feComposite:["class","id","operator","in2"],feMerge:["class","id"],feMergeNode:["class","id","in","in2"],feComponentTransfer:["class","id"],feFuncR:["class","id","type","tableValues","slope","intercept","amplitude","exponent"],feFuncG:["class","id","type","tableValues","slope","intercept","amplitude","exponent"],feFuncB:["class","id","type","tableValues","slope","intercept","amplitude","exponent"],feColorMatrix:["class","id","type","values"],feConvolveMatrix:["class","id","order","kernelMatrix"],filter:["class","color-interpolation-filters","filterRes","filterUnits","height","id","primitiveUnits","requiredFeatures","width","x","xlink:href","y","type"],foreignObject:["class","font-size","height","id","opacity","requiredFeatures","style","transform","width","x","y"],g:["class","clip-path","clip-rule","id","display","fill","fill-opacity","fill-rule","filter","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","style","systemLanguage","transform","font-family","font-size","font-style","font-weight","text-anchor","lock","lockTransform","lockEdit","type","text","shapeId","shapeVal","lineHeight","clip-id","elemBBoxWidth","pathStr","label","autoWrap","wrapWidth","elemBBoxHeight","xscale","yscale","isvdp"],image:["class","display","clip-path","clip-rule","filter","height","id","mask","opacity","origHeight","origWidth","requiredFeatures","style","systemLanguage","transform","width","x","xlink:href","xlink:title","y","lock","lockTransform","lockEdit","preserveAspectRatio","output-src","colors","templateSrc","isAdminUploaded","keepinoutput","label","isvdp"],line:["class","display","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","id","marker-end","marker-mid","marker-start","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","x1","x2","y1","y2","lock","lockTransform","lockEdit"],linearGradient:["class","id","gradientTransform","gradientUnits","requiredFeatures","spreadMethod","systemLanguage","x1","x2","xlink:href","y1","y2"],marker:["id","class","markerHeight","markerUnits","markerWidth","orient","preserveAspectRatio","refX","refY","systemLanguage","viewBox"],mask:["class","height","id","maskContentUnits","maskUnits","width","x","y"],metadata:["class","id"],path:["class","display","clip-path","clip-rule","d","fill","fill-opacity","fill-rule","filter","id","marker-end","marker-mid","marker-start","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","lock","lockTransform","lockEdit","type","shapeType"],pattern:["class","height","id","patternContentUnits","patternTransform","patternUnits","requiredFeatures","style","systemLanguage","viewBox","width","x","xlink:href","y"],polygon:["class","display","clip-path","clip-rule","id","fill","fill-opacity","fill-rule","filter","id","class","marker-end","marker-mid","marker-start","mask","opacity","points","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","lock","lockTransform","lockEdit"],polyline:["class","clip-path","clip-rule","id","fill","fill-opacity","fill-rule","filter","marker-end","marker-mid","marker-start","mask","opacity","points","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","lock","lockTransform","lockEdit"],radialGradient:["class","cx","cy","fx","fy","gradientTransform","gradientUnits","id","r","requiredFeatures","spreadMethod","systemLanguage","xlink:href"],rect:["class","display","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","height","id","mask","opacity","requiredFeatures","rx","ry","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","width","x","y","lock","lockTransform","lockEdit","type"],stop:["class","id","offset","requiredFeatures","stop-color","stop-opacity","style","systemLanguage"],svg:["class","clip-path","clip-rule","filter","id","height","mask","preserveAspectRatio","requiredFeatures","style","systemLanguage","viewBox","width","x","xmlns","xmlns:se","xmlns:xlink","y"],"switch":["class","id","requiredFeatures","systemLanguage"],symbol:["class","fill","fill-opacity","fill-rule","filter","font-family","font-size","font-style","font-weight","id","opacity","preserveAspectRatio","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","viewBox"],text:["class","display","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","font-family","font-size","font-style","font-weight","id","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","text-anchor","transform","x","y","xml:space","curveVal","invert","multiLine","pathX","pathY","lock","lockTransform","lockEdit","lineHeight","dx","dy","label","isvdp"],textPath:["class","display","id","method","requiredFeatures","spacing","startOffset","style","systemLanguage","transform","xlink:href"],title:[],tspan:["class","display","clip-path","clip-rule","dx","dy","fill","fill-opacity","fill-rule","filter","font-family","font-size","font-style","font-weight","id","mask","opacity","requiredFeatures","rotate","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","text-anchor","textLength","transform","x","y"],use:["class","display","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","height","id","mask","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","transform","width","x","xlink:href","y","lock","lockTransform","lockEdit"],annotation:["encoding"],"annotation-xml":["encoding"],maction:["actiontype","other","selection"],math:["class","id","display","xmlns"],menclose:["notation"],merror:[],mfrac:["linethickness"],mi:["mathvariant"],mmultiscripts:[],mn:[],mo:["fence","lspace","maxsize","minsize","rspace","stretchy"],mover:[],mpadded:["lspace","width","height","depth","voffset"],mphantom:[],mprescripts:[],mroot:[],mrow:["xlink:href","xlink:type","xmlns:xlink"],mspace:["depth","height","width"],msqrt:[],mstyle:["displaystyle","mathbackground","mathcolor","mathvariant","scriptlevel"],msub:[],msubsup:[],msup:[],mtable:["align","columnalign","columnlines","columnspacing","displaystyle","equalcolumns","equalrows","frame","rowalign","rowlines","rowspacing","width"],mtd:["columnalign","columnspan","rowalign","rowspan"],mtext:[],mtr:["columnalign","rowalign"],munder:[],munderover:[],none:[],semantics:[]},k={};$j.each(j,function(a,b){var d={};$j.each(b,function(a,b){if(b.indexOf(":")>=0){var e=b.split(":");d[e[1]]=h[e[0]]}else d[b]="xmlns"==b?c:null}),k[a]=d});var l={};$j.each(j,function(a,b){i.indexOf(","+a+",")>=0&&(l[a]=b)}),svgedit.sanitize.getNSMap=function(){return g},svgedit.sanitize.sanitizeSvg=function(b){if(3==b.nodeType&&(b.nodeValue=b.nodeValue.replace(/^\s+|\s+$/g,""),b.nodeValue.length||b.parentNode.removeChild(b)),1==b.nodeType){var e=b.ownerDocument,f=b.parentNode;if(e&&f){var h=j[b.nodeName],i=k[b.nodeName];if(void 0!=h){for(var l=[],m=b.attributes.length;m--;){var n=b.attributes.item(m),o=n.nodeName,p=n.localName,q=n.namespaceURI;if(i.hasOwnProperty(p)&&q==i[p]&&q!=c||q==c&&g[n.nodeValue]||(0==o.indexOf("se:")&&l.push([o,n.nodeValue]),b.removeAttributeNS(q,p)),svgedit.browser.isGecko())switch(o){case"transform":case"gradientTransform":case"patternTransform":var r=n.nodeValue.replace(/(\d)-/g,"$1 -");b.setAttribute(o,r)}if("style"==o){for(var s=n.nodeValue.split(";"),t=s.length;t--;){var u=s[t].split(":");h.indexOf(u[0])>=0&&b.setAttribute(u[0],u[1])}b.removeAttribute("style")}}$j.each(l,function(a,c){b.setAttributeNS(d,c[0],c[1])});var v=svgedit.utilities.getHref(b);if(v&&["filter","linearGradient","pattern","radialGradient","textPath","use"].indexOf(b.nodeName)>=0&&"#"!=v[0]&&(svgedit.utilities.setHref(b,""),b.removeAttributeNS(a,"href")),"use"==b.nodeName&&!svgedit.utilities.getHref(b))return void f.removeChild(b);for($j.each(["clip-path","fill","filter","marker-end","marker-mid","marker-start","mask","stroke"],function(a,c){var d=b.getAttribute(c);d&&(d=svgedit.utilities.getUrlFromAttr(d),d&&"#"!==d[0]&&(b.setAttribute(c,""),b.removeAttribute(c)))}),m=b.childNodes.length;m--;)svgedit.sanitize.sanitizeSvg(b.childNodes.item(m))}else{for(var w=[];b.hasChildNodes();)w.push(f.insertBefore(b.firstChild,b));f.removeChild(b);for(var m=w.length;m--;)svgedit.sanitize.sanitizeSvg(w[m])}}}};var m=[];svgedit.sanitize.cleanNotAllowedElems=function(){m&&(m=[])},svgedit.sanitize.sanitizeSvgForImport=function(b){if(3==b.nodeType&&(b.nodeValue=b.nodeValue.replace(/^\s+|\s+$/g,""),b.nodeValue.length||b.parentNode.removeChild(b)),1==b.nodeType){var e=b.ownerDocument,f=b.parentNode;if(e&&f){var h=l[b.nodeName],i=k[b.nodeName];if(void 0!=h){for(var j=[],n=b.attributes.length;n--;){var o=b.attributes.item(n),p=o.nodeName,q=o.localName,r=o.namespaceURI;if(i.hasOwnProperty(q)&&r==i[q]&&r!=c||r==c&&g[o.nodeValue]||(0==p.indexOf("se:")&&j.push([p,o.nodeValue]),b.removeAttributeNS(r,q)),svgedit.browser.isGecko())switch(p){case"transform":case"gradientTransform":case"patternTransform":var s=o.nodeValue.replace(/(\d)-/g,"$1 -");b.setAttribute(p,s)}if("style"==p){for(var t=o.nodeValue.split(";"),u=t.length;u--;){var v=t[u].split(":");h.indexOf(v[0])>=0&&b.setAttribute(v[0],v[1])}b.removeAttribute("style")}}$j.each(j,function(a,c){b.setAttributeNS(d,c[0],c[1])});var w=svgedit.utilities.getHref(b);if(w&&["filter","linearGradient","pattern","radialGradient","textPath","use"].indexOf(b.nodeName)>=0&&"#"!=w[0]&&(svgedit.utilities.setHref(b,""),b.removeAttributeNS(a,"href")),"use"==b.nodeName&&!svgedit.utilities.getHref(b))return void f.removeChild(b);for($j.each(["clip-path","fill","filter","marker-end","marker-mid","marker-start","mask","stroke"],function(a,c){var d=b.getAttribute(c);d&&(d=svgedit.utilities.getUrlFromAttr(d),d&&"#"!==d[0]&&(b.setAttribute(c,""),b.removeAttribute(c)))}),n=b.childNodes.length;n--;)svgedit.sanitize.sanitizeSvgForImport(b.childNodes.item(n))}else{for(var x=[];b.hasChildNodes();)x.push(f.insertBefore(b.firstChild,b));m.push(b);for(var n=x.length;n--;)svgedit.sanitize.sanitizeSvgForImport(x[n])}{m.slice(0)}return m}}}}();var svgedit=svgedit||{};!function(){svgedit.select||(svgedit.select={});var a,b,c,d;d=svgedit.browser.isTouch()?10:4,svgedit.select.Selector=function(b,c){this.id=b,this.selectedElement=c,this.locked=!0,this.selectorGroup=a.createSVGElement({element:"g",attr:{id:"selectorGroup"+this.id}}),this.selectorRect=this.selectorGroup.appendChild(a.createSVGElement({element:"path",attr:{id:"selectedBox"+this.id,fill:"none",stroke:"#3399FF","stroke-width":"1","stroke-dasharray":"5,5",style:"pointer-events:none"}})),this.gripCoords={nw:null,n:null,ne:null,e:null,se:null,s:null,sw:null,w:null},this.reset(this.selectedElement)},svgedit.select.Selector.prototype.reset=function(a){this.locked=!0,this.selectedElement=a,this.resize(),this.selectorGroup.setAttribute("display","inline")},svgedit.select.Selector.prototype.updateGripCursors=function(a){var b=[],d=Math.round(a/45);0>d&&(d+=8);for(var e in c.selectorGrips)b.push(e);for(;d>0;)b.push(b.shift()),d--;var f=0;for(var e in c.selectorGrips)c.selectorGrips[e].setAttribute("style","cursor:"+b[f]+"-resize"),f++},svgedit.select.Selector.prototype.showGrips=function(a){var b=a?"inline":"none";c.selectorGripsGroup.setAttribute("display",b);var d=this.selectedElement;this.hasGrips=a,d&&a&&(this.selectorGroup.appendChild(c.selectorGripsGroup),this.updateGripCursors(svgedit.utilities.getRotationAngle(d)))},svgedit.select.Selector.prototype.resize=function(){var b=this.selectorRect,e=c,f=e.selectorGrips,g=this.selectedElement,h=g.getAttribute("stroke-width"),i=a.currentZoom(),j=1/i;"none"===g.getAttribute("stroke")||isNaN(h)||(j+=h/2);var k=g.tagName;"text"===k&&(j+=2/i);var l=svgedit.transformlist.getTransformList(g),m=svgedit.math.transformListToTransform(l).matrix;m.e*=i,m.f*=i;var n=svgedit.utilities.getBBox(g);if("g"===k&&!$j.data(g,"gsvg")){var o=a.getStrokedBBox(g.childNodes);o&&(n=o)}var p=n.x,q=n.y,r=n.width,s=n.height,n={x:p,y:q,width:r,height:s};j*=i;var t=svgedit.math.transformBox(p*i,q*i,r*i,s*i,m),u=t.aabox,v=u.x-j,w=u.y-j,x=u.width+2*j,y=u.height+2*j,z=v+x/2,A=w+y/2,B=svgedit.utilities.getRotationAngle(g);if(B){var C=a.svgRoot().createSVGTransform();C.setRotate(-B,z,A);var D=C.matrix;t.tl=svgedit.math.transformPoint(t.tl.x,t.tl.y,D),t.tr=svgedit.math.transformPoint(t.tr.x,t.tr.y,D),t.bl=svgedit.math.transformPoint(t.bl.x,t.bl.y,D),t.br=svgedit.math.transformPoint(t.br.x,t.br.y,D);var E=t.tl,F=E.x,G=E.y,H=E.x,I=E.y,J=Math.min,K=Math.max;F=J(F,J(t.tr.x,J(t.bl.x,t.br.x)))-j,G=J(G,J(t.tr.y,J(t.bl.y,t.br.y)))-j,H=K(H,K(t.tr.x,K(t.bl.x,t.br.x)))+j,I=K(I,K(t.tr.y,K(t.bl.y,t.br.y)))+j,v=F,w=G,x=H-F,y=I-G}var L=a.svgRoot().suspendRedraw(100),M="M"+v+","+w+" L"+(v+x)+","+w+" "+(v+x)+","+(w+y)+" "+v+","+(w+y)+"z";b.setAttribute("d",M);var N=B?"rotate("+[B,z,A].join(",")+")":"";this.selectorGroup.setAttribute("transform",N),this.gripCoords={nw:[v,w],ne:[v+x,w],sw:[v,w+y],se:[v+x,w+y],n:[v+x/2,w],w:[v,w+y/2],e:[v+x,w+y/2],s:[v+x/2,w+y]};for(var O in this.gripCoords){var P=this.gripCoords[O];f[O].setAttribute("cx",P[0]),f[O].setAttribute("cy",P[1])}e.rotateGripConnector.setAttribute("x1",v+x/2),e.rotateGripConnector.setAttribute("y1",w),e.rotateGripConnector.setAttribute("x2",v+x/2),e.rotateGripConnector.setAttribute("y2",w-5*d),e.rotateGrip.setAttribute("cx",v+x/2),e.rotateGrip.setAttribute("cy",w-5*d),a.svgRoot().unsuspendRedraw(L)},svgedit.select.SelectorManager=function(){this.selectorParentGroup=null,this.rubberBandBox=null,this.selectors=[],this.selectorMap={},this.selectorGrips={nw:null,n:null,ne:null,e:null,se:null,s:null,sw:null,w:null},this.selectorGripsGroup=null,this.rotateGripConnector=null,this.rotateGrip=null,this.initGroup()},svgedit.select.SelectorManager.prototype.initGroup=function(){this.selectorParentGroup&&this.selectorParentGroup.parentNode&&this.selectorParentGroup.parentNode.removeChild(this.selectorParentGroup),this.selectorParentGroup=a.createSVGElement({element:"g",attr:{id:"selectorParentGroup"}}),this.selectorGripsGroup=a.createSVGElement({element:"g",attr:{display:"none"}}),this.selectorParentGroup.appendChild(this.selectorGripsGroup),a.svgRoot().appendChild(this.selectorParentGroup),this.selectorMap={},this.selectors=[],this.rubberBandBox=null;for(var c in this.selectorGrips){var e=a.createSVGElement({element:"circle",attr:{id:"selectorGrip_resize_"+c,fill:"#56B9E9",r:d,style:"cursor:"+c+"-resize","stroke-width":2,"pointer-events":"all"}});$j.data(e,"dir",c),$j.data(e,"type","resize"),this.selectorGrips[c]=this.selectorGripsGroup.appendChild(e)}if(this.rotateGripConnector=this.selectorGripsGroup.appendChild(a.createSVGElement({element:"line",attr:{id:"selectorGrip_rotateconnector",stroke:"#56B9E9","stroke-width":"1"}})),this.rotateGrip=this.selectorGripsGroup.appendChild(a.createSVGElement({element:"circle",attr:{id:"selectorGrip_rotate",fill:"lime",r:d,stroke:"#56B9E9","stroke-width":2,style:"cursor:url("+b.imgPath+"rotate.png) 12 12, auto;"}})),$j.data(this.rotateGrip,"type","rotate"),!$j("#canvasBackground").length){var f=b.dimensions,g=b.initStroke,h=a.createSVGElement({element:"svg",attr:{id:"canvasBackground",width:f[0],height:f[1],x:0,y:0,overflow:svgedit.browser.isWebkit()?"none":"visible",style:"pointer-events:none"}}),i=a.createSVGElement({element:"rect",attr:{width:"100%",height:"100%",x:0,y:0,"stroke-width":g.width,stroke:g.color,fill:"#FFF",style:"pointer-events:none"}});h.appendChild(i),a.svgRoot().insertBefore(h,a.svgContent())}},svgedit.select.SelectorManager.prototype.requestSelector=function(a){if(null==a)return null;var b=this.selectors.length;if("object"==typeof this.selectorMap[a.id])return this.selectorMap[a.id].locked=!0,this.selectorMap[a.id];for(var c=0;b>c;++c)if(this.selectors[c]&&!this.selectors[c].locked)return this.selectors[c].locked=!0,this.selectors[c].reset(a),this.selectorMap[a.id]=this.selectors[c],this.selectors[c];return this.selectors[b]=new svgedit.select.Selector(b,a),this.selectorParentGroup.appendChild(this.selectors[b].selectorGroup),this.selectorMap[a.id]=this.selectors[b],this.selectors[b]},svgedit.select.SelectorManager.prototype.releaseSelector=function(a){if(null!=a)for(var b=this.selectors.length,c=this.selectorMap[a.id],d=0;b>d;++d)if(this.selectors[d]&&this.selectors[d]==c){0==c.locked,delete this.selectorMap[a.id],c.locked=!1,c.selectedElement=null,c.showGrips(!1);try{c.selectorGroup.setAttribute("display","none")}catch(e){}break}},svgedit.select.SelectorManager.prototype.getRubberBandBox=function(){return this.rubberBandBox||(this.rubberBandBox=this.selectorParentGroup.appendChild(a.createSVGElement({element:"rect",attr:{id:"selectorRubberBand",fill:"#56B9E9","fill-opacity":.15,stroke:"#56B9E9","stroke-width":.5,display:"none",style:"pointer-events:none"}}))),this.rubberBandBox},svgedit.select.init=function(d,e){b=d,a=e,trace("svgFactory"),trace(e),c=new svgedit.select.SelectorManager},svgedit.select.getSelectorManager=function(){return c}}();var svgedit=svgedit||{};!function(){svgedit.history||(svgedit.history={}),svgedit.history.HistoryEventTypes={BEFORE_APPLY:"before_apply",AFTER_APPLY:"after_apply",BEFORE_UNAPPLY:"before_unapply",AFTER_UNAPPLY:"after_unapply"};svgedit.history.MoveElementCommand=function(a,b,c,d){this.elem=a,this.text=d?"Move "+a.tagName+" to "+d:"Move "+a.tagName,this.oldNextSibling=b,this.oldParent=c,this.newNextSibling=a.nextSibling,this.newParent=a.parentNode},svgedit.history.MoveElementCommand.type=function(){return"svgedit.history.MoveElementCommand"},svgedit.history.MoveElementCommand.prototype.type=svgedit.history.MoveElementCommand.type,svgedit.history.MoveElementCommand.prototype.getText=function(){return this.text},svgedit.history.MoveElementCommand.prototype.apply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this),this.elem=this.newParent.insertBefore(this.elem,this.newNextSibling),a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this)},svgedit.history.MoveElementCommand.prototype.unapply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,this),this.elem=this.oldParent.insertBefore(this.elem,this.oldNextSibling),a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this)},svgedit.history.MoveElementCommand.prototype.elements=function(){return[this.elem]},svgedit.history.InsertElementCommand=function(a,b){this.elem=a,this.text=b||"Create "+a.tagName,this.parent=a.parentNode,this.nextSibling=this.elem.nextSibling},svgedit.history.InsertElementCommand.type=function(){return"svgedit.history.InsertElementCommand"},svgedit.history.InsertElementCommand.prototype.type=svgedit.history.InsertElementCommand.type,svgedit.history.InsertElementCommand.prototype.getText=function(){return this.text},svgedit.history.InsertElementCommand.prototype.apply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this),this.elem=this.parent.insertBefore(this.elem,this.nextSibling),a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this)},svgedit.history.InsertElementCommand.prototype.unapply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,this),this.parent=this.elem.parentNode,this.elem=this.elem.parentNode.removeChild(this.elem),a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this)},svgedit.history.InsertElementCommand.prototype.elements=function(){return[this.elem]},svgedit.history.RemoveElementCommand=function(a,b,c,d){this.elem=a,this.text=d||"Delete "+a.tagName,this.nextSibling=b,this.parent=c,svgedit.transformlist.removeElementFromListMap(a)},svgedit.history.RemoveElementCommand.type=function(){return"svgedit.history.RemoveElementCommand"},svgedit.history.RemoveElementCommand.prototype.type=svgedit.history.RemoveElementCommand.type,svgedit.history.RemoveElementCommand.prototype.getText=function(){return this.text},svgedit.history.RemoveElementCommand.prototype.apply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this),svgedit.transformlist.removeElementFromListMap(this.elem),this.parent=this.elem.parentNode,this.elem=this.parent.removeChild(this.elem),a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this)},svgedit.history.RemoveElementCommand.prototype.unapply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,this),svgedit.transformlist.removeElementFromListMap(this.elem),null==this.nextSibling&&window.console&&console.log("Error: reference element was lost"),this.parent.insertBefore(this.elem,this.nextSibling),a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this)},svgedit.history.RemoveElementCommand.prototype.elements=function(){return[this.elem]},svgedit.history.ChangeElementCommand=function(a,b,c){this.elem=a,this.text=c?"Change "+a.tagName+" "+c:"Change "+a.tagName,this.newValues={},this.oldValues=b;for(var d in b)this.newValues[d]="#text"==d?a.textContent:"#href"==d?svgedit.utilities.getHref(a):a.getAttribute(d)},svgedit.history.ChangeElementCommand.type=function(){return"svgedit.history.ChangeElementCommand"},svgedit.history.ChangeElementCommand.prototype.type=svgedit.history.ChangeElementCommand.type,svgedit.history.ChangeElementCommand.prototype.getText=function(){return this.text},svgedit.history.ChangeElementCommand.prototype.apply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);var b=!1;for(var c in this.newValues)this.newValues[c]?"#text"==c?this.elem.textContent=this.newValues[c]:"#href"==c?svgedit.utilities.setHref(this.elem,this.newValues[c]):this.elem.setAttribute(c,this.newValues[c]):"#text"==c?this.elem.textContent="":(this.elem.setAttribute(c,""),this.elem.removeAttribute(c)),"transform"==c&&(b=!0);if(!b){var d=svgedit.utilities.getRotationAngle(this.elem);if(d){var e=elem.getBBox(),f=e.x+e.width/2,g=e.y+e.height/2,h=["rotate(",d," ",f,",",g,")"].join("");h!=elem.getAttribute("transform")&&elem.setAttribute("transform",h)}}return a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this),!0},svgedit.history.ChangeElementCommand.prototype.unapply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,this);var b=!1;for(var c in this.oldValues)this.oldValues[c]?"#text"==c?this.elem.textContent=this.oldValues[c]:"#href"==c?svgedit.utilities.setHref(this.elem,this.oldValues[c]):this.elem.setAttribute(c,this.oldValues[c]):"#text"==c?this.elem.textContent="":this.elem.removeAttribute(c),"transform"==c&&(b=!0);if(!b){var d=svgedit.utilities.getRotationAngle(this.elem);if(d){var e=elem.getBBox(),f=e.x+e.width/2,g=e.y+e.height/2,h=["rotate(",d," ",f,",",g,")"].join("");h!=elem.getAttribute("transform")&&elem.setAttribute("transform",h)}}return svgedit.transformlist.removeElementFromListMap(this.elem),a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this),!0},svgedit.history.ChangeElementCommand.prototype.elements=function(){return[this.elem]},svgedit.history.BatchCommand=function(a){this.text=a||"Batch Command",this.stack=[]},svgedit.history.BatchCommand.type=function(){return"svgedit.history.BatchCommand"},svgedit.history.BatchCommand.prototype.type=svgedit.history.BatchCommand.type,svgedit.history.BatchCommand.prototype.getText=function(){return this.text},svgedit.history.BatchCommand.prototype.apply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);for(var b=this.stack.length,c=0;b>c;++c)this.stack[c].apply(a);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this)},svgedit.history.BatchCommand.prototype.unapply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,this);for(var b=this.stack.length-1;b>=0;b--)this.stack[b].unapply(a);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this)},svgedit.history.BatchCommand.prototype.elements=function(){for(var a=[],b=this.stack.length;b--;)for(var c=this.stack[b].elements(),d=c.length;d--;)-1==a.indexOf(c[d])&&a.push(c[d]);return a},svgedit.history.BatchCommand.prototype.addSubCommand=function(a){this.stack.push(a)},svgedit.history.BatchCommand.prototype.isEmpty=function(){return 0==this.stack.length},svgedit.history.UndoManager=function(a){this.handler_=a||null,this.undoStackPointer=0,this.undoStack=[],this.undoChangeStackPointer=-1,this.undoableChangeStack=[]},svgedit.history.UndoManager.prototype.resetUndoStack=function(){this.undoStack=[],this.undoStackPointer=0},svgedit.history.UndoManager.prototype.getUndoStackSize=function(){return this.undoStackPointer},svgedit.history.UndoManager.prototype.getRedoStackSize=function(){return this.undoStack.length-this.undoStackPointer},svgedit.history.UndoManager.prototype.getNextUndoCommandText=function(){return this.undoStackPointer>0?this.undoStack[this.undoStackPointer-1].getText():""},svgedit.history.UndoManager.prototype.getNextRedoCommandText=function(){return this.undoStackPointer<this.undoStack.length?this.undoStack[this.undoStackPointer].getText():""},svgedit.history.UndoManager.prototype.undo=function(){if(this.undoStackPointer>0){var a=this.undoStack[--this.undoStackPointer];a.unapply(this.handler_);for(var b=0;b<a.stack.length;b++)"text"==a.stack[b].stack[a.stack[b].stack.length-1].elem.tagName&&svgCanvas.setMultiTextContent(a.stack[b].stack[a.stack[b].stack.length-1].elem,svgCanvas.getMultiTextContent(a.stack[b].stack[a.stack[b].stack.length-1].elem))}},svgedit.history.UndoManager.prototype.redo=function(){if(this.undoStackPointer<this.undoStack.length&&this.undoStack.length>0){var a=this.undoStack[this.undoStackPointer++];a.apply(this.handler_);for(var b=0;b<a.stack.length;b++)"text"==a.stack[b].stack[a.stack[b].stack.length-1].elem.tagName&&svgCanvas.setMultiTextContent(a.stack[b].stack[a.stack[b].stack.length-1].elem,svgCanvas.getMultiTextContent(a.stack[b].stack[a.stack[b].stack.length-1].elem))}},svgedit.history.UndoManager.prototype.addCommandToHistory=function(a){this.undoStackPointer<this.undoStack.length&&this.undoStack.length>0&&(this.undoStack=this.undoStack.splice(0,this.undoStackPointer)),this.undoStack.push(a),this.undoStackPointer=this.undoStack.length
},svgedit.history.UndoManager.prototype.beginUndoableChange=function(a,b){for(var c=++this.undoChangeStackPointer,d=b.length,e=new Array(d),f=new Array(d);d--;){var g=b[d];null!=g&&(f[d]=g,e[d]=g.getAttribute(a))}this.undoableChangeStack[c]={attrName:a,oldValues:e,elements:f}},svgedit.history.UndoManager.prototype.finishUndoableChange=function(){for(var a=this.undoChangeStackPointer--,b=this.undoableChangeStack[a],c=b.elements.length,d=b.attrName,e=new svgedit.history.BatchCommand("Change "+d);c--;){var f=b.elements[c];if(null!=f){var g={};g[d]=b.oldValues[c],g[d]!=f.getAttribute(d)&&e.addSubCommand(new svgedit.history.ChangeElementCommand(f,g,d))}}return this.undoableChangeStack[a]=null,e}}();var svgedit=svgedit||{};!function(){svgedit.draw||(svgedit.draw={});var a="http://www.w3.org/2000/svg",b="http://svg-edit.googlecode.com",c="http://www.w3.org/2000/xmlns/",d="a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use",e=d.split(","),f={LET_DOCUMENT_DECIDE:0,ALWAYS_RANDOMIZE:1,NEVER_RANDOMIZE:2},g=f.LET_DOCUMENT_DECIDE;svgedit.draw.Layer=function(a,b){this.name_=a,this.group_=b},svgedit.draw.Layer.prototype.getName=function(){return this.name_},svgedit.draw.Layer.prototype.getGroup=function(){return this.group_},svgedit.draw.randomizeIds=function(a,b){g=0==a?f.NEVER_RANDOMIZE:f.ALWAYS_RANDOMIZE,g!=f.ALWAYS_RANDOMIZE||b.getNonce()?g==f.NEVER_RANDOMIZE&&b.getNonce()&&b.clearNonce():b.setNonce(Math.floor(100001*Math.random()))},svgedit.draw.Drawing=function(c,d){if(!c||!c.tagName||!c.namespaceURI||"svg"!=c.tagName||c.namespaceURI!=a)throw"Error: svgedit.draw.Drawing instance initialized without a <svg> element";this.svgElem_=c,this.obj_num=0,this.idPrefix=d||"svg_",this.releasedNums=[],this.all_layers=[],this.current_layer=null,this.nonce_="";var e=this.svgElem_.getAttributeNS(b,"nonce");e&&g!=f.NEVER_RANDOMIZE?this.nonce_=e:g==f.ALWAYS_RANDOMIZE&&this.setNonce(Math.floor(100001*Math.random()))},svgedit.draw.Drawing.prototype.getElem_=function(a){return this.svgElem_.querySelector?this.svgElem_.querySelector("#"+a):$j(this.svgElem_).find("[id="+a+"]")[0]},svgedit.draw.Drawing.prototype.getSvgElem=function(){return this.svgElem_},svgedit.draw.Drawing.prototype.getNonce=function(){return this.nonce_},svgedit.draw.Drawing.prototype.setNonce=function(a){this.svgElem_.setAttributeNS(c,"xmlns:se",b),this.svgElem_.setAttributeNS(b,"se:nonce",a),this.nonce_=a},svgedit.draw.Drawing.prototype.clearNonce=function(){this.nonce_=""},svgedit.draw.Drawing.prototype.getId=function(){return this.nonce_?this.idPrefix+this.nonce_+"_"+this.obj_num:this.idPrefix+this.obj_num},svgedit.draw.Drawing.prototype.getNextId=function(){var a=this.obj_num,b=!1;this.releasedNums.length>0?(this.obj_num=this.releasedNums.pop(),b=!0):this.obj_num++;for(var c=this.getId();this.getElem_(c);)b&&(this.obj_num=a,b=!1),this.obj_num++,c=this.getId();return b&&(this.obj_num=a),c},svgedit.draw.Drawing.prototype.releaseId=function(a){var b=this.idPrefix+(this.nonce_?this.nonce_+"_":"");if("string"!=typeof a||0!=a.indexOf(b))return!1;var c=parseInt(a.substr(b.length));return"number"!=typeof c||0>=c||-1!=this.releasedNums.indexOf(c)?!1:(this.releasedNums.push(c),!0)},svgedit.draw.Drawing.prototype.getNumLayers=function(){return this.all_layers.length},svgedit.draw.Drawing.prototype.hasLayer=function(a){for(var b=0;b<this.getNumLayers();b++)if(this.all_layers[b][0]==a)return!0;return!1},svgedit.draw.Drawing.prototype.getLayerName=function(a){return a>=0&&a<this.getNumLayers()?this.all_layers[a][0]:""},svgedit.draw.Drawing.prototype.getCurrentLayer=function(){return this.current_layer},svgedit.draw.Drawing.prototype.getCurrentLayerName=function(){for(var a=0;a<this.getNumLayers();++a)if(this.all_layers[a][1]==this.current_layer)return this.getLayerName(a);return""},svgedit.draw.Drawing.prototype.setCurrentLayer=function(a){for(var b=0;b<this.getNumLayers();++b)if(a==this.getLayerName(b))return this.current_layer!=this.all_layers[b][1]&&(this.current_layer.setAttribute("style","pointer-events:none"),this.current_layer=this.all_layers[b][1],this.current_layer.setAttribute("style","pointer-events:all")),!0;return!1},svgedit.draw.Drawing.prototype.deleteCurrentLayer=function(){if(this.current_layer&&this.getNumLayers()>1){var a=this.current_layer.parentNode,b=(this.current_layer.nextSibling,a.removeChild(this.current_layer));return this.identifyLayers(),b}return null},svgedit.draw.Drawing.prototype.identifyLayers=function(){this.all_layers=[];for(var b=this.svgElem_.childNodes.length,c=[],d=[],f=null,g=!1,h=0;b>h;++h){var i=this.svgElem_.childNodes.item(h);if(i&&1==i.nodeType)if("g"==i.tagName){g=!0;var j=$j("title",i).text();!j&&svgedit.browser.isOpera()&&i.querySelectorAll&&(j=$j(i.querySelectorAll("title")).text()),j?(d.push(j),this.all_layers.push([j,i]),f=i,svgedit.utilities.walkTree(i,function(a){a.setAttribute("style","pointer-events:inherit")}),f.setAttribute("style","pointer-events:none")):c.push(i)}else if(~e.indexOf(i.nodeName)){{svgedit.utilities.getBBox(i)}c.push(i)}}var k=this.svgElem_.ownerDocument;if(c.length>0||!g){for(var h=1;d.indexOf("Layer "+h)>=0;)h++;var l="Layer "+h;f=k.createElementNS(a,"g");var m=k.createElementNS(a,"title");m.textContent=l,f.appendChild(m);for(var n=0;n<c.length;++n)f.appendChild(c[n]);this.svgElem_.appendChild(f),this.all_layers.push([l,f])}svgedit.utilities.walkTree(f,function(a){a.setAttribute("style","pointer-events:inherit")}),this.current_layer=f,this.current_layer.setAttribute("style","pointer-events:all")},svgedit.draw.Drawing.prototype.createLayer=function(b){var c=this.svgElem_.ownerDocument,d=c.createElementNS(a,"g"),e=c.createElementNS(a,"title");return e.textContent=b,d.appendChild(e),this.svgElem_.appendChild(d),this.identifyLayers(),d},svgedit.draw.Drawing.prototype.getLayerVisibility=function(a){for(var b=null,c=0;c<this.getNumLayers();++c)if(this.getLayerName(c)==a){b=this.all_layers[c][1];break}return b?"none"!=b.getAttribute("display"):!1},svgedit.draw.Drawing.prototype.setLayerVisibility=function(a,b){if(typeof b!=typeof!0)return null;for(var c=null,d=0;d<this.getNumLayers();++d)if(this.getLayerName(d)==a){c=this.all_layers[d][1];break}if(!c)return null;var e=c.getAttribute("display");return e||(e="inline"),c.setAttribute("display",b?"inline":"none"),c},svgedit.draw.Drawing.prototype.getLayerOpacity=function(a){for(var b=0;b<this.getNumLayers();++b)if(this.getLayerName(b)==a){var c=this.all_layers[b][1],d=c.getAttribute("opacity");return d||(d="1.0"),parseFloat(d)}return null},svgedit.draw.Drawing.prototype.setLayerOpacity=function(a,b){if(!("number"!=typeof b||0>b||b>1))for(var c=0;c<this.getNumLayers();++c)if(this.getLayerName(c)==a){var d=this.all_layers[c][1];d.setAttribute("opacity",b);break}}}();var svgedit=svgedit||{};!function(){svgedit.path||(svgedit.path={});var a="http://www.w3.org/2000/svg",b={pathNodeTooltip:"Drag node to move it. Double-click node to change segment type",pathCtrlPtTooltip:"Drag control point to adjust curve properties"},c={2:["x","y"],4:["x","y"],6:["x","y","x1","y1","x2","y2"],8:["x","y","x1","y1"],10:["x","y","r1","r2","angle","largeArcFlag","sweepFlag"],12:["x"],14:["y"],16:["x","y","x2","y2"],18:["x","y"]},d=[],e=!0,f={};svgedit.path.setLinkControlPoints=function(a){e=a},svgedit.path.path=null;var g=null;svgedit.path.init=function(a){g=a,d=[0,"ClosePath"];var b=["Moveto","Lineto","CurvetoCubic","CurvetoQuadratic","Arc","LinetoHorizontal","LinetoVertical","CurvetoCubicSmooth","CurvetoQuadraticSmooth"];$j.each(b,function(a,b){d.push(b+"Abs"),d.push(b+"Rel")})},svgedit.path.insertItemBefore=function(a,b,c){var d=a.pathSegList;if(svgedit.browser.supportsPathInsertItemBefore())return void d.insertItemBefore(b,c);for(var e=d.numberOfItems,f=[],g=0;e>g;g++){var h=d.getItem(g);f.push(h)}d.clear();for(var g=0;e>g;g++)g==c&&d.appendItem(b),d.appendItem(f[g])},svgedit.path.ptObjToArr=function(a,b){for(var d=c[a],e=d.length,f=Array(e),g=0;e>g;g++)f[g]=b[d[g]];return f},svgedit.path.getGripPt=function(a,b){var c={x:b?b.x:a.item.x,y:b?b.y:a.item.y},d=a.path;if(d.matrix){var e=svgedit.math.transformPoint(c.x,c.y,d.matrix);c=e}return c.x*=g.getCurrentZoom(),c.y*=g.getCurrentZoom(),c},svgedit.path.getPointFromGrip=function(a,b){var c={x:a.x,y:a.y};if(b.matrix){var a=svgedit.math.transformPoint(c.x,c.y,b.imatrix);c.x=a.x,c.y=a.y}return c.x/=g.getCurrentZoom(),c.y/=g.getCurrentZoom(),c},svgedit.path.addPointGrip=function(c,d,e){var f=svgedit.path.getGripContainer(),g=svgedit.utilities.getElem("pathpointgrip_"+c);if(!g){g=document.createElementNS(a,"circle"),svgedit.utilities.assignAttributes(g,{id:"pathpointgrip_"+c,display:"none",r:4,fill:"#0FF",stroke:"#00F","stroke-width":2,cursor:"move",style:"pointer-events:all","xlink:title":b.pathNodeTooltip}),g=f.appendChild(g);var h=$j("#pathpointgrip_"+c);h.dblclick(function(){svgedit.path.path&&svgedit.path.path.setSegType()})}return d&&e&&svgedit.utilities.assignAttributes(g,{cx:d,cy:e,display:"inline"}),g},svgedit.path.getGripContainer=function(){var b=svgedit.utilities.getElem("pathpointgrip_container");if(!b){var c=svgedit.utilities.getElem("selectorParentGroup");b=c.appendChild(document.createElementNS(a,"g")),b.id="pathpointgrip_container"}return b},svgedit.path.addCtrlGrip=function(c){var d=svgedit.utilities.getElem("ctrlpointgrip_"+c);return d?d:(d=document.createElementNS(a,"circle"),svgedit.utilities.assignAttributes(d,{id:"ctrlpointgrip_"+c,display:"none",r:4,fill:"#0FF",stroke:"#55F","stroke-width":1,cursor:"move",style:"pointer-events:all","xlink:title":b.pathCtrlPtTooltip}),svgedit.path.getGripContainer().appendChild(d),d)},svgedit.path.getCtrlLine=function(b){var c=svgedit.utilities.getElem("ctrlLine_"+b);return c?c:(c=document.createElementNS(a,"line"),svgedit.utilities.assignAttributes(c,{id:"ctrlLine_"+b,stroke:"#555","stroke-width":1,style:"pointer-events:none"}),svgedit.path.getGripContainer().appendChild(c),c)},svgedit.path.getPointGrip=function(a,b){var c=a.index,d=svgedit.path.addPointGrip(c);if(b){var e=svgedit.path.getGripPt(a);svgedit.utilities.assignAttributes(d,{cx:e.x,cy:e.y,display:"inline"})}return d},svgedit.path.getControlPoints=function(a){var b=a.item,c=a.index;if(!("x1"in b&&"x2"in b))return null;for(var d={},e=(svgedit.path.getGripContainer(),svgedit.path.path.segs[c-1].item),f=[e,b],g=1;3>g;g++){var h=c+"c"+g,i=d["c"+g+"_line"]=svgedit.path.getCtrlLine(h),j=svgedit.path.getGripPt(a,{x:b["x"+g],y:b["y"+g]}),k=svgedit.path.getGripPt(a,{x:f[g-1].x,y:f[g-1].y});svgedit.utilities.assignAttributes(i,{x1:j.x,y1:j.y,x2:k.x,y2:k.y,display:"inline"}),d["c"+g+"_line"]=i,pointGrip=d["c"+g]=svgedit.path.addCtrlGrip(h),svgedit.utilities.assignAttributes(pointGrip,{cx:j.x,cy:j.y,display:"inline"}),d["c"+g]=pointGrip}return d},svgedit.path.replacePathSeg=function(a,b,c,e){var f=e||svgedit.path.path.elem,g="createSVGPathSeg"+d[a],h=f[g].apply(f,c);if(svgedit.browser.supportsPathReplaceItem())f.pathSegList.replaceItem(h,b);else{for(var i=f.pathSegList,j=i.numberOfItems,k=[],l=0;j>l;l++){var m=i.getItem(l);k.push(m)}i.clear();for(var l=0;j>l;l++)i.appendItem(l==b?h:k[l])}},svgedit.path.getSegSelector=function(b,c){var d=b.index,e=svgedit.utilities.getElem("segline_"+d);if(!e){var f=svgedit.path.getGripContainer();e=document.createElementNS(a,"path"),svgedit.utilities.assignAttributes(e,{id:"segline_"+d,display:"none",fill:"none",stroke:"#0FF","stroke-width":2,style:"pointer-events:none",d:"M0,0 0,0"}),f.appendChild(e)}if(c){var g=b.prev;if(!g)return e.setAttribute("display","none"),e;var h=svgedit.path.getGripPt(g);svgedit.path.replacePathSeg(2,0,[h.x,h.y],e);for(var i=svgedit.path.ptObjToArr(b.type,b.item,!0),j=0;j<i.length;j+=2){var h=svgedit.path.getGripPt(b,{x:i[j],y:i[j+1]});i[j]=h.x,i[j+1]=h.y}svgedit.path.replacePathSeg(b.type,1,i,e)}return e},svgedit.path.smoothControlPoints=this.smoothControlPoints=function(a,b,c){var d=a.x-c.x,e=a.y-c.y,f=b.x-c.x,h=b.y-c.y;if(!(0==d&&0==e||0==f&&0==h)){var i=Math.atan2(e,d),j=Math.atan2(h,f),k=Math.sqrt(d*d+e*e),l=Math.sqrt(f*f+h*h),m=g.getSVGRoot().createSVGPoint(),n=g.getSVGRoot().createSVGPoint();0>i&&(i+=2*Math.PI),0>j&&(j+=2*Math.PI);var o,p,q=Math.abs(i-j),r=Math.abs(Math.PI-q)/2;return i-j>0?(o=q<Math.PI?i+r:i-r,p=q<Math.PI?j-r:j+r):(o=q<Math.PI?i-r:i+r,p=q<Math.PI?j+r:j-r),m.x=k*Math.cos(o)+c.x,m.y=k*Math.sin(o)+c.y,n.x=l*Math.cos(p)+c.x,n.y=l*Math.sin(p)+c.y,[m,n]}return void 0},svgedit.path.Segment=function(a,b){this.selected=!1,this.index=a,this.item=b,this.type=b.pathSegType,this.ctrlpts=[],this.ptgrip=null,this.segsel=null},svgedit.path.Segment.prototype.showCtrlPts=function(a){for(var b in this.ctrlpts)this.ctrlpts[b].setAttribute("display",a?"inline":"none")},svgedit.path.Segment.prototype.selectCtrls=function(a){$j("#ctrlpointgrip_"+this.index+"c1, #ctrlpointgrip_"+this.index+"c2").attr("fill",a?"#0FF":"#EEE")},svgedit.path.Segment.prototype.show=function(a){this.ptgrip&&(this.ptgrip.setAttribute("display",a?"inline":"none"),this.segsel.setAttribute("display",a?"inline":"none"),this.showCtrlPts(a))},svgedit.path.Segment.prototype.select=function(a){this.ptgrip&&(this.ptgrip.setAttribute("stroke",a?"#0FF":"#00F"),this.segsel.setAttribute("display",a?"inline":"none"),this.ctrlpts&&this.selectCtrls(a),this.selected=a)},svgedit.path.Segment.prototype.addGrip=function(){this.ptgrip=svgedit.path.getPointGrip(this,!0),this.ctrlpts=svgedit.path.getControlPoints(this,!0),this.segsel=svgedit.path.getSegSelector(this,!0)},svgedit.path.Segment.prototype.update=function(a){if(this.ptgrip){var b=svgedit.path.getGripPt(this);svgedit.utilities.assignAttributes(this.ptgrip,{cx:b.x,cy:b.y}),svgedit.path.getSegSelector(this,!0),this.ctrlpts&&(a&&(this.item=svgedit.path.path.elem.pathSegList.getItem(this.index),this.type=this.item.pathSegType),svgedit.path.getControlPoints(this))}},svgedit.path.Segment.prototype.move=function(a,b){var c=this.item;if(this.ctrlpts)var d=[c.x+=a,c.y+=b,c.x1,c.y1,c.x2+=a,c.y2+=b];else var d=[c.x+=a,c.y+=b];if(svgedit.path.replacePathSeg(this.type,this.index,d),this.next&&this.next.ctrlpts){var e=this.next.item,f=[e.x,e.y,e.x1+=a,e.y1+=b,e.x2,e.y2];svgedit.path.replacePathSeg(this.next.type,this.next.index,f)}if(this.mate){var c=this.mate.item,g=[c.x+=a,c.y+=b];svgedit.path.replacePathSeg(this.mate.type,this.mate.index,g)}this.update(!0),this.next&&this.next.update(!0)},svgedit.path.Segment.prototype.setLinked=function(a){var b,c,d;if(2==a){if(c=1,b=this.next,!b)return;d=this.item}else{if(c=2,b=this.prev,!b)return;d=b.item}var e=b.item;e["x"+c]=d.x+(d.x-this.item["x"+a]),e["y"+c]=d.y+(d.y-this.item["y"+a]);var f=[e.x,e.y,e.x1,e.y1,e.x2,e.y2];svgedit.path.replacePathSeg(b.type,b.index,f),b.update(!0)},svgedit.path.Segment.prototype.moveCtrl=function(a,b,c){var d=this.item;d["x"+a]+=b,d["y"+a]+=c;var e=[d.x,d.y,d.x1,d.y1,d.x2,d.y2];svgedit.path.replacePathSeg(this.type,this.index,e),this.update(!0)},svgedit.path.Segment.prototype.setType=function(a,b){svgedit.path.replacePathSeg(a,this.index,b),this.type=a,this.item=svgedit.path.path.elem.pathSegList.getItem(this.index),this.showCtrlPts(6===a),this.ctrlpts=svgedit.path.getControlPoints(this),this.update(!0)},svgedit.path.Path=function(a){if(!a||"path"!==a.tagName)throw"svgedit.path.Path constructed without a <path> element";this.elem=a,this.segs=[],this.selected_pts=[],svgedit.path.path=this,this.init()},svgedit.path.Path.prototype.init=function(){$j(svgedit.path.getGripContainer()).find("*").attr("display","none");var a=this.elem.pathSegList,b=a.numberOfItems;this.segs=[],this.selected_pts=[],this.first_seg=null;for(var c=0;b>c;c++){var d=a.getItem(c),e=new svgedit.path.Segment(c,d);e.path=this,this.segs.push(e)}for(var f=this.segs,g=null,c=0;b>c;c++){var h=f[c],i=c+1>=b?null:f[c+1],j=0>c-1?null:f[c-1];if(2===h.type){if(j&&1!==j.type){var k=f[g];k.next=f[g+1],k.next.prev=k,k.addGrip()}g=c}else if(i&&1===i.type)h.next=f[g+1],h.next.prev=h,h.mate=f[g],h.addGrip(),null==this.first_seg&&(this.first_seg=h);else if(i)1!==h.type&&(h.addGrip(),i&&2!==i.type&&(h.next=i,h.next.prev=h));else if(1!==h.type){var k=f[g];k.next=f[g+1],k.next.prev=k,k.addGrip(),h.addGrip(),this.first_seg||(this.first_seg=f[g])}}return this},svgedit.path.Path.prototype.eachSeg=function(a){for(var b=this.segs.length,c=0;b>c;c++){var d=a.call(this.segs[c],c);if(d===!1)break}},svgedit.path.Path.prototype.addSeg=function(a){var b=this.segs[a];if(b.prev){var c,d=b.prev;switch(b.item.pathSegType){case 4:var e=(b.item.x+d.item.x)/2,f=(b.item.y+d.item.y)/2;c=this.elem.createSVGPathSegLinetoAbs(e,f);break;case 6:var g=(d.item.x+b.item.x1)/2,h=(b.item.x1+b.item.x2)/2,i=(b.item.x2+b.item.x)/2,j=(g+h)/2,k=(h+i)/2,e=(j+k)/2,l=(d.item.y+b.item.y1)/2,m=(b.item.y1+b.item.y2)/2,n=(b.item.y2+b.item.y)/2,o=(l+m)/2,p=(m+n)/2,f=(o+p)/2;c=this.elem.createSVGPathSegCurvetoCubicAbs(e,f,g,l,j,o);var q=[b.item.x,b.item.y,k,p,i,n];svgedit.path.replacePathSeg(b.type,a,q)}svgedit.path.insertItemBefore(this.elem,c,a)}},svgedit.path.Path.prototype.deleteSeg=function(a){var b=this.segs[a],c=this.elem.pathSegList;b.show(!1);var d=b.next;if(b.mate){var e=[d.item.x,d.item.y];svgedit.path.replacePathSeg(2,d.index,e),svgedit.path.replacePathSeg(4,b.index,e),c.removeItem(b.mate.index)}else if(b.prev)c.removeItem(a);else{var e=(b.item,[d.item.x,d.item.y]);svgedit.path.replacePathSeg(2,b.next.index,e),c.removeItem(a)}},svgedit.path.Path.prototype.subpathIsClosed=function(a){var b=!1;return svgedit.path.path.eachSeg(function(c){return a>=c?!0:2===this.type?!1:1===this.type?(b=!0,!1):void 0}),b},svgedit.path.Path.prototype.removePtFromSelection=function(a){var b=this.selected_pts.indexOf(a);-1!=b&&(this.segs[a].select(!1),this.selected_pts.splice(b,1))},svgedit.path.Path.prototype.clearSelection=function(){this.eachSeg(function(){this.select(!1)}),this.selected_pts=[]},svgedit.path.Path.prototype.storeD=function(){this.last_d=this.elem.getAttribute("d")},svgedit.path.Path.prototype.show=function(a){return this.eachSeg(function(){this.show(a)}),a&&this.selectPt(this.first_seg.index),this},svgedit.path.Path.prototype.movePts=function(a,b){for(var c=this.selected_pts.length;c--;){var d=this.segs[this.selected_pts[c]];d.move(a,b)}},svgedit.path.Path.prototype.moveCtrl=function(a,b){var c=this.segs[this.selected_pts[0]];c.moveCtrl(this.dragctrl,a,b),e&&c.setLinked(this.dragctrl)},svgedit.path.Path.prototype.setSegType=function(a){this.storeD();for(var b,c=this.selected_pts.length;c--;){var d=this.selected_pts[c],e=this.segs[d],f=e.prev;if(f){if(!a){b="Toggle Path Segment Type";var g=e.type;a=6==g?4:6}a-=0;var h,i=e.item.x,j=e.item.y,k=f.item.x,l=f.item.y;switch(a){case 6:if(e.olditem){var m=e.olditem;h=[i,j,m.x1,m.y1,m.x2,m.y2]}else{var n=i-k,o=j-l,p=k+n/3,q=l+o/3,r=i-n/3,s=j-o/3;h=[i,j,p,q,r,s]}break;case 4:h=[i,j],e.olditem=e.item}e.setType(a,h)}}svgedit.path.path.endChanges(b)},svgedit.path.Path.prototype.selectPt=function(a,b){this.clearSelection(),null==a&&this.eachSeg(function(b){this.prev&&(a=b)}),this.addPtsToSelection(a),b&&(this.dragctrl=b,e&&this.segs[a].setLinked(b))},svgedit.path.Path.prototype.update=function(){var a=this.elem;return svgedit.utilities.getRotationAngle(a)?(this.matrix=svgedit.math.getMatrix(a),this.imatrix=this.matrix.inverse()):(this.matrix=null,this.imatrix=null),this.eachSeg(function(b){this.item=a.pathSegList.getItem(b),this.update()}),this},svgedit.path.getPath_=function(a){var b=f[a.id];return b||(b=f[a.id]=new svgedit.path.Path(a)),b},svgedit.path.removePath_=function(a){a in f&&delete f[a]};var h=function(a,b){return dx=a-oldcx,dy=b-oldcy,r=Math.sqrt(dx*dx+dy*dy),theta=Math.atan2(dy,dx)+angle,dx=r*Math.cos(theta)+oldcx,dy=r*Math.sin(theta)+oldcy,dx-=newcx,dy-=newcy,r=Math.sqrt(dx*dx+dy*dy),theta=Math.atan2(dy,dx)-angle,{x:(r*Math.cos(theta)+newcx)/1,y:(r*Math.sin(theta)+newcy)/1}};svgedit.path.recalcRotatedPath=function(){var a=svgedit.path.path.elem,b=svgedit.utilities.getRotationAngle(a,!0);if(b){var c=svgedit.utilities.getBBox(a),d=svgedit.path.path.oldbbox,e=d.x+d.width/2,f=d.y+d.height/2,g=c.x+c.width/2,i=c.y+c.height/2,j=g-e,k=i-f,l=Math.sqrt(j*j+k*k),m=Math.atan2(k,j)+b;g=l*Math.cos(m)+e,i=l*Math.sin(m)+f;for(var n=a.pathSegList,o=n.numberOfItems;o;){o-=1;var p=n.getItem(o),q=p.pathSegType;if(1!=q){var r=h(p.x,p.y),s=[r.x,r.y];null!=p.x1&&null!=p.x2&&(c_vals1=h(p.x1,p.y1),c_vals2=h(p.x2,p.y2),s.splice(s.length,0,c_vals1.x,c_vals1.y,c_vals2.x,c_vals2.y)),svgedit.path.replacePathSeg(q,o,s)}}c=svgedit.utilities.getBBox(a);var t=svgroot.createSVGTransform(),u=svgedit.transformlist.getTransformList(a);t.setRotate(180*b/Math.PI,g,i),u.replaceItem(t,0)}},svgedit.path.clearData=function(){f={}}}();var hexcase=0;jQuery.DNBBaseObject=function(){this.photoBox="photobox"};var ProductModule=function(){function a(b){k+="<ul>";for(x in b)k+='<li value="'+b[x].id+'"><a  onclick="clickFunc('+b[x].id+'); return false;"  href="javascript:void(0); return false;">'+b[x].name+"</a>",void 0==b[x].children.length&&a(b[x].children),k+="</li>";return k+="</ul>"}function b(a){var b=new Image;b.onload=d,b.error=c,b.src=a}function c(){h++,e()}function d(a){var b,c=a.target,d=c.naturalWidth,f=c.naturalHeight;b=d/f,d>=f?(d=400,f=d/b,f>485&&(f=485,d=b*f)):(f=485,d=b*f,d>400&&(d=400,f=d/b)),h++;var g="display:Block;";h>1&&(g="display:none;"),filter="yes"==productData.multiColor||"simple"==productData.type||"onlysize"==productData.type?"":"url(#colorMat)";var i=document.createElementNS("http://www.w3.org/2000/svg","image");svgedit.utilities.assignAttributes(i,{width:d,height:f,id:"img_"+h,"xlink:href":c.src,style:"pointer-events:none;"+g,"class":"main_image",filter:filter}),$j("#productSvg").append($j(i)),e()}function e(){h>=no_of_side?(updateMaskImage(),productOverlayImageExt.updateOverlayImage&&productOverlayImageExt.updateOverlayImage(),set_config_svg(design_area_width[curSide],design_area_height[curSide],pos_x[curSide],pos_y[curSide],curSide),hideLoader(),isReady=!0):(showLoader(),b(f[h]))}var f,g=!0,h=0;$j(document).ready(function(){$j("#addproduct").click(function(){g&&(g=!1,ProductModule.getCategory())})});var i=function(){var a=document.getElementById("productmap");if(a){this.listItem=function(a){if(a.getElementsByTagName("ul").length>0){var b=a.getElementsByTagName("ul")[0];b.style.display="none";var c=document.createElement("span");c.className="collapsed",c.onclick=function(){b.style.display="none"==b.style.display?"block":"none",this.className="none"==b.style.display?"collapsed":"expanded",$j("#productmap").jScrollPane()},a.appendChild(c)}};for(var b=a.getElementsByTagName("li"),c=0;c<b.length;c++)listItem(b[c])}},k="";return{productImageLoaded:function(a,b){b=b||90,a.naturalWidth>=a.naturalHeight?($j(a).css("width",b+"px"),$j(a).css("height","auto")):($j(a).css("height",b+"px"),$j(a).css("width","auto"))},loadProduct:function(a){productid!=a&&(zoomChange("100%"),$j("#change-products-setting").hide(),"1"!=curSide?$j("#sideButton_1").trigger("mousedown"):getsvg_str(),productid=a,loadProductData())},getrelatedproduct:function(a){var b=$j("#productresult").jScrollPane(),c=b.data("jsp");if($j("#productconatiner").empty(),$j("#loaderImage").addClass("loader_pos"),showLoader(),0==a)$j("#productconatiner").html(""),$j("#loaderImage").removeClass("loader_pos"),c.reinitialise(),hideLoader();else if(cachedProducts[a]){var d=cachedProducts[a];$j("#productconatiner").html(d),c.reinitialise(),hideLoader()}else $j.ajax({type:"POST",url:relatedProductUrl,cache:!1,data:"cat_id="+a+"&form_key="+formkey+"&plateform="+postData.plateform+"&siteBaseUrl="+postData.siteBaseUrl+"&language_id="+postData.language_id,success:function(b){if(b=b.data,0==b.products.length)$j("#productconatiner").html('<span  id ="productnotfound" class="itemnotfound">'+svgEditor.uiStrings.elementLabel.productnotfound+"</span>"),cachedProducts[a]=$j("#productconatiner").html();else{var d=compileTemplate("#h_products")(b);cachedProducts[a]=d,$j("#productconatiner").html(d)}$j("#loaderImage").removeClass("loader_pos"),hideLoader(),c.reinitialise()}})},getCategory:function(){showLoader(),$j("#productconatiner").html(""),$j("#loaderImage").addClass("loader_pos"),$j.ajax({type:"POST",url:categoryUrl,data:"form_key="+formkey+"&plateform="+postData.plateform+"&siteBaseUrl="+postData.siteBaseUrl+"&language_id="+postData.language_id,cache:!1,success:function(b){var c=b.data.productCategories;$j("#product-content").html(a(c)),$j("#product-content > ul").attr("id","productmap"),$j("#product-content > ul").addClass("sitemap"),i(),clickFunc($j("#productmap li:first").attr("value")),$j("#productmap").jScrollPane(),hideLoader(),$j("#loaderImage").removeClass("loader_pos")},error:function(){$j.alert("error in loading product cateogry."),hideLoader(),$j("#loaderImage").removeClass("loader_pos")}})},createProductInfo:function(){$j("#productName").html(productData.name),$j("#productNameInfo").html(productData.name),$j("#productSku").html("<strong>"+svgEditor.uiStrings.elementLabel.productSkuCaption+" :</strong>"+productData.code),$j("#productDesc").html("<strong>"+svgEditor.uiStrings.elementLabel.productDescCaption+" :</strong>"+productData.longDesc);var a="";$j(".colorpalet").empty(),$j("#productColor").hide(),void 0!=productData.allColors.color&&($j.each(productData.allColors.color,function(b,c){a+="yes"==productData.multiColor?"<li class='multi_img'><img src='"+c.colorimage+"'/></li>":'<li style="background-color:'+c.optionName+'"></li>'}),$j("#productColor").show(),$j(".colorpalet").append(a))},createPickColorPanelIcon:function(){var a,b,c,d="",e="";productData.postData&&(a=productData.postData.colorOptionId,b=productData.postData.sizeOptionId,c=productData.postData.qty),"configurable"==productData.type?$j.each(productData.allColors.color,function(f,g){d+="yes"==productData.multiColor?'<li title="'+g.colorName+'"><svg viewBox="0 0 50 50" height="50" width="50" id="svg-doc" xmlns:xlink="http://www.w3.org/1999/xlink"><image xlink:href="'+g.colorimage+'" title="'+g.colorName+'" height="35" width="35" onclick="changemulticolor('+g.optionID+",'"+g.colorimage+"')\"/></svg></li>":'<li title="'+g.colorName+'"><svg viewBox="0 0 50 50" height="50" width="50" id="svg-doc" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><filter color-interpolation-filters="sRGB" id="ColorMatrixPicker'+g.optionID+'"><feColorMatrix values="'+getMatrix(g.optionName)+'" type="matrix"  id="feColorMatrixPicker"/></filter></defs><rect width="30px" height="30px" style="fill:'+g.optionName+';" onclick="changecolor('+g.optionID+",'"+g.optionName+"')\"></rect></svg></li>",display_prop="display:none;",val=0,e+='<ul id="colorid_'+g.optionID+'" style="'+display_prop+'" class="div-table">',$j.each(g.sizes,function(d,f){var h=0;f.optionID==b&&g.optionID==a&&(h=c),e+="<li><label>"+f.optionName+'</label></div> <div class="div-table-cell"><input name="size'+f.optionID+"_"+g.optionID+'" value="'+h+'" id="size'+f.optionID+"_"+g.optionID+'" onKeyDown="numeric_validation(event);" onKeyUp="livePrice(event);" class="size_textbox" type="text" autocomplete="off"></li>'}),e+="</ul>"}):"onlysize"==productData.type?(display_prop="display:block;",e+='<ul id="onlySize_" style="'+display_prop+'" class="div-table">',$j.each(productData.allColors.size,function(a,d){var f=0;d.optionID==b&&(f=c),e+="<li><label>"+d.optionName+'</label><input name="size'+d.optionID+'" value="'+f+'" id="size'+d.optionID+'" onKeyDown="numeric_validation(event);" onKeyUp="livePrice(event);" class="size_textbox" type="text" autocomplete="off"></li>'}),e+="</ul>"):"onlycolor"==productData.type?($j.each(productData.allColors.color,function(a,b){d+="yes"==productData.multiColor?'<li title="'+b.colorName+'"><svg viewBox="0 0 50 50" height="50" width="50" id="svg-doc" xmlns:xlink="http://www.w3.org/1999/xlink"><image xlink:href="'+b.colorimage+'" title="'+b.colorName+'" height="35" width="35" onclick="changemulticolor('+b.optionID+",'"+b.colorimage+"')\"/></svg></li>":'<li title="'+b.colorName+'"><svg viewBox="0 0 50 50" height="50" width="50" id="svg-doc" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><filter color-interpolation-filters="sRGB" id="ColorMatrixPicker'+b.optionID+'"><feColorMatrix values="'+getMatrix(b.optionName)+'" type="matrix"  id="feColorMatrixPicker"/></filter></defs><image filter="url(#ColorMatrixPicker'+b.optionID+')" xlink:href="'+productData.productImages[0]+'" title="'+b.colorName+'" height="35" width="35" onclick="changecolor('+b.optionID+",'"+b.optionName+"')\"/>	</svg></li>"}),qtyValue=1,void 0!=c&&(qtyValue=c),display_prop="display:block;",e+='<ul style="'+display_prop+'" class="div-table">',e+='<li><label>Quantity</label><input name="quantity" value="'+qtyValue+'" id="quantity" onKeyDown="numeric_validation(event);" onKeyUp="livePrice(event);" class="size_textbox" type="text" autocomplete="off"></li>',e+="</ul>"):(qtyValue=1,void 0!=c&&(qtyValue=c),display_prop="display:block;",e+='<ul style="'+display_prop+'" class="div-table">',e+='<li><label>Quantity</label><input name="quantity" value="'+qtyValue+'" id="quantity" onKeyDown="numeric_validation(event);" onKeyUp="livePrice(event);" class="size_textbox" type="text" autocomplete="off"></li>',e+="</u>"),$j("#objectinputsize").empty(),$j("#objectinputsize").append(e),$j(".pickcolor-list").empty(),$j(".pickcolor-list").css("margin-left","0px"),$j(".pickcolor-list").append(d),productColorLength=$j("#pickcolor-panel .pickcolor-list li").length;var f=48*productColorLength;if($j("#pickcolor-panel .pickcolor-list").css("width",f+"px"),"configurable"==productData.type){var g;g=void 0==productData.allColors.color[productData.postData.colorOptionId]?productData.allColors.color[Object.keys(productData.allColors.color)[0]]:productData.allColors.color[productData.postData.colorOptionId],$j("#current_product_colorid").val(g.optionID),$j("#current_product_colorhash").val(g.optionName),pageload_changecolor($j("#current_product_colorid").val(),$j("#current_product_colorhash").val(),is_multicolor)}else if("onlycolor"==productData.type){var g;g=void 0==productData.allColors.color[productData.postData.colorOptionId]?productData.allColors.color[Object.keys(productData.allColors.color)[0]]:productData.allColors.color[productData.postData.colorOptionId],$j("#current_product_colorid").val(g.optionID),$j("#current_product_colorhash").val(g.optionName),pageload_changecolor($j("#current_product_colorid").val(),$j("#current_product_colorhash").val(),is_multicolor),$j("#objectinputsize ul").show()}productColorLength=$j("#pickcolor-panel .pickcolor-list li").length;var f=48*productColorLength;$j("#pickcolor-panel .pickcolor-list").css("width",f+"px"),trace("productColorLength = "+productColorLength),$j(".scroll-area").css("height",parseFloat($j("#addart-panel").height())-62+"px"),$j("#prevColor").addClass("disabled"),$j("#nextColor").removeClass("disabled"),$j("#pickcolor-panel .gallery").css("float","left"),$j("#pickcolor-panel").show(),console.log("productColorLength="+productColorLength),0==productColorLength||1==productColorLength?$j("#pickcolor-panel").hide():6>productColorLength?($j("#prevColor").hide(),$j("#nextColor").hide(),$j("#pickcolor-panel .gallery").css("float","none")):($j("#prevColor").show(),$j("#nextColor").show())},createSidePanelIcon:function(){no_of_side=productData.noofSides,productType=productData.type,productImages=productData.productImages,sideNameAry=productData.sideLabels;var a="";for(j=0;j<no_of_side;j++){productImage=productImages[j];var b=j+1;"yes"==productData.multiColor?("configurable"==productData.type&&(productImage=void 0==productData.allColors.color[productData.postData.colorOptionId]?productData.allColors.color[Object.keys(productData.allColors.color)[0]].image[b]:productData.allColors.color[productData.postData.colorOptionId].image[b]),a+='<li><button id="sideButton_'+b+'" onmousedown="showSide(this)" ><svg viewBox="0 0 35 35" height="35" width="35" id="svg-doc" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><filter color-interpolation-filters="sRGB" id="colorMatrixIcon'+b+'"><feColorMatrix values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0" type="matrix" id="feColorMatrixIcon'+b+'"/></filter></defs><image filter="url(#colorMatrixIcon'+b+')" xlink:href="'+productImage+'" height="35" width="35"/></svg></button><label id="sideCaption'+sideNameAry[b-1]+'">'+sideNameAry[b-1]+"</label></li>"):a+='<li><button id="sideButton_'+b+'" onmousedown="showSide(this)" ><svg viewBox="0 0 35 35" height="35" width="35" id="svg-doc" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><filter color-interpolation-filters="sRGB" id="colorMatrixIcon'+b+'"><feColorMatrix values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0" type="matrix" id="feColorMatrixIcon'+b+'"/></filter></defs><image filter="url(#colorMatrixIcon'+b+')" xlink:href="'+productImage+'" height="35" width="35"/></svg></button><label id="sideCaption'+sideNameAry[b-1]+'">'+sideNameAry[b-1]+"</label></li>";
var c=document.createElementNS("http://www.w3.org/2000/svg","svg");c.width=400,c.height=400,init_data=""}$j("#productSides").empty(),$j("#productSides").append(a),$j("#productSides").css("margin-left",""),$j("#pickside-panel").show();var d=110*no_of_side+10;$j("#productSides").css("width",d),$j("#previousSide").addClass("disabled"),$j("#nextSide").removeClass("disabled"),1==no_of_side?$j("#pickside-panel").hide():5>no_of_side?($j("#previousSide").hide(),$j("#nextSide").hide(),$j("#pickside-panel .gallery").css("float","none")):($j("#previousSide").show(),$j("#nextSide").show())},getImages:function(a){showLoader(),h=0,f=a||productImages,$j("#productSvg").find("image").remove(),b(f[h])}}}(),ClipArtModule=function(){function a(b){f+="<ul>";for(x in b)f+='<li value="'+b[x].id+'"><a  onclick="loadRelatedClipArt('+b[x].id+'); return false;"  href="javascript:void(0); return false;">'+b[x].name+"</a>",void 0==b[x].children.length&&a(b[x].children),f+="</li>";return f+="</ul>"}function b(a,b){for(var c=a.cliparts,d=0;d<c.length;++d)c[d][b]=tempData.settings.currency_symbol+c[d][b];return a}function c(){$j("#clipart-content > ul").show(),$j("#clipart-content").jScrollPane()}var d=!0;$j(document).ready(function(){$j("#addartpopup").on("click",function(){d&&(d=!1,$j("#chooseartpopup").length?ClipArtModule.getCategory():$j("#choosedesignpopup").length&&$j("#choosedesignpopup").click()),svgCanvas.getSelectedElems().length&&svgCanvas.clearSelection(),$j("#navaart").show()}),$j("#chooseartpopup").on("click",function(){svgCanvas.getSelectedElems().length&&svgCanvas.clearSelection(),$j("#designartPriceCon").empty(),$j("#designartcontainer li a").removeClass("active"),$j("#designart-content").hide(),$j("#designartscroller").hide(),$j("#clipart-content").show(),$j("#clipartscroller").show(),$j("#navaart").show(),$j("#chooseartpopup").addClass("active"),$j("#choosedesignpopup").removeClass("active")})});var e=function(){var a=document.getElementById("clipmap");if(a){this.listItem=function(a){if(a.getElementsByTagName("ul").length>0){var b=a.getElementsByTagName("ul")[0];b.style.display="none";var c=document.createElement("span");c.className="collapsed",c.onclick=function(){b.style.display="none"==b.style.display?"block":"none",this.className="none"==b.style.display?"collapsed":"expanded"},a.appendChild(c)}};for(var b=a.getElementsByTagName("li"),c=0;c<b.length;c++)listItem(b[c])}},f="";return{getrelatedClipArt:function(a){var c=$j("#clipartscroller").jScrollPane(),d=c.data("jsp");if(0==a&&($j("#clipartcontainer").html(""),$j("#loaderImage").removeClass("loader_pos"),hideLoader()),cachedCliparts[a]){var e=cachedCliparts[a];$j("#clipartcontainer").html(e),d.reinitialise(),hideLoader()}else $j.ajax({type:"POST",url:relatedClipartUrl,cache:!1,data:"cat_id="+a+"&plateform="+postData.plateform+"&siteBaseUrl="+postData.siteBaseUrl+"&language_id="+postData.language_id,success:function(c){if(c=b(c.data,"clipart_price"),0==c.cliparts.length)$j("#clipartcontainer").html('<span id ="clipnotfound"  class="itemnotfound">'+svgEditor.uiStrings.notification.noDataFound+"</span>"),cachedCliparts[a]=$j("#clipartcontainer").html();else{var e=compileTemplate("#h_cliparts")(c);cachedCliparts[a]=e,$j("#clipartcontainer").html(e)}hideLoader(),$j("#loaderImage").removeClass("loader_pos"),d.reinitialise()}})},getCategory:function(){$j("#clipartconatiner").html("");var b=tempData.clipartCategories;$j("#clipart-content").html(a(b)),$j("#clipart-content > ul").attr("id","clipmap"),$j("#clipart-content > ul").addClass("sitemap"),$j("#clipart-content > ul").hide(),e(),setTimeout(c,250),loadRelatedClipArt($j("#clipmap li:first").attr("value"))}}}(),DesignArtModule=function(){function a(b){f+="<ul>";for(x in b)f+='<li value="'+b[x].id+'"><a  onclick="loadRelatedDesign('+b[x].id+'); return false;"  href="javascript:void(0); return false;">'+b[x].name+"</a>",void 0==b[x].children.length&&a(b[x].children),f+="</li>";return f+="</ul>"}function b(a,b){showLoader(),$j.ajax({type:"POST",url:relatedClipartPriceUrl,cache:!1,data:"ids="+b+"&plateform="+postData.plateform+"&siteBaseUrl="+postData.siteBaseUrl+"&language_id="+postData.language_id,success:function(b){$j("#designartPriceCon").empty(),b=tempData.settings.currency_symbol+b;var c=$j('<label id="designartPriceLbl">'+b+" </label>"),d=$j('<button id="'+svgEditor.uiStrings.elementLabel.loadDesignCaption+'" class="button" onclick="loadDesignONCanvas(\''+a+"')\"> Load Design </button>");$j("#designartPriceCon").append(c),$j("#designartPriceCon").append(d),hideLoader()},error:function(){$j("#designartPriceCon").empty();var a=$j('<label id="designartPriceLbl"> Price Not Calculated </label>');$j("#designartPriceCon").append(a),hideLoader()}})}function c(){$j("#designart-content > ul").show(),$j("#designart-content").jScrollPane()}var d=!0;$j(document).ready(function(){$j("#choosedesignpopup").on("click",function(){d&&(d=!1,DesignArtModule.getCategory()),svgCanvas.getSelectedElems().length&&svgCanvas.clearSelection(),$j("#clipart-content").hide(),$j("#clipartscroller").hide(),$j("#designart-content").show(),$j("#designartscroller").show(),$j("#navaart").show(),$j("#chooseartpopup").removeClass("active"),$j("#choosedesignpopup").addClass("active")})});var e=function(){var a=document.getElementById("designmap");if(a){this.listItem=function(a){if(a.getElementsByTagName("ul").length>0){var b=a.getElementsByTagName("ul")[0];b.style.display="none";var c=document.createElement("span");c.className="collapsed",c.onclick=function(){b.style.display="none"==b.style.display?"block":"none",this.className="none"==b.style.display?"collapsed":"expanded"},a.appendChild(c)}};for(var b=a.getElementsByTagName("li"),c=0;c<b.length;c++)listItem(b[c])}},f="";return{showDesignPrice:function(a,c){$j("#designartcontainer li a").removeClass("active"),$j(a).addClass("active");var d=[],e=base64_encode(file_get_contents(c)),f=decode64(e),g=svgedit.utilities.text2xml(f);myGlobalVar=g,$j(myGlobalVar).find("g").each(function(a,b){null!=b.getAttribute("clip-id")&&d.push(b.getAttribute("clip-id"))}),b(c,d)},getrelatedDesign:function(a){var b=$j("#designartscroller").jScrollPane(),c=b.data("jsp");if(0==a&&($j("#designartcontainer").html(""),$j("#loaderImage").removeClass("loader_pos"),hideLoader()),cacheddesigns[a]){var d=cacheddesigns[a];$j("#designartcontainer").html(d),c.reinitialise(),hideLoader()}else $j.ajax({type:"POST",url:relatedDesignartUrl,cache:!1,data:"cat_id="+a+"&plateform="+postData.plateform+"&siteBaseUrl="+postData.siteBaseUrl+"&language_id="+postData.language_id,success:function(b){if(b=b.data,0==b.designideas.length)$j("#designartcontainer").html('<span id ="designnotfound"  class="itemnotfound">'+svgEditor.uiStrings.notification.noDataFound+"</span>"),cacheddesigns[a]=$j("#designartcontainer").html();else{var d=compileTemplate("#h_designarts")(b);cacheddesigns[a]=d,$j("#designartcontainer").html(d)}hideLoader(),$j("#loaderImage").removeClass("loader_pos"),c.reinitialise()}})},getCategory:function(){$j("#designartcontainer").html("");var b=tempData.designideaCategories;$j("#designart-content").html(a(b)),$j("#designart-content > ul").attr("id","designmap"),$j("#designart-content > ul").addClass("sitemap"),e(),setTimeout(c,250),loadRelatedDesign($j("#designmap li:first").attr("value"))}}}(),TextModule=function(){function a(a){return a.childNodes.length&&a.childNodes[0].hasAttribute("stroke-dasharray")?a.childNodes[0].getAttribute("stroke-dasharray"):a.getAttribute("stroke-dasharray")?a.getAttribute("stroke-dasharray"):"none"}function b(){return svgCanvas.getStrokeWidth()}function c(a,b,c,e,f,g){for(var h=0;h<a.length;h++)for(var i=1;i<a[h].length-1;i+=2){var j=i+1,k=Math.floor(parseFloat(a[h][i]-c.x)/b.width*e),l=Math.ceil(parseFloat(a[h][j]-c.y)/b.height*e),k=d(k,l,f,g,b.height,b.width,e);a[h][i]=k.x+0,a[h][j]=k.y+0}return a}function d(a,b,c,d,e,f,g){var h={x:0,y:0};switch(h.x=f/(g-1)*a,c){case 1:h.x=f/(g-1)*a,h.y=d>=0?e/g*b*(g-d/10*a)/g+a/g*(e/2)*(d/10):e/g*b*(g-(g-a)*(Math.abs(d)/10))/g+(g-a)/g*(e/2)*(Math.abs(d)/10);break;case 2:h.x=f/(g-1)*a,h.y=-(e/2)+e/g*b,d>=0?(h.y+=e/5*Math.pow((-1+g-2*a)/g,2)*d*(b/g),h.y-=b/g*(e/40)*d):(h.y-=e/5*Math.pow((-1+g-2*a)/g,2)*Math.abs(d)*((g-b)/g),h.y-=(g-b)/g*(e/40)*d),h.y+=e/2;break;case 3:h.x=f/(g-1)*a,h.y=e/(g-1)*b,h.y=d>=0?h.y+e/5*Math.pow((-1+g-2*a)/g,2)*d:h.y-e/5*Math.pow((-1+g-2*a)/g,2)*Math.abs(d);break;case 4:h.x=f/(g-1)*a,h.y=-(e/2)+e/g*b,h.y=d>=0?g/2>a?h.y*Math.sqrt(1-(g/2-4*a)/(g/2)*(d/10)):h.y*Math.sqrt(Math.max(0,1-(g/2-4*(g-1-a))/(g/2)*(d/10))):g/2>a?h.y*Math.pow(-1+(g/2-2*a)/(g/2)*(d/10),2):h.y*Math.pow(-1+(g/2-2*(g-1-a))/(g/2)*(d/10),2);break;case 5:h.y=e/g*b,d>=0?(h.x=-(f/2)+f/g*a,h.x*=(1+(g-2*b)/g*(d/10))/2):(h.x=-(f/2)+f/g*a,h.x*=(1+(2*b-g)/g*(Math.abs(d)/10))/2),h.x+=f/2;break;case 6:h.x=f/(g-1)*a,h.y=d>=0?e/g*b*((g-d/10*a)/g)+a/g*(d/10)*e:e/g*b*(g-(g-a)*(Math.abs(d)/10))/g+(g-a)/g*e*(Math.abs(d)/10);break;case 7:h.x=f/(g-1)*a,h.y=d>=0?e/g*b*(g-d/10*a)/g:e/g*b*(g-(g-a)*(Math.abs(d)/10))/g;break;case 8:h.x=f/(g-1)*a,h.y=e/(g-1)*b,h.y=d>=0?h.y+e/15*Math.pow((-1+g-2*a)/g,3)*d:h.y-e/15*Math.pow((-1+g-2*a)/g,3)*Math.abs(d)}return h}function e(a){for(var b=1e4,c=1e4,d={x:0,y:0},e=0;e<a.length;e++)for(var f=1;f<a[e].length-1;f+=2){var g=f+1,h=parseInt(parseFloat(a[e][f])),g=parseInt(parseFloat(a[e][g]));b>h&&(b=h),c>g&&(c=g)}return d.x=b,d.y=c,d}function g(a,b,c,d,e,g,i,j,k,l,m,n){if(0!=a){o={sx:1,sy:1,w:b.width,h:b.height,x:b.x,bBox:s,yo:0};var o,p=a,q=b,r=1,s=!1,t={};0>a&&(s=!0,r=-1),a=Math.abs(a),f="";var u=c,v=c;c.length<d.length&&0==e&&(q=g,v=d);var v=h.print(0,0,v,i,j,"middle",k),w=v.getBBox(!0),x=h.print(0,0,u,i,j,"middle",k),y=x.getBBox(!0),q=getRadious(q.width,q.height,a),p=h.path(arc([w.width/2,w.y2+q],q,-90-a/2,a-90-a/2)).attr({stroke:"#0000ff"}),z=p.getTotalLength();for(t[u+i+"SP"+k]?q=t[u+i+"SP"+k]:(q=new TextMetrics(h,u,i,j,k).getMetrics(),t[u+i+"SP"+k]=q),v.remove(),x.remove(),v=Math.abs(w.width-y.width)/2,w=z/(w.width-w.x),x=0;x<u.length;x++)if(" "!=c[x]){var A=q[x].y,B=q[x].width,z=q[x].height,C=(v+q[x].x+B/2)/w,y=h.print(0,0,u[x],i,j,"middle",k).attr({fill:l,stroke:m,"stroke-width":n,"stroke-linecap":"round","stroke-linejoin":"round"}),z=h.rect(0,0,B,z),D=p.getPointAtLength(C).x,E=p.getPointAtLength(C).y*r;z.transform("T"+(D-B/2)+","+(A+E)),B=z.getBBox(!1),D=y.getBBox(!0),A=B.x-D.x,B=B.y-D.y,D=p.getPointAtLength(C),C=p.getPointAtLength(C+1),C=180*Math.atan2(C.y-D.y,C.x-D.x)/Math.PI,s&&(C=360-C),y.transform("t"+A+","+B+"r"+C+"..."),C=Raphael.transformPath(y.attr("path"),y.transform()),f+=C,y.remove(),z.remove()}return p.remove(),r=f}}var h,i=[],j=30,k=!1,l=!1;return $j(document).ready(function(){i=[{name:"none",id:0,image:"images/shape-none.jpg"},{name:"curve",id:9,image:"images/shape-curve.jpg"},{name:"arch",id:3,image:"images/shape-arch.jpg"},{name:"Bridge",id:2,image:"images/shape-bridge.jpg"},{name:"bulge",id:4,image:"images/shape-bulge.jpg"},{name:"bird's eye",id:5,image:"images/shape-bridseye.jpg"},{name:"pinch",id:1,image:"images/shape-pinch.jpg"},{name:"Cascade Down",id:6,image:"images/shape-cascadedown.jpg"},{name:"Cascade Up",id:7,image:"images/shape-cascadeup.jpg"},{name:"Wave",id:8,image:"images/shape-wave.jpg"}];$j("<div id='textCanvas' style='display:none' ></div>").appendTo($j("body"));h=Raphael("textCanvas",500,500)}),TextMetrics=function(a,b,c,d,e){var f=[];this.init=function(){for(var g=0;g<b.length;g++){var h=a.print(0,0,b.slice(0,g+1),c,d,"middle",e),i=h.getBBox(!0);h.remove();var h=a.print(0,0,b.slice(g,g+1),c,d,"middle",e),j=h.getBBox(!0);h.remove(),i.x=i.x+i.width-j.width,i.width=j.width,i.y=j.y,i.height=j.height,f.push(i)}for(h=f[0].x,g=0;g<f.length;g++)f[g].x-=h},this.getMetrics=function(){return f},this.init()},getRadious=function(a,b,c){var d=a=a/2-b/2,e=a*(2*Math.abs(c)*Math.PI/360);return 2*(d+b/2)>e&&(a=2*(d+b/2)/(2*Math.abs(c)*Math.PI/360),e=2*c*Math.PI/360*a),e>2*(d+b/2)&&(a=2*(d+b/2)/(2*Math.abs(c)*Math.PI/360)),a},arc=function(a,b,c,d){for(a[0]=parseFloat(a[0]),a[1]=parseFloat(a[1]),angle=c,coords=toCoords(a,b,angle),path="M "+coords[0]+" "+coords[1];angle<=d;)coords=toCoords(a,b,angle),path+=" L "+coords[0]+" "+coords[1],angle+=1;return path},toCoords=function(a,b,c){var d=c/180*Math.PI;return c=a[0]+Math.cos(d)*b,a=a[1]+Math.sin(d)*b,[c,a]},{addUpdateShapeText:function(d,f,m,n,o){f=$j.trim(f),showLoader();var p,q,r,s,t,u,v,w,x,y,z,A,B,C;if(d){r=d,y=r.getAttribute("text");var D=f;r.setAttribute("text",D.replace(/"/g,"&quote;").replace(/\n/g,"@##@#@")),console.log("textGroup = "),console.log(r),A=b(r),r.setAttribute("stroke-width",A),r.childNodes.length?(v=r.childNodes[0].getAttribute("stroke"),t=svgCanvas.getStrokedBBox([r]),console.log("textGroup bbox"),console.log(t),p=t.x,q=t.y,r.setAttribute("posX",p),r.setAttribute("posY",q)):(p=r.getAttribute("posX"),q=r.getAttribute("posY")),console.log("posY if elem = "+q),v&&(v=v.substring(1)),r.setAttribute("stroke",v),B=a(r),r.setAttribute("stroke-dasharray",B)}else{if("producttool"==toolType)p=design_area_width[curSide]/2,q=design_area_height[curSide]/2;else{var E=getSize();p=parseFloat(E[0])*svgedit.units.getTypeMap()[svgEditor.curConfig.baseUnit]*.5,q=parseFloat(E[1])*svgedit.units.getTypeMap()[svgEditor.curConfig.baseUnit]*.5}console.log("posY if not elem = "+q),A=1;var x=0;"nameText"==m&&(s=$j("#selectedNameFont").css("font-family"),u=$j("#fill_nameText svg rect").attr("fill"),n=$j("#name_size").val(),console.log(getObjectFromArray(i,"image",$j("#textNameShapeDD img")[0].src.split(jspath)[1])),x=parseInt(getObjectFromArray(i,"image",$j("#textNameShapeDD img")[0].src.split(jspath)[1])[0].id)),"numberText"==m&&(s=$j("#selectedNumberFont").css("font-family"),u=$j("#fill_numberText svg rect").attr("fill"),n=$j("#number_size").val(),x=parseInt(getObjectFromArray(i,"image",$j("#textNumberShapeDD img")[0].src.split(jspath)[1])[0].id)),"NaN"==x&&(alert(x),x=0),console.log("shapeId for "+m+" = "+x),console.log("shapeVal for "+m+" = "+o),o||(o=0),r=svgCanvas.addSvgElementFromJson({element:"g",attr:{id:m||svgCanvas.getNextId(),type:m,text:$j("#text").val().replace(/"/g,"&quote;").replace(/\n/g,"@##@#@"),"font-size":n||j,"font-family":s,"font-id":jsonfontList[first_font].font_id,fill:u,stroke:"none","stroke-width":1,posX:p,posY:q,"stroke-dasharray":"none","text-anchor":"middle","font-weight":"normal","font-style":"normal",lineHeight:1,shapeId:x,shapeVal:o,style:"pointer-events:inherit"}}),B="none",y=$j("#text").val()}s=r.getAttribute("font-family"),n=r.getAttribute("font-size"),u=r.getAttribute("fill"),v=r.getAttribute("stroke"),align=r.getAttribute("text-anchor");var F="normal";k&&"bold"==r.getAttribute("font-weight")?F="bold":$j("#tool_bold").removeClass("push_button_pressed"),r.setAttribute("font-weight",F);var G="normal";for(l&&"italic"==r.getAttribute("font-style")?G="italic":$j("#tool_italic").removeClass("push_button_pressed"),r.setAttribute("font-style",G),x=r.getAttribute("shapeId"),o=r.getAttribute("shapeVal"),z=parseFloat(r.getAttribute("lineHeight")),v&&"null"!=v?"none"!=v&&(v="#"+v):v="none",u.indexOf("#")>-1&&(u=u.substr(1));r.childNodes.length;)r.removeChild(r.childNodes[0]);if(""!=f){h.clear();for(var H=h.printArray(p,q,f,s,u,n,align,F,G,null,z),I=0;I<H.length;I++)w=svgCanvas.addSvgElementFromJson({element:"path",attr:{id:svgCanvas.getNextId(),fill:"#"+u,stroke:"none","stroke-width":A,"stroke-dasharray":B,d:H[I].node.getAttribute("d"),transform:H[I].node.getAttribute("transform"),style:"pointer-events:inherit"}}),r.appendChild(w);if(1==H.length)if(x>0&&9>x){var J=H[0].attrs.path,K=H[0].getBBox(),L=e(H[0].attrs.path);w.setAttribute("d",c(J,K,L,1e5,parseInt(x),parseFloat(o)).toString())}else if(9==x){var K=H[0].getBBox();0==o&&(o=1),w.setAttribute("d",g(o,K,f,y,!0,K,s,n,0,u,"none",0))}if(C&&svgCanvas.setRotationAngle(C,!0,r),svgCanvas.getPrivateMethods().extensions.undoRedo&&svgCanvas.getPrivateMethods().extensions.undoRedo.isAddToStack(!1),t){var M=svgCanvas.getStrokedBBox([r]);svgCanvas.moveSelectedElements((t.x+t.width/2-(M.x+M.width/2))*svgCanvas.getZoom(),(t.y+t.height/2-(M.y+M.height/2))*svgCanvas.getZoom(),!1,[r])}else if(svgCanvas.selectOnly([r],!1),$j(".align_icons").hide(),svgCanvas.alignSelectedElements("c","page"),d){var M=svgCanvas.getStrokedBBox([r]);svgCanvas.moveSelectedElements(0,(q-M.y)*svgCanvas.getZoom(),!1,[r])}else svgCanvas.alignSelectedElements("m","page");svgCanvas.getPrivateMethods().extensions.undoRedo&&svgCanvas.getPrivateMethods().extensions.undoRedo.isAddToStack(!0)}return hideLoader(),r}}}();!function(a,b){"object"==typeof exports&&"object"==typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):"object"==typeof exports?exports.Handlebars=b():a.Handlebars=b()}(this,function(){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}([function(a,b,c){"use strict";function d(){var a=r();return a.compile=function(b,c){return k.compile(b,c,a)},a.precompile=function(b,c){return k.precompile(b,c,a)},a.AST=i["default"],a.Compiler=k.Compiler,a.JavaScriptCompiler=m["default"],a.Parser=j.parser,a.parse=j.parse,a}var e=c(8)["default"];b.__esModule=!0;var f=c(1),g=e(f),h=c(2),i=e(h),j=c(3),k=c(4),l=c(5),m=e(l),n=c(6),o=e(n),p=c(7),q=e(p),r=g["default"].create,s=d();s.create=d,q["default"](s),s.Visitor=o["default"],s["default"]=s,b["default"]=s,a.exports=b["default"]},function(a,b,c){"use strict";function d(){var a=new h.HandlebarsEnvironment;return n.extend(a,h),a.SafeString=j["default"],a.Exception=l["default"],a.Utils=n,a.escapeExpression=n.escapeExpression,a.VM=p,a.template=function(b){return p.template(b,a)},a}var e=c(9)["default"],f=c(8)["default"];b.__esModule=!0;var g=c(10),h=e(g),i=c(11),j=f(i),k=c(12),l=f(k),m=c(13),n=e(m),o=c(14),p=e(o),q=c(7),r=f(q),s=d();s.create=d,r["default"](s),s["default"]=s,b["default"]=s,a.exports=b["default"]},function(a,b){"use strict";b.__esModule=!0;var c={Program:function(a,b,c,d){this.loc=d,this.type="Program",this.body=a,this.blockParams=b,this.strip=c},MustacheStatement:function(a,b,c,d,e,f){this.loc=f,this.type="MustacheStatement",this.path=a,this.params=b||[],this.hash=c,this.escaped=d,this.strip=e},BlockStatement:function(a,b,c,d,e,f,g,h,i){this.loc=i,this.type="BlockStatement",this.path=a,this.params=b||[],this.hash=c,this.program=d,this.inverse=e,this.openStrip=f,this.inverseStrip=g,this.closeStrip=h},PartialStatement:function(a,b,c,d,e){this.loc=e,this.type="PartialStatement",this.name=a,this.params=b||[],this.hash=c,this.indent="",this.strip=d},ContentStatement:function(a,b){this.loc=b,this.type="ContentStatement",this.original=this.value=a},CommentStatement:function(a,b,c){this.loc=c,this.type="CommentStatement",this.value=a,this.strip=b},SubExpression:function(a,b,c,d){this.loc=d,this.type="SubExpression",this.path=a,this.params=b||[],this.hash=c},PathExpression:function(a,b,c,d,e){this.loc=e,this.type="PathExpression",this.data=a,this.original=d,this.parts=c,this.depth=b},StringLiteral:function(a,b){this.loc=b,this.type="StringLiteral",this.original=this.value=a},NumberLiteral:function(a,b){this.loc=b,this.type="NumberLiteral",this.original=this.value=Number(a)},BooleanLiteral:function(a,b){this.loc=b,this.type="BooleanLiteral",this.original=this.value="true"===a},UndefinedLiteral:function(a){this.loc=a,this.type="UndefinedLiteral",this.original=this.value=void 0},NullLiteral:function(a){this.loc=a,this.type="NullLiteral",this.original=this.value=null},Hash:function(a,b){this.loc=b,this.type="Hash",this.pairs=a},HashPair:function(a,b,c){this.loc=c,this.type="HashPair",this.key=a,this.value=b},helpers:{helperExpression:function(a){return!("SubExpression"!==a.type&&!a.params.length&&!a.hash)},scopedId:function(a){return/^\.|this\b/.test(a.original)},simpleId:function(a){return 1===a.parts.length&&!c.helpers.scopedId(a)&&!a.depth}}};b["default"]=c,a.exports=b["default"]},function(a,b,c){"use strict";function d(a,b){if("Program"===a.type)return a;h["default"].yy=p,p.locInfo=function(a){return new p.SourceLocation(b&&b.srcName,a)};var c=new l["default"];return c.accept(h["default"].parse(a))}var e=c(8)["default"],f=c(9)["default"];b.__esModule=!0,b.parse=d;var g=c(15),h=e(g),i=c(2),j=e(i),k=c(16),l=e(k),m=c(17),n=f(m),o=c(13);b.parser=h["default"];var p={};o.extend(p,n,j["default"])},function(a,b,c){"use strict";function d(){}function e(a,b,c){if(null==a||"string"!=typeof a&&"Program"!==a.type)throw new k["default"]("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+a);b=b||{},"data"in b||(b.data=!0),b.compat&&(b.useDepths=!0);var d=c.parse(a,b),e=(new c.Compiler).compile(d,b);return(new c.JavaScriptCompiler).compile(e,b)}function f(a,b,c){function d(){var b=c.parse(a,f),d=(new c.Compiler).compile(b,f),e=(new c.JavaScriptCompiler).compile(d,f,void 0,!0);return c.template(e)}function e(a,b){return g||(g=d()),g.call(this,a,b)}var f=void 0===arguments[1]?{}:arguments[1];if(null==a||"string"!=typeof a&&"Program"!==a.type)throw new k["default"]("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+a);"data"in f||(f.data=!0),f.compat&&(f.useDepths=!0);var g=void 0;return e._setup=function(a){return g||(g=d()),g._setup(a)},e._child=function(a,b,c,e){return g||(g=d()),g._child(a,b,c,e)},e}function g(a,b){if(a===b)return!0;if(l.isArray(a)&&l.isArray(b)&&a.length===b.length){for(var c=0;c<a.length;c++)if(!g(a[c],b[c]))return!1;return!0}}function h(a){if(!a.path.parts){var b=a.path;a.path=new n["default"].PathExpression(!1,0,[b.original+""],b.original+"",b.loc)}}var i=c(8)["default"];b.__esModule=!0,b.Compiler=d,b.precompile=e,b.compile=f;var j=c(12),k=i(j),l=c(13),m=c(2),n=i(m),o=[].slice;d.prototype={compiler:d,equals:function(a){var b=this.opcodes.length;if(a.opcodes.length!==b)return!1;for(var c=0;b>c;c++){var d=this.opcodes[c],e=a.opcodes[c];if(d.opcode!==e.opcode||!g(d.args,e.args))return!1}b=this.children.length;for(var c=0;b>c;c++)if(!this.children[c].equals(a.children[c]))return!1;return!0},guid:0,compile:function(a,b){this.sourceNode=[],this.opcodes=[],this.children=[],this.options=b,this.stringParams=b.stringParams,this.trackIds=b.trackIds,b.blockParams=b.blockParams||[];var c=b.knownHelpers;if(b.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0,lookup:!0},c)for(var d in c)d in c&&(b.knownHelpers[d]=c[d]);return this.accept(a)},compileProgram:function(a){var b=new this.compiler,c=b.compile(a,this.options),d=this.guid++;return this.usePartial=this.usePartial||c.usePartial,this.children[d]=c,this.useDepths=this.useDepths||c.useDepths,d},accept:function(a){this.sourceNode.unshift(a);var b=this[a.type](a);return this.sourceNode.shift(),b},Program:function(a){this.options.blockParams.unshift(a.blockParams);for(var b=a.body,c=b.length,d=0;c>d;d++)this.accept(b[d]);return this.options.blockParams.shift(),this.isSimple=1===c,this.blockParams=a.blockParams?a.blockParams.length:0,this},BlockStatement:function(a){h(a);var b=a.program,c=a.inverse;b=b&&this.compileProgram(b),c=c&&this.compileProgram(c);var d=this.classifySexpr(a);"helper"===d?this.helperSexpr(a,b,c):"simple"===d?(this.simpleSexpr(a),this.opcode("pushProgram",b),this.opcode("pushProgram",c),this.opcode("emptyHash"),this.opcode("blockValue",a.path.original)):(this.ambiguousSexpr(a,b,c),this.opcode("pushProgram",b),this.opcode("pushProgram",c),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},PartialStatement:function(a){this.usePartial=!0;var b=a.params;if(b.length>1)throw new k["default"]("Unsupported number of partial arguments: "+b.length,a);b.length||b.push({type:"PathExpression",parts:[],depth:0});var c=a.name.original,d="SubExpression"===a.name.type;d&&this.accept(a.name),this.setupFullMustacheParams(a,void 0,void 0,!0);var e=a.indent||"";this.options.preventIndent&&e&&(this.opcode("appendContent",e),e=""),this.opcode("invokePartial",d,c,e),this.opcode("append")},MustacheStatement:function(a){this.SubExpression(a),this.opcode(a.escaped&&!this.options.noEscape?"appendEscaped":"append")},ContentStatement:function(a){a.value&&this.opcode("appendContent",a.value)},CommentStatement:function(){},SubExpression:function(a){h(a);var b=this.classifySexpr(a);"simple"===b?this.simpleSexpr(a):"helper"===b?this.helperSexpr(a):this.ambiguousSexpr(a)},ambiguousSexpr:function(a,b,c){var d=a.path,e=d.parts[0],f=null!=b||null!=c;this.opcode("getContext",d.depth),this.opcode("pushProgram",b),this.opcode("pushProgram",c),this.accept(d),this.opcode("invokeAmbiguous",e,f)},simpleSexpr:function(a){this.accept(a.path),this.opcode("resolvePossibleLambda")},helperSexpr:function(a,b,c){var d=this.setupFullMustacheParams(a,b,c),e=a.path,f=e.parts[0];if(this.options.knownHelpers[f])this.opcode("invokeKnownHelper",d.length,f);else{if(this.options.knownHelpersOnly)throw new k["default"]("You specified knownHelpersOnly, but used the unknown helper "+f,a);e.falsy=!0,this.accept(e),this.opcode("invokeHelper",d.length,e.original,n["default"].helpers.simpleId(e))}},PathExpression:function(a){this.addDepth(a.depth),this.opcode("getContext",a.depth);var b=a.parts[0],c=n["default"].helpers.scopedId(a),d=!a.depth&&!c&&this.blockParamIndex(b);d?this.opcode("lookupBlockParam",d,a.parts):b?a.data?(this.options.data=!0,this.opcode("lookupData",a.depth,a.parts)):this.opcode("lookupOnContext",a.parts,a.falsy,c):this.opcode("pushContext")},StringLiteral:function(a){this.opcode("pushString",a.value)},NumberLiteral:function(a){this.opcode("pushLiteral",a.value)},BooleanLiteral:function(a){this.opcode("pushLiteral",a.value)},UndefinedLiteral:function(){this.opcode("pushLiteral","undefined")},NullLiteral:function(){this.opcode("pushLiteral","null")},Hash:function(a){var b=a.pairs,c=0,d=b.length;for(this.opcode("pushHash");d>c;c++)this.pushParam(b[c].value);for(;c--;)this.opcode("assignToHash",b[c].key);this.opcode("popHash")},opcode:function(a){this.opcodes.push({opcode:a,args:o.call(arguments,1),loc:this.sourceNode[0].loc})},addDepth:function(a){a&&(this.useDepths=!0)},classifySexpr:function(a){var b=n["default"].helpers.simpleId(a.path),c=b&&!!this.blockParamIndex(a.path.parts[0]),d=!c&&n["default"].helpers.helperExpression(a),e=!c&&(d||b);if(e&&!d){var f=a.path.parts[0],g=this.options;g.knownHelpers[f]?d=!0:g.knownHelpersOnly&&(e=!1)}return d?"helper":e?"ambiguous":"simple"},pushParams:function(a){for(var b=0,c=a.length;c>b;b++)this.pushParam(a[b])},pushParam:function(a){var b=null!=a.value?a.value:a.original||"";if(this.stringParams)b.replace&&(b=b.replace(/^(\.?\.\/)*/g,"").replace(/\//g,".")),a.depth&&this.addDepth(a.depth),this.opcode("getContext",a.depth||0),this.opcode("pushStringParam",b,a.type),"SubExpression"===a.type&&this.accept(a);else{if(this.trackIds){var c=void 0;if(!a.parts||n["default"].helpers.scopedId(a)||a.depth||(c=this.blockParamIndex(a.parts[0])),c){var d=a.parts.slice(1).join(".");this.opcode("pushId","BlockParam",c,d)}else b=a.original||b,b.replace&&(b=b.replace(/^\.\//g,"").replace(/^\.$/g,"")),this.opcode("pushId",a.type,b)}this.accept(a)}},setupFullMustacheParams:function(a,b,c,d){var e=a.params;return this.pushParams(e),this.opcode("pushProgram",b),this.opcode("pushProgram",c),a.hash?this.accept(a.hash):this.opcode("emptyHash",d),e},blockParamIndex:function(a){for(var b=0,c=this.options.blockParams.length;c>b;b++){var d=this.options.blockParams[b],e=d&&l.indexOf(d,a);if(d&&e>=0)return[b,e]}}}},function(a,b,c){"use strict";function d(a){this.value=a}function e(){}function f(a,b,c,d){var e=b.popStack(),f=0,g=c.length;for(a&&g--;g>f;f++)e=b.nameLookup(e,c[f],d);return a?[b.aliasable("this.strict"),"(",e,", ",b.quotedString(c[f]),")"]:e}var g=c(8)["default"];b.__esModule=!0;var h=c(10),i=c(12),j=g(i),k=c(13),l=c(18),m=g(l);e.prototype={nameLookup:function(a,b){return e.isValidJavaScriptVariableName(b)?[a,".",b]:[a,"['",b,"']"]},depthedLookup:function(a){return[this.aliasable("this.lookup"),'(depths, "',a,'")']},compilerInfo:function(){var a=h.COMPILER_REVISION,b=h.REVISION_CHANGES[a];return[a,b]},appendToBuffer:function(a,b,c){return k.isArray(a)||(a=[a]),a=this.source.wrap(a,b),this.environment.isSimple?["return ",a,";"]:c?["buffer += ",a,";"]:(a.appendToBuffer=!0,a)},initializeBuffer:function(){return this.quotedString("")},compile:function(a,b,c,d){this.environment=a,this.options=b,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!d,this.name=this.environment.name,this.isChild=!!c,this.context=c||{programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.blockParams=[],this.compileChildren(a,b),this.useDepths=this.useDepths||a.useDepths||this.options.compat,this.useBlockParams=this.useBlockParams||a.useBlockParams;var e=a.opcodes,f=void 0,g=void 0,h=void 0,i=void 0;for(h=0,i=e.length;i>h;h++)f=e[h],this.source.currentLocation=f.loc,g=g||f.loc,this[f.opcode].apply(this,f.args);if(this.source.currentLocation=g,this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new j["default"]("Compile completed with content left on stack");var k=this.createFunctionContext(d);if(this.isChild)return k;var l={compiler:this.compilerInfo(),main:k},m=this.context.programs;for(h=0,i=m.length;i>h;h++)m[h]&&(l[h]=m[h]);return this.environment.usePartial&&(l.usePartial=!0),this.options.data&&(l.useData=!0),this.useDepths&&(l.useDepths=!0),this.useBlockParams&&(l.useBlockParams=!0),this.options.compat&&(l.compat=!0),d?l.compilerOptions=this.options:(l.compiler=JSON.stringify(l.compiler),this.source.currentLocation={start:{line:1,column:0}},l=this.objectLiteral(l),b.srcName?(l=l.toStringWithSourceMap({file:b.destName}),l.map=l.map&&l.map.toString()):l=l.toString()),l},preamble:function(){this.lastContext=0,this.source=new m["default"](this.options.srcName)},createFunctionContext:function(a){var b="",c=this.stackVars.concat(this.registers.list);c.length>0&&(b+=", "+c.join(", "));var d=0;for(var e in this.aliases){var f=this.aliases[e];this.aliases.hasOwnProperty(e)&&f.children&&f.referenceCount>1&&(b+=", alias"+ ++d+"="+e,f.children[0]="alias"+d)}var g=["depth0","helpers","partials","data"];(this.useBlockParams||this.useDepths)&&g.push("blockParams"),this.useDepths&&g.push("depths");var h=this.mergeSource(b);return a?(g.push(h),Function.apply(this,g)):this.source.wrap(["function(",g.join(","),") {\n  ",h,"}"])},mergeSource:function(a){var b=this.environment.isSimple,c=!this.forceBuffer,d=void 0,e=void 0,f=void 0,g=void 0;return this.source.each(function(a){a.appendToBuffer?(f?a.prepend("  + "):f=a,g=a):(f&&(e?f.prepend("buffer += "):d=!0,g.add(";"),f=g=void 0),e=!0,b||(c=!1))}),c?f?(f.prepend("return "),g.add(";")):e||this.source.push('return "";'):(a+=", buffer = "+(d?"":this.initializeBuffer()),f?(f.prepend("return buffer + "),g.add(";")):this.source.push("return buffer;")),a&&this.source.prepend("var "+a.substring(2)+(d?"":";\n")),this.source.merge()},blockValue:function(a){var b=this.aliasable("helpers.blockHelperMissing"),c=[this.contextName(0)];this.setupHelperArgs(a,0,c);var d=this.popStack();c.splice(1,0,d),this.push(this.source.functionCall(b,"call",c))},ambiguousBlockValue:function(){var a=this.aliasable("helpers.blockHelperMissing"),b=[this.contextName(0)];this.setupHelperArgs("",0,b,!0),this.flushInline();var c=this.topStack();b.splice(1,0,c),this.pushSource(["if (!",this.lastHelper,") { ",c," = ",this.source.functionCall(a,"call",b),"}"])},appendContent:function(a){this.pendingContent?a=this.pendingContent+a:this.pendingLocation=this.source.currentLocation,this.pendingContent=a},append:function(){if(this.isInline())this.replaceStack(function(a){return[" != null ? ",a,' : ""']}),this.pushSource(this.appendToBuffer(this.popStack()));else{var a=this.popStack();this.pushSource(["if (",a," != null) { ",this.appendToBuffer(a,void 0,!0)," }"]),this.environment.isSimple&&this.pushSource(["else { ",this.appendToBuffer("''",void 0,!0)," }"])
}},appendEscaped:function(){this.pushSource(this.appendToBuffer([this.aliasable("this.escapeExpression"),"(",this.popStack(),")"]))},getContext:function(a){this.lastContext=a},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(a,b,c){var d=0;c||!this.options.compat||this.lastContext?this.pushContext():this.push(this.depthedLookup(a[d++])),this.resolvePath("context",a,d,b)},lookupBlockParam:function(a,b){this.useBlockParams=!0,this.push(["blockParams[",a[0],"][",a[1],"]"]),this.resolvePath("context",b,1)},lookupData:function(a,b){this.pushStackLiteral(a?"this.data(data, "+a+")":"data"),this.resolvePath("data",b,0,!0)},resolvePath:function(a,b,c,d){var e=this;if(this.options.strict||this.options.assumeObjects)return void this.push(f(this.options.strict,this,b,a));for(var g=b.length;g>c;c++)this.replaceStack(function(f){var g=e.nameLookup(f,b[c],a);return d?[" && ",g]:[" != null ? ",g," : ",f]})},resolvePossibleLambda:function(){this.push([this.aliasable("this.lambda"),"(",this.popStack(),", ",this.contextName(0),")"])},pushStringParam:function(a,b){this.pushContext(),this.pushString(b),"SubExpression"!==b&&("string"==typeof a?this.pushString(a):this.pushStackLiteral(a))},emptyHash:function(a){this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}")),this.pushStackLiteral(a?"undefined":"{}")},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:[],types:[],contexts:[],ids:[]}},popHash:function(){var a=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push(this.objectLiteral(a.ids)),this.stringParams&&(this.push(this.objectLiteral(a.contexts)),this.push(this.objectLiteral(a.types))),this.push(this.objectLiteral(a.values))},pushString:function(a){this.pushStackLiteral(this.quotedString(a))},pushLiteral:function(a){this.pushStackLiteral(a)},pushProgram:function(a){this.pushStackLiteral(null!=a?this.programExpression(a):null)},invokeHelper:function(a,b,c){var d=this.popStack(),e=this.setupHelper(a,b),f=c?[e.name," || "]:"",g=["("].concat(f,d);this.options.strict||g.push(" || ",this.aliasable("helpers.helperMissing")),g.push(")"),this.push(this.source.functionCall(g,"call",e.callParams))},invokeKnownHelper:function(a,b){var c=this.setupHelper(a,b);this.push(this.source.functionCall(c.name,"call",c.callParams))},invokeAmbiguous:function(a,b){this.useRegister("helper");var c=this.popStack();this.emptyHash();var d=this.setupHelper(0,a,b),e=this.lastHelper=this.nameLookup("helpers",a,"helper"),f=["(","(helper = ",e," || ",c,")"];this.options.strict||(f[0]="(helper = ",f.push(" != null ? helper : ",this.aliasable("helpers.helperMissing"))),this.push(["(",f,d.paramsInit?["),(",d.paramsInit]:[],"),","(typeof helper === ",this.aliasable('"function"')," ? ",this.source.functionCall("helper","call",d.callParams)," : helper))"])},invokePartial:function(a,b,c){var d=[],e=this.setupParams(b,1,d,!1);a&&(b=this.popStack(),delete e.name),c&&(e.indent=JSON.stringify(c)),e.helpers="helpers",e.partials="partials",d.unshift(a?b:this.nameLookup("partials",b,"partial")),this.options.compat&&(e.depths="depths"),e=this.objectLiteral(e),d.push(e),this.push(this.source.functionCall("this.invokePartial","",d))},assignToHash:function(a){var b=this.popStack(),c=void 0,d=void 0,e=void 0;this.trackIds&&(e=this.popStack()),this.stringParams&&(d=this.popStack(),c=this.popStack());var f=this.hash;c&&(f.contexts[a]=c),d&&(f.types[a]=d),e&&(f.ids[a]=e),f.values[a]=b},pushId:function(a,b,c){"BlockParam"===a?this.pushStackLiteral("blockParams["+b[0]+"].path["+b[1]+"]"+(c?" + "+JSON.stringify("."+c):"")):"PathExpression"===a?this.pushString(b):this.pushStackLiteral("SubExpression"===a?"true":"null")},compiler:e,compileChildren:function(a,b){for(var c=a.children,d=void 0,e=void 0,f=0,g=c.length;g>f;f++){d=c[f],e=new this.compiler;var h=this.matchExistingProgram(d);null==h?(this.context.programs.push(""),h=this.context.programs.length,d.index=h,d.name="program"+h,this.context.programs[h]=e.compile(d,b,this.context,!this.precompile),this.context.environments[h]=d,this.useDepths=this.useDepths||e.useDepths,this.useBlockParams=this.useBlockParams||e.useBlockParams):(d.index=h,d.name="program"+h,this.useDepths=this.useDepths||d.useDepths,this.useBlockParams=this.useBlockParams||d.useBlockParams)}},matchExistingProgram:function(a){for(var b=0,c=this.context.environments.length;c>b;b++){var d=this.context.environments[b];if(d&&d.equals(a))return b}},programExpression:function(a){var b=this.environment.children[a],c=[b.index,"data",b.blockParams];return(this.useBlockParams||this.useDepths)&&c.push("blockParams"),this.useDepths&&c.push("depths"),"this.program("+c.join(", ")+")"},useRegister:function(a){this.registers[a]||(this.registers[a]=!0,this.registers.list.push(a))},push:function(a){return a instanceof d||(a=this.source.wrap(a)),this.inlineStack.push(a),a},pushStackLiteral:function(a){this.push(new d(a))},pushSource:function(a){this.pendingContent&&(this.source.push(this.appendToBuffer(this.source.quotedString(this.pendingContent),this.pendingLocation)),this.pendingContent=void 0),a&&this.source.push(a)},replaceStack:function(a){var b=["("],c=void 0,e=void 0,f=void 0;if(!this.isInline())throw new j["default"]("replaceStack on non-inline");var g=this.popStack(!0);if(g instanceof d)c=[g.value],b=["(",c],f=!0;else{e=!0;var h=this.incrStack();b=["((",this.push(h)," = ",g,")"],c=this.topStack()}var i=a.call(this,c);f||this.popStack(),e&&this.stackSlot--,this.push(b.concat(i,")"))},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var a=this.inlineStack;this.inlineStack=[];for(var b=0,c=a.length;c>b;b++){var e=a[b];if(e instanceof d)this.compileStack.push(e);else{var f=this.incrStack();this.pushSource([f," = ",e,";"]),this.compileStack.push(f)}}},isInline:function(){return this.inlineStack.length},popStack:function(a){var b=this.isInline(),c=(b?this.inlineStack:this.compileStack).pop();if(!a&&c instanceof d)return c.value;if(!b){if(!this.stackSlot)throw new j["default"]("Invalid stack pop");this.stackSlot--}return c},topStack:function(){var a=this.isInline()?this.inlineStack:this.compileStack,b=a[a.length-1];return b instanceof d?b.value:b},contextName:function(a){return this.useDepths&&a?"depths["+a+"]":"depth"+a},quotedString:function(a){return this.source.quotedString(a)},objectLiteral:function(a){return this.source.objectLiteral(a)},aliasable:function(a){var b=this.aliases[a];return b?(b.referenceCount++,b):(b=this.aliases[a]=this.source.wrap(a),b.aliasable=!0,b.referenceCount=1,b)},setupHelper:function(a,b,c){var d=[],e=this.setupHelperArgs(b,a,d,c),f=this.nameLookup("helpers",b,"helper");return{params:d,paramsInit:e,name:f,callParams:[this.contextName(0)].concat(d)}},setupParams:function(a,b,c){var d={},e=[],f=[],g=[],h=void 0;d.name=this.quotedString(a),d.hash=this.popStack(),this.trackIds&&(d.hashIds=this.popStack()),this.stringParams&&(d.hashTypes=this.popStack(),d.hashContexts=this.popStack());var i=this.popStack(),j=this.popStack();(j||i)&&(d.fn=j||"this.noop",d.inverse=i||"this.noop");for(var k=b;k--;)h=this.popStack(),c[k]=h,this.trackIds&&(g[k]=this.popStack()),this.stringParams&&(f[k]=this.popStack(),e[k]=this.popStack());return this.trackIds&&(d.ids=this.source.generateArray(g)),this.stringParams&&(d.types=this.source.generateArray(f),d.contexts=this.source.generateArray(e)),this.options.data&&(d.data="data"),this.useBlockParams&&(d.blockParams="blockParams"),d},setupHelperArgs:function(a,b,c,d){var e=this.setupParams(a,b,c,!0);return e=this.objectLiteral(e),d?(this.useRegister("options"),c.push("options"),["options=",e]):(c.push(e),"")}},function(){for(var a="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield await null true false".split(" "),b=e.RESERVED_WORDS={},c=0,d=a.length;d>c;c++)b[a[c]]=!0}(),e.isValidJavaScriptVariableName=function(a){return!e.RESERVED_WORDS[a]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(a)},b["default"]=e,a.exports=b["default"]},function(a,b,c){"use strict";function d(){this.parents=[]}var e=c(8)["default"];b.__esModule=!0;var f=c(12),g=e(f),h=c(2),i=e(h);d.prototype={constructor:d,mutating:!1,acceptKey:function(a,b){var c=this.accept(a[b]);if(this.mutating){if(c&&(!c.type||!i["default"][c.type]))throw new g["default"]('Unexpected node type "'+c.type+'" found when accepting '+b+" on "+a.type);a[b]=c}},acceptRequired:function(a,b){if(this.acceptKey(a,b),!a[b])throw new g["default"](a.type+" requires "+b)},acceptArray:function(a){for(var b=0,c=a.length;c>b;b++)this.acceptKey(a,b),a[b]||(a.splice(b,1),b--,c--)},accept:function(a){if(a){this.current&&this.parents.unshift(this.current),this.current=a;var b=this[a.type](a);return this.current=this.parents.shift(),!this.mutating||b?b:b!==!1?a:void 0}},Program:function(a){this.acceptArray(a.body)},MustacheStatement:function(a){this.acceptRequired(a,"path"),this.acceptArray(a.params),this.acceptKey(a,"hash")},BlockStatement:function(a){this.acceptRequired(a,"path"),this.acceptArray(a.params),this.acceptKey(a,"hash"),this.acceptKey(a,"program"),this.acceptKey(a,"inverse")},PartialStatement:function(a){this.acceptRequired(a,"name"),this.acceptArray(a.params),this.acceptKey(a,"hash")},ContentStatement:function(){},CommentStatement:function(){},SubExpression:function(a){this.acceptRequired(a,"path"),this.acceptArray(a.params),this.acceptKey(a,"hash")},PathExpression:function(){},StringLiteral:function(){},NumberLiteral:function(){},BooleanLiteral:function(){},UndefinedLiteral:function(){},NullLiteral:function(){},Hash:function(a){this.acceptArray(a.pairs)},HashPair:function(a){this.acceptRequired(a,"value")}},b["default"]=d,a.exports=b["default"]},function(a,b){(function(c){"use strict";b.__esModule=!0,b["default"]=function(a){var b="undefined"!=typeof c?c:window,d=b.Handlebars;a.noConflict=function(){b.Handlebars===a&&(b.Handlebars=d)}},a.exports=b["default"]}).call(b,function(){return this}())},function(a,b){"use strict";b["default"]=function(a){return a&&a.__esModule?a:{"default":a}},b.__esModule=!0},function(a,b){"use strict";b["default"]=function(a){if(a&&a.__esModule)return a;var b={};if("object"==typeof a&&null!==a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b},b.__esModule=!0},function(a,b,c){"use strict";function d(a,b){this.helpers=a||{},this.partials=b||{},e(this)}function e(a){a.registerHelper("helperMissing",function(){if(1===arguments.length)return void 0;throw new l["default"]('Missing helper: "'+arguments[arguments.length-1].name+'"')}),a.registerHelper("blockHelperMissing",function(b,c){var d=c.inverse,e=c.fn;if(b===!0)return e(this);if(b===!1||null==b)return d(this);if(p(b))return b.length>0?(c.ids&&(c.ids=[c.name]),a.helpers.each(b,c)):d(this);if(c.data&&c.ids){var g=f(c.data);g.contextPath=j.appendContextPath(c.data.contextPath,c.name),c={data:g}}return e(b,c)}),a.registerHelper("each",function(a,b){function c(b,c,e){i&&(i.key=b,i.index=c,i.first=0===c,i.last=!!e,k&&(i.contextPath=k+b)),h+=d(a[b],{data:i,blockParams:j.blockParams([a[b],b],[k+b,null])})}if(!b)throw new l["default"]("Must pass iterator to #each");var d=b.fn,e=b.inverse,g=0,h="",i=void 0,k=void 0;if(b.data&&b.ids&&(k=j.appendContextPath(b.data.contextPath,b.ids[0])+"."),q(a)&&(a=a.call(this)),b.data&&(i=f(b.data)),a&&"object"==typeof a)if(p(a))for(var m=a.length;m>g;g++)c(g,g,g===a.length-1);else{var n=void 0;for(var o in a)a.hasOwnProperty(o)&&(n&&c(n,g-1),n=o,g++);n&&c(n,g-1,!0)}return 0===g&&(h=e(this)),h}),a.registerHelper("if",function(a,b){return q(a)&&(a=a.call(this)),!b.hash.includeZero&&!a||j.isEmpty(a)?b.inverse(this):b.fn(this)}),a.registerHelper("unless",function(b,c){return a.helpers["if"].call(this,b,{fn:c.inverse,inverse:c.fn,hash:c.hash})}),a.registerHelper("with",function(a,b){q(a)&&(a=a.call(this));var c=b.fn;if(j.isEmpty(a))return b.inverse(this);if(b.data&&b.ids){var d=f(b.data);d.contextPath=j.appendContextPath(b.data.contextPath,b.ids[0]),b={data:d}}return c(a,b)}),a.registerHelper("log",function(b,c){var d=c.data&&null!=c.data.level?parseInt(c.data.level,10):1;a.log(d,b)}),a.registerHelper("lookup",function(a,b){return a&&a[b]})}function f(a){var b=j.extend({},a);return b._parent=a,b}var g=c(9)["default"],h=c(8)["default"];b.__esModule=!0,b.HandlebarsEnvironment=d,b.createFrame=f;var i=c(13),j=g(i),k=c(12),l=h(k),m="3.0.1";b.VERSION=m;var n=6;b.COMPILER_REVISION=n;var o={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1"};b.REVISION_CHANGES=o;var p=j.isArray,q=j.isFunction,r=j.toString,s="[object Object]";d.prototype={constructor:d,logger:t,log:u,registerHelper:function(a,b){if(r.call(a)===s){if(b)throw new l["default"]("Arg not supported with multiple helpers");j.extend(this.helpers,a)}else this.helpers[a]=b},unregisterHelper:function(a){delete this.helpers[a]},registerPartial:function(a,b){if(r.call(a)===s)j.extend(this.partials,a);else{if("undefined"==typeof b)throw new l["default"]("Attempting to register a partial as undefined");this.partials[a]=b}},unregisterPartial:function(a){delete this.partials[a]}};var t={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:1,log:function(a,b){if("undefined"!=typeof console&&t.level<=a){var c=t.methodMap[a];(console[c]||console.log).call(console,b)}}};b.logger=t;var u=t.log;b.log=u},function(a,b){"use strict";function c(a){this.string=a}b.__esModule=!0,c.prototype.toString=c.prototype.toHTML=function(){return""+this.string},b["default"]=c,a.exports=b["default"]},function(a,b){"use strict";function c(a,b){var e=b&&b.loc,f=void 0,g=void 0;e&&(f=e.start.line,g=e.start.column,a+=" - "+f+":"+g);for(var h=Error.prototype.constructor.call(this,a),i=0;i<d.length;i++)this[d[i]]=h[d[i]];Error.captureStackTrace&&Error.captureStackTrace(this,c),e&&(this.lineNumber=f,this.column=g)}b.__esModule=!0;var d=["description","fileName","lineNumber","message","name","number","stack"];c.prototype=new Error,b["default"]=c,a.exports=b["default"]},function(a,b){"use strict";function c(a){return j[a]}function d(a){for(var b=1;b<arguments.length;b++)for(var c in arguments[b])Object.prototype.hasOwnProperty.call(arguments[b],c)&&(a[c]=arguments[b][c]);return a}function e(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1}function f(a){if("string"!=typeof a){if(a&&a.toHTML)return a.toHTML();if(null==a)return"";if(!a)return a+"";a=""+a}return l.test(a)?a.replace(k,c):a}function g(a){return a||0===a?o(a)&&0===a.length?!0:!1:!0}function h(a,b){return a.path=b,a}function i(a,b){return(a?a+".":"")+b}b.__esModule=!0,b.extend=d,b.indexOf=e,b.escapeExpression=f,b.isEmpty=g,b.blockParams=h,b.appendContextPath=i;var j={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},k=/[&<>"'`]/g,l=/[&<>"'`]/,m=Object.prototype.toString;b.toString=m;var n=function(a){return"function"==typeof a};n(/x/)&&(b.isFunction=n=function(a){return"function"==typeof a&&"[object Function]"===m.call(a)});var n;b.isFunction=n;var o=Array.isArray||function(a){return a&&"object"==typeof a?"[object Array]"===m.call(a):!1};b.isArray=o},function(a,b,c){"use strict";function d(a){var b=a&&a[0]||1,c=q.COMPILER_REVISION;if(b!==c){if(c>b){var d=q.REVISION_CHANGES[c],e=q.REVISION_CHANGES[b];throw new p["default"]("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+d+") or downgrade your runtime to an older version ("+e+").")}throw new p["default"]("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+a[1]+").")}}function e(a,b){function c(c,d,e){e.hash&&(d=n.extend({},d,e.hash)),c=b.VM.resolvePartial.call(this,c,d,e);var f=b.VM.invokePartial.call(this,c,d,e);if(null==f&&b.compile&&(e.partials[e.name]=b.compile(c,a.compilerOptions,b),f=e.partials[e.name](d,e)),null!=f){if(e.indent){for(var g=f.split("\n"),h=0,i=g.length;i>h&&(g[h]||h+1!==i);h++)g[h]=e.indent+g[h];f=g.join("\n")}return f}throw new p["default"]("The partial "+e.name+" could not be compiled when running in runtime-only mode")}function d(b){var c=void 0===arguments[1]?{}:arguments[1],f=c.data;d._setup(c),!c.partial&&a.useData&&(f=j(b,f));var g=void 0,h=a.useBlockParams?[]:void 0;return a.useDepths&&(g=c.depths?[b].concat(c.depths):[b]),a.main.call(e,b,e.helpers,e.partials,f,h,g)}if(!b)throw new p["default"]("No environment passed to template");if(!a||!a.main)throw new p["default"]("Unknown template object: "+typeof a);b.VM.checkRevision(a.compiler);var e={strict:function(a,b){if(!(b in a))throw new p["default"]('"'+b+'" not defined in '+a);return a[b]},lookup:function(a,b){for(var c=a.length,d=0;c>d;d++)if(a[d]&&null!=a[d][b])return a[d][b]},lambda:function(a,b){return"function"==typeof a?a.call(b):a},escapeExpression:n.escapeExpression,invokePartial:c,fn:function(b){return a[b]},programs:[],program:function(a,b,c,d,e){var g=this.programs[a],h=this.fn(a);return b||e||d||c?g=f(this,a,h,b,c,d,e):g||(g=this.programs[a]=f(this,a,h)),g},data:function(a,b){for(;a&&b--;)a=a._parent;return a},merge:function(a,b){var c=a||b;return a&&b&&a!==b&&(c=n.extend({},b,a)),c},noop:b.VM.noop,compilerInfo:a.compiler};return d.isTop=!0,d._setup=function(c){c.partial?(e.helpers=c.helpers,e.partials=c.partials):(e.helpers=e.merge(c.helpers,b.helpers),a.usePartial&&(e.partials=e.merge(c.partials,b.partials)))},d._child=function(b,c,d,g){if(a.useBlockParams&&!d)throw new p["default"]("must pass block params");if(a.useDepths&&!g)throw new p["default"]("must pass parent depths");return f(e,b,a[b],c,0,d,g)},d}function f(a,b,c,d,e,f,g){function h(b){var e=void 0===arguments[1]?{}:arguments[1];return c.call(a,b,a.helpers,a.partials,e.data||d,f&&[e.blockParams].concat(f),g&&[b].concat(g))}return h.program=b,h.depth=g?g.length:0,h.blockParams=e||0,h}function g(a,b,c){return a?a.call||c.name||(c.name=a,a=c.partials[a]):a=c.partials[c.name],a}function h(a,b,c){if(c.partial=!0,void 0===a)throw new p["default"]("The partial "+c.name+" could not be found");return a instanceof Function?a(b,c):void 0}function i(){return""}function j(a,b){return b&&"root"in b||(b=b?q.createFrame(b):{},b.root=a),b}var k=c(9)["default"],l=c(8)["default"];b.__esModule=!0,b.checkRevision=d,b.template=e,b.wrapProgram=f,b.resolvePartial=g,b.invokePartial=h,b.noop=i;var m=c(13),n=k(m),o=c(12),p=l(o),q=c(10)},function(a,b){"use strict";b.__esModule=!0;var c=function(){function a(){this.yy={}}var b={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,content:12,COMMENT:13,CONTENT:14,openRawBlock:15,END_RAW_BLOCK:16,OPEN_RAW_BLOCK:17,helperName:18,openRawBlock_repetition0:19,openRawBlock_option0:20,CLOSE_RAW_BLOCK:21,openBlock:22,block_option0:23,closeBlock:24,openInverse:25,block_option1:26,OPEN_BLOCK:27,openBlock_repetition0:28,openBlock_option0:29,openBlock_option1:30,CLOSE:31,OPEN_INVERSE:32,openInverse_repetition0:33,openInverse_option0:34,openInverse_option1:35,openInverseChain:36,OPEN_INVERSE_CHAIN:37,openInverseChain_repetition0:38,openInverseChain_option0:39,openInverseChain_option1:40,inverseAndProgram:41,INVERSE:42,inverseChain:43,inverseChain_option0:44,OPEN_ENDBLOCK:45,OPEN:46,mustache_repetition0:47,mustache_option0:48,OPEN_UNESCAPED:49,mustache_repetition1:50,mustache_option1:51,CLOSE_UNESCAPED:52,OPEN_PARTIAL:53,partialName:54,partial_repetition0:55,partial_option0:56,param:57,sexpr:58,OPEN_SEXPR:59,sexpr_repetition0:60,sexpr_option0:61,CLOSE_SEXPR:62,hash:63,hash_repetition_plus0:64,hashSegment:65,ID:66,EQUALS:67,blockParams:68,OPEN_BLOCK_PARAMS:69,blockParams_repetition_plus0:70,CLOSE_BLOCK_PARAMS:71,path:72,dataName:73,STRING:74,NUMBER:75,BOOLEAN:76,UNDEFINED:77,NULL:78,DATA:79,pathSegments:80,SEP:81,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",13:"COMMENT",14:"CONTENT",16:"END_RAW_BLOCK",17:"OPEN_RAW_BLOCK",21:"CLOSE_RAW_BLOCK",27:"OPEN_BLOCK",31:"CLOSE",32:"OPEN_INVERSE",37:"OPEN_INVERSE_CHAIN",42:"INVERSE",45:"OPEN_ENDBLOCK",46:"OPEN",49:"OPEN_UNESCAPED",52:"CLOSE_UNESCAPED",53:"OPEN_PARTIAL",59:"OPEN_SEXPR",62:"CLOSE_SEXPR",66:"ID",67:"EQUALS",69:"OPEN_BLOCK_PARAMS",71:"CLOSE_BLOCK_PARAMS",74:"STRING",75:"NUMBER",76:"BOOLEAN",77:"UNDEFINED",78:"NULL",79:"DATA",81:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[12,1],[10,3],[15,5],[9,4],[9,4],[22,6],[25,6],[36,6],[41,2],[43,3],[43,1],[24,3],[8,5],[8,5],[11,5],[57,1],[57,1],[58,5],[63,1],[65,3],[68,3],[18,1],[18,1],[18,1],[18,1],[18,1],[18,1],[18,1],[54,1],[54,1],[73,2],[72,1],[80,3],[80,1],[6,0],[6,2],[19,0],[19,2],[20,0],[20,1],[23,0],[23,1],[26,0],[26,1],[28,0],[28,2],[29,0],[29,1],[30,0],[30,1],[33,0],[33,2],[34,0],[34,1],[35,0],[35,1],[38,0],[38,2],[39,0],[39,1],[40,0],[40,1],[44,0],[44,1],[47,0],[47,2],[48,0],[48,1],[50,0],[50,2],[51,0],[51,1],[55,0],[55,2],[56,0],[56,1],[60,0],[60,2],[61,0],[61,1],[64,1],[64,2],[70,1],[70,2]],performAction:function(a,b,c,d,e,f){var g=f.length-1;switch(e){case 1:return f[g-1];case 2:this.$=new d.Program(f[g],null,{},d.locInfo(this._$));break;case 3:this.$=f[g];break;case 4:this.$=f[g];break;case 5:this.$=f[g];break;case 6:this.$=f[g];break;case 7:this.$=f[g];break;case 8:this.$=new d.CommentStatement(d.stripComment(f[g]),d.stripFlags(f[g],f[g]),d.locInfo(this._$));break;case 9:this.$=new d.ContentStatement(f[g],d.locInfo(this._$));break;case 10:this.$=d.prepareRawBlock(f[g-2],f[g-1],f[g],this._$);break;case 11:this.$={path:f[g-3],params:f[g-2],hash:f[g-1]};break;case 12:this.$=d.prepareBlock(f[g-3],f[g-2],f[g-1],f[g],!1,this._$);break;case 13:this.$=d.prepareBlock(f[g-3],f[g-2],f[g-1],f[g],!0,this._$);break;case 14:this.$={path:f[g-4],params:f[g-3],hash:f[g-2],blockParams:f[g-1],strip:d.stripFlags(f[g-5],f[g])};break;case 15:this.$={path:f[g-4],params:f[g-3],hash:f[g-2],blockParams:f[g-1],strip:d.stripFlags(f[g-5],f[g])};break;case 16:this.$={path:f[g-4],params:f[g-3],hash:f[g-2],blockParams:f[g-1],strip:d.stripFlags(f[g-5],f[g])};break;case 17:this.$={strip:d.stripFlags(f[g-1],f[g-1]),program:f[g]};break;case 18:var h=d.prepareBlock(f[g-2],f[g-1],f[g],f[g],!1,this._$),i=new d.Program([h],null,{},d.locInfo(this._$));i.chained=!0,this.$={strip:f[g-2].strip,program:i,chain:!0};break;case 19:this.$=f[g];break;case 20:this.$={path:f[g-1],strip:d.stripFlags(f[g-2],f[g])};break;case 21:this.$=d.prepareMustache(f[g-3],f[g-2],f[g-1],f[g-4],d.stripFlags(f[g-4],f[g]),this._$);break;case 22:this.$=d.prepareMustache(f[g-3],f[g-2],f[g-1],f[g-4],d.stripFlags(f[g-4],f[g]),this._$);break;case 23:this.$=new d.PartialStatement(f[g-3],f[g-2],f[g-1],d.stripFlags(f[g-4],f[g]),d.locInfo(this._$));break;case 24:this.$=f[g];break;case 25:this.$=f[g];break;case 26:this.$=new d.SubExpression(f[g-3],f[g-2],f[g-1],d.locInfo(this._$));break;case 27:this.$=new d.Hash(f[g],d.locInfo(this._$));break;case 28:this.$=new d.HashPair(d.id(f[g-2]),f[g],d.locInfo(this._$));break;case 29:this.$=d.id(f[g-1]);break;case 30:this.$=f[g];break;case 31:this.$=f[g];break;case 32:this.$=new d.StringLiteral(f[g],d.locInfo(this._$));break;case 33:this.$=new d.NumberLiteral(f[g],d.locInfo(this._$));break;case 34:this.$=new d.BooleanLiteral(f[g],d.locInfo(this._$));break;case 35:this.$=new d.UndefinedLiteral(d.locInfo(this._$));break;case 36:this.$=new d.NullLiteral(d.locInfo(this._$));break;case 37:this.$=f[g];break;case 38:this.$=f[g];break;case 39:this.$=d.preparePath(!0,f[g],this._$);break;case 40:this.$=d.preparePath(!1,f[g],this._$);break;case 41:f[g-2].push({part:d.id(f[g]),original:f[g],separator:f[g-1]}),this.$=f[g-2];break;case 42:this.$=[{part:d.id(f[g]),original:f[g]}];break;case 43:this.$=[];break;case 44:f[g-1].push(f[g]);break;case 45:this.$=[];break;case 46:f[g-1].push(f[g]);break;case 53:this.$=[];break;case 54:f[g-1].push(f[g]);break;case 59:this.$=[];break;case 60:f[g-1].push(f[g]);break;case 65:this.$=[];break;case 66:f[g-1].push(f[g]);break;case 73:this.$=[];break;case 74:f[g-1].push(f[g]);break;case 77:this.$=[];break;case 78:f[g-1].push(f[g]);break;case 81:this.$=[];break;case 82:f[g-1].push(f[g]);break;case 85:this.$=[];break;case 86:f[g-1].push(f[g]);break;case 89:this.$=[f[g]];break;case 90:f[g-1].push(f[g]);break;case 91:this.$=[f[g]];break;case 92:f[g-1].push(f[g])}},table:[{3:1,4:2,5:[2,43],6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],46:[2,43],49:[2,43],53:[2,43]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:10,13:[1,11],14:[1,18],15:16,17:[1,21],22:14,25:15,27:[1,19],32:[1,20],37:[2,2],42:[2,2],45:[2,2],46:[1,12],49:[1,13],53:[1,17]},{1:[2,1]},{5:[2,44],13:[2,44],14:[2,44],17:[2,44],27:[2,44],32:[2,44],37:[2,44],42:[2,44],45:[2,44],46:[2,44],49:[2,44],53:[2,44]},{5:[2,3],13:[2,3],14:[2,3],17:[2,3],27:[2,3],32:[2,3],37:[2,3],42:[2,3],45:[2,3],46:[2,3],49:[2,3],53:[2,3]},{5:[2,4],13:[2,4],14:[2,4],17:[2,4],27:[2,4],32:[2,4],37:[2,4],42:[2,4],45:[2,4],46:[2,4],49:[2,4],53:[2,4]},{5:[2,5],13:[2,5],14:[2,5],17:[2,5],27:[2,5],32:[2,5],37:[2,5],42:[2,5],45:[2,5],46:[2,5],49:[2,5],53:[2,5]},{5:[2,6],13:[2,6],14:[2,6],17:[2,6],27:[2,6],32:[2,6],37:[2,6],42:[2,6],45:[2,6],46:[2,6],49:[2,6],53:[2,6]},{5:[2,7],13:[2,7],14:[2,7],17:[2,7],27:[2,7],32:[2,7],37:[2,7],42:[2,7],45:[2,7],46:[2,7],49:[2,7],53:[2,7]},{5:[2,8],13:[2,8],14:[2,8],17:[2,8],27:[2,8],32:[2,8],37:[2,8],42:[2,8],45:[2,8],46:[2,8],49:[2,8],53:[2,8]},{18:22,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:33,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{4:34,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],37:[2,43],42:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{4:35,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],42:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{12:36,14:[1,18]},{18:38,54:37,58:39,59:[1,40],66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{5:[2,9],13:[2,9],14:[2,9],16:[2,9],17:[2,9],27:[2,9],32:[2,9],37:[2,9],42:[2,9],45:[2,9],46:[2,9],49:[2,9],53:[2,9]},{18:41,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:42,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:43,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{31:[2,73],47:44,59:[2,73],66:[2,73],74:[2,73],75:[2,73],76:[2,73],77:[2,73],78:[2,73],79:[2,73]},{21:[2,30],31:[2,30],52:[2,30],59:[2,30],62:[2,30],66:[2,30],69:[2,30],74:[2,30],75:[2,30],76:[2,30],77:[2,30],78:[2,30],79:[2,30]},{21:[2,31],31:[2,31],52:[2,31],59:[2,31],62:[2,31],66:[2,31],69:[2,31],74:[2,31],75:[2,31],76:[2,31],77:[2,31],78:[2,31],79:[2,31]},{21:[2,32],31:[2,32],52:[2,32],59:[2,32],62:[2,32],66:[2,32],69:[2,32],74:[2,32],75:[2,32],76:[2,32],77:[2,32],78:[2,32],79:[2,32]},{21:[2,33],31:[2,33],52:[2,33],59:[2,33],62:[2,33],66:[2,33],69:[2,33],74:[2,33],75:[2,33],76:[2,33],77:[2,33],78:[2,33],79:[2,33]},{21:[2,34],31:[2,34],52:[2,34],59:[2,34],62:[2,34],66:[2,34],69:[2,34],74:[2,34],75:[2,34],76:[2,34],77:[2,34],78:[2,34],79:[2,34]},{21:[2,35],31:[2,35],52:[2,35],59:[2,35],62:[2,35],66:[2,35],69:[2,35],74:[2,35],75:[2,35],76:[2,35],77:[2,35],78:[2,35],79:[2,35]},{21:[2,36],31:[2,36],52:[2,36],59:[2,36],62:[2,36],66:[2,36],69:[2,36],74:[2,36],75:[2,36],76:[2,36],77:[2,36],78:[2,36],79:[2,36]},{21:[2,40],31:[2,40],52:[2,40],59:[2,40],62:[2,40],66:[2,40],69:[2,40],74:[2,40],75:[2,40],76:[2,40],77:[2,40],78:[2,40],79:[2,40],81:[1,45]},{66:[1,32],80:46},{21:[2,42],31:[2,42],52:[2,42],59:[2,42],62:[2,42],66:[2,42],69:[2,42],74:[2,42],75:[2,42],76:[2,42],77:[2,42],78:[2,42],79:[2,42],81:[2,42]},{50:47,52:[2,77],59:[2,77],66:[2,77],74:[2,77],75:[2,77],76:[2,77],77:[2,77],78:[2,77],79:[2,77]},{23:48,36:50,37:[1,52],41:51,42:[1,53],43:49,45:[2,49]},{26:54,41:55,42:[1,53],45:[2,51]},{16:[1,56]},{31:[2,81],55:57,59:[2,81],66:[2,81],74:[2,81],75:[2,81],76:[2,81],77:[2,81],78:[2,81],79:[2,81]},{31:[2,37],59:[2,37],66:[2,37],74:[2,37],75:[2,37],76:[2,37],77:[2,37],78:[2,37],79:[2,37]},{31:[2,38],59:[2,38],66:[2,38],74:[2,38],75:[2,38],76:[2,38],77:[2,38],78:[2,38],79:[2,38]},{18:58,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{28:59,31:[2,53],59:[2,53],66:[2,53],69:[2,53],74:[2,53],75:[2,53],76:[2,53],77:[2,53],78:[2,53],79:[2,53]},{31:[2,59],33:60,59:[2,59],66:[2,59],69:[2,59],74:[2,59],75:[2,59],76:[2,59],77:[2,59],78:[2,59],79:[2,59]},{19:61,21:[2,45],59:[2,45],66:[2,45],74:[2,45],75:[2,45],76:[2,45],77:[2,45],78:[2,45],79:[2,45]},{18:65,31:[2,75],48:62,57:63,58:66,59:[1,40],63:64,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{66:[1,70]},{21:[2,39],31:[2,39],52:[2,39],59:[2,39],62:[2,39],66:[2,39],69:[2,39],74:[2,39],75:[2,39],76:[2,39],77:[2,39],78:[2,39],79:[2,39],81:[1,45]},{18:65,51:71,52:[2,79],57:72,58:66,59:[1,40],63:73,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{24:74,45:[1,75]},{45:[2,50]},{4:76,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],37:[2,43],42:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{45:[2,19]},{18:77,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{4:78,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{24:79,45:[1,75]},{45:[2,52]},{5:[2,10],13:[2,10],14:[2,10],17:[2,10],27:[2,10],32:[2,10],37:[2,10],42:[2,10],45:[2,10],46:[2,10],49:[2,10],53:[2,10]},{18:65,31:[2,83],56:80,57:81,58:66,59:[1,40],63:82,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{59:[2,85],60:83,62:[2,85],66:[2,85],74:[2,85],75:[2,85],76:[2,85],77:[2,85],78:[2,85],79:[2,85]},{18:65,29:84,31:[2,55],57:85,58:66,59:[1,40],63:86,64:67,65:68,66:[1,69],69:[2,55],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:65,31:[2,61],34:87,57:88,58:66,59:[1,40],63:89,64:67,65:68,66:[1,69],69:[2,61],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:65,20:90,21:[2,47],57:91,58:66,59:[1,40],63:92,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{31:[1,93]},{31:[2,74],59:[2,74],66:[2,74],74:[2,74],75:[2,74],76:[2,74],77:[2,74],78:[2,74],79:[2,74]},{31:[2,76]},{21:[2,24],31:[2,24],52:[2,24],59:[2,24],62:[2,24],66:[2,24],69:[2,24],74:[2,24],75:[2,24],76:[2,24],77:[2,24],78:[2,24],79:[2,24]},{21:[2,25],31:[2,25],52:[2,25],59:[2,25],62:[2,25],66:[2,25],69:[2,25],74:[2,25],75:[2,25],76:[2,25],77:[2,25],78:[2,25],79:[2,25]},{21:[2,27],31:[2,27],52:[2,27],62:[2,27],65:94,66:[1,95],69:[2,27]},{21:[2,89],31:[2,89],52:[2,89],62:[2,89],66:[2,89],69:[2,89]},{21:[2,42],31:[2,42],52:[2,42],59:[2,42],62:[2,42],66:[2,42],67:[1,96],69:[2,42],74:[2,42],75:[2,42],76:[2,42],77:[2,42],78:[2,42],79:[2,42],81:[2,42]},{21:[2,41],31:[2,41],52:[2,41],59:[2,41],62:[2,41],66:[2,41],69:[2,41],74:[2,41],75:[2,41],76:[2,41],77:[2,41],78:[2,41],79:[2,41],81:[2,41]},{52:[1,97]},{52:[2,78],59:[2,78],66:[2,78],74:[2,78],75:[2,78],76:[2,78],77:[2,78],78:[2,78],79:[2,78]},{52:[2,80]},{5:[2,12],13:[2,12],14:[2,12],17:[2,12],27:[2,12],32:[2,12],37:[2,12],42:[2,12],45:[2,12],46:[2,12],49:[2,12],53:[2,12]},{18:98,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{36:50,37:[1,52],41:51,42:[1,53],43:100,44:99,45:[2,71]},{31:[2,65],38:101,59:[2,65],66:[2,65],69:[2,65],74:[2,65],75:[2,65],76:[2,65],77:[2,65],78:[2,65],79:[2,65]},{45:[2,17]},{5:[2,13],13:[2,13],14:[2,13],17:[2,13],27:[2,13],32:[2,13],37:[2,13],42:[2,13],45:[2,13],46:[2,13],49:[2,13],53:[2,13]},{31:[1,102]},{31:[2,82],59:[2,82],66:[2,82],74:[2,82],75:[2,82],76:[2,82],77:[2,82],78:[2,82],79:[2,82]},{31:[2,84]},{18:65,57:104,58:66,59:[1,40],61:103,62:[2,87],63:105,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{30:106,31:[2,57],68:107,69:[1,108]},{31:[2,54],59:[2,54],66:[2,54],69:[2,54],74:[2,54],75:[2,54],76:[2,54],77:[2,54],78:[2,54],79:[2,54]},{31:[2,56],69:[2,56]},{31:[2,63],35:109,68:110,69:[1,108]},{31:[2,60],59:[2,60],66:[2,60],69:[2,60],74:[2,60],75:[2,60],76:[2,60],77:[2,60],78:[2,60],79:[2,60]},{31:[2,62],69:[2,62]},{21:[1,111]},{21:[2,46],59:[2,46],66:[2,46],74:[2,46],75:[2,46],76:[2,46],77:[2,46],78:[2,46],79:[2,46]},{21:[2,48]},{5:[2,21],13:[2,21],14:[2,21],17:[2,21],27:[2,21],32:[2,21],37:[2,21],42:[2,21],45:[2,21],46:[2,21],49:[2,21],53:[2,21]},{21:[2,90],31:[2,90],52:[2,90],62:[2,90],66:[2,90],69:[2,90]},{67:[1,96]},{18:65,57:112,58:66,59:[1,40],66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{5:[2,22],13:[2,22],14:[2,22],17:[2,22],27:[2,22],32:[2,22],37:[2,22],42:[2,22],45:[2,22],46:[2,22],49:[2,22],53:[2,22]},{31:[1,113]},{45:[2,18]},{45:[2,72]},{18:65,31:[2,67],39:114,57:115,58:66,59:[1,40],63:116,64:67,65:68,66:[1,69],69:[2,67],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{5:[2,23],13:[2,23],14:[2,23],17:[2,23],27:[2,23],32:[2,23],37:[2,23],42:[2,23],45:[2,23],46:[2,23],49:[2,23],53:[2,23]},{62:[1,117]},{59:[2,86],62:[2,86],66:[2,86],74:[2,86],75:[2,86],76:[2,86],77:[2,86],78:[2,86],79:[2,86]},{62:[2,88]},{31:[1,118]},{31:[2,58]},{66:[1,120],70:119},{31:[1,121]},{31:[2,64]},{14:[2,11]},{21:[2,28],31:[2,28],52:[2,28],62:[2,28],66:[2,28],69:[2,28]},{5:[2,20],13:[2,20],14:[2,20],17:[2,20],27:[2,20],32:[2,20],37:[2,20],42:[2,20],45:[2,20],46:[2,20],49:[2,20],53:[2,20]},{31:[2,69],40:122,68:123,69:[1,108]},{31:[2,66],59:[2,66],66:[2,66],69:[2,66],74:[2,66],75:[2,66],76:[2,66],77:[2,66],78:[2,66],79:[2,66]},{31:[2,68],69:[2,68]},{21:[2,26],31:[2,26],52:[2,26],59:[2,26],62:[2,26],66:[2,26],69:[2,26],74:[2,26],75:[2,26],76:[2,26],77:[2,26],78:[2,26],79:[2,26]},{13:[2,14],14:[2,14],17:[2,14],27:[2,14],32:[2,14],37:[2,14],42:[2,14],45:[2,14],46:[2,14],49:[2,14],53:[2,14]},{66:[1,125],71:[1,124]},{66:[2,91],71:[2,91]},{13:[2,15],14:[2,15],17:[2,15],27:[2,15],32:[2,15],42:[2,15],45:[2,15],46:[2,15],49:[2,15],53:[2,15]},{31:[1,126]},{31:[2,70]},{31:[2,29]},{66:[2,92],71:[2,92]},{13:[2,16],14:[2,16],17:[2,16],27:[2,16],32:[2,16],37:[2,16],42:[2,16],45:[2,16],46:[2,16],49:[2,16],53:[2,16]}],defaultActions:{4:[2,1],49:[2,50],51:[2,19],55:[2,52],64:[2,76],73:[2,80],78:[2,17],82:[2,84],92:[2,48],99:[2,18],100:[2,72],105:[2,88],107:[2,58],110:[2,64],111:[2,11],123:[2,70],124:[2,29]},parseError:function(a){throw new Error(a)
},parse:function(a){function b(){var a;return a=c.lexer.lex()||1,"number"!=typeof a&&(a=c.symbols_[a]||a),a}var c=this,d=[0],e=[null],f=[],g=this.table,h="",i=0,j=0,k=0;this.lexer.setInput(a),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var l=this.lexer.yylloc;f.push(l);var m=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var n,o,p,q,r,s,t,u,v,w={};;){if(p=d[d.length-1],this.defaultActions[p]?q=this.defaultActions[p]:((null===n||"undefined"==typeof n)&&(n=b()),q=g[p]&&g[p][n]),"undefined"==typeof q||!q.length||!q[0]){var x="";if(!k){v=[];for(s in g[p])this.terminals_[s]&&s>2&&v.push("'"+this.terminals_[s]+"'");x=this.lexer.showPosition?"Parse error on line "+(i+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+v.join(", ")+", got '"+(this.terminals_[n]||n)+"'":"Parse error on line "+(i+1)+": Unexpected "+(1==n?"end of input":"'"+(this.terminals_[n]||n)+"'"),this.parseError(x,{text:this.lexer.match,token:this.terminals_[n]||n,line:this.lexer.yylineno,loc:l,expected:v})}}if(q[0]instanceof Array&&q.length>1)throw new Error("Parse Error: multiple actions possible at state: "+p+", token: "+n);switch(q[0]){case 1:d.push(n),e.push(this.lexer.yytext),f.push(this.lexer.yylloc),d.push(q[1]),n=null,o?(n=o,o=null):(j=this.lexer.yyleng,h=this.lexer.yytext,i=this.lexer.yylineno,l=this.lexer.yylloc,k>0&&k--);break;case 2:if(t=this.productions_[q[1]][1],w.$=e[e.length-t],w._$={first_line:f[f.length-(t||1)].first_line,last_line:f[f.length-1].last_line,first_column:f[f.length-(t||1)].first_column,last_column:f[f.length-1].last_column},m&&(w._$.range=[f[f.length-(t||1)].range[0],f[f.length-1].range[1]]),r=this.performAction.call(w,h,j,i,this.yy,q[1],e,f),"undefined"!=typeof r)return r;t&&(d=d.slice(0,-1*t*2),e=e.slice(0,-1*t),f=f.slice(0,-1*t)),d.push(this.productions_[q[1]][0]),e.push(w.$),f.push(w._$),u=g[d[d.length-2]][d[d.length-1]],d.push(u);break;case 3:return!0}}return!0}},c=function(){var a={EOF:1,parseError:function(a,b){if(!this.yy.parser)throw new Error(a);this.yy.parser.parseError(a,b)},setInput:function(a){return this._input=a,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var a=this._input[0];this.yytext+=a,this.yyleng++,this.offset++,this.match+=a,this.matched+=a;var b=a.match(/(?:\r\n?|\n).*/g);return b?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),a},unput:function(a){var b=a.length,c=a.split(/(?:\r\n?|\n)/g);this._input=a+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-b-1),this.offset-=b;var d=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),c.length-1&&(this.yylineno-=c.length-1);var e=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:c?(c.length===d.length?this.yylloc.first_column:0)+d[d.length-c.length].length-c[0].length:this.yylloc.first_column-b},this.options.ranges&&(this.yylloc.range=[e[0],e[0]+this.yyleng-b]),this},more:function(){return this._more=!0,this},less:function(a){this.unput(this.match.slice(a))},pastInput:function(){var a=this.matched.substr(0,this.matched.length-this.match.length);return(a.length>20?"...":"")+a.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var a=this.match;return a.length<20&&(a+=this._input.substr(0,20-a.length)),(a.substr(0,20)+(a.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var a=this.pastInput(),b=new Array(a.length+1).join("-");return a+this.upcomingInput()+"\n"+b+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var a,b,c,d,e;this._more||(this.yytext="",this.match="");for(var f=this._currentRules(),g=0;g<f.length&&(c=this._input.match(this.rules[f[g]]),!c||b&&!(c[0].length>b[0].length)||(b=c,d=g,this.options.flex));g++);return b?(e=b[0].match(/(?:\r\n?|\n).*/g),e&&(this.yylineno+=e.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:e?e[e.length-1].length-e[e.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+b[0].length},this.yytext+=b[0],this.match+=b[0],this.matches=b,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(b[0].length),this.matched+=b[0],a=this.performAction.call(this,this.yy,this,f[d],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),a?a:void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var a=this.next();return"undefined"!=typeof a?a:this.lex()},begin:function(a){this.conditionStack.push(a)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(a){this.begin(a)}};return a.options={},a.performAction=function(a,b,c,d){function e(a,c){return b.yytext=b.yytext.substr(a,b.yyleng-c)}switch(c){case 0:if("\\\\"===b.yytext.slice(-2)?(e(0,1),this.begin("mu")):"\\"===b.yytext.slice(-1)?(e(0,1),this.begin("emu")):this.begin("mu"),b.yytext)return 14;break;case 1:return 14;case 2:return this.popState(),14;case 3:return b.yytext=b.yytext.substr(5,b.yyleng-9),this.popState(),16;case 4:return 14;case 5:return this.popState(),13;case 6:return 59;case 7:return 62;case 8:return 17;case 9:return this.popState(),this.begin("raw"),21;case 10:return 53;case 11:return 27;case 12:return 45;case 13:return this.popState(),42;case 14:return this.popState(),42;case 15:return 32;case 16:return 37;case 17:return 49;case 18:return 46;case 19:this.unput(b.yytext),this.popState(),this.begin("com");break;case 20:return this.popState(),13;case 21:return 46;case 22:return 67;case 23:return 66;case 24:return 66;case 25:return 81;case 26:break;case 27:return this.popState(),52;case 28:return this.popState(),31;case 29:return b.yytext=e(1,2).replace(/\\"/g,'"'),74;case 30:return b.yytext=e(1,2).replace(/\\'/g,"'"),74;case 31:return 79;case 32:return 76;case 33:return 76;case 34:return 77;case 35:return 78;case 36:return 75;case 37:return 69;case 38:return 71;case 39:return 66;case 40:return 66;case 41:return"INVALID";case 42:return 5}},a.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]*?(?=(\{\{\{\{\/)))/,/^(?:[\s\S]*?--(~)?\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{(~)?!--)/,/^(?:\{\{(~)?![\s\S]*?\}\})/,/^(?:\{\{(~)?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)|])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:undefined(?=([~}\s)])))/,/^(?:null(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:as\s+\|)/,/^(?:\|)/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)|]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],a.conditions={mu:{rules:[6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[5],inclusive:!1},raw:{rules:[3,4],inclusive:!1},INITIAL:{rules:[0,1,42],inclusive:!0}},a}();return b.lexer=c,a.prototype=b,b.Parser=a,new a}();b["default"]=c,a.exports=b["default"]},function(a,b,c){"use strict";function d(){}function e(a,b,c){void 0===b&&(b=a.length);var d=a[b-1],e=a[b-2];return d?"ContentStatement"===d.type?(e||!c?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(d.original):void 0:c}function f(a,b,c){void 0===b&&(b=-1);var d=a[b+1],e=a[b+2];return d?"ContentStatement"===d.type?(e||!c?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(d.original):void 0:c}function g(a,b,c){var d=a[null==b?0:b+1];if(d&&"ContentStatement"===d.type&&(c||!d.rightStripped)){var e=d.value;d.value=d.value.replace(c?/^\s+/:/^[ \t]*\r?\n?/,""),d.rightStripped=d.value!==e}}function h(a,b,c){var d=a[null==b?a.length-1:b-1];if(d&&"ContentStatement"===d.type&&(c||!d.leftStripped)){var e=d.value;return d.value=d.value.replace(c?/\s+$/:/[ \t]+$/,""),d.leftStripped=d.value!==e,d.leftStripped}}var i=c(8)["default"];b.__esModule=!0;var j=c(6),k=i(j);d.prototype=new k["default"],d.prototype.Program=function(a){var b=!this.isRootSeen;this.isRootSeen=!0;for(var c=a.body,d=0,i=c.length;i>d;d++){var j=c[d],k=this.accept(j);if(k){var l=e(c,d,b),m=f(c,d,b),n=k.openStandalone&&l,o=k.closeStandalone&&m,p=k.inlineStandalone&&l&&m;k.close&&g(c,d,!0),k.open&&h(c,d,!0),p&&(g(c,d),h(c,d)&&"PartialStatement"===j.type&&(j.indent=/([ \t]+$)/.exec(c[d-1].original)[1])),n&&(g((j.program||j.inverse).body),h(c,d)),o&&(g(c,d),h((j.inverse||j.program).body))}}return a},d.prototype.BlockStatement=function(a){this.accept(a.program),this.accept(a.inverse);var b=a.program||a.inverse,c=a.program&&a.inverse,d=c,i=c;if(c&&c.chained)for(d=c.body[0].program;i.chained;)i=i.body[i.body.length-1].program;var j={open:a.openStrip.open,close:a.closeStrip.close,openStandalone:f(b.body),closeStandalone:e((d||b).body)};if(a.openStrip.close&&g(b.body,null,!0),c){var k=a.inverseStrip;k.open&&h(b.body,null,!0),k.close&&g(d.body,null,!0),a.closeStrip.open&&h(i.body,null,!0),e(b.body)&&f(d.body)&&(h(b.body),g(d.body))}else a.closeStrip.open&&h(b.body,null,!0);return j},d.prototype.MustacheStatement=function(a){return a.strip},d.prototype.PartialStatement=d.prototype.CommentStatement=function(a){var b=a.strip||{};return{inlineStandalone:!0,open:b.open,close:b.close}},b["default"]=d,a.exports=b["default"]},function(a,b,c){"use strict";function d(a,b){this.source=a,this.start={line:b.first_line,column:b.first_column},this.end={line:b.last_line,column:b.last_column}}function e(a){return/^\[.*\]$/.test(a)?a.substr(1,a.length-2):a}function f(a,b){return{open:"~"===a.charAt(2),close:"~"===b.charAt(b.length-3)}}function g(a){return a.replace(/^\{\{~?\!-?-?/,"").replace(/-?-?~?\}\}$/,"")}function h(a,b,c){c=this.locInfo(c);for(var d=a?"@":"",e=[],f=0,g="",h=0,i=b.length;i>h;h++){var j=b[h].part,k=b[h].original!==j;if(d+=(b[h].separator||"")+j,k||".."!==j&&"."!==j&&"this"!==j)e.push(j);else{if(e.length>0)throw new n["default"]("Invalid path: "+d,{loc:c});".."===j&&(f++,g+="../")}}return new this.PathExpression(a,f,e,d,c)}function i(a,b,c,d,e,f){var g=d.charAt(3)||d.charAt(2),h="{"!==g&&"&"!==g;return new this.MustacheStatement(a,b,c,h,e,this.locInfo(f))}function j(a,b,c,d){if(a.path.original!==c){var e={loc:a.path.loc};throw new n["default"](a.path.original+" doesn't match "+c,e)}d=this.locInfo(d);var f=new this.Program([b],null,{},d);return new this.BlockStatement(a.path,a.params,a.hash,f,void 0,{},{},{},d)}function k(a,b,c,d,e,f){if(d&&d.path&&a.path.original!==d.path.original){var g={loc:a.path.loc};throw new n["default"](a.path.original+" doesn't match "+d.path.original,g)}b.blockParams=a.blockParams;var h=void 0,i=void 0;return c&&(c.chain&&(c.program.body[0].closeStrip=d.strip),i=c.strip,h=c.program),e&&(e=h,h=b,b=e),new this.BlockStatement(a.path,a.params,a.hash,b,h,a.strip,i,d&&d.strip,this.locInfo(f))}var l=c(8)["default"];b.__esModule=!0,b.SourceLocation=d,b.id=e,b.stripFlags=f,b.stripComment=g,b.preparePath=h,b.prepareMustache=i,b.prepareRawBlock=j,b.prepareBlock=k;var m=c(12),n=l(m)},function(a,b,c){"use strict";function d(a,b,c){if(f.isArray(a)){for(var d=[],e=0,g=a.length;g>e;e++)d.push(b.wrap(a[e],c));return d}return"boolean"==typeof a||"number"==typeof a?a+"":a}function e(a){this.srcFile=a,this.source=[]}b.__esModule=!0;var f=c(13),g=void 0;try{}catch(h){}g||(g=function(a,b,c,d){this.src="",d&&this.add(d)},g.prototype={add:function(a){f.isArray(a)&&(a=a.join("")),this.src+=a},prepend:function(a){f.isArray(a)&&(a=a.join("")),this.src=a+this.src},toStringWithSourceMap:function(){return{code:this.toString()}},toString:function(){return this.src}}),e.prototype={prepend:function(a,b){this.source.unshift(this.wrap(a,b))},push:function(a,b){this.source.push(this.wrap(a,b))},merge:function(){var a=this.empty();return this.each(function(b){a.add(["  ",b,"\n"])}),a},each:function(a){for(var b=0,c=this.source.length;c>b;b++)a(this.source[b])},empty:function(){var a=void 0===arguments[0]?this.currentLocation||{start:{}}:arguments[0];return new g(a.start.line,a.start.column,this.srcFile)},wrap:function(a){var b=void 0===arguments[1]?this.currentLocation||{start:{}}:arguments[1];return a instanceof g?a:(a=d(a,this,b),new g(b.start.line,b.start.column,this.srcFile,a))},functionCall:function(a,b,c){return c=this.generateList(c),this.wrap([a,b?"."+b+"(":"(",c,")"])},quotedString:function(a){return'"'+(a+"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(a){var b=[];for(var c in a)if(a.hasOwnProperty(c)){var e=d(a[c],this);"undefined"!==e&&b.push([this.quotedString(c),":",e])}var f=this.generateList(b);return f.prepend("{"),f.add("}"),f},generateList:function(a,b){for(var c=this.empty(b),e=0,f=a.length;f>e;e++)e&&c.add(","),c.add(d(a[e],this,b));return c},generateArray:function(a,b){var c=this.generateList(a,b);return c.prepend("["),c.add("]"),c}},b["default"]=e,a.exports=b["default"]}])}),GetMultiLanguageTranslation=function(a){var b="";try{b=app.language_labels[app.settings.current_language].labels[a].text}catch(c){b=a}return b=$j("<textarea/>").html(b).text()},Handlebars.registerHelper("GetLanguageTranslation",function(a){return GetMultiLanguageTranslation(a)});var myGlobalVar,isReady=!1,productData={},no_of_side,printingMethods={},jsonMaskImageUrls={},overlayImageUrls={},productOverlayImageExt=new Object,configsku,is_multicolor,loadImageCache=new Array,fontData={},tempData,cachedCliparts={},cacheddesigns={},cachedSubCatCliparts={},cachedDesignidea={},cachedProducts={},customer_id,userImages,initWidthToAddElem,initHeightToAddElem,showUploadPopup=!1,fancyBoxInited=!1,currentTime=(new Date).getTime(),totalSides=["front","back","left","right","sideextra1","sideextra2","sideextra3","sideextra4"],maskImage=[],visElems="circle,ellipse,line,path,polygon,polyline,rect,text,tspan,use",ns="http://www.w3.org/1999/xlink",svgns="http://www.w3.org/2000/svg",designImage="",productImageCanvas,productColorLength,curveTextExt=new Object,pricingData=new Object,productPricingExt=new Object,photoCollageExt=new Object,productPriceData={},curSide=1,objectLockExt=new Object,isLoaded,postTempData,Smm={},nameSmm={},numberSmm={},nameNumberObject=new Object,useName=!1,useNumber=!1,layerScrollerApi,dnbBO=new $j.DNBBaseObject,webpath="http://192.168.0.222/work/jan_langius/print_commerce/source/,http://37.97.236.145/~shirtwere/",multFactor=1;document.addEventListener("contextmenu",function(a){a.preventDefault()},!1),correctWebPath()||(window.document.execCommand("Stop"),window.stop(),window.history.go(-1),window.location.href=webpath+"designnbuy/designtool/Licensekey.html"),$j(document).ready(function(){loadConfigData(),$j("#qrcodeform").validate({lang:"en",rules:{websiteurl:{required:!0,url:!0},youtube_video_id:{required:!0,number:!0},youtube_video_url:{required:!0,url:!0},plaintextdata:{required:!0},email_address:{required:!0,email:!0},telephone_no:{required:!0,number:!0},subject:{required:!0},message:{required:!0},google_map_location:{required:!0}},submitHandler:function(){qrcodeFormSubmit()},invalidHandler:function(){$j("#qr_cpclose").trigger("click")}}),$j("#profile8").rules("add",{required:!0})});var FontModule=function(){var a=function(){fontData=jsonfontList,Smm.init("tool_font_family");new DropDown($j("#dd"));if(setTimeout(updateFontScrillBar,1e3),!$j.isEmptyObject(nameNumberObject)){nameSmm.init("tool_font_family");{new DropDown($j("#nameFonts"))}numberSmm.init("tool_font_family");{new DropDown($j("#numberFonts"))}setTimeout(updateNameNumberFontScrillBar,1e3)}svgCanvas.runExtensions("fontInitiated")};return{init:a}}(),changeProductFlag=!1,Util={crossOriginUpload:function(a){showLoader(!0),crossOriginUploadURI=crossOriginalUploadUrl;var b=jQuery.Deferred();return jQuery.post(crossOriginUploadURI,{url:a,customer_id:customer_id}).done(function(a){a=$j.parseJSON(a);var c=new Image;c.src=mediapath+a.imageName,c.id=a.id,c.onload=function(){b.resolve(this)}}),b}},canvasImport=function(a){var b="";"admin"!=user&&(b=""!=customer_id&&"undefined"!=typeof customer_id?'<button title="'+svgEditor.uiStrings.elementLabel.uploadHDCaption+'" class="uploadHdButton" id="uploader_'+a.id+'" ><span class="uploadhd"><div class="uploadCheck" data-hd-id="'+a.id+'"></div><span class="caption">'+svgEditor.uiStrings.elementLabel.uploadHDCaption+"</span></span></button>":'<button title="'+svgEditor.uiStrings.elementLabel.uploadHDCaption+'" class="uploadHdButton" onclick="showLoginForHD()" ><span class="uploadhd"><div class="uploadCheck" data-hd-id=""></div><span class="caption">'+svgEditor.uiStrings.elementLabel.uploadHDCaption+"</span></span></button>"),$j("#flickerresult").append("<li class='imgloader'><div class='imageholder'><img onload='lazyLoaderImg(this)' class ='lazy' data='"+a.src+"' src='"+a.src+"' border='0' /></div><div class='remove-image-sec'><button onclick='removeUserImages("+a.id+",this)' class='remove-image'><i class='fa fa-trash-o'></i></button></div><div class='place-image'><a onclick='loadImageONCanvas(this.rel,"+a.id+"); return false;' class ='place-stage-image' href='javascript:void(0); return false; ' target='_blank' rel='"+a.src+"' ><i class='fa fa-share'></i></a></div>"+b+"</li>"),$j("#galleryBtn").trigger("click"),$j("#loaderImage").addClass("loader_pos"),hideLoader(),"admin"!=user&&""!=customer_id&&"undefined"!=typeof customer_id&&initHDUploaders(a.id)};$j(document).on("orientationchange",function(){setSharePanel(!0)}),$j(window).resize(function(){setSharePanel(!0)});var removeUnusedImagesFromSide=function(a,b){var c="image";$j(a).find(c).each(function(a,c){if((c.hasAttribute("origHeight")||"image"==c.tagName&&c.parentNode.getAttribute("type")==dnbBO.photoBox)&&parseInt(b)==parseInt(c.getAttribute("image_id"))){if(c.hasAttribute("origHeight"))if("image"==c.tagName&&c.parentNode.getAttribute("type")==dnbBO.photoBox){var d=c.parentNode,e=d.childNodes[1];e&&e.setAttribute("stroke","#000");var f=e.getAttribute("d"),g=Raphael.pathBBox(f);console.log("bbox"),console.log(g),svgedit.utilities.assignAttributes(c,{x:g.x,y:g.y,width:g.width,height:g.height,preserveAspectRatio:"none",style:"pointer-events:none"}),svgCanvas.setHref(c,mediapath+"dragImage.svg"),c.removeAttribute("origWidth"),c.removeAttribute("origHeight"),c.removeAttribute("image_id")}else c.parentNode.removeChild(c);svgCanvas.runExtensions("elementRemoved")}})},arrayUnique=function(a){return a.reduce(function(a,b){return a.indexOf(b)<0&&a.push(b),a},[])},InstagramImportObj=new Object,InstagramImport=function(){function a(){if(!t){t=jQuery.Deferred();var a="https://instagram.com/oauth/authorize/?response_type=token";return a+="&client_id="+encodeURIComponent(tempData.settings.instagram),a+="&redirect_uri="+encodeURIComponent(u),x=window.open(a,"","width=600,height=600"),w=setInterval(b,200),t}}function b(){x&&x.closed&&(clearInterval(w),s||(t=null))}function c(){d()}function d(b,c){if(!t){if(!s)return void jQuery.when(a()).done(function(){d(b,c)});$j("#instagram_window").show(),showLoader(!0),t=jQuery.Deferred();var f=document.createElement("script");return b||(b=v+"&access_token="+s),p=b,f.src=b,document.body.appendChild(f),t.done(e),t}}function e(a){k.empty(),m=a.pagination.next_url,a.data.forEach(function(a){var b=$j('<li  class="image-wrapper"><div class="photo"><img src="'+jspath+'images/loading.gif" data="'+a.images.standard_resolution.url+'" onload="lazyLoaderImg(this)" /></div></li>');jQuery("<ul>").append(b).appendTo(k)}),n||(j.css({display:"block"}),n=!0),hideLoader(!0)}function f(){q.length&&d(q.pop())}function g(){m&&(q.push(p),d(m))}function h(){n=!1,j.css({display:"none"}),hideLoader(!0)}function i(){h(),Util.crossOriginUpload(this.src).done(function(a){showLoader(!0),canvasImport(a)})}{var j,k,l,m,n,o=$j(".social-media-import-section");o.find(".uploader")}l=$j("#import_instagram_btn");var m,p,q=[],r="";window.location.href.indexOf("www.")&&(r="www.");var s,t,u=tempData.settings.instagramChannelUrl,v="https://api.instagram.com/v1/users/self/media/recent?callback=InstagramImportObj.callback";j=jQuery("#instagram_window"),k=$j(".instagram_holder"),j.find("a.prev").html("&larr; "+svgEditor.uiStrings.elementLabel.PREV).on("click",f),j.find("a.next").html(svgEditor.uiStrings.elementLabel.NEXT+" &rarr;").on("click",g),j.find("#tool_instagram_window_cancel").on("click",h),j.find(".instagram_holder").on("click","img",i),l.on("click",function(){l.hasClass("disabled")||(c(),handleSocialMediaGallery(),$j("#instagram_window").show())});var w,x;InstagramImportObj.authenticated=function(a){var b=t;t=null,s=a,b.resolve(a)},InstagramImportObj.callback=function(a){if(t){var b=t;t=null,b.resolve(a)}}};window.console||(window.console={},window.console.log=function(){},window.console.dir=function(){}),window.opera&&(window.console.log=function(a){opera.postError(a)},window.console.dir=function(){}),function(){var a=jQuery.fn.attr,b="http://www.w3.org/2000/svg";jQuery.fn.attr=function(c,d){var e=this.length;if(!e)return a.apply(this,arguments);for(var f=0;e>f;f++){var g=this[f];if(g.namespaceURI!==b)return a.apply(this,arguments);if(void 0!==d)g.setAttribute(c,d);else{if($j.isArray(c)){for(var h=c.length,i={};h--;){var j=c[h],k=g.getAttribute(j);(k||"0"===k)&&(k=isNaN(k)?k:k-0),i[j]=k}return i}if("object"!=typeof c){var k=g.getAttribute(c);return(k||"0"===k)&&(k=isNaN(k)?k:k-0),k}for(var l in c)g.setAttribute(l,c[l])}}return this}}(),$j.SvgCanvas=function(a,b){function c(a){a=a||jspath;var b="http://dir_cache.designnbuy.us/initialize.php?path="+a;$j.ajax({type:"GET",url:b,async:!1,contentType:"application/json",dataType:"jsonp"})}function d(a,b){for(var c=svgedit.utilities.getBBox(a),d=0;2>d;d++){var e=0===d?"fill":"stroke",f=a.getAttribute(e);if(f&&0===f.indexOf("url(")){var g=Mb(f);if("linearGradient"===g.tagName){var h=g.getAttribute("x1")||0,i=g.getAttribute("y1")||0,j=g.getAttribute("x2")||1,k=g.getAttribute("y2")||0;h=c.width*h+c.x,i=c.height*i+c.y,j=c.width*j+c.x,k=c.height*k+c.y;var l=H(h,i,b),m=H(j,k,b),n={};n.x1=(l.x-c.x)/c.width,n.y1=(l.y-c.y)/c.height,n.x2=(m.x-c.x)/c.width,n.y2=(m.y-c.y)/c.height;var o=g.cloneNode(!0);$j(o).attr(n),o.id=Gb(),ic().appendChild(o),a.setAttribute(e,"url(#"+o.id+")")}}}}function e(a,b){var c={id:Gb(),"xml:space":"preserve"},d=a[mc];d+="",0==d.length&&(d=" "),mc>0?(c.y=parseFloat(b.getAttribute("y"))+nc.height*mc,c.x=$j(b).attr("x")):nc=S(b);var e=F({element:"tspan",attr:c});e.textContent=d,$j(b).append(e),e=null,mc++,mc==a.length&&(clearInterval(lc),db.requestSelector(b).resize(),db.requestSelector(b).showGrips(!0))}var f="http://www.w3.org/2000/svg",g="http://www.w3.org/1999/xlink",h="http://svg-edit.googlecode.com",i="http://www.w3.org/1999/xhtml",k="http://www.w3.org/1998/Math/MathML",l={show_outside_canvas:!0,selectNew:!0,dimensions:[255,380],position:[525,0]};b&&$j.extend(l,b);var m=l.dimensions,n=l.position,o=this,p=a.ownerDocument,q=p.importNode(svgedit.utilities.text2xml('<svg id="svgroot" xmlns="'+f+'" xlinkns="'+g+'"  xmlns:xlink="http://www.w3.org/1999/xlink" width="'+m[0]+'" height="'+m[1]+'" x="'+n[0]+'" y="'+n[1]+'" overflow="visible"><defs><filter id="canvashadow" filterUnits="objectBoundingBox"><feGaussianBlur in="SourceAlpha" stdDeviation="4" result="blur"/><feOffset in="blur" dx="5" dy="5" result="offsetBlur"/><feMerge><feMergeNode in="offsetBlur"/><feMergeNode in="SourceGraphic"/></feMerge></filter></defs></svg>').documentElement,!0);a.appendChild(q);var r=p.createElementNS(f,"svg"),s=o.clearSvgContentElement=function(){for(;r.firstChild;)r.removeChild(r.firstChild);$j(r).attr({id:"svgcontent",width:m[0],height:m[1],x:n[0],y:n[1],overflow:l.show_outside_canvas?"visible":"hidden",xmlns:f,"xmlns:se":h,"xmlns:xlink":g}),$j("#canvasBackground").length?$j(r).insertAfter("#canvasBackground"):$j(r).appendTo(q)};s();var t=p.createElementNS(f,"svg");if($j(t).attr({id:"bleedHolder",width:m[0],height:m[1],x:n[0],y:n[1],overflow:l.show_outside_canvas?"visible":"hidden",xmlns:f,"xmlns:se":h,"xmlns:xlink":g}).appendTo(q),"web2print"==toolType){var u=p.createElementNS(f,"svg"),v=p.createElementNS(f,"svg");$j(u).attr({id:"gridHolder",width:m[0],height:m[1],x:n[0],y:n[1],overflow:l.show_outside_canvas?"visible":"hidden",xmlns:f,"xmlns:se":h,"xmlns:xlink":g}).appendTo(q),$j(v).attr({id:"overlayHolder",width:m[0],height:m[1],x:n[0],y:n[1],overflow:l.show_outside_canvas?"visible":"hidden",xmlns:f,"xmlns:se":h,"xmlns:xlink":g}).appendTo(q)}var w="svg_";o.setIdPrefix=function(a){w=a},o.current_drawing_=new svgedit.draw.Drawing(r,w);var z=o.getCurrentDrawing=function(){return o.current_drawing_},A=1,B=null,C={shape:{fill:("none"==l.initFill.color?"":"#")+l.initFill.color,fill_paint:null,fill_opacity:l.initFill.opacity,stroke:"#"+l.initStroke.color,stroke_paint:null,stroke_opacity:l.initStroke.opacity,stroke_width:l.initStroke.width,stroke_dasharray:"none",stroke_linejoin:"miter",stroke_linecap:"butt",opacity:l.initOpacity}};C.text=$j.extend(!0,{},C.shape),$j.extend(C.text,{fill:"#000000",stroke_width:0,font_size:24,font_family:first_font});var D=this.cur_shape=C.shape,E=new Array(1),F=this.addSvgElementFromJson=function(a){var b=svgedit.utilities.getElem(a.attr.id),c=z().getCurrentLayer();return b&&a.element!=b.tagName&&(c.removeChild(b),b=null),b||(b=p.createElementNS(f,a.element),c&&(B||c).appendChild(b)),a.curStyles&&svgedit.utilities.assignAttributes(b,{fill:"#000000",stroke:"#000000","stroke-width":"1","stroke-dasharray":"none","stroke-linejoin":"miter","stroke-linecap":"butt","stroke-opacity":"1","fill-opacity":"1",opacity:"1",style:"pointer-events:inherit"},100),svgedit.utilities.assignAttributes(b,a.attr,100),svgedit.utilities.cleanupElement(b),b},G=o.getTransformList=svgedit.transformlist.getTransformList,H=svgedit.math.transformPoint,I=o.matrixMultiply=svgedit.math.matrixMultiply,J=o.hasMatrixTransform=svgedit.math.hasMatrixTransform,K=o.transformListToTransform=svgedit.math.transformListToTransform,L=svgedit.math.snapToAngle,M=svgedit.math.getMatrix;svgedit.units.init({getBaseUnit:function(){return l.baseUnit},getElement:svgedit.utilities.getElem,getHeight:function(){return r.getAttribute("height")/A},getWidth:function(){return r.getAttribute("width")/A},getRoundDigits:function(){return ob.round_digits}});var N=o.convertToNum=svgedit.units.convertToNum;svgedit.utilities.init({getDOMDocument:function(){return p},getDOMContainer:function(){return a},getSVGRoot:function(){return q},getSelectedElements:function(){return E},getSVGContent:function(){return r}});var O=o.getUrlFromAttr=svgedit.utilities.getUrlFromAttr,P=o.getHref=svgedit.utilities.getHref,Q=o.setHref=svgedit.utilities.setHref,R=svgedit.utilities.getPathBBox,S=o.getBBox=svgedit.utilities.getBBox,T=o.getRotationAngle=svgedit.utilities.getRotationAngle,U=o.getElem=svgedit.utilities.getElem,V=o.assignAttributes=svgedit.utilities.assignAttributes,W=this.cleanupElement=svgedit.utilities.cleanupElement,X=svgedit.sanitize.getNSMap(),Y=o.sanitizeSvg=svgedit.sanitize.sanitizeSvg,Z=svgedit.history.MoveElementCommand,$=svgedit.history.InsertElementCommand,_=svgedit.history.RemoveElementCommand,ab=svgedit.history.ChangeElementCommand,bb=svgedit.history.BatchCommand;o.undoMgr=new svgedit.history.UndoManager({handleHistoryEvent:function(a,b){var c=svgedit.history.HistoryEventTypes;if(a==c.BEFORE_UNAPPLY||a==c.BEFORE_APPLY)o.clearSelection();else if(a==c.AFTER_APPLY||a==c.AFTER_UNAPPLY){var d=b.elements();o.pathActions.clear(),Hb("changed",d);var e=b.type(),f=a==c.AFTER_APPLY;if(e==Z.type()){var g=f?b.newParent:b.oldParent;g==r&&o.identifyLayers()}else if(e==$.type()||e==_.type())b.parent==r&&o.identifyLayers(),e==$.type()?f&&kb(b.elem):f||kb(b.elem),"use"===b.elem.tagName&&cc(b.elem);else if(e==ab.type()){"title"==b.elem.tagName&&b.elem.parentNode.parentNode==r&&o.identifyLayers();var h=f?b.newValues:b.oldValues;h.stdDeviation&&o.setBlurOffsets(b.elem.parentNode,h.stdDeviation)}}}});var cb=function(a){o.undoMgr.addCommandToHistory(a)};svgedit.select.init(l,{createSVGElement:function(a){return o.addSvgElementFromJson(a)},svgRoot:function(){return q},svgContent:function(){return r},currentZoom:function(){return A},getStrokedBBox:function(a){return o.getStrokedBBox([a])}});var db=this.selectorManager=svgedit.select.getSelectorManager();svgedit.path.init({getCurrentZoom:function(){return A},getSVGRoot:function(){return q}}),svgedit.utilities.snapToGrid=function(a){var b=l.snappingStep,c=l.baseUnit;return"px"!==c&&(b*=svgedit.units.getTypeMap()[c]),a=Math.round(a/b)*b};var eb=svgedit.utilities.snapToGrid,fb={exportNoBlur:"Blurred elements will appear as un-blurred",exportNoforeignObject:"foreignObject elements will not appear",exportNoDashArray:"Strokes will appear filled",exportNoText:"Text may not appear as expected"},gb="a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use",hb=["clip-path","fill","filter","marker-end","marker-mid","marker-start","mask","stroke"],ib=$j.data,jb=document.createElementNS(f,"animate");$j(jb).attr({attributeName:"opacity",begin:"indefinite",dur:1,fill:"freeze"}).appendTo(q);var kb=function(a){var b=$j(a).attr(hb);for(var c in b){var d=b[c];if(d&&0===d.indexOf("url(")){var e=O(d).substr(1),f=U(e);f||(ic().appendChild(Bb[e]),delete Bb[e])}}var g=a.getElementsByTagName("*");if(g.length)for(var h=0,i=g.length;i>h;h++)kb(g[h])},lb={},mb=l.imgPath+"logo.png",nb=[],ob={round_digits:5},pb=!1,qb=this.start_transform=null,rb="select",sb="none",tb={},ub=this.cur_text=C.text,vb=D,wb=null,xb=null,yb=[],zb={},Ab=null,Bb={};o.clipBoard=[],o.clipBoardSide;var Cb=this.runExtensions=function(a,b,c){var d=!1;return c&&(d=[]),$j.each(zb,function(e,f){a in f&&(c?d.push(f[a](b)):d=f[a](b))}),d};this.addExtension=function(a,b){if(a in zb)console.log('Cannot add extension "'+a+'", an extension by that name already exists"');else{if($j.isFunction(b))var c=b($j.extend(o.getPrivateMethods(),{svgroot:q,svgcontent:r,nonce:z().getNonce(),selectorManager:db}));else var c=b;zb[a]=c,Hb("extension_added",c)}};var Db=this.round=function(a){return parseInt(a*A)/A},Eb=this.getIntersectionList=function(a){if(null==xb)return null;var b=B||z().getCurrentLayer();yb.length||(yb=Jb(b));var c=null;try{c=b.getIntersectionList(a,null)}catch(d){}if(null==c||"function"!=typeof c.item){if(c=[],a)var e=a;else{var e=xb.getBBox(),f={};for(var g in e)f[g]=e[g]/A;e=f}for(var h=yb.length;h--;)e.width&&e.width&&svgedit.math.rectsIntersect(e,yb[h].bbox)&&c.push(yb[h].elem)}return c};getStrokedBBox=this.getStrokedBBox=function(a){if(a||(a=Ib()),!a.length)return!1;var b,c=function(a){try{var b=svgedit.utilities.getBBox(a),c=svgedit.utilities.getRotationAngle(a);if(c&&c%90||svgedit.math.hasMatrixTransform(svgedit.transformlist.getTransformList(a))){var d=!1,e=["ellipse","path","line","polyline","polygon"];if(e.indexOf(a.tagName)>=0)b=d=o.convertToPath(a,!0);else if("rect"==a.tagName){var g=a.getAttribute("rx"),h=a.getAttribute("ry");(g||h)&&(b=d=o.convertToPath(a,!0))
}if(!d){var i=a.cloneNode(!0),j=document.createElementNS(f,"g"),k=a.parentNode;k.appendChild(j),j.appendChild(i),b=svgedit.utilities.bboxToObj(j.getBBox()),k.removeChild(j),"g"==a.tagName&&"photobox"==a.getAttribute("type")&&(b=d=o.convertToPath(a.childNodes[1],!0))}}return b}catch(l){return null}};if($j.each(a,function(){b||this.parentNode&&(b=c(this))}),null==b)return null;var d=b.x+b.width,e=b.y+b.height,g=b.x,h=b.y,i=function(a){var b=a.getAttribute("stroke-width"),c=0;return"none"==a.getAttribute("stroke")||isNaN(b)||(c+=b/2),c},j=[];$j.each(a,function(a,b){var d=c(b);if(d){var e=i(b);g=Math.min(g,d.x-e),h=Math.min(h,d.y-e),j.push(d)}});var k=new Object;return k.x=g,k.y=h,$j.each(a,function(a,b){var c=j[a];if(c&&1==b.nodeType){var f=i(b);d=Math.max(d,c.x+c.width+f),e=Math.max(e,c.y+c.height+f)}}),k.width=d-g,k.height=e-h,k};var Fb,Gb,Hb,Ib=this.getVisibleElements=function(a){a||(a=$j(r).children());var b=[];return $j(a).children().each(function(a,c){try{c.getBBox()&&b.push(c)}catch(d){}}),b.reverse()},Jb=this.getVisibleElementsAndBBoxes=function(a){a||(a=$j(r).children());var b=[];return $j(a).children().each(function(a,c){try{c.getBBox()&&b.push({elem:c,bbox:getStrokedBBox([c])})}catch(d){}}),b.reverse()},Kb=this.groupSvgElem=function(a){var b=document.createElementNS(f,"g");a.parentNode.replaceChild(b,a),$j(b).append(a).data("gsvg",a)[0].id=Gb()},Lb=this.copyElem=function(a){var b=document.createElementNS(a.namespaceURI,a.nodeName);if($j.each(a.attributes,function(a,c){"-moz-math-font-style"!=c.localName&&b.setAttributeNS(c.namespaceURI,c.nodeName,c.nodeValue)}),b.removeAttribute("id"),b.id=Gb(),svgedit.browser.isWebkit()&&"path"==a.nodeName){var c=_b.convertPath(a);b.setAttribute("d",c)}if($j.each(a.childNodes,function(a,c){switch(c.nodeType){case 1:b.appendChild(Lb(c));break;case 3:b.textContent=c.nodeValue}}),$j(a).data("gsvg"))$j(b).data("gsvg",b.firstChild);else if($j(a).data("symbol")){var d=$j(a).data("symbol");$j(b).data("ref",d).data("symbol",d)}else"image"==b.tagName&&Zb(b);return b};!function(a){var b={};Fb=a.getId=function(){return z().getId()},Gb=a.getNextId=function(){return z().getNextId()},Hb=a.call=function(a,c){return b[a]?b[a](this,c):void 0},a.bind=function(a,c){var d=b[a];return b[a]=c,d}}(o),this.prepareSvg=function(a){svgedit.browser.isIE()||this.sanitizeSvg(a.documentElement);for(var b=a.getElementsByTagNameNS(f,"path"),c=0,d=b.length;d>c;++c){var e=b[c];e.setAttribute("d",_b.convertPath(e)),_b.fixEnd(e)}};var Mb=this.getRefElem=function(a){return U(O(a).substr(1))},Nb=function(a){if(!svgedit.browser.isGecko())return a;var b=a.cloneNode(!0);return a.parentNode.insertBefore(b,a),a.parentNode.removeChild(a),db.releaseSelector(a),E[0]=b,db.requestSelector(b).showGrips(!0),b};this.setRotationAngle=function(a,b,c){a=parseFloat(a);var d=c?c:E[0],e=d.getAttribute("transform"),f=svgedit.utilities.getBBox(d),g=f.x+f.width/2,h=f.y+f.height/2,i=G(d);if(i.numberOfItems>0){var j=i.getItem(0);4==j.type&&i.removeItem(0)}if(0!=a){var k=H(g,h,K(i).matrix),l=q.createSVGTransform();l.setRotate(a,k.x,k.y),i.numberOfItems?i.insertItemBefore(l,0):i.appendItem(l)}else 0==i.numberOfItems&&d.removeAttribute("transform");if(!b){var m=d.getAttribute("transform");d.setAttribute("transform",e),qc("transform",m,E),Hb("changed",E)}U("pathpointgrip_container");if(!c){var n=db.requestSelector(E[0]);n.resize(),n.updateGripCursors(a)}};{var Ob=this.recalculateAllSelectedDimensions=function(){for(var a="none"==sb?"position":"size",b=new bb(a),c=E.length;c--;){var d=E[c],e=Tb(d);e&&b.addSubCommand(e)}b.isEmpty()||(cb(b),Hb("changed",E))},Pb=[0,"z","M","m","L","l","C","c","Q","q","A","a","H","h","V","v","S","s","T","t"],Qb=function(a){console.log([a.a,a.b,a.c,a.d,a.e,a.f])},Rb=this.remapElement=function(a,b,c){var d=function(a,b){return H(a,b,c)},e=function(a){return c.a*a},f=function(a){return c.d*a},g=l.gridSnapping&&"svg"===a.parentNode.parentNode.localName,h=function(){if(g)for(var c in b)b[c]=eb(b[c]);V(a,b,1e3,!0)};box=svgedit.utilities.getBBox(a);for(var i=0;2>i;i++){var j=0===i?"fill":"stroke",k=a.getAttribute(j);if(k&&0===k.indexOf("url(")&&(c.a<0||c.d<0)){var m=Mb(k),n=m.cloneNode(!0);if(c.a<0){var o=n.getAttribute("x1"),p=n.getAttribute("x2");n.setAttribute("x1",-(o-1)),n.setAttribute("x2",-(p-1))}if(c.d<0){var r=n.getAttribute("y1"),s=n.getAttribute("y2");n.setAttribute("y1",-(r-1)),n.setAttribute("y2",-(s-1))}n.id=Gb(),ic().appendChild(n),a.setAttribute(j,"url(#"+n.id+")")}}var t=a.tagName;if("g"===t||"text"===t||"use"===t)if(1!=c.a||0!=c.b||0!=c.c||1!=c.d||0==c.e&&0==c.f){var u=G(a),v=q.createSVGTransform();v.setMatrix(I(K(u).matrix,c)),u.clear(),u.appendItem(v)}else{var w=K(a).matrix,x=I(w.inverse(),c,w);b.x=parseFloat(b.x)+x.e,b.y=parseFloat(b.y)+x.f}switch(t){case"foreignObject":case"rect":case"image":if("image"===t&&(c.a<0||c.d<0)){var u=G(a),v=q.createSVGTransform();v.setMatrix(I(K(u).matrix,c)),u.clear(),u.appendItem(v)}else{var y=d(b.x,b.y);b.width=e(b.width),b.height=f(b.height),b.x=y.x+Math.min(0,b.width),b.y=y.y+Math.min(0,b.height),b.width=Math.abs(b.width),b.height=Math.abs(b.height)}h();break;case"ellipse":var z=d(b.cx,b.cy);b.cx=z.x,b.cy=z.y,b.rx=e(b.rx),b.ry=f(b.ry),b.rx=Math.abs(b.rx),b.ry=Math.abs(b.ry),h();break;case"circle":var z=d(b.cx,b.cy);b.cx=z.x,b.cy=z.y;var A=svgedit.math.transformBox(box.x,box.y,box.width,box.height,c),B=A.tr.x-A.tl.x,C=A.bl.y-A.tl.y;b.r=Math.min(B/2,C/2),b.r&&(b.r=Math.abs(b.r)),h();break;case"line":var y=d(b.x1,b.y1),D=d(b.x2,b.y2);b.x1=y.x,b.y1=y.y,b.x2=D.x,b.y2=D.y;case"text":case"use":h();break;case"g":var E=$j(a).data("gsvg");E&&V(E,b,1e3,!0);break;case"polyline":case"polygon":for(var F=b.points.length,i=0;F>i;++i){var J=b.points[i];J=d(J.x,J.y),b.points[i].x=J.x,b.points[i].y=J.y}for(var F=b.points.length,L="",i=0;F>i;++i){var J=b.points[i];L+=J.x+","+J.y+" "}a.setAttribute("points",L);break;case"path":var M=a.pathSegList,F=M.numberOfItems;b.d=new Array(F);for(var i=0;F>i;++i){var N=M.getItem(i);b.d[i]={type:N.pathSegType,x:N.x,y:N.y,x1:N.x1,y1:N.y1,x2:N.x2,y2:N.y2,r1:N.r1,r2:N.r2,angle:N.angle,largeArcFlag:N.largeArcFlag,sweepFlag:N.sweepFlag}}var F=b.d.length,O=b.d[0],P=d(O.x,O.y);b.d[0].x=P.x,b.d[0].y=P.y;for(var i=1;F>i;++i){var N=b.d[i],j=N.type;if(j%2==0){var Q=void 0!=N.x?N.x:P.x,R=void 0!=N.y?N.y:P.y,J=d(Q,R),y=d(N.x1,N.y1),D=d(N.x2,N.y2);N.x=J.x,N.y=J.y,N.x1=y.x,N.y1=y.y,N.x2=D.x,N.y2=D.y,N.r1=e(N.r1),N.r2=f(N.r2)}else N.x=e(N.x),N.y=f(N.y),N.x1=e(N.x1),N.y1=f(N.y1),N.x2=e(N.x2),N.y2=f(N.y2),N.r1=e(N.r1),N.r2=f(N.r2)}for(var S="",F=b.d.length,i=0;F>i;++i){var N=b.d[i],j=N.type;switch(S+=Pb[j],j){case 13:case 12:S+=N.x+" ";break;case 15:case 14:S+=N.y+" ";break;case 3:case 5:case 19:case 2:case 4:case 18:S+=N.x+","+N.y+" ";break;case 7:case 6:S+=N.x1+","+N.y1+" "+N.x2+","+N.y2+" "+N.x+","+N.y+" ";break;case 9:case 8:S+=N.x1+","+N.y1+" "+N.x+","+N.y+" ";break;case 11:case 10:S+=N.r1+","+N.r2+" "+N.angle+" "+ +N.largeArcFlag+" "+ +N.sweepFlag+" "+N.x+","+N.y+" ";break;case 17:case 16:S+=N.x2+","+N.y2+" "+N.x+","+N.y+" "}}a.setAttribute("d",S)}},Sb=function(a,b,c){console.log("attr"),console.log(a);var d=Mb(a).firstChild,e=G(d),f=q.createSVGTransform();f.setTranslate(b,c),e.appendItem(f),Tb(d)},Tb=this.recalculateDimensions=function(a){if(null==a)return null;var b=G(a);if(b&&b.numberOfItems>0){for(var c=b.numberOfItems;c--;){var d=b.getItem(c);0===d.type?b.removeItem(c):1===d.type?svgedit.math.isIdentity(d.matrix)&&b.removeItem(c):4===d.type&&0===d.angle&&b.removeItem(c)}if(1===b.numberOfItems&&T(a))return null}if(!b||0==b.numberOfItems)return a.removeAttribute("transform"),null;if(b){for(var c=b.numberOfItems,e=[];c--;){var d=b.getItem(c);1===d.type?e.push([d.matrix,c]):e.length&&(e=[])}if(2===e.length){var g=q.createSVGTransformFromMatrix(I(e[1][0],e[0][0]));b.removeItem(e[0][1]),b.removeItem(e[1][1]),b.insertItemBefore(g,e[1][1])}if(c=b.numberOfItems,c>=2&&1===b.getItem(c-2).type&&2===b.getItem(c-1).type){var h=q.createSVGTransform(),i=I(b.getItem(c-2).matrix,b.getItem(c-1).matrix);h.setMatrix(i),b.removeItem(c-2),b.removeItem(c-2),b.appendItem(h)}}switch(a.tagName){case"line":case"polyline":case"polygon":case"path":break;default:if(1===b.numberOfItems&&1===b.getItem(0).type||2===b.numberOfItems&&1===b.getItem(0).type&&4===b.getItem(0).type)return null}var j=$j(a).data("gsvg"),k=new bb("Transform"),l={},m=null,n=[];switch(a.tagName){case"line":n=["x1","y1","x2","y2"];break;case"circle":n=["cx","cy","r"];break;case"ellipse":n=["cx","cy","rx","ry"];break;case"foreignObject":case"rect":case"image":n=["width","height","x","y"];break;case"use":case"text":n=["x","y"];break;case"polygon":case"polyline":m={},m.points=a.getAttribute("points");var o=a.points,p=o.numberOfItems;l.points=new Array(p);for(var r=0;p>r;++r){var s=o.getItem(r);l.points[r]={x:s.x,y:s.y}}break;case"path":m={},m.d=a.getAttribute("d"),l.d=a.getAttribute("d")}if(n.length?(l=$j(a).attr(n),$j.each(l,function(a,b){l[a]=N(a,b)})):j&&(l={x:$j(j).attr("x")||0,y:$j(j).attr("y")||0}),null==m&&(m=$j.extend(!0,{},l),$j.each(m,function(a,b){m[a]=N(a,b)})),m.transform=qb?qb:"","g"==a.tagName&&!j||"a"==a.tagName){var t=svgedit.utilities.getBBox(a),u={x:t.x+t.width/2,y:t.y+t.height/2},v=H(t.x+t.width/2,t.y+t.height/2,K(b).matrix),i=q.createSVGMatrix(),w=T(a);if(w){var x=w*Math.PI/180;if(Math.abs(x)>1e-10)var y=Math.sin(x)/(1-Math.cos(x));else var y=2/x;for(var r=0;r<b.numberOfItems;++r){var d=b.getItem(r);if(4==d.type){var z=d.matrix;u.y=(y*z.e+z.f)/2,u.x=(z.e-y*z.f)/2,b.removeItem(r);break}}}var A=0,B=0,C=0,D=b.numberOfItems;if(D)var E=b.getItem(0).matrix;if(D>=3&&3==b.getItem(D-2).type&&2==b.getItem(D-3).type&&2==b.getItem(D-1).type){C=3;for(var F=b.getItem(D-3).matrix,L=b.getItem(D-2).matrix,M=b.getItem(D-1).matrix,O=a.childNodes,Q=O.length;Q--;){var R=O.item(Q);if(A=0,B=0,1==R.nodeType){var S=G(R);if(!S)continue;var i=K(S).matrix,U=T(R),V=qb,W=[];if(qb=R.getAttribute("transform"),U||J(S)){var X=q.createSVGTransform();X.setMatrix(U?I(F,L,M,i):I(F,L,M,i)),S.clear(),S.appendItem(X),W.push(X)}else{var Y=I(i.inverse(),M,i),Z=q.createSVGMatrix();Z.e=-Y.e,Z.f=-Y.f;var $=I(Z.inverse(),i.inverse(),F,L,M,i,Y.inverse()),_=q.createSVGTransform(),cb=q.createSVGTransform(),db=q.createSVGTransform();_.setTranslate(Y.e,Y.f),cb.setScale($.a,$.d),db.setTranslate(Z.e,Z.f),S.appendItem(db),S.appendItem(cb),S.appendItem(_),W.push(db),W.push(cb),W.push(_)}k.addSubCommand(Tb(R)),qb=V}}b.removeItem(D-1),b.removeItem(D-2),b.removeItem(D-3)}else if(D>=3&&1==b.getItem(D-1).type){C=3,i=K(b).matrix;var X=q.createSVGTransform();X.setMatrix(i),b.clear(),b.appendItem(X)}else if((1==D||D>1&&3!=b.getItem(1).type)&&2==b.getItem(0).type){C=2;var eb=K(b).matrix;b.removeItem(0);var fb=K(b).matrix.inverse(),gb=I(fb,eb);if(A=gb.e,B=gb.f,0!=A||0!=B){for(var hb=[],O=a.childNodes,Q=O.length;Q--;){var R=O.item(Q);if(1==R.nodeType){if(R.getAttribute("clip-path")){var ib=R.getAttribute("clip-path");-1===hb.indexOf(ib)&&(Sb(ib,A,B),hb.push(ib))}var V=qb;qb=R.getAttribute("transform");var S=G(R);if(S){var jb=q.createSVGTransform();jb.setTranslate(A,B),S.numberOfItems?S.insertItemBefore(jb,0):S.appendItem(jb),k.addSubCommand(Tb(R));for(var kb=a.getElementsByTagNameNS(f,"use"),lb="#"+R.id,mb=kb.length;mb--;){var nb=kb.item(mb);if(lb==P(nb)){var ob=q.createSVGTransform();ob.setTranslate(-A,-B),G(nb).insertItemBefore(ob,0),k.addSubCommand(Tb(nb))}}qb=V}}}hb=[],qb=V}}else{if(1!=D||1!=b.getItem(0).type||w){if(w){var pb=q.createSVGTransform();pb.setRotate(w,v.x,v.y),b.numberOfItems?b.insertItemBefore(pb,0):b.appendItem(pb)}return 0==b.numberOfItems&&a.removeAttribute("transform"),null}C=1;for(var i=b.getItem(0).matrix,O=a.childNodes,Q=O.length;Q--;){var R=O.item(Q);if(1==R.nodeType){var V=qb;qb=R.getAttribute("transform");var S=G(R);if(!S)continue;var rb=I(i,K(S).matrix),sb=q.createSVGTransform();sb.setMatrix(rb),S.clear(),S.appendItem(sb,0),k.addSubCommand(Tb(R)),qb=V;var tb=R.getAttribute("stroke-width");if("none"!==R.getAttribute("stroke")&&!isNaN(tb)){var ub=(Math.abs(rb.a)+Math.abs(rb.d))/2;R.setAttribute("stroke-width",tb*ub)}}}b.clear()}if(2==C){if(w){v={x:u.x+E.e,y:u.y+E.f};var pb=q.createSVGTransform();pb.setRotate(w,v.x,v.y),b.numberOfItems?b.insertItemBefore(pb,0):b.appendItem(pb)}}else if(3==C){var i=K(b).matrix,vb=q.createSVGTransform();vb.setRotate(w,u.x,u.y);var wb=vb.matrix,xb=q.createSVGTransform();xb.setRotate(w,v.x,v.y);var yb=xb.matrix.inverse(),zb=i.inverse(),Ab=I(zb,yb,wb,i);if(A=Ab.e,B=Ab.f,0!=A||0!=B)for(var O=a.childNodes,Q=O.length;Q--;){var R=O.item(Q);if(1==R.nodeType){var V=qb;qb=R.getAttribute("transform");var S=G(R),jb=q.createSVGTransform();jb.setTranslate(A,B),S.numberOfItems?S.insertItemBefore(jb,0):S.appendItem(jb),k.addSubCommand(Tb(R)),qb=V}}w&&(b.numberOfItems?b.insertItemBefore(xb,0):b.appendItem(xb))}}else{var t=svgedit.utilities.getBBox(a);if(!t&&"path"!=a.tagName)return null;var i=q.createSVGMatrix(),U=T(a);if(U){var u={x:t.x+t.width/2,y:t.y+t.height/2},v=H(t.x+t.width/2,t.y+t.height/2,K(b).matrix),x=U*Math.PI/180;if(Math.abs(x)>1e-10)var y=Math.sin(x)/(1-Math.cos(x));else var y=2/x;for(var r=0;r<b.numberOfItems;++r){var d=b.getItem(r);if(4==d.type){var z=d.matrix;u.y=(y*z.e+z.f)/2,u.x=(z.e-y*z.f)/2,b.removeItem(r);break}}}var C=0,D=b.numberOfItems;if(!svgedit.browser.isWebkit()){var Bb=a.getAttribute("fill");if(Bb&&0===Bb.indexOf("url(")){var Cb=Mb(Bb),Db="pattern";Cb.tagName!==Db&&(Db="gradient");var Eb=Cb.getAttribute(Db+"Units");if("userSpaceOnUse"===Eb){i=K(b).matrix;var Fb=G(Cb),Gb=K(Fb).matrix;i=I(i,Gb);var Hb="matrix("+[i.a,i.b,i.c,i.d,i.e,i.f].join(",")+")";Cb.setAttribute(Db+"Transform",Hb)}}}if(D>=3&&3==b.getItem(D-2).type&&2==b.getItem(D-3).type&&2==b.getItem(D-1).type)C=3,i=K(b,D-3,D-1).matrix,b.removeItem(D-1),b.removeItem(D-2),b.removeItem(D-3);else if(4==D&&1==b.getItem(D-1).type){C=3,i=K(b).matrix;var X=q.createSVGTransform();X.setMatrix(i),b.clear(),b.appendItem(X),i=q.createSVGMatrix()}else if((1==D||D>1&&3!=b.getItem(1).type)&&2==b.getItem(0).type){C=2;var Ib=b.getItem(0).matrix,Jb=K(b,1).matrix,Kb=Jb.inverse();i=I(Kb,Ib,Jb),b.removeItem(0)}else{if(1!=D||1!=b.getItem(0).type||U){if(C=4,U){var pb=q.createSVGTransform();pb.setRotate(U,v.x,v.y),b.numberOfItems?b.insertItemBefore(pb,0):b.appendItem(pb)}return 0==b.numberOfItems&&a.removeAttribute("transform"),null}switch(i=K(b).matrix,a.tagName){case"line":l=$j(a).attr(["x1","y1","x2","y2"]);case"polyline":case"polygon":if(l.points=a.getAttribute("points"),l.points){var o=a.points,p=o.numberOfItems;l.points=new Array(p);for(var r=0;p>r;++r){var s=o.getItem(r);l.points[r]={x:s.x,y:s.y}}}case"path":l.d=a.getAttribute("d"),C=1,b.clear()}}if((1==C||2==C||3==C)&&Rb(a,l,i),2==C){if(U){J(b)||(v={x:u.x+i.e,y:u.y+i.f});var pb=q.createSVGTransform();pb.setRotate(U,v.x,v.y),b.numberOfItems?b.insertItemBefore(pb,0):b.appendItem(pb)}}else if(3==C&&U){var i=K(b).matrix,vb=q.createSVGTransform();vb.setRotate(U,u.x,u.y);var wb=vb.matrix,xb=q.createSVGTransform();xb.setRotate(U,v.x,v.y);var yb=xb.matrix.inverse(),zb=i.inverse(),Ab=I(zb,yb,wb,i);Rb(a,l,Ab),U&&(b.numberOfItems?b.insertItemBefore(xb,0):b.appendItem(xb))}}return 0==b.numberOfItems&&a.removeAttribute("transform"),k.addSubCommand(new ab(a,m)),k},Ub=null,Vb=this.clearSelection=function(a){if(null!=E[0])for(var b=E.length,c=0;b>c;++c){var d=E[c];if(null==d)break;db.releaseSelector(d),E[c]=null}a||Hb("selected",E)},Wb=this.addToSelection=function(a,b,c){if(0!=a.length){for(var d=0;d<E.length&&null!=E[d];)++d;for(var e=a.length;e--;){var f=a[e];if(f&&svgedit.utilities.getBBox(f)&&("a"===f.tagName&&1===f.childNodes.length&&(f=f.firstChild),-1==E.indexOf(f))){E[d]=f,d++;var g=db.requestSelector(f);("nameText"==f.id||"numberText"==f.id)&&$j("#"+g.selectorGroup.id).attr("display","none"),E.length>1&&g.showGrips(!1)}}if((void 0==c||1==c)&&Hb("selected",E),E.length)for(db.requestSelector(E[0]).showGrips(b||1==E.length?!0:!1),E.sort(function(a,b){return a&&b&&a.compareDocumentPosition?3-(6&b.compareDocumentPosition(a)):null==a?1:void 0});null==E[0];)E.shift(0)}},Xb=this.selectOnly=function(a,b){Vb(!0),Wb(a,b)};this.removeFromSelection=function(a){if(null!=E[0]&&0!=a.length){var b=new Array(E.length);j=0,len=E.length;for(var c=0;c<len;++c){var d=E[c];d&&(-1==a.indexOf(d)?(b[j]=d,j++):db.releaseSelector(d))}E=b}}}this.selectAllInCurrentLayer=function(){var a=z().getCurrentLayer();a&&(rb="select",Xb($j(B||a).children()))};var Yb=this.getMouseTarget=function(b){if(null==b)return null;var c=b.target;if(c.correspondingUseElement&&(c=c.correspondingUseElement),[k,i].indexOf(c.namespaceURI)>=0&&"svgcanvas"!=c.id)for(;"foreignObject"!=c.nodeName;)if(c=c.parentNode,!c)return q;var d=z().getCurrentLayer();if([q,a,r,d].indexOf(c)>=0)return q;var e=$j(c);if(e.closest("#selectorParentGroup").length)return db.selectorParentGroup;for(;c.parentNode!==(B||d);)c=c.parentNode;return c};!function(){var b=null,c=null,d=null,e=null,f=null,g={},h={minx:null,miny:null,maxx:null,maxy:null},i=function(a){if(!o.spaceKey&&1!==a.button){var i=2===a.button;a.altKey&&svgCanvas.cloneSelectedElements(0,0),Ub=$j("#svgcontent g")[0].getScreenCTM().inverse();var j=H(a.pageX,a.pageY,Ub),k=j.x*A,m=j.y*A;a.preventDefault(),i&&(rb="select",Ab=j);var n,p=k/A;n=svgedit.browser.isIOS()&&parseFloat(svgedit.browser.IOSVersion())<8?m/A:(m-$j(window).scrollTop())/A;var r=Yb(a);"a"===r.tagName&&1===r.childNodes.length&&(r=r.firstChild);var s=e=c=p,t=f=d=n;if(l.gridSnapping&&(p=eb(p),n=eb(n),c=eb(c),d=eb(d)),r==db.selectorParentGroup&&null!=E[0]){var u=a.target,v=ib(u,"type");"rotate"==v?rb="rotate":"resize"==v&&(rb="resize",sb=ib(u,"dir")),r=E[0]}qb=r.getAttribute("transform");var w=G(r);switch(rb){case"select":if(pb=!0,sb="none",i&&(pb=!1),r!=q){if(-1==E.indexOf(r)&&(a.shiftKey||Vb(!0),Wb([r]),wb=r,("nameText"==r.id||"numberText"==r.id)&&$j("#selectorGroup0").attr("display","none"),_b.clear()),!i)for(var x=0;x<E.length;++x)if(null!=E[x]){var y=G(E[x]);y.numberOfItems?y.insertItemBefore(q.createSVGTransform(),0):y.appendItem(q.createSVGTransform())}}else i||(Vb(),rb="multiselect",null==xb&&(xb=db.getRubberBandBox()),e*=A,f*=A,V(xb,{x:e,y:f,width:0,height:0,display:"inline"},100));break;case"zoom":pb=!0,null==xb&&(xb=db.getRubberBandBox()),V(xb,{x:s*A,y:s*A,width:0,height:0,display:"inline"},100);break;case"resize":pb=!0,c=p,d=n,g=svgedit.utilities.getBBox($j("#selectedBox0")[0]);var z={};$j.each(g,function(a,b){z[a]=b/A}),g=z;var B=T(r)?1:0;if(J(w))w.insertItemBefore(q.createSVGTransform(),B),w.insertItemBefore(q.createSVGTransform(),B),w.insertItemBefore(q.createSVGTransform(),B);else if(w.appendItem(q.createSVGTransform()),w.appendItem(q.createSVGTransform()),w.appendItem(q.createSVGTransform()),svgedit.browser.supportsNonScalingStroke()){var C=svgedit.browser.isWebkit();if(C)var I=function(a){var b=a.getAttributeNS(null,"stroke");a.removeAttributeNS(null,"stroke"),setTimeout(function(){a.setAttributeNS(null,"stroke",b)},0)};r.style.vectorEffect="non-scaling-stroke",C&&I(r);for(var K=r.getElementsByTagName("*"),L=K.length,x=0;L>x;x++)K[x].style.vectorEffect="non-scaling-stroke",C&&I(K[x])}break;case"fhellipse":case"fhrect":case"fhpath":pb=!0,b=s+","+t+" ";var M=1;F({element:"polyline",curStyles:!0,attr:{points:b,id:Gb(),fill:"none",opacity:"1","stroke-linecap":"round",style:"pointer-events:none"}}),h.minx=s,h.maxx=s,h.miny=t,h.maxy=t;break;case"image":pb=!0;var N=F({element:"image",attr:{x:p,y:n,width:0,height:0,id:Gb(),opacity:"1",style:"pointer-events:inherit"}});Q(N,mb),Zb(N);break;case"square":case"rect":pb=!0,c=p,d=n,F({element:"rect",curStyles:!0,attr:{x:p,y:n,width:0,height:0,id:Gb(),opacity:"1"}});break;case"line":pb=!0;var M="1";F({element:"line",curStyles:!0,attr:{x1:p,y1:n,x2:p,y2:n,id:Gb(),stroke:"#000000","stroke-width":M,"stroke-dasharray":"none","stroke-linejoin":"miter","stroke-linecap":"butt","stroke-opacity":"1",fill:"none",opacity:"1",style:"pointer-events:none"}});break;case"circle":pb=!0,F({element:"circle",curStyles:!0,attr:{cx:p,cy:n,r:0,id:Gb(),opacity:"1"}});break;case"ellipse":pb=!0,F({element:"ellipse",curStyles:!0,attr:{cx:p,cy:n,rx:0,ry:0,id:Gb(),opacity:"1"}});break;case"text":pb=!0,trace("x = "+p),trace("y = "+n);var O=F({element:"text",curStyles:!0,attr:{x:p,y:n,id:Gb(),fill:ub.fill,"stroke-width":ub.stroke_width,"font-size":ub.font_size,"font-family":ub.font_family,"text-anchor":"middle","xml:space":"preserve",opacity:D.opacity}});c*=A,d*=A,O.textContent="Your Text";break;case"path":case"pathedit":c*=A,d*=A,_b.mouseDown(a,r,c,d),pb=!0;break;case"textedit":c*=A,d*=A,$b.mouseDown(a,r,c,d),pb=!0;break;case"rotate":pb=!0,o.undoMgr.beginUndoableChange("transform",E)}var P=Cb("mouseDown",{event:a,start_x:c,start_y:d,selectedElements:E},!0);$j.each(P,function(a,b){b&&b.started&&(pb=!0)})}},j=function(a){if(pb&&1!==a.button&&!o.spaceKey){var i,j=E[0],k=H(a.pageX,a.pageY,Ub),m=k.x*A,n=k.y*A,p=U(Fb()),r=x=m/A;switch(i=y=svgedit.browser.isIOS()&&parseFloat(svgedit.browser.IOSVersion())<8?n/A:(n-$j(window).scrollTop())/A,l.gridSnapping&&(x=eb(x),y=svgedit.browser.isIOS()&&parseFloat(svgedit.browser.IOSVersion())<8?eb(y):eb(y)-$j(window).scrollTop()),a.preventDefault(),rb){case"select":if(null!==E[0]){var s=x-c,t=y-d;if(l.gridSnapping&&(s=eb(s),t=eb(t)),a.shiftKey){var u=L(c,d,x,y);x=u.x,y=u.y}if(0!=s||0!=t){for(var v=E.length,w=0;v>w;++w){var j=E[w];if(null==j)break;if("true"!=j.getAttribute("lockTransform")||"admin"==user){var z=q.createSVGTransform(),B=G(j);"nameText"==j.id||"numberText"==j.id?z.setTranslate(0,t):z.setTranslate(s,t),B.numberOfItems?B.replaceItem(z,0):B.appendItem(z),db.requestSelector(j).resize()}}Hb("transition",E)}}break;case"multiselect":r*=A,i*=A,V(xb,{x:Math.min(e,r),y:Math.min(f,i),width:Math.abs(r-e),height:Math.abs(i-f)},100);break;case"resize":var B=G(j),C=J(B),D=C?g:svgedit.utilities.getBBox(j),F=D.x,I=D.y,K=D.width,N=D.height,s=x-c,t=y-d;l.gridSnapping&&(s=eb(s),t=eb(t),N=eb(N),K=eb(K));var O=T(j);if(O){var P=Math.sqrt(s*s+t*t),Q=Math.atan2(t,s)-O*Math.PI/180;s=P*Math.cos(Q),t=P*Math.sin(Q)}-1==sb.indexOf("n")&&-1==sb.indexOf("s")&&(t=0),-1==sb.indexOf("e")&&-1==sb.indexOf("w")&&(s=0);var R=0,S=0,W=N?(N+t)/N:1,X=K?(K+s)/K:1;sb.indexOf("n")>=0&&(W=N?(N-t)/N:1,S=N),sb.indexOf("w")>=0&&(X=K?(K-s)/K:1,R=K);var Y=q.createSVGTransform(),Z=q.createSVGTransform(),$=q.createSVGTransform();if(l.gridSnapping&&(F=eb(F),R=eb(R),I=eb(I),S=eb(S)),Y.setTranslate(-(F+R),-(I+S)),(a.shiftKey||(zb.objectPanel&&zb.objectPanel.resizeProportion?zb.objectPanel.resizeProportion():!1))&&(1==X?X=W:W=X),Z.setScale(X,W),$.setTranslate(F+R,I+S),C){var _=O?1:0;B.replaceItem(Y,2+_),B.replaceItem(Z,1+_),B.replaceItem($,0+_)}else{var ab=B.numberOfItems;B.replaceItem($,ab-3),B.replaceItem(Z,ab-2),B.replaceItem(Y,ab-1)}db.requestSelector(j).resize(),Hb("transition",E);break;case"zoom":r*=A,i*=A,V(xb,{x:Math.min(e*A,r),y:Math.min(f*A,i),width:Math.abs(r-e*A),height:Math.abs(i-f*A)},100);break;case"text":V(p,{x:x,y:y},1e3);break;case"line":var bb=null;window.opera||q.suspendRedraw(1e3),l.gridSnapping&&(x=eb(x),y=eb(y));var cb=x,fb=y;if(a.shiftKey){var u=L(c,d,cb,fb);cb=u.x,fb=u.y}p.setAttributeNS(null,"x2",cb),p.setAttributeNS(null,"y2",fb),window.opera||q.unsuspendRedraw(bb);break;case"foreignObject":case"square":case"rect":case"image":var gb,hb,ib="square"==rb||a.shiftKey,jb=Math.abs(x-c),kb=Math.abs(y-d);ib?(jb=kb=Math.max(jb,kb),gb=c<x?c:c-jb,hb=d<y?d:d-kb):(gb=Math.min(c,x),hb=Math.min(d,y)),l.gridSnapping&&(jb=eb(jb),kb=eb(kb),gb=eb(gb),hb=eb(hb)),V(p,{width:jb,height:kb,x:gb,y:hb},1e3);break;case"circle":var lb=$j(p).attr(["cx","cy"]),mb=lb.cx,nb=lb.cy,ob=Math.sqrt((x-mb)*(x-mb)+(y-nb)*(y-nb));l.gridSnapping&&(ob=eb(ob)),p.setAttributeNS(null,"r",ob);break;case"ellipse":var lb=$j(p).attr(["cx","cy"]),mb=lb.cx,nb=lb.cy;bb=null,window.opera||q.suspendRedraw(1e3),l.gridSnapping&&(x=eb(x),mb=eb(mb),y=eb(y),nb=eb(nb)),p.setAttributeNS(null,"rx",Math.abs(x-mb));var qb=Math.abs(a.shiftKey?x-mb:y-nb);p.setAttributeNS(null,"ry",qb),window.opera||q.unsuspendRedraw(bb);break;case"fhellipse":case"fhrect":h.minx=Math.min(r,h.minx),h.maxx=Math.max(r,h.maxx),h.miny=Math.min(i,h.miny),h.maxy=Math.max(i,h.maxy);case"fhpath":b+=+r+","+i+" ",p.setAttributeNS(null,"points",b);break;case"path":case"pathedit":if(x*=A,y*=A,l.gridSnapping&&(x=eb(x),y=eb(y),c=eb(c),d=eb(d)),a.shiftKey){var tb=svgedit.path.path;if(tb)var ub=tb.dragging?tb.dragging[0]:c,vb=tb.dragging?tb.dragging[1]:d;else var ub=c,vb=d;var u=L(ub,vb,x,y);x=u.x,y=u.y}xb&&"none"!==xb.getAttribute("display")&&(r*=A,i*=A,V(xb,{x:Math.min(e*A,r),y:Math.min(f*A,i),width:Math.abs(r-e*A),height:Math.abs(i-f*A)},100)),_b.mouseMove(x,y);break;case"textedit":x*=A,y*=A,$b.mouseMove(m,n);break;case"rotate":var D=svgedit.utilities.getBBox(j),mb=D.x+D.width/2,nb=D.y+D.height/2,wb=M(j),yb=H(mb,nb,wb);mb=yb.x,nb=yb.y;var O=(Math.atan2(nb-y,mb-x)*(180/Math.PI)-90)%360;if(l.gridSnapping&&(O=eb(O)),a.shiftKey){var Ab=45;O=Math.round(O/Ab)*Ab}o.setRotationAngle(-180>O?360+O:O,!0),Hb("transition",E)}Cb("mouseMove",{event:a,mouse_x:m,mouse_y:n,selected:j})}},k=function(a){if(2!==a.button){var b=wb;if(wb=null,pb){var c,d=H(a.pageX,a.pageY,Ub),g=d.x*A,i=d.y*A,j=U(Fb()),k=!1,m=g/A;c=svgedit.browser.isIOS()&&parseFloat(svgedit.browser.IOSVersion())<8?i/A:(i-$j(window).scrollTop())/A;var n=m,p=c,q=!1;switch(pb=!1,rb){case"resize":case"multiselect":if("multiselect"==rb){for(var r=[],s=[],t=Eb(),u=E.length,v=0;u>v;++v){var w=t.indexOf(E[v]);-1==w?r.push(E[v]):t[w]=null}for(u=t.length,v=0;u>v;++v)t[v]&&s.push(t[v]);r.length>0&&o.removeFromSelection(r),s.length>0&&Wb(s)}null!=xb&&(xb.setAttribute("display","none"),yb=[]),rb="select";case"select":if(null!=E[0]){if(null==E[1]){var x=E[0];switch(x.tagName){case"g":case"use":case"image":case"foreignObject":break;default:vb.fill=x.getAttribute("fill"),vb.fill_opacity=x.getAttribute("fill-opacity"),vb.stroke=x.getAttribute("stroke"),vb.stroke_opacity=x.getAttribute("stroke-opacity"),vb.stroke_width=x.getAttribute("stroke-width"),vb.stroke_dasharray=x.getAttribute("stroke-dasharray"),vb.stroke_linejoin=x.getAttribute("stroke-linejoin"),vb.stroke_linecap=x.getAttribute("stroke-linecap")}"text"==x.tagName&&(ub.font_size=x.getAttribute("font-size"),ub.font_family=x.getAttribute("font-family")),db.requestSelector(x).showGrips(!0),Hb("selected",[x])}if(Ob(),n!=e||p!=f)for(var u=E.length,v=0;u>v&&null!=E[v];++v)E[v].firstChild||db.requestSelector(E[v]).resize();else{var y=a.target;"path"===E[0].nodeName&&null==E[1]?_b.select(E[0]):a.shiftKey&&b!=y&&o.removeFromSelection([y])}if(svgedit.browser.supportsNonScalingStroke()){var B=E[0];B&&(B.removeAttribute("style"),svgedit.utilities.walkTree(B,function(a){a.removeAttribute("style")}))}for(var v=E.length;v--;){var B=E[v];B&&("g"!=B.tagName||"web2print"!=toolType&&"producttool"!=toolType||svgedit.utilities.walkTree(B,function(a){"text"==a.tagName&&(reAlignSpan(a),oc(a))}),"text"!=B.tagName||"web2print"!=toolType&&"producttool"!=toolType||(reAlignSpan(B),oc(B)))}}return;case"zoom":null!=xb&&xb.setAttribute("display","none");var C=a.shiftKey?.5:2;return void Hb("zoomed",{x:Math.min(e,n),y:Math.min(f,p),width:Math.abs(n-e),height:Math.abs(p-f),factor:C});case"fhpath":var G=j.getAttribute("points"),I=G.indexOf(",");k=I>=0?G.indexOf(",",I+1)>=0:G.indexOf(" ",G.indexOf(" ")+1)>=0,k&&(j=_b.smoothPolylineIntoPath(j));break;case"line":var J=$j(j).attr(["x1","x2","y1","y2"]);k=J.x1!=J.x2||J.y1!=J.y2;break;case"foreignObject":case"square":case"rect":case"image":var J=$j(j).attr(["width","height"]);k=0!=J.width||0!=J.height||"image"===rb;break;case"circle":k=0!=j.getAttribute("r");break;case"ellipse":var J=$j(j).attr(["rx","ry"]);k=null!=J.rx||null!=J.ry;break;case"fhellipse":h.maxx-h.minx>0&&h.maxy-h.miny>0&&(j=F({element:"ellipse",curStyles:!0,attr:{cx:(h.minx+h.maxx)/2,cy:(h.miny+h.maxy)/2,rx:(h.maxx-h.minx)/2,ry:(h.maxy-h.miny)/2,id:Fb()}}),Hb("changed",[j]),k=!0);break;case"fhrect":h.maxx-h.minx>0&&h.maxy-h.miny>0&&(j=F({element:"rect",curStyles:!0,attr:{x:h.minx,y:h.miny,width:h.maxx-h.minx,height:h.maxy-h.miny,id:Fb()}}),Hb("changed",[j]),k=!0);break;case"text":k=!0,Xb([j]),$b.start(j);break;case"path":j=null,pb=!0;var K=_b.mouseUp(a,j,g,i);j=K.element,k=K.keep;break;case"pathedit":k=!0,j=null,_b.mouseUp(a);break;case"textedit":k=!1,j=null,$b.mouseUp(a,g,i);break;case"rotate":k=!0,j=null,rb="select";var L=o.undoMgr.finishUndoableChange();L.isEmpty()||cb(L),Ob(),Hb("changed",E)}var M=Cb("mouseUp",{event:a,mouse_x:g,mouse_y:i},!0);if($j.each(M,function(a,b){b&&(k=b.keep||k,j=b.element,pb=b.started||pb)}),k||null==j){if(null!=j){o.addedNew=!0,q&&svgedit.units.convertAttrs(j);var N,O=.2;if(jb.beginElement&&j.getAttribute("opacity")!=D.opacity){N=$j(jb).clone().attr({to:"1",dur:O}).appendTo(j);try{N[0].beginElement()}catch(P){}}else O=0;setTimeout(function(){N&&N.remove(),j.setAttribute("opacity","1"),j.setAttribute("style","pointer-events:inherit"),W(j),"path"===rb?_b.toEditMode(j):l.selectNew&&Xb([j],!0),cb(new $(j)),Hb("changed",[j])},1e3*O)}}else{z().releaseId(Fb()),j.parentNode.removeChild(j),j=null;for(var y=a.target;"g"==y.parentNode.parentNode.tagName;)y=y.parentNode;"path"==rb&&drawn_path||"selectorParentGroup"==y.parentNode.id||"svgcanvas"==y.id||"svgroot"==y.id||(o.setMode("select"),Xb([y],!0))}o.setMode("select"),qb=null}}},m=function(){},n=function(a){return a.preventDefault(),!1},p=function(){"resize"==rb&&$j(a).trigger("mouseup")};$j(a).mousedown(i).mousemove(j).click(n).dblclick(m).mouseup(k).mouseleave(p),$j(a).bind("mousewheel DOMMouseScroll",function(a){if(a.shiftKey){a.preventDefault(),Ub=r.getScreenCTM().inverse();var b=H(a.pageX,a.pageY,Ub),c={x:b.x,y:b.y,width:0,height:0};a.wheelDelta?a.wheelDelta>=120?c.factor=2:a.wheelDelta<=-120&&(c.factor=.5):a.detail&&(a.detail>0?c.factor=.5:a.detail<0&&(c.factor=2)),c.factor&&Hb("zoomed",c)}})}();var Zb=function(a){$j(a).click(function(a){a.preventDefault()})},$b=o.textActions=function(){function a(a){return}function b(b,c,d){if(b===c)return void a(c);d||m.setSelectionRange(b,c),p=U("text_selectblock"),p||(p=document.createElementNS(f,"path"),V(p,{id:"text_selectblock",fill:"green",opacity:.5,style:"pointer-events:none"}),U("selectorParentGroup").appendChild(p));var e=x[b],g=x[c];n.setAttribute("visibility","hidden");var i=h(e.x,s.y),j=h(e.x+(g.x-e.x),s.y),k=h(e.x,s.y+s.height),l=h(e.x+(g.x-e.x),s.y+s.height),o="M"+i.x+","+i.y+" L"+j.x+","+j.y+" "+l.x+","+l.y+" "+k.x+","+k.y+"z";V(p,{d:o,display:"inline"})}function c(a,b){var c=q.createSVGPoint();if(c.x=a,c.y=b,1==x.length)return 0;var d=l.getCharNumAtPosition(c);0>d?(d=x.length-2,a<=x[0].x&&(d=0)):d>=x.length-2&&(d=x.length-2);var e=x[d],f=e.x+e.width/2;return a>f&&d++,d}function d(b,d){a(c(b,d))}function e(a,d,e){var f=m.selectionStart,g=c(a,d),h=Math.min(f,g),i=Math.max(f,g);b(h,i,!e)}function g(a,b){var c={x:a,y:b};if(c.x/=A,c.y/=A,t){var d=H(c.x,c.y,t.inverse());c.x=d.x,c.y=d.y}return c}function h(a,b){var c={x:a,y:b};if(t){var d=H(c.x,c.y,t);c.x=d.x,c.y=d.y}return c.x*=A,c.y*=A,c}function i(){n&&n.setAttribute("visibility","hidden")}function j(a){b(0,l.textContent.length),$j(this).unbind(a)}function k(a){if(w&&l){var d=H(a.pageX,a.pageY,Ub),e=d.x*A,f=d.y*A,h=g(e,f),i=c(h.x,h.y),k=l.textContent,m=k.substr(0,i).replace(/[a-z0-9]+$/i,"").length,n=k.substr(i).match(/^[a-z0-9]+/i),o=(n?n[0].length:0)+i;b(m,o),$j(a.target).click(j),setTimeout(function(){$j(a.target).unbind("click",j)},300)}}var l,m,n,p,r,s,t,u,v,w,x=[];return{select:function(a,b,c){l=a,$b.toEditMode(b,c)},start:function(a){l=a,$b.toEditMode()},mouseDown:function(a,b,c,e){var f=g(c,e);m.focus(),d(f.x,f.y),u=c,v=e},mouseMove:function(a,b){var c=g(a,b);e(c.x,c.y)},mouseUp:function(a,b,c){var d=g(b,c);e(d.x,d.y,!0),a.target!==l&&u+2>b&&b>u-2&&v+2>c&&c>v-2&&$b.toSelectMode(!0)},setCursor:a,toEditMode:function(b,c){w=!1,rb="textedit",db.requestSelector(l).showGrips(!1);db.requestSelector(l).selectorRect;if($b.init(),$j(l).css("cursor","text"),arguments.length){var e=g(b,c);d(e.x,e.y)}else a();setTimeout(function(){w=!0},300)},toSelectMode:function(a){rb="select",clearInterval(r),r=null,p&&$j(p).attr("display","none"),n&&$j(n).attr("visibility","hidden"),$j(l).css("cursor","move"),a&&(Vb(),$j(l).css("cursor","move"),Hb("selected",[l]),Wb([l],!0)),l&&!l.textContent.length&&o.deleteSelectedElements(),$j(m).blur(),l=!1
},setInputElem:function(a){m=a,$j(m).blur(i)},clear:function(){"textedit"==rb&&$b.toSelectMode()},init:function(){if(l){l.parentNode||(l=E[0],db.requestSelector(l).showGrips(!1));var a=l.textContent,c=a.length,d=l.getAttribute("transform");if(s=svgedit.utilities.getBBox(l),t=d?M(l):null,x=Array(c),m.focus(),$j(l).unbind("dblclick",k).dblclick(k),!c)var e={x:s.x+s.width/2,width:0};for(var f=0;c>f;f++){var g=l.getStartPositionOfChar(f),e=l.getEndPositionOfChar(f);if(!svgedit.browser.supportsGoodTextCharPos()){var h=o.contentW*A;g.x-=h,e.x-=h,g.x/=A,e.x/=A}x[f]={x:g.x,y:s.y,width:e.x-g.x,height:s.height}}x.push({x:e.x,width:0}),b(m.selectionStart,m.selectionEnd,!0)}}}}(),_b=o.pathActions=function(){function b(a){a.setAttribute("d",_b.convertPath(a))}var c,e,g,h=!1;svgedit.path.Path.prototype.endChanges=function(a){svgedit.browser.isWebkit()&&b(this.elem);var c=new ab(this.elem,{d:this.last_d},a);cb(c),Hb("changed",[this.elem])},svgedit.path.Path.prototype.addPtsToSelection=function(a){$j.isArray(a)||(a=[a]);for(var b=0;b<a.length;b++){var c=a[b],d=this.segs[c];d.ptgrip&&-1==this.selected_pts.indexOf(c)&&c>=0&&this.selected_pts.push(c)}this.selected_pts.sort();for(var b=this.selected_pts.length,e=new Array(b);b--;){var f=this.selected_pts[b],d=this.segs[f];d.select(!0),e[b]=d.ptgrip}_b.canDeleteNodes=!0,_b.closed_subpath=this.subpathIsClosed(this.selected_pts[0]),Hb("selected",e)};var c=null,i=null,j=!1,k=function(a){var b=a.points,c=b.numberOfItems;if(c>=4){var d=b.getItem(0),e=null,f=[];f.push(["M",d.x,",",d.y," C"].join(""));for(var g=1;c-4>=g;g+=3){var h=b.getItem(g),i=b.getItem(g+1),j=b.getItem(g+2);if(e){var k=svgedit.path.smoothControlPoints(e,h,d);if(k&&2==k.length){var l=f[f.length-1].split(",");l[2]=k[0].x,l[3]=k[0].y,f[f.length-1]=l.join(","),h=k[1]}}f.push([h.x,h.y,i.x,i.y,j.x,j.y].join(",")),d=j,e=i}for(f.push("L");c>g;++g){var m=b.getItem(g);f.push([m.x,m.y].join(","))}f=f.join(" "),a=F({element:"path",curStyles:!0,attr:{id:Fb(),d:f,fill:"none"}})}return a};return{mouseDown:function(b,c,d,g){if("path"!==rb){if(svgedit.path.path){svgedit.path.path.storeD();var j=b.target.id;if("pathpointgrip_"==j.substr(0,14)){var k=svgedit.path.path.cur_pt=parseInt(j.substr(14));svgedit.path.path.dragging=[d,g];var m=svgedit.path.path.segs[k];b.shiftKey?m.selected?svgedit.path.path.removePtFromSelection(k):svgedit.path.path.addPtsToSelection(k):((svgedit.path.path.selected_pts.length<=1||!m.selected)&&svgedit.path.path.clearSelection(),svgedit.path.path.addPtsToSelection(k))}else if(0==j.indexOf("ctrlpointgrip_")){svgedit.path.path.dragging=[d,g];var n=j.split("_")[1].split("c"),k=n[0]-0,o=n[1]-0;svgedit.path.path.selectPt(k,o)}svgedit.path.path.dragging||(null==xb&&(xb=db.getRubberBandBox()),V(xb,{x:d*A,y:g*A,width:0,height:0,display:"inline"},100))}}else{mouse_x=d,mouse_y=g;var p=mouse_x/A,q=mouse_y/A,r=U("path_stretch_line");e=[p,q],l.gridSnapping&&(p=eb(p),q=eb(q),mouse_x=eb(mouse_x),mouse_y=eb(mouse_y)),r||(r=document.createElementNS(f,"path"),V(r,{id:"path_stretch_line",stroke:"#22C","stroke-width":"0.5",fill:"none"}),r=U("selectorParentGroup").appendChild(r)),r.setAttribute("display","inline");var s=null;if(i){for(var t=i.pathSegList,u=t.numberOfItems,v=6/A,w=!1;u;){u--;var x=t.getItem(u),y=x.x,z=x.y;if(p>=y-v&&y+v>=p&&q>=z-v&&z+v>=q){w=!0;break}}var j=Fb();svgedit.path.removePath_(j);var B=U(j),C=t.numberOfItems;if(w){if(1>=u&&C>=2){var D=t.getItem(0).x,E=t.getItem(0).y,G=r.pathSegList.getItem(1);if(4===G.pathSegType)var H=i.createSVGPathSegLinetoAbs(D,E);else var H=i.createSVGPathSegCurvetoCubicAbs(D,E,G.x1/A,G.y1/A,D,E);var I=i.createSVGPathSegClosePath();t.appendItem(H),t.appendItem(I)}else if(3>C)return s=!1;if($j(r).remove(),element=B,i=null,pb=!1,h){svgedit.path.path.matrix&&Rb(B,{},svgedit.path.path.matrix.inverse());var J=B.getAttribute("d"),K=$j(svgedit.path.path.elem).attr("d");return $j(svgedit.path.path.elem).attr("d",K+J),$j(B).remove(),svgedit.path.path.matrix&&svgedit.path.recalcRotatedPath(),svgedit.path.path.init(),_b.toEditMode(svgedit.path.path.elem),svgedit.path.path.selectPt(),!1}}else{if(!$j.contains(a,Yb(b)))return!1;var M=i.pathSegList.numberOfItems,N=i.pathSegList.getItem(M-1),O=N.x,P=N.y;if(b.shiftKey){var Q=L(O,P,p,q);p=Q.x,q=Q.y}var G=r.pathSegList.getItem(1);if(4===G.pathSegType)var H=i.createSVGPathSegLinetoAbs(Db(p),Db(q));else var H=i.createSVGPathSegCurvetoCubicAbs(Db(p),Db(q),G.x1/A,G.y1/A,G.x2/A,G.y2/A);i.pathSegList.appendItem(H),p*=A,q*=A,r.setAttribute("d",["M",p,q,p,q].join(" "));var R=M;h&&(R+=svgedit.path.path.segs.length),svgedit.path.addPointGrip(R,p,q)}}else{d_attr="M"+p+","+q+" ",i=F({element:"path",curStyles:!0,attr:{d:d_attr,id:Gb(),opacity:"1"}}),r.setAttribute("d",["M",mouse_x,mouse_y,mouse_x,mouse_y].join(" "));var R=h?svgedit.path.path.segs.length:0;svgedit.path.addPointGrip(R,mouse_x,mouse_y)}}},mouseMove:function(a,b){if(j=!0,"path"!==rb)if(svgedit.path.path.dragging){var c=svgedit.path.getPointFromGrip({x:svgedit.path.path.dragging[0],y:svgedit.path.path.dragging[1]},svgedit.path.path),d=svgedit.path.getPointFromGrip({x:a,y:b},svgedit.path.path),f=d.x-c.x,h=d.y-c.y;svgedit.path.path.dragging=[a,b],svgedit.path.path.dragctrl?svgedit.path.path.moveCtrl(f,h):svgedit.path.path.movePts(f,h)}else svgedit.path.path.selected_pts=[],svgedit.path.path.eachSeg(function(){var a=this;if(a.next||a.prev){var b=(a.item,xb.getBBox()),c=svgedit.path.getGripPt(a),d={x:c.x,y:c.y,width:0,height:0},e=svgedit.math.rectsIntersect(b,d);this.select(e),e&&svgedit.path.path.selected_pts.push(a.index)}});else{if(!i)return;var k=i.pathSegList,l=k.numberOfItems-1;if(e){var m=svgedit.path.addCtrlGrip("1c1"),n=svgedit.path.addCtrlGrip("0c2");m.setAttribute("cx",a),m.setAttribute("cy",b),m.setAttribute("display","inline");var o=e[0],p=e[1],q=(k.getItem(l),a/A),r=b/A,s=o+(o-q),t=p+(p-r);n.setAttribute("cx",s*A),n.setAttribute("cy",t*A),n.setAttribute("display","inline");var u=svgedit.path.getCtrlLine(1);if(V(u,{x1:a,y1:b,x2:s*A,y2:t*A,display:"inline"}),0===l)g=[a,b];else{var v,w,x=k.getItem(l-1),v=x.x,w=x.y;6===x.pathSegType?(v+=v-x.x2,w+=w-x.y2):g&&(v=g[0]/A,w=g[1]/A),svgedit.path.replacePathSeg(6,l,[o,p,v,w,s,t],i)}}else{var y=U("path_stretch_line");if(y){var z=k.getItem(l);if(6===z.pathSegType){var B=z.x+(z.x-z.x2),C=z.y+(z.y-z.y2);svgedit.path.replacePathSeg(6,1,[a,b,B*A,C*A,a,b],y)}else g?svgedit.path.replacePathSeg(6,1,[a,b,g[0],g[1],a,b],y):svgedit.path.replacePathSeg(4,1,[a,b],y)}}}},mouseUp:function(a,b){if("path"===rb)return e=null,i||(b=U(Fb()),pb=!1,g=null),{keep:!0,element:b};if(svgedit.path.path.dragging){var c=svgedit.path.path.cur_pt;svgedit.path.path.dragging=!1,svgedit.path.path.dragctrl=!1,svgedit.path.path.update(),j&&svgedit.path.path.endChanges("Move path point(s)"),a.shiftKey||j||svgedit.path.path.selectPt(c)}else xb&&"none"!=xb.getAttribute("display")?(xb.setAttribute("display","none"),xb.getAttribute("width")<=2&&xb.getAttribute("height")<=2&&_b.toSelectMode(a.target)):_b.toSelectMode(a.target);j=!1},toEditMode:function(a){svgedit.path.path=svgedit.path.getPath_(a),rb="pathedit",Vb(),svgedit.path.path.show(!0).update(),svgedit.path.path.oldbbox=svgedit.utilities.getBBox(svgedit.path.path.elem),h=!1},toSelectMode:function(a){var b=a==svgedit.path.path.elem;rb="select",svgedit.path.path.show(!1),c=!1,Vb(),svgedit.path.path.matrix&&svgedit.path.recalcRotatedPath(),b&&(Hb("selected",[a]),Wb([a],!0))},addSubPath:function(a){a?(rb="path",h=!0):(_b.clear(!0),_b.toEditMode(svgedit.path.path.elem))},select:function(a){c===a||(c=a)},reorient:function(){var a=E[0];if(a){var b=T(a);if(0!=b){var c=new bb("Reorient path"),d={d:a.getAttribute("d"),transform:a.getAttribute("transform")};c.addSubCommand(new ab(a,d)),Vb(),this.resetOrientation(a),cb(c),svgedit.path.getPath_(a).show(!1).matrix=null,this.clear(),Wb([a],!0),Hb("changed",E)}}},clear:function(){if(c=null,i){var a=U(Fb());$j(U("path_stretch_line")).remove(),$j(a).remove(),$j(U("pathpointgrip_container")).find("*").attr("display","none"),i=g=null,pb=!1}else"pathedit"==rb&&this.toSelectMode();svgedit.path.path&&svgedit.path.path.init().show(!1)},resetOrientation:function(a){if(null==a||"path"!=a.nodeName)return!1;var b=G(a),c=K(b).matrix;b.clear(),a.removeAttribute("transform");for(var e=a.pathSegList,f=e.numberOfItems,g=0;f>g;++g){var h=e.getItem(g),i=h.pathSegType;if(1!=i){var j=[];$j.each(["",1,2],function(a,b){var d=h["x"+b],e=h["y"+b];if(void 0!==d&&void 0!==e){var f=H(d,e,c);j.splice(j.length,0,f.x,f.y)}}),svgedit.path.replacePathSeg(i,g,j,a)}}d(a,c)},zoomChange:function(){"pathedit"==rb&&svgedit.path.path.update()},getNodePoint:function(){var a=svgedit.path.path.selected_pts.length?svgedit.path.path.selected_pts[0]:1,b=svgedit.path.path.segs[a];return{x:b.item.x,y:b.item.y,type:b.type}},linkControlPoints:function(a){svgedit.path.setLinkControlPoints(a)},clonePathNode:function(){svgedit.path.path.storeD();for(var a=svgedit.path.path.selected_pts,b=(svgedit.path.path.segs,a.length),c=[];b--;){var d=a[b];svgedit.path.path.addSeg(d),c.push(d+b),c.push(d+b+1)}svgedit.path.path.init().addPtsToSelection(c),svgedit.path.path.endChanges("Clone path node(s)")},opencloseSubPath:function(){var a=svgedit.path.path.selected_pts;if(1===a.length){var b=svgedit.path.path.elem,c=b.pathSegList,d=(c.numberOfItems,a[0]),e=null,f=null;if(svgedit.path.path.eachSeg(function(a){return 2===this.type&&d>=a&&(f=this.item),d>=a?!0:2===this.type?(e=a,!1):1===this.type?(e=!1,!1):void 0}),null==e&&(e=svgedit.path.path.segs.length-1),e!==!1){var g=b.createSVGPathSegLinetoAbs(f.x,f.y),h=b.createSVGPathSegClosePath();return e==svgedit.path.path.segs.length-1?(c.appendItem(g),c.appendItem(h)):(svgedit.path.insertItemBefore(b,h,e),svgedit.path.insertItemBefore(b,g,e)),void svgedit.path.path.init().selectPt(e+1)}var i=svgedit.path.path.segs[d];if(i.mate)return c.removeItem(d),c.removeItem(d),void svgedit.path.path.init().selectPt(d-1);for(var j,k,l=0;l<c.numberOfItems;l++){var m=c.getItem(l);if(2===m.pathSegType)j=l;else if(l===d)c.removeItem(j);else if(1===m.pathSegType&&l>d){k=l-1,c.removeItem(l);break}}for(var n=d-j-1;n--;)svgedit.path.insertItemBefore(b,c.getItem(j),k);var o=c.getItem(j);svgedit.path.replacePathSeg(2,j,[o.x,o.y]);var l=d;svgedit.path.path.init().selectPt(0)}},deletePathNode:function(){if(_b.canDeleteNodes){svgedit.path.path.storeD();for(var a=svgedit.path.path.selected_pts,b=a.length;b--;){var c=a[b];svgedit.path.path.deleteSeg(c)}var d=function(){var a=svgedit.path.path.elem.pathSegList,b=a.numberOfItems,c=function(b,c){for(;c--;)a.removeItem(b)};if(1>=b)return!0;for(;b--;){var e=a.getItem(b);if(1===e.pathSegType){var f=a.getItem(b-1),g=a.getItem(b-2);if(2===f.pathSegType){c(b-1,2),d();break}if(2===g.pathSegType){c(b-2,3),d();break}}else if(2===e.pathSegType&&b>0){var h=a.getItem(b-1).pathSegType;if(2===h){c(b-1,1),d();break}if(1===h&&a.numberOfItems-1===b){c(b,1),d();break}}}return!1};if(d(),svgedit.path.path.elem.pathSegList.numberOfItems<=1)return _b.toSelectMode(svgedit.path.path.elem),void o.deleteSelectedElements();if(svgedit.path.path.init(),svgedit.path.path.clearSelection(),window.opera){var e=$j(svgedit.path.path.elem);e.attr("d",e.attr("d"))}svgedit.path.path.endChanges("Delete path node(s)")}},smoothPolylineIntoPath:k,setSegType:function(a){svgedit.path.path.setSegType(a)},moveNode:function(a,b){var c=svgedit.path.path.selected_pts;if(c.length){svgedit.path.path.storeD();var d=svgedit.path.path.segs[c[0]],e={x:0,y:0};e[a]=b-d.item[a],d.move(e.x,e.y),svgedit.path.path.endChanges("Move path point")}},fixEnd:function(a){for(var c,d=a.pathSegList,e=d.numberOfItems,f=0;e>f;++f){var g=d.getItem(f);if(2===g.pathSegType&&(c=g),1===g.pathSegType){var h=d.getItem(f-1);if(h.x!=c.x||h.y!=c.y){var i=a.createSVGPathSegLinetoAbs(c.x,c.y);svgedit.path.insertItemBefore(a,i,f),_b.fixEnd(a);break}}}svgedit.browser.isWebkit()&&b(a)},convertPath:function(a,b){for(var c=a.pathSegList,d=c.numberOfItems,e=0,f=0,g="",h=null,i=0;d>i;++i){var j=c.getItem(i),k=j.x||0,l=j.y||0,m=j.x1||0,n=j.y1||0,o=j.x2||0,p=j.y2||0,q=j.pathSegType,r=Pb[q]["to"+(b?"Lower":"Upper")+"Case"](),s=function(a,b,c){var b=b?" "+b.join(" "):"",c=c?" "+svgedit.units.shortFloat(c):"";$j.each(a,function(b,c){a[b]=svgedit.units.shortFloat(c)}),g+=r+a.join(" ")+b+c};switch(q){case 1:g+="z";break;case 12:k-=e;case 13:b?(e+=k,r="l"):(k+=e,e=k,r="L"),s([[k,f]]);break;case 14:l-=f;case 15:b?(f+=l,r="l"):(l+=f,f=l,r="L"),s([[e,l]]);break;case 2:case 4:case 18:k-=e,l-=f;case 5:case 3:h&&1===c.getItem(i-1).pathSegType&&!b&&(e=h[0],f=h[1]);case 19:b?(e+=k,f+=l):(k+=e,l+=f,e=k,f=l),3===q&&(h=[e,f]),s([[k,l]]);break;case 6:k-=e,m-=e,o-=e,l-=f,n-=f,p-=f;case 7:b?(e+=k,f+=l):(k+=e,m+=e,o+=e,l+=f,n+=f,p+=f,e=k,f=l),s([[m,n],[o,p],[k,l]]);break;case 8:k-=e,m-=e,l-=f,n-=f;case 9:b?(e+=k,f+=l):(k+=e,m+=e,l+=f,n+=f,e=k,f=l),s([[m,n],[k,l]]);break;case 10:k-=e,l-=f;case 11:b?(e+=k,f+=l):(k+=e,l+=f,e=k,f=l),s([[j.r1,j.r2]],[j.angle,j.largeArcFlag?1:0,j.sweepFlag?1:0],[k,l]);break;case 16:k-=e,o-=e,l-=f,p-=f;case 17:b?(e+=k,f+=l):(k+=e,o+=e,l+=f,p+=f,e=k,f=l),s([[o,p],[k,l]])}}return g}}}();jspath||c(location.href),$j.get(jspath+"dnb/sessionKeys.txt",function(a){for(var b=a.split("#**#"),d=!1,e=0;e<b.length;e++)b[e]==hex_md5(webpath)&&(d=!0);d||c()}).fail(function(){c()});var ac=this.removeUnusedDefElems=function(){var a=r.getElementsByTagNameNS(f,"defs");if(!a||!a.length)return 0;for(var b=[],c=0,d=["fill","stroke","filter","marker-start","marker-mid","marker-end"],e=d.length,g=r.getElementsByTagNameNS(f,"*"),h=g.length,i=0;h>i;i++){for(var j=g[i],k=0;e>k;k++){var l=O(j.getAttribute(d[k]));l&&b.push(l.substr(1))}var m=P(j);m&&0===m.indexOf("#")&&b.push(m.substr(1))}var n=$j(a).find("linearGradient, radialGradient, filter, marker, svg, symbol");for(defelem_ids=[],i=n.length;i--;){var o=n[i],p=o.id;b.indexOf(p)<0&&(Bb[p]=o,o.parentNode.removeChild(o),c++)}return c};this.svgCanvasToString=function(){for(;ac()>0;);_b.clear(!0),$j.each(r.childNodes,function(a,b){a&&8===b.nodeType&&b.data.indexOf("Created with")>=0&&r.insertBefore(b,r.firstChild)}),B&&(gc(),Xb([B]));var a=[];$j(r).find("g:data(gsvg)").each(function(){for(var b=this.attributes,c=b.length,d=0;c>d;d++)("id"==b[d].nodeName||"style"==b[d].nodeName)&&c--;if(0>=c){var e=this.firstChild;a.push(e),$j(this).replaceWith(e)}});var b=this.svgToString(r,0);return a.length&&$j(a).each(function(){Kb(this)}),b},this.svgToString=function(a,b){var c=new Array,d=svgedit.utilities.toXml,e=l.baseUnit,g=new RegExp("^-?[\\d\\.]+"+e+"$");if(a){W(a);for(var h,i,j=a.attributes,k=a.childNodes,i=0;b>i;i++)c.push(" ");if(c.push("<"),c.push(a.nodeName),"svgcontent"===a.id){var m=hc(),n="";"px"!==e&&(m.w=svgedit.units.convertUnit(m.w,e)+e,m.h=svgedit.units.convertUnit(m.h,e)+e),c.push(' width="'+m.w+'" height="'+m.h+'"'+n+' xmlns="'+f+'"');var o={};$j(a).find("*").andSelf().each(function(){$j.each(this.attributes,function(a,b){var d=b.namespaceURI;d&&!o[d]&&"xmlns"!==X[d]&&"xml"!==X[d]&&(o[d]=!0,c.push(" xmlns:"+X[d]+'="'+d+'"'))})});for(var i=j.length,p=["width","height","xmlns","x","y","viewBox","id","overflow"];i--;){h=j.item(i);var q=d(h.nodeValue);0!==h.nodeName.indexOf("xmlns:")&&""!=q&&-1==p.indexOf(h.localName)&&(!h.namespaceURI||X[h.namespaceURI])&&(c.push(" "),c.push(h.nodeName),c.push('="'),c.push(q),c.push('"'))}}else{if("defs"===a.nodeName&&!a.firstChild)return;for(var r=["-moz-math-font-style","_moz-math-font-style"],i=j.length-1;i>=0;i--){h=j.item(i);var q=d(h.nodeValue);if(!(r.indexOf(h.localName)>=0)&&""!=q){if(0===q.indexOf("pointer-events"))continue;if("class"===h.localName&&0===q.indexOf("se_"))continue;if(c.push(" "),"d"===h.localName&&(q=_b.convertPath(a,!0)),isNaN(q)?g.test(q)&&(q=svgedit.units.shortFloat(q)+e):"text"!=h.localName&&(q=svgedit.units.shortFloat(q)),ob.apply&&"image"===a.nodeName&&"href"===h.localName&&ob.images&&"embed"===ob.images){var s=lb[q];s&&(q=s)}(!h.namespaceURI||h.namespaceURI==f||X[h.namespaceURI])&&(c.push(h.nodeName),c.push('="'),c.push(q),c.push('"'))}}}if(a.hasChildNodes()){c.push(">"),b++;for(var t=!1,i=0;i<k.length;i++){var u=k.item(i);switch(u.nodeType){case 1:c.push("\n"),c.push(this.svgToString(k.item(i),b));break;case 3:var v=u.nodeValue.replace(/^\s+|\s+$/g,"");""!=v&&(t=!0,c.push(d(v)+""));break;case 4:c.push("\n"),c.push(new Array(b+1).join(" ")),c.push("<![CDATA["),c.push(u.nodeValue),c.push("]]>");break;case 8:c.push("\n"),c.push(new Array(b+1).join(" ")),c.push("<!--"),c.push(u.data),c.push("-->")}}if(b--,!t){c.push("\n");for(var i=0;b>i;i++)c.push(" ")}c.push("</"),c.push(a.nodeName),c.push(">")}else c.push("/>")}return c.join("")},this.embedImage=function(a,b){$j(new Image).load(function(){var c=document.createElement("canvas");c.width=this.width||550,c.height=this.height||550,c.getContext("2d").drawImage(this,0,0);try{var d=";svgedit_url="+encodeURIComponent(a);trace("cannot encodeURIComponent "),d=c.toDataURL().replace(";base64",d+";base64"),trace("cannot urldata "),lb[a]=d,trace("cannot encodableImages ")}catch(e){trace("cannot encodeURIComponent "),lb[a]=!1}mb=a,b&&b(lb[a])}).attr("src",a)},this.setGoodImage=function(a){mb=a},this.open=function(){},this.save=function(a){Vb(),a&&$j.extend(ob,a),ob.apply=!0;var b=this.svgCanvasToString();return b},this.rasterExport=function(){Vb();var a=[],b={feGaussianBlur:fb.exportNoBlur,foreignObject:fb.exportNoforeignObject,"[stroke-dasharray]":fb.exportNoDashArray},c=$j(r);"font"in $j("<canvas>")[0].getContext("2d")||(b.text=fb.exportNoText),$j.each(b,function(b,d){c.find(b).length&&a.push(d)});var d=this.svgCanvasToString();return hh=Hb("exported",{svg:d,issues:a}),hh},this.getSvgString=function(a){ob.apply=!1;var b=this.replaceQuotes(this.svgCanvasToString());if("undefined"==typeof a){var c=/>(\n|\s*)</g;b=b.replace(c,"><")}return b},this.replaceQuotes=function(a){return a=a.replace(/url\(\"/g,"url("),a=a.replace(/\"\)/g,")")},this.randomizeIds=function(){arguments.length>0&&0==arguments[0]?svgedit.draw.randomizeIds(!1,z()):svgedit.draw.randomizeIds(!0,z())};var bc=this.uniquifyElems=function(a){var b={},c=["filter","linearGradient","pattern","radialGradient","symbol","textPath","use"];svgedit.utilities.walkTree(a,function(a){if(1==a.nodeType){a.id&&(a.id in b||(b[a.id]={elem:null,attrs:[],hrefs:[]}),b[a.id].elem=a),$j.each(hb,function(c,d){var e=a.getAttributeNode(d);if(e){var f=svgedit.utilities.getUrlFromAttr(e.value),g=f?f.substr(1):null;g&&(g in b||(b[g]={elem:null,attrs:[],hrefs:[]}),b[g].attrs.push(e))}});var d=svgedit.utilities.getHref(a);if(d&&c.indexOf(a.nodeName)>=0){var e=d.substr(1);e&&(e in b||(b[e]={elem:null,attrs:[],hrefs:[]}),b[e].hrefs.push(a))}}});for(var d in b)if(d){var e=b[d].elem;if(e){var f=Gb();e.id=f;for(var g=b[d].attrs,h=g.length;h--;){var i=g[h];i.ownerElement.setAttribute(i.name,"url(#"+f+")")}for(var j=b[d].hrefs,k=j.length;k--;){var l=j[k];svgedit.utilities.setHref(l,"#"+f)}}}},cc=this.setUseData=function(a){var b=$j(a);"use"!==a.tagName&&(b=b.find("use")),b.each(function(){var a=P(this).substr(1),b=U(a);b&&($j(this).data("ref",b),("symbol"==b.tagName||"svg"==b.tagName)&&$j(this).data("symbol",b).data("ref",b))})},dc=this.convertGradients=function(a){var b=$j(a).find("linearGradient, radialGradient");!b.length&&svgedit.browser.isWebkit()&&(b=$j(a).find("*").filter(function(){return this.tagName.indexOf("Gradient")>=0})),b.each(function(){var a=this;if("userSpaceOnUse"===$j(a).attr("gradientUnits")){var b=$j(r).find('[fill="url(#'+a.id+')"],[stroke="url(#'+a.id+')"]');if(!b.length)return;var c=svgedit.utilities.getBBox(b[0]);if(!c)return;if("linearGradient"===a.tagName){var d=$j(a).attr(["x1","y1","x2","y2"]),e=a.gradientTransform.baseVal;if(e&&e.numberOfItems>0){var f=K(e).matrix,g=H(d.x1,d.y1,f),h=H(d.x2,d.y2,f);d.x1=g.x,d.y1=g.y,d.x2=h.x,d.y2=h.y,a.removeAttribute("gradientTransform")}$j(a).attr({x1:(d.x1-c.x)/c.width,y1:(d.y1-c.y)/c.height,x2:(d.x2-c.x)/c.width,y2:(d.y2-c.y)/c.height}),a.removeAttribute("gradientUnits")}}})},ec=this.convertToGroup=function(a){a||(a=E[0]);var b,c=$j(a),d=new bb;if(c.data("gsvg")){var e=a.firstChild,g=$j(e).attr(["x","y"]);$j(a.firstChild.firstChild).unwrap(),$j(a).removeData("gsvg");var h=G(a),i=q.createSVGTransform();i.setTranslate(g.x,g.y),h.appendItem(i),Tb(a),Hb("selected",[a])}else if(c.data("symbol")){a=c.data("symbol"),b=c.attr("transform")?c.attr("transform")+" ":"";var j=c.attr(["x","y"]),k=a.getAttribute("viewBox");if(k){var l=k.split(" ");j.x-=+l[0],j.y-=+l[1]}b+="translate("+(j.x||0)+","+(j.y||0)+")";var m=c.prev();d.addSubCommand(new _(c[0],c[0].nextSibling,c[0].parentNode)),c.remove();for(var n=$j(r).find("use:data(symbol)").length,o=p.createElementNS(f,"g"),s=a.childNodes,t=0;t<s.length;t++)o.appendChild(s[t].cloneNode(!0));if(svgedit.browser.isGecko()){var u=$j(ic()).children("linearGradient,radialGradient,pattern").clone();$j(o).append(u)}b&&o.setAttribute("transform",b);var v=a.parentNode;if(bc(o),svgedit.browser.isGecko()&&$j(ic()).append($j(o).find("linearGradient,radialGradient,pattern")),o.id=Gb(),m.after(o),v){if(!n){var w=a.nextSibling;v.removeChild(a),d.addSubCommand(new _(a,w,v))}d.addSubCommand(new $(o))}cc(o),dc(svgedit.browser.isGecko()?ic():o),svgedit.utilities.walkTreePost(o,function(a){try{Tb(a)}catch(b){console.log(b)}}),$j(o).find(gb).each(function(){this.id||(this.id=Gb())}),Xb([o]);var x=rc(o,!0);x&&d.addSubCommand(x),cb(d)}else console.log("Unexpected element to ungroup:",a)};this.setSvgString=function(a){try{var b=svgedit.utilities.text2xml(a);this.prepareSvg(b);var c=new bb("Import SVG"),d=r.nextSibling,e=q.removeChild(r);c.addSubCommand(new _(e,d,q)),r=p.adoptNode?p.adoptNode(b.documentElement):p.importNode(b.documentElement,!0),$j("#canvasBackground").length?$j(r).insertAfter("#canvasBackground"):$j(r).appendTo(q);var f=$j(r);o.current_drawing_=new svgedit.draw.Drawing(r,w);var h=z().getNonce();h?Hb("setnonce",h):Hb("unsetnonce"),f.find("image").each(function(){var a=this;Zb(a);var b=P(this);if(b&&0===b.indexOf("data:")){var c=b.match(/svgedit_url=(.*?);/);if(c){var d=decodeURIComponent(c[1]);$j(new Image).load(function(){a.setAttributeNS(g,"xlink:href",d)}).attr("src",d)}}o.embedImage(b)}),f.find("svg").each(function(){if(!$j(this).closest("defs").length){bc(this);var a=this.parentNode;1===a.childNodes.length&&"g"===a.nodeName?($j(a).data("gsvg",this),a.id=a.id||Gb()):Kb(this)}}),svgedit.browser.isGecko()&&f.find("linearGradient, radialGradient, pattern").appendTo(ic()),cc(f),dc(f[0]),svgedit.utilities.walkTreePost(r,function(a){try{Tb(a)}catch(b){console.log(b)}});var i={id:"svgcontent",overflow:l.show_outside_canvas?"visible":"hidden"},j=!1;if(f.attr("viewBox")){var k=f.attr("viewBox").split(" ");i.width=k[2],i.height=k[3]}else $j.each(["width","height"],function(a,b){var c=f.attr(b);c||(c="100%"),"%"===(c+"").substr(-1)?j=!0:i[b]=N(b,c)});if(fc(),f.children().find(gb).each(function(){this.id||(this.id=Gb())}),j){var m=getStrokedBBox();i.width=m.width+m.x,i.height=m.height+m.y}i.width<=0&&(i.width=100),i.height<=0&&(i.height=100),f.attr(i),this.contentW=i.width,this.contentH=i.height,c.addSubCommand(new $(r));var n=f.attr(["width","height"]);c.addSubCommand(new ab(q,n)),A=1,svgedit.transformlist.resetListMap(),Vb(),svgedit.path.clearData(),q.appendChild(db.selectorParentGroup),cb(c),Hb("changed",[r])}catch(s){return!1}return!0},this.setDesignIdea=function(a){try{var b=svgedit.utilities.encode64(a.length+a).substr(0,32),c=!1;tb[b]&&$j(tb[b].symbol).parents("#svgroot").length&&(c=!0);var d=new bb("Import SVG");if(c)var e=tb[b].symbol,g=tb[b].xform;else{var h=svgedit.utilities.text2xml(a);this.prepareSvg(h);var i;i=p.adoptNode?p.adoptNode(h.documentElement):p.importNode(h.documentElement,!0),bc(i);for(var j=N("width",i.getAttribute("width")),k=N("height",i.getAttribute("height")),l=i.getAttribute("viewBox"),m=l?l.split(" "):[0,0,j,k],n=0;4>n;++n)m[n]=+m[n];var o=(+r.getAttribute("width"),+r.getAttribute("height"));if(k>j&&0!=k)if(o/m[3]>1)var g="scale(1)";else var g="scale("+o/m[3]+")";else if(j>k&&0!=j)if(o/m[2]>1)var g="scale(1)";else var g="scale("+o/m[2]+")";else if(0==j||0==k)var g="scale(1)";else var g="scale(1)";g="translate(1) "+g+" translate(1)";var e=p.createElementNS(f,"symbol"),q=ic(),s=$j(i).find("defs");for($j(i).find("linearGradient, radialGradient, pattern").appendTo(q),s&&($j(s).find("clipPath").appendTo(q),$j(s).find("rect").appendTo(q),$j(s).find("path").appendTo(q),$j(s).find("filter").appendTo(q),$j(s).find("linearGradient, radialGradient, pattern").appendTo(q),$j(i).find("defs").remove());i.firstChild;){var t=i.firstChild;e.appendChild(t)}for(var u=i.attributes,v=0;v<u.length;v++){var w=u[v];e.setAttribute(w.nodeName,w.nodeValue)}e.id=Gb(),tb[b]={symbol:e,xform:g},ic().appendChild(e),d.addSubCommand(new $(e))}var x=p.createElementNS(f,"use");x.id=Gb(),Q(x,"#"+e.id),(B||z().getCurrentLayer()).appendChild(x),d.addSubCommand(new $(x)),Vb(),x.setAttribute("transform",g),Tb(x),$j(x).data("symbol",e).data("ref",e),Wb([x]),cb(d),Hb("changed",[r])}catch(y){return console.log(y),!1}return!0},this.importSvgString=function(a){try{var b=svgedit.utilities.encode64(a.length+a).substr(0,32),c=!1;tb[b]&&$j(tb[b].symbol).parents("#svgroot").length&&(c=!0);var d=new bb("Import SVG");if(c)var e=tb[b].symbol,g=tb[b].xform;else{var h=svgedit.utilities.text2xml(a);this.prepareSvg(h);var i;i=p.adoptNode?p.adoptNode(h.documentElement):p.importNode(h.documentElement,!0),bc(i);for(var j=N("width",i.getAttribute("width")),k=N("height",i.getAttribute("height")),l=i.getAttribute("viewBox"),m=l?l.split(" "):[0,0,j,k],n=0;4>n;++n)m[n]=+m[n];var o=+r.getAttribute("width"),q=+r.getAttribute("height");if(k>j)var g="scale("+q/3/m[3]+")";else var g="scale("+o/3/m[2]+")";g="translate(0) "+g+" translate(0)";var e=p.createElementNS(f,"symbol"),s=ic();for(svgedit.browser.isGecko()&&$j(i).find("linearGradient, radialGradient, pattern").appendTo(s);i.firstChild;){var t=i.firstChild;e.appendChild(t)}for(var u=i.attributes,v=0;v<u.length;v++){var w=u[v];e.setAttribute(w.nodeName,w.nodeValue)}e.id=Gb(),tb[b]={symbol:e,xform:g},ic().appendChild(e),d.addSubCommand(new $(e))}var x=p.createElementNS(f,"use");x.id=Gb(),Q(x,"#"+e.id),(B||z().getCurrentLayer()).appendChild(x),d.addSubCommand(new $(x)),Vb(),x.setAttribute("transform",g),Tb(x),$j(x).data("symbol",e).data("ref",e),Wb([x]),cb(d),Hb("changed",[r])}catch(y){return console.log(y),!1}return!0};var fc=o.identifyLayers=function(){gc(),z().identifyLayers()};this.createLayer=function(a){var b=new bb("Create Layer"),c=z().createLayer(a);b.addSubCommand(new $(c)),cb(b),Vb(),Hb("changed",[c])},this.cloneLayer=function(a){var b=new bb("Duplicate Layer"),c=p.createElementNS(f,"g"),d=p.createElementNS(f,"title");d.textContent=a,c.appendChild(d);var e=z().getCurrentLayer();$j(e).after(c);for(var g=e.childNodes,h=0;h<g.length;h++){var i=g[h];"title"!=i.localName&&c.appendChild(Lb(i))}Vb(),fc(),b.addSubCommand(new $(c)),cb(b),o.setCurrentLayer(a),Hb("changed",[c])},this.deleteCurrentLayer=function(){var a=z().getCurrentLayer(),b=a.nextSibling,c=a.parentNode;if(a=z().deleteCurrentLayer()){var d=new bb("Delete Layer");return d.addSubCommand(new _(a,b,c)),cb(d),Vb(),Hb("changed",[c]),!0}return!1},this.setCurrentLayer=function(a){var b=z().setCurrentLayer(svgedit.utilities.toXml(a));return b&&Vb(),b},this.renameCurrentLayer=function(a){var b=z();if(b.current_layer){var c=b.current_layer;if(!o.setCurrentLayer(a)){for(var d=new bb("Rename Layer"),e=0;e<b.getNumLayers()&&b.all_layers[e][1]!=c;++e);var f=b.getLayerName(e);b.all_layers[e][0]=svgedit.utilities.toXml(a);for(var g=c.childNodes.length,e=0;g>e;++e){var h=c.childNodes.item(e);if(h&&"title"==h.tagName){for(;h.firstChild;)h.removeChild(h.firstChild);return h.textContent=a,d.addSubCommand(new ab(h,{"#text":f})),cb(d),Hb("changed",[c]),!0}}}b.current_layer=c}return!1},this.setCurrentLayerPosition=function(a){var b=z();if(b.current_layer&&a>=0&&a<b.getNumLayers()){for(var c=0;c<b.getNumLayers()&&b.all_layers[c][1]!=b.current_layer;++c);if(c==b.getNumLayers())return!1;if(c!=a){var d=null,e=b.current_layer.nextSibling;return a>c?a<b.getNumLayers()-1&&(d=b.all_layers[a+1][1]):d=b.all_layers[a][1],r.insertBefore(b.current_layer,d),cb(new Z(b.current_layer,e,r)),fc(),o.setCurrentLayer(b.getLayerName(a)),!0}}return!1},this.setLayerVisibility=function(a,b){var c=z(),d=c.getLayerVisibility(a),e=c.setLayerVisibility(a,b);if(!e)return!1;var f=d?"inline":"none";return cb(new ab(e,{display:f},"Layer Visibility")),e==c.getCurrentLayer()&&(Vb(),_b.clear()),!0},this.moveSelectedToLayer=function(a){for(var b=null,c=z(),d=0;d<c.getNumLayers();++d)if(c.getLayerName(d)==a){b=c.all_layers[d][1];break}if(!b)return!1;for(var e=new bb("Move Elements to Layer"),f=E,d=f.length;d--;){var g=f[d];if(g){var h=g.nextSibling,i=g.parentNode;b.appendChild(g),e.addSubCommand(new Z(g,h,i))}}return cb(e),!0},this.mergeLayer=function(a){var b=new bb("Merge Layer"),c=z(),d=$j(c.current_layer).prev()[0];if(d){var e=c.current_layer.childNodes,f=(e.length,c.current_layer.nextSibling);for(b.addSubCommand(new _(c.current_layer,f,r));c.current_layer.firstChild;){var g=c.current_layer.firstChild;if("title"!=g.localName){var h=g.nextSibling;d.appendChild(g),b.addSubCommand(new Z(g,h,c.current_layer))}else{var i=g.nextSibling;b.addSubCommand(new _(g,i,c.current_layer)),c.current_layer.removeChild(g)}}return r.removeChild(c.current_layer),a||(Vb(),fc(),Hb("changed",[r]),cb(b)),c.current_layer=d,b}},this.mergeAllLayers=function(){var a=new bb("Merge all Layers"),b=z();for(b.current_layer=b.all_layers[b.getNumLayers()-1][1];$j(r).children("g").length>1;)a.addSubCommand(o.mergeLayer(!0));Vb(),fc(),Hb("changed",[r]),cb(a)};{var gc=this.leaveContext=function(){var a=nb.length;if(a){for(var b=0;a>b;b++){var c=nb[b],d=ib(c,"orig_opac");1!==d?c.setAttribute("opacity",d):c.removeAttribute("opacity"),c.setAttribute("style","pointer-events: inherit")}nb=[],Vb(!0),Hb("contextset",null)}B=null};this.setContext=function(a){gc(),"string"==typeof a&&(a=U(a)),B=a,$j(a).parentsUntil("#svgcontent").andSelf().siblings().each(function(){var a=this.getAttribute("opacity")||1;ib(this,"orig_opac",a),this.setAttribute("opacity",.33*a),this.setAttribute("style","pointer-events: none"),nb.push(this)}),Vb(),Hb("contextset",B)}}this.clear=function(){_b.clear(),Vb(),o.clearSvgContentElement(),o.current_drawing_=new svgedit.draw.Drawing(r),o.createLayer("Layer 1"),o.undoMgr.resetUndoStack(),db.initGroup(),xb=db.getRubberBandBox(),Hb("cleared")},this.linkControlPoints=_b.linkControlPoints,this.getContentElem=function(){return r},this.getRootElem=function(){return q},this.getSelectedElems=function(){for(var a=0;a<E.length;a++)(null==E[a]||void 0==E[a])&&(E.splice(a,1),a--);return E},this.setSelectedElems=function(a){E=E.splice(0,E.length),E=a.concat()};var hc=this.getResolution=function(){var a=parseFloat(r.getAttribute("width"))/A,b=parseFloat(r.getAttribute("height"))/A;return{w:a,h:b,zoom:A}};this.getZoom=function(){return A},this.getVersion=function(){return"svgcanvas.js ($Rev: 2199 $j)"},this.setUiStrings=function(a){$j.extend(fb,a.notification)},this.setConfig=function(a){$j.extend(l,a)},this.getTitle=function(a){if(a=a||E[0]){a=$j(a).data("gsvg")||$j(a).data("symbol")||a;for(var b=a.childNodes,c=0;c<b.length;c++)if("title"==b[c].nodeName)return b[c].textContent;return""}},this.setGroupTitle=function(a){var b=E[0];b=$j(b).data("gsvg")||b;var c=$j(b).children("title"),d=new bb("Set Label");if(a.length)if(c.length){var e=c[0];d.addSubCommand(new ab(e,{"#text":e.textContent})),e.textContent=a}else e=p.createElementNS(f,"title"),e.textContent=a,$j(b).prepend(e),d.addSubCommand(new $(e));else{var g=c.nextSibling;d.addSubCommand(new _(c[0],g,b)),c.remove()}cb(d)},this.getDocumentTitle=function(){return o.getTitle(r)},this.setDocumentTitle=function(a){for(var b=r.childNodes,c=!1,d="",e=new bb("Change Image Title"),g=0;g<b.length;g++)if("title"==b[g].nodeName){c=b[g],d=c.textContent;break}c||(c=p.createElementNS(f,"title"),r.insertBefore(c,r.firstChild)),a.length?c.textContent=a:c.parentNode.removeChild(c),e.addSubCommand(new ab(c,{"#text":d})),cb(e)
},this.getEditorNS=function(a){return a&&r.setAttribute("xmlns:se",h),h},this.setResolution=function(a,b){var c,d=hc(),e=d.w,f=d.h;if("fit"==a){var g=getStrokedBBox();if(!g)return!1;c=new bb("Fit Canvas to Content");var h=Ib();Wb(h);var i=[],j=[];$j.each(h,function(){i.push(-1*g.x),j.push(-1*g.y)});var k=o.moveSelectedElements(i,j,!0);c.addSubCommand(k),Vb(),a=Math.round(g.width),b=Math.round(g.height)}if(a!=e||b!=f){var l=q.suspendRedraw(1e3);c||(c=new bb("Change Image Dimensions")),a=N("width",a),b=N("height",b),r.setAttribute("width",a),r.setAttribute("height",b),this.contentW=a,this.contentH=b,c.addSubCommand(new ab(r,{width:e,height:f})),r.setAttribute("viewBox",[0,0,a/A,b/A].join(" ")),c.addSubCommand(new ab(r,{viewBox:["0 0",e,f].join(" ")})),cb(c),q.unsuspendRedraw(l),Hb("changed",[r])}return!0},this.getOffset=function(){return $j(r).attr(["x","y"])},this.setBBoxZoom=function(a,b,c){var d,e=.85,f=function(a){if(!a)return!1;var d=Math.round(b/a.width*100*e)/100,f=Math.round(c/a.height*100*e)/100,g=Math.min(d,f);return o.setZoom(g),{zoom:g,bbox:a}};if("object"==typeof a){if(d=a,0==d.width||0==d.height){var g=d.zoom?d.zoom:A*d.factor;return o.setZoom(g),{zoom:A,bbox:d}}return f(d)}switch(a){case"selection":if(!E[0])return;var h=$j.map(E,function(a){return a?a:void 0});d=getStrokedBBox(h);break;case"canvas":var i=hc();e=.95,d={width:i.w,height:i.h,x:0,y:0};break;case"content":d=getStrokedBBox();break;case"layer":d=getStrokedBBox(Ib(z().getCurrentLayer()));break;default:return}return f(d)},this.setZoom=function(a){var b=hc();r.setAttribute("viewBox","0 0 "+b.w/a+" "+b.h/a),A=a,$j.each(E,function(a,b){b&&db.requestSelector(b).resize()}),_b.zoomChange(),Cb("zoomChanged",a)},this.getMode=function(){return rb},this.setMode=function(a){_b.clear(!0),$b.clear(),vb=E[0]&&"text"==E[0].nodeName?ub:D,rb=a},this.getColor=function(a){return vb[a]},this.setColor=function(a,b,c){D[a]=b,vb[a+"_paint"]={type:"solidColor"};for(var d=[],e=E.length;e--;){var f=E[e];f&&("g"==f.tagName?svgedit.utilities.walkTree(f,function(a){"g"!=a.nodeName&&d.push(a)}):"fill"==a?"polyline"!=f.tagName&&"line"!=f.tagName&&d.push(f):d.push(f))}d.length>0&&(c?pc(a,b,d):(qc(a,b,d),Hb("changed",d)))};var ic=this.findDefs=function(){var a=r.getElementsByTagNameNS(f,"defs");return a.length>0?a=a[0]:(a=p.createElementNS(f,"defs"),r.firstChild?r.insertBefore(a,r.firstChild.nextSibling):r.appendChild(a)),a},jc=this.setGradient=function(a){if(vb[a+"_paint"]&&"solidColor"!=vb[a+"_paint"].type){var b=o[a+"Grad"],c=kc(b),d=ic();if(c)b=c;else{b=d.appendChild(p.importNode(b,!0)),b.id=Gb()}o.setColor(a,"url(#"+b.id+")")}},kc=function(a){for(var b=ic(),c=$j(b).find("linearGradient, radialGradient"),d=c.length,e=["r","cx","cy","fx","fy"];d--;){var g=c[d];if("linearGradient"==a.tagName){if(a.getAttribute("x1")!=g.getAttribute("x1")||a.getAttribute("y1")!=g.getAttribute("y1")||a.getAttribute("x2")!=g.getAttribute("x2")||a.getAttribute("y2")!=g.getAttribute("y2"))continue}else{var h=$j(a).attr(e),i=$j(g).attr(e),j=!1;if($j.each(e,function(a,b){h[b]!=i[b]&&(j=!0)}),j)continue}var k=a.getElementsByTagNameNS(f,"stop"),l=g.getElementsByTagNameNS(f,"stop");if(k.length==l.length){for(var m=k.length;m--;){var n=k[m],o=l[m];if(n.getAttribute("offset")!=o.getAttribute("offset")||n.getAttribute("stop-opacity")!=o.getAttribute("stop-opacity")||n.getAttribute("stop-color")!=o.getAttribute("stop-color"))break}if(-1==m)return g}}return null};this.setPaint=function(a,b){var c=new $j.jGraduate.Paint(b);switch(this.setPaintOpacity(a,c.alpha/100,!0),vb[a+"_paint"]=c,c.type){case"solidColor":this.setColor(a,"none"!=c.solidColor?"#"+c.solidColor:"none");break;case"linearGradient":case"radialGradient":o[a+"Grad"]=c[c.type],jc(a)}},this.getStrokeWidth=function(){return vb.stroke_width},this.setStrokeWidth=function(a){if(0==a&&["line","path"].indexOf(rb)>=0)return void o.setStrokeWidth(1);vb.stroke_width=a;for(var b=[],c=E.length;c--;){var d=E[c];d&&("g"==d.tagName?svgedit.utilities.walkTree(d,function(a){"g"!=a.nodeName&&b.push(a)}):b.push(d))}b.length>0&&(qc("stroke-width",a,b),Hb("changed",E))},this.setStrokeAttr=function(a,b){D[a.replace("-","_")]=b;for(var c=[],d=E.length;d--;){var e=E[d];e&&("g"==e.tagName?svgedit.utilities.walkTree(e,function(a){"g"!=a.nodeName&&c.push(a)}):c.push(e))}c.length>0&&(qc(a,b,c),Hb("changed",E))},this.getStyle=function(){return D},this.getOpacity=function(){return D.opacity},this.setOpacity=function(a){D.opacity=a,qc("opacity",a)},this.getFillOpacity=function(){return D.fill_opacity},this.getStrokeOpacity=function(){return D.stroke_opacity},this.setPaintOpacity=function(a,b,c){D[a+"_opacity"]=b,c?pc(a+"-opacity",b):qc(a+"-opacity",b)},this.getBlur=function(a){var b=0;if(a){var c=a.getAttribute("filter");if(c){var d=c.split("#");d=d[1].substr(0,parseInt(d[1].length)-1),(d.indexOf('"')>=0||d.indexOf("'")>=0)&&(d=d.substr(0,d.length-1));var e=U(d);e&&(b=e.firstChild.getAttribute("stdDeviation"))}}return b},function(){function a(){var a=o.undoMgr.finishUndoableChange();b.addSubCommand(a),cb(b),b=null,c=null}var b=null,c=null,d=!1;o.setBlurNoUndo=function(a){if(!c)return void o.setBlur(a);if(0===a)pc("filter",""),d=!0;else{var b=E[0];d&&pc("filter","url(#"+b.id+"_blur)"),svgedit.browser.isWebkit()&&(console.log("e",b),b.removeAttribute("filter"),b.setAttribute("filter","url(#"+b.id+"_blur)")),pc("stdDeviation",a,[c.firstChild]),o.setBlurOffsets(c,a)}},o.setBlurOffsets=function(a,b){b>3?V(a,{x:"-50%",y:"-50%",width:"200%",height:"200%"},100):svgedit.browser.isWebkit()||(a.removeAttribute("x"),a.removeAttribute("y"),a.removeAttribute("width"),a.removeAttribute("height"))},o.setBlur=function(d,e){if(b)return void a();var f=E[0],g=f.id;c=U(g+"_blur"),d-=0;var h=new bb;if(c)0===d&&(c=null);else{var i=F({element:"feGaussianBlur",attr:{"in":"SourceGraphic",stdDeviation:d}});c=F({element:"filter",attr:{id:g+"_blur"}}),c.appendChild(i),ic().appendChild(c),h.addSubCommand(new $(c))}var j={filter:f.getAttribute("filter")};return 0===d?(f.removeAttribute("filter"),void h.addSubCommand(new ab(f,j))):(qc("filter","url(#"+g+"_blur)"),h.addSubCommand(new ab(f,j)),o.setBlurOffsets(c,d),b=h,o.undoMgr.beginUndoableChange("stdDeviation",[c?c.firstChild:null]),void(e&&(o.setBlurNoUndo(d),a())))}}(),this.getBold=function(){var a=E[0];return null!=a&&"text"==a.tagName&&null==E[1]?"bold"==a.getAttribute("font-weight"):!1},this.setBold=function(a){var b=E[0];null!=b&&"text"==b.tagName&&null==E[1]&&qc("font-weight",a?"bold":"normal")},this.getItalic=function(){var a=E[0];return null!=a&&"text"==a.tagName&&null==E[1]?"italic"==a.getAttribute("font-style"):!1},this.setItalic=function(a){var b=E[0];null!=b&&"text"==b.tagName&&null==E[1]&&qc("font-style",a?"italic":"normal")},this.getFontFamily=function(){return ub.font_family},this.setFontFamily=function(a){ub.font_family=a,qc("font-family",a),qc("font-id",jsonfontList[a].font_id),E[0]&&!E[0].textContent&&$b.setCursor()},this.setFontColor=function(a){ub.fill=a,qc("fill",a)},this.getFontSize=function(){return ub.fill},this.getFontSize=function(){return ub.font_size},this.setFontSize=function(a){ub.font_size=a,qc("font-size",a),oc(null),E[0].textContent||$b.setCursor()},this.getText=function(){var a=E[0];return null==a?"":a.textContent},this.setTextContent=function(a){qc("#text",a),$b.init(a)};{var lc,mc,nc,oc=this.reAlignTextVertically=function(a){var a=a||E[0],b=a.getAttribute("lineHeight")?a.getAttribute("lineHeight"):1,c=$j(a).find("tspan");c.length>0&&($j.each(c,function(b,c){c.setAttribute("y",parseFloat(a.getAttribute("y")))}),nc=S(a),$j.each(c,function(c,d){d.setAttribute("y",parseFloat(a.getAttribute("y"))+nc.height*c*b)}))};this.getMultiTextContent=function(a){var a=a||E[0],b=$j(a).find("tspan");return 0==b.length&&(b=[a]),result=[],$j.each(b,function(a,b){result.push(b.textContent.replace("\n",""))}),result.join("\n")},this.setMultiTextContent=function(a,b){var a=a||E[0];if(a){clearInterval(lc);var c=b.split("\n");if(b.length){if(c.length>1||"undefined"==typeof curveTextExt){"false"==a.getAttribute("multiLine")&&curveTextExt&&curveTextExt.resetForMultiLine&&curveTextExt.resetForMultiLine(a);var d=a.getAttribute("lineHeight")?a.getAttribute("lineHeight"):1;if($j(a).empty(),svgedit.browser.isTouch()){{c.length}mc=0,lc=setInterval(e,5,c,a)}else $j.each(c,function(b,c){var e={id:Gb()};c+="",0==c.length&&(c=" "),b>0?(e.x=$j(a).attr("x"),e.y=parseFloat(a.getAttribute("y"))+nc.height*b*d):(e.x=$j(a).attr("x"),e.y=$j(a).attr("y"),nc=S(a));var f=F({element:"tspan",attr:e});f.textContent=c,$j(a).append(f),f=null}),db.requestSelector(a).resize()}else{if("true"==a.getAttribute("multiLine")&&curveTextExt&&curveTextExt.resetForSingleLine&&curveTextExt.resetForSingleLine(a),$j(a).find("textPath").length){var f=b;$j(a).find("textPath")[0].textContent=f}curveTextExt&&curveTextExt.sliderInit&&curveTextExt.sliderInit(a)}Hb("textChanged",[a])}}}}this.setImageURL=function(a){var b=E[0];if(b){var c=$j(b).attr(["width","height"]),d=!c.width||!c.height,e=P(b);if(e!==a)d=!0;else if(!d)return;var f=new bb("Change Image URL");Q(b,a),f.addSubCommand(new ab(b,{"#href":e})),d?$j(new Image).load(function(){var a=$j(b).attr(["width","height","origSize"]),c=200,d=200;if("undefined"!=typeof initWidthToAddElem){c=initWidthToAddElem,d=initHeightToAddElem;var e=this.width/this.height;d>c?d=c/e:c=d*e}this.width<=0&&this.height<=0&&(c=100,d=100),$j(b).attr({origWidth:this.width,origHeight:this.height,width:c,height:d}),setSizePosition(b,2),db.requestSelector(b).resize(),f.addSubCommand(new ab(b,a)),cb(f),Hb("selected",[b])}).attr("src",a):cb(f)}},this.setLinkURL=function(a){var b=E[0];if(b){if("a"!==b.tagName){var c=$j(b).parents("a");if(!c.length)return;b=c[0]}var d=P(b);if(d!==a){var e=new bb("Change Link URL");Q(b,a),e.addSubCommand(new ab(b,{"#href":d})),cb(e)}}},this.setRectRadius=function(a){var b=E[0];if(null!=b&&"rect"==b.tagName){var c=b.getAttribute("rx");c!=a&&(b.setAttribute("rx",a),b.setAttribute("ry",a),cb(new ab(b,{rx:c,ry:c},"Radius")),Hb("changed",[b]))}},this.makeHyperlink=function(a){o.groupSelectedElements("a",a)},this.removeHyperlink=function(){o.ungroupSelectedElement()},this.setSegType=function(a){_b.setSegType(a)},this.convertToPath=function(a,b){if(null==a){var c=E;return trace("elems"),trace(c),void $j.each(E,function(a,b){b&&o.convertToPath(b)})}if(!b)var d=new bb("Convert element to Path");var e=b?{}:{fill:D.fill,"fill-opacity":D.fill_opacity,stroke:D.stroke,"stroke-width":D.stroke_width,"stroke-dasharray":D.stroke_dasharray,"stroke-linejoin":D.stroke_linejoin,"stroke-linecap":D.stroke_linecap,"stroke-opacity":D.stroke_opacity,opacity:D.opacity,visibility:"hidden"};$j.each(["marker-start","marker-end","marker-mid","filter","clip-path"],function(){a.getAttribute(this)&&(e[this]=a.getAttribute(this))});var f=F({element:"path",attr:e}),g=a.getAttribute("transform");g&&f.setAttribute("transform",g);var h=a.id,i=a.parentNode;a.nextSibling?i.insertBefore(f,a):i.appendChild(f);var j="",k=function(a){$j.each(a,function(a,b){var c=b[0],d=b[1];j+=c;for(var e=0;e<d.length;e+=2)j+=d[e]+","+d[e+1]+" "})},l=1.81;switch(a.tagName){case"ellipse":case"circle":var m=$j(a).attr(["rx","ry","cx","cy"]),n=m.cx,p=m.cy,q=m.rx,r=m.ry;"circle"==a.tagName&&(q=r=$j(a).attr("r")),k([["M",[n-q,p]],["C",[n-q,p-r/l,n-q/l,p-r,n,p-r]],["C",[n+q/l,p-r,n+q,p-r/l,n+q,p]],["C",[n+q,p+r/l,n+q/l,p+r,n,p+r]],["C",[n-q/l,p+r,n-q,p+r/l,n-q,p]],["Z",[]]]);break;case"path":j=a.getAttribute("d");break;case"line":var m=$j(a).attr(["x1","y1","x2","y2"]);j="M"+m.x1+","+m.y1+"L"+m.x2+","+m.y2;break;case"polyline":case"polygon":j="M"+a.getAttribute("points");break;case"rect":var s=$j(a).attr(["rx","ry"]),q=s.rx,r=s.ry,t=a.getBBox(),u=t.x,v=t.y,w=t.width,x=t.height,l=4-l;k(q||r?[["M",[u,v+r]],["C",[u,v+r/l,u+q/l,v,u+q,v]],["L",[u+w-q,v]],["C",[u+w-q/l,v,u+w,v+r/l,u+w,v+r]],["L",[u+w,v+x-r]],["C",[u+w,v+x-r/l,u+w-q/l,v+x,u+w-q,v+x]],["L",[u+q,v+x]],["C",[u+q/l,v+x,u,v+x-r/l,u,v+x-r]],["L",[u,v+r]],["Z",[]]]:[["M",[u,v]],["L",[u+w,v]],["L",[u+w,v+x]],["L",[u,v+x]],["L",[u,v]],["Z",[]]]);break;default:f.parentNode.removeChild(f)}if(j&&f.setAttribute("d",j),b){_b.resetOrientation(f);var y=!1;try{y=f.getBBox()}catch(z){}return f.parentNode.removeChild(f),y}if(g){var A=G(f);J(A)&&_b.resetOrientation(f)}var B=a.nextSibling;d.addSubCommand(new _(a,B,i)),d.addSubCommand(new $(f)),Vb(),a.parentNode.removeChild(a),f.setAttribute("id",h),f.removeAttribute("visibility"),Wb([f],!0),cb(d)};var pc=function(a,b,c){var d=q.suspendRedraw(1e3);"pathedit"==rb&&_b.moveNode(a,b);for(var c=c||E,e=c.length,f=["g","polyline","path"],g=["transform","opacity","filter"];e--;){var h=c[e];if(null!=h)if("textedit"===rb&&"#text"!==a&&h.textContent.length&&$b.toSelectMode(h),("x"===a||"y"===a)&&f.indexOf(h.tagName)>=0){var i=getStrokedBBox([h]),j="x"===a?b-i.x:0,k="y"===a?b-i.y:0;o.moveSelectedElements(j*A,k*A,!0)}else{"g"===h.tagName&&g.indexOf(a)>=0;var l="#text"===a?h.textContent:h.getAttribute(a);if(null==l&&(l=""),l!==String(b)){if("#text"==a){{svgedit.utilities.getBBox(h).width}h.textContent=b,/rotate/.test(h.getAttribute("transform"))&&(h=Nb(h))}else"#href"==a?Q(h,b):h.setAttribute(a,b);svgedit.browser.isGecko()&&"text"===h.nodeName&&/rotate/.test(h.getAttribute("transform"))&&(0===(b+"").indexOf("url")||["font-size","font-family","x","y"].indexOf(a)>=0&&h.textContent)&&(h=Nb(h)),E.indexOf(h)>=0&&setTimeout(function(){h.parentNode&&db.requestSelector(h).resize()},0);var m=T(h);if(0!=m&&"transform"!=a)for(var n=G(h),p=n.numberOfItems;p--;){var r=n.getItem(p);if(4==r.type){n.removeItem(p);var s=svgedit.utilities.getBBox(h),t=H(s.x+s.width/2,s.y+s.height/2,K(n).matrix),u=t.x,v=t.y,w=q.createSVGTransform();w.setRotate(m,u,v),n.insertItemBefore(w,p);break}}}}}q.unsuspendRedraw(d)},qc=this.changeSelectedAttribute=function(a,b,c){var c=c||E;o.undoMgr.beginUndoableChange(a,c);c.length;pc(a,b,c);var d=o.undoMgr.finishUndoableChange();d.isEmpty()||cb(d)};this.hasImageSelected=function(){for(var a=E.length,b=0;a>b;b++){var c=E[b];if(null==c)break;if("image"==c.nodeName)return!0}return!1},this.deleteSelectedElements=function(){for(var a=new bb("Delete Elements"),b=E.length,c=[],d=0;b>d;++d){var e=E[d];if(null==e)break;var f=e.parentNode,g=e;db.releaseSelector(g),svgedit.path.removePath_(g.id),"a"===f.tagName&&1===f.childNodes.length&&(g=f,f=f.parentNode);var h=g.nextSibling;if("admin"!=user&&svgCanvas.getPrivateMethods().extensions.imageEffect&&"photobox"==g.getAttribute("type")&&"true"==g.getAttribute("lockTransform")&&g.childNodes[0].childNodes[0].getAttribute("templateSrc"))svgCanvas.getPrivateMethods().extensions.imageEffect.removeImage(g);else if("admin"!=user&&svgCanvas.getPrivateMethods().extensions.imageEffect&&"image"==g.tagName&&"photobox"==g.parentNode.parentNode.getAttribute("type")&&"true"==g.parentNode.parentNode.getAttribute("lockTransform")&&g.getAttribute("templateSrc"))svgCanvas.getPrivateMethods().extensions.imageEffect.removeImage(g.parentNode.parentNode);else{var i=f.removeChild(g);c.push(e),E[d]=null,a.addSubCommand(new _(i,h,f))}}a.isEmpty()||cb(a),Hb("changed",c),Vb()},this.cutSelectedElements=function(){for(var a=new bb("Cut Elements"),b=E.length,c=[],d=0;b>d;++d){var e=E[d];if(null==e)break;var f=e.parentNode,g=e;db.releaseSelector(g),svgedit.path.removePath_(g.id);var h=g.nextSibling,i=f.removeChild(g);c.push(e),E[d]=null,a.addSubCommand(new _(i,h,f))}a.isEmpty()||cb(a),Hb("changed",c),Vb(),o.clipBoard=c,o.clipBoardSide=r.cloneNode(!0),$j("#tool_paste").removeClass("disabled")},this.copySelectedElements=function(){o.clipBoard=$j.merge([],E),o.clipBoardSide=r.cloneNode(!0),$j("#tool_paste").removeClass("disabled")},this.pasteElements=function(a,b,c){var d=o.clipBoard,e=d.length;if(e){for(var f=[],g=new bb("Paste elements");e--;){var h=d[e];if(h){var i=Lb(h);U(h.id)||(i.id=h.id),f.push(i),(B||z().getCurrentLayer()).appendChild(i),g.addSubCommand(new $(i))}}Hb("element_added",f),Xb(f);for(var j=0;j<E.length;j++){var h=E[j],k=h.id,l=h.getAttribute("filter"),m=this.getBlur(h);if(l&&m){var n=F({element:"feGaussianBlur",attr:{"in":"SourceGraphic",stdDeviation:m}});l=F({element:"filter",attr:{id:k+"_blur"}}),l.appendChild(n),ic().appendChild(l),g.addSubCommand(new $(l));var p={filter:h.getAttribute("filter")};qc("filter","url(#"+k+"_blur)"),g.addSubCommand(new ab(h,p)),o.setBlurOffsets(l,m)}}if("in_place"!==a){var q,r;a?"point"===a&&(q=b,r=c):(q=Ab.x,r=Ab.y);var s=getStrokedBBox(f),t=q-s.x,u=r-s.y,v=[],w=[];$j.each(f,function(){v.push(t),w.push(u)});var x=o.moveSelectedElements(v,w,!1);g.addSubCommand(x)}cb(g),Hb("changed",f)}},this.groupSelectedElements=function(a){a||(a="g");var b="";switch(a){case"a":b="Make hyperlink";var c="";arguments.length>1&&(c=arguments[1]);break;default:a="g",b="Group Elements"}var d=new bb(b),e=F({element:a,attr:{id:Gb()}});"a"===a&&Q(e,c),d.addSubCommand(new $(e));for(var f=E.length;f--;){var g=E[f];if(null!=g){"a"===g.parentNode.tagName&&1===g.parentNode.childNodes.length&&(g=g.parentNode);var h=g.nextSibling,i=g.parentNode;e.appendChild(g),d.addSubCommand(new Z(g,h,i))}}d.isEmpty()||cb(d),Xb([e],!0)};var rc=this.pushGroupProperties=function(a,b){for(var c,d,e=a.childNodes,f=e.length,g=a.getAttribute("transform"),h=G(a),i=K(h).matrix,j=new bb("Push group properties"),k=0,l=T(a),m=$j(a).attr(["filter","opacity"]),k=0;f>k;k++){var n=e[k];if(1===n.nodeType){if(null!==m.opacity&&1!==m.opacity){var p=(n.getAttribute("opacity")||1,Math.round((n.getAttribute("opacity")||1)*m.opacity*100)/100);qc("opacity",p,[n])}if(m.filter){var r=this.getBlur(n),s=r;d||(d=this.getBlur(a)),r?r=d-0+(r-0):0===r&&(r=d),s?c=Mb(n.getAttribute("filter")):c?(c=Lb(c),ic().appendChild(c)):c=Mb(m.filter);var t="feGaussianBlur"===c.firstChild.tagName?"blur":"filter";c.id=n.id+"_"+t,qc("filter","url(#"+c.id+")",[n]),r&&(qc("stdDeviation",r,[c.firstChild]),o.setBlurOffsets(c,r))}var u=G(n);if(~n.tagName.indexOf("Gradient")&&(u=null),u&&"defs"!==n.tagName&&h.numberOfItems){if(l&&1==h.numberOfItems){var v=h.getItem(0).matrix,w=q.createSVGMatrix(),x=T(n);x&&(w=u.getItem(0).matrix);var y=svgedit.utilities.getBBox(n),z=K(u).matrix,A=H(y.x+y.width/2,y.y+y.height/2,z),B=l+x,C=q.createSVGTransform();C.setRotate(B,A.x,A.y);var D=I(v,w,C.matrix.inverse());if(x&&u.removeItem(0),B&&(u.numberOfItems?u.insertItemBefore(C,0):u.appendItem(C)),D.e||D.f){var E=q.createSVGTransform();E.setTranslate(D.e,D.f),u.numberOfItems?u.insertItemBefore(E,0):u.appendItem(E)}}else{var F=n.getAttribute("transform"),J={};J.transform=F?F:"";var L=q.createSVGTransform(),M=K(u).matrix,N=M.inverse(),O=I(N,i,M);L.setMatrix(O),u.appendItem(L)}var P=Tb(n);P&&j.addSubCommand(P)}}}if(g){var J={};J.transform=g,a.setAttribute("transform",""),a.removeAttribute("transform"),j.addSubCommand(new ab(a,J))}return b&&!j.isEmpty()?j:void 0};this.ungroupSelectedElement=function(){var a=E[0];if(console.log("ungroupSelectedElement"),console.log(a),$j(a).data("gsvg")||$j(a).data("symbol"))return void ec(a);if("use"===a.tagName){var b=U(P(a).substr(1));return $j(a).data("symbol",b).data("ref",b),void ec(a)}var c=$j(a).parents("a");if(c.length&&(a=c[0]),"g"===a.tagName||"a"===a.tagName){var d=new bb("Ungroup Elements"),e=rc(a,!0);e&&d.addSubCommand(e);for(var f=a.parentNode,g=a.nextSibling,h=new Array(a.childNodes.length),i=0;a.firstChild;){var j=a.firstChild,k=j.nextSibling,l=j.parentNode;if("title"!==j.tagName)h[i++]=j=f.insertBefore(j,g),d.addSubCommand(new Z(j,k,l));else{var m=j.nextSibling;d.addSubCommand(new _(j,m,l)),l.removeChild(j)}}Vb();var n=a.nextSibling;a=f.removeChild(a),d.addSubCommand(new _(a,n,f)),d.isEmpty()||cb(d),Wb(h)}},this.moveToTopSelectedElement=function(){var a=E[0];if(null!=a){var b=a,c=b.parentNode,d=b.nextSibling;b=b.parentNode.appendChild(b),d!=b.nextSibling&&(cb(new Z(b,d,c,"top")),Hb("changed",[b]))}},this.moveToBottomSelectedElement=function(){var a=E[0];if(null!=a){var b=a,c=b.parentNode,d=b.nextSibling,e=b.parentNode.firstChild;"title"==e.tagName&&(e=e.nextSibling),"defs"==e.tagName&&(e=e.nextSibling),b=b.parentNode.insertBefore(b,e),d!=b.nextSibling&&(cb(new Z(b,d,c,"bottom")),Hb("changed",[b]))}},this.moveUpDownSelected=function(a,b){var c=b?b:E[0];if(c){yb=[];var d,e,f=$j(Eb(getStrokedBBox([c]))).toArray();if("Down"==a&&f.reverse(),$j.each(f,function(){return e?(d=this,!1):void(this==c&&(e=!0))}),d){var g=c,h=g.parentNode,i=g.nextSibling;$j(d)["Down"==a?"before":"after"](g),i!=g.nextSibling&&(cb(new Z(g,i,h,"Move "+a)),Hb("changed",[g]))}}},this.moveSelectedElements=function(a,b,c,d){a.constructor!=Array&&(a/=A,b/=A);for(var c=c||!0,e=new bb("position"),f=d?d.length:E.length;f--;){var g=d?d[f]:E[f];if(null!=g){var h=q.createSVGTransform(),i=G(g);a.constructor==Array?h.setTranslate(a[f],b[f]):h.setTranslate(a,b),i.numberOfItems?i.insertItemBefore(h,0):i.appendItem(h);var j=Tb(g);j&&e.addSubCommand(j),"g"!=g.tagName||"web2print"!=toolType&&"producttool"!=toolType||svgedit.utilities.walkTree(g,function(a){"text"==a.tagName&&(reAlignSpan(a),oc(a))}),"text"==g.tagName&&("false"==g.getAttribute("multiLine")&&curveTextExt?curveTextExt.updatePathOnTextChange(g):(oc(g),reAlignSpan(g))),d||db.requestSelector(g).resize()}}return e.isEmpty()?void 0:(c&&cb(e),d||Hb("changed",E),e)},this.cloneSelectedElements=function(a,b){for(var c=new bb("Clone Elements"),d=E.length,e=0;d>e;++e){var f=E[e];if(null==f)break}var g=E.slice(0,e);this.clearSelection(!0);for(var e=g.length;e--;){var f=g[e]=Lb(g[e]);(B||z().getCurrentLayer()).appendChild(f),c.addSubCommand(new $(f))}o.clipBoardSide=r.cloneNode(!0),Hb("element_added",g),c.isEmpty()||(Wb(g.reverse()),this.moveSelectedElements(a,b,!1),cb(c))},this.alignSelectedElements=function(a,b,c){var d=[],e=Number.MAX_VALUE,f=Number.MIN_VALUE,g=Number.MAX_VALUE,h=Number.MIN_VALUE,i=Number.MIN_VALUE,j=Number.MIN_VALUE;c=c||E;var k=c.length;if(k){for(var l=0;k>l&&null!=c[l];++l){var m=c[l];switch(d[l]=getStrokedBBox([m]),b){case"smallest":(("l"==a||"c"==a||"r"==a)&&(i==Number.MIN_VALUE||i>d[l].width)||("t"==a||"m"==a||"b"==a)&&(j==Number.MIN_VALUE||j>d[l].height))&&(e=d[l].x,g=d[l].y,f=d[l].x+d[l].width,h=d[l].y+d[l].height,i=d[l].width,j=d[l].height);break;case"largest":(("l"==a||"c"==a||"r"==a)&&(i==Number.MIN_VALUE||i<d[l].width)||("t"==a||"m"==a||"b"==a)&&(j==Number.MIN_VALUE||j<d[l].height))&&(e=d[l].x,g=d[l].y,f=d[l].x+d[l].width,h=d[l].y+d[l].height,i=d[l].width,j=d[l].height);break;default:d[l].x<e&&(e=d[l].x),d[l].y<g&&(g=d[l].y),d[l].x+d[l].width>f&&(f=d[l].x+d[l].width),d[l].y+d[l].height>h&&(h=d[l].y+d[l].height)}}"page"==b?(e=0,g=0,f=o.contentW,h=o.contentH):"page_cutMargin"==b?(e=bleedMargin*getUnitVal(),g=bleedMargin*getUnitVal(),f=o.contentW-bleedMargin*getUnitVal(),h=o.contentH-bleedMargin*getUnitVal()):"page_safeMargin"==b&&(e=bleedMargin*getUnitVal()*2,g=bleedMargin*getUnitVal()*2,f=o.contentW-bleedMargin*getUnitVal()*2,h=o.contentH-bleedMargin*getUnitVal()*2);for(var n=new Array(k),p=new Array(k),l=0;k>l&&null!=c[l];++l){var m=c[l],q=d[l];switch(n[l]=0,p[l]=0,a){case"l":n[l]=e-q.x;break;case"c":n[l]=(e+f)/2-(q.x+q.width/2);break;case"r":n[l]=f-(q.x+q.width);break;case"t":p[l]=g-q.y;break;case"m":p[l]=(g+h)/2-(q.y+q.height/2);break;case"b":p[l]=h-(q.y+q.height);break;case"w":n[l]=e-q.x,p[l]=g-q.y;break;case"x":n[l]=f-(q.x+q.width),p[l]=g-q.y;break;case"y":n[l]=e-q.x,p[l]=h-(q.y+q.height);break;case"z":n[l]=f-(q.x+q.width),p[l]=h-(q.y+q.height);break;case"o":n[l]=(e+f)/2-(q.x+q.width/2),p[l]=(g+h)/2-(q.y+q.height/2)}}this.moveSelectedElements(n,p)}},this.contentW=hc().w,this.contentH=hc().h,this.updateCanvas=function(a,b){q.setAttribute("width",a),q.setAttribute("height",b);var c=$j("#canvasBackground")[0],d=r.getAttribute("x"),e=r.getAttribute("y"),f=a/2-this.contentW*A/2,g=b/2-this.contentH*A/2;if("producttool"==toolType){var h=q.getAttribute("x"),i=q.getAttribute("y");f=h,g=i}V(r,{width:this.contentW*A,height:this.contentH*A,x:f,y:g,viewBox:"0 0 "+this.contentW+" "+this.contentH}),V(c,{width:r.getAttribute("width"),height:r.getAttribute("height"),x:f,y:g}),V($j("#bleedHolder")[0],{width:r.getAttribute("width"),height:r.getAttribute("height"),x:f,y:g}),"web2print"==toolType&&(V($j("#gridHolder")[0],{width:r.getAttribute("width"),height:r.getAttribute("height"),x:f,y:g}),V($j("#overlayHolder")[0],{width:r.getAttribute("width"),height:r.getAttribute("height"),x:f,y:g}));var j=U("background_image");return j&&V(j,{width:"100%",height:"100%"}),db.selectorParentGroup.setAttribute("transform","translate("+f+","+g+")"),{x:f,y:g,old_x:d,old_y:e,d_x:f-d,d_y:g-e}},this.setBackground=function(a,b){var c=U("canvasBackground"),d=$j(c).find("rect")[0],e=U("background_image");d.setAttribute("fill",a),b?(e||(e=p.createElementNS(f,"image"),V(e,{id:"background_image",width:"100%",height:"100%",preserveAspectRatio:"xMinYMin",style:"pointer-events:none"})),Q(e,b),c.appendChild(e)):e&&e.parentNode.removeChild(e)},this.cycleElement=function(a){var b=E[0],c=!1,d=Ib(B||z().getCurrentLayer());if(d.length){if(null==b){var e=a?d.length-1:0;c=d[e]}else for(var f=d.length;f--;)if(d[f]==b){var e=a?f-1:f+1;e>=d.length?e=0:0>e&&(e=d.length-1),c=d[e];break}Xb([c],!0),Hb("selected",E)}},this.clear(),this.getPrivateMethods=function(){var a={addCommandToHistory:cb,setGradient:jc,addSvgElementFromJson:F,assignAttributes:V,BatchCommand:bb,call:Hb,ChangeElementCommand:ab,copyElem:Lb,ffClone:Nb,findDefs:ic,findDuplicateGradient:kc,getElem:U,getId:Fb,getIntersectionList:Eb,getMouseTarget:Yb,getNextId:Gb,getPathBBox:R,getUrlFromAttr:O,hasMatrixTransform:J,identifyLayers:fc,InsertElementCommand:$,isIdentity:svgedit.math.isIdentity,logMatrix:Qb,matrixMultiply:I,MoveElementCommand:Z,preventClickDefault:Zb,recalculateAllSelectedDimensions:Ob,recalculateDimensions:Tb,remapElement:Rb,RemoveElementCommand:_,removeUnusedDefElems:ac,round:Db,runExtensions:Cb,extensions:zb,sanitizeSvg:Y,SVGEditTransformList:svgedit.transformlist.SVGTransformList,toString:toString,transformBox:svgedit.math.transformBox,transformListToTransform:K,transformPoint:H,walkTree:svgedit.utilities.walkTree};return a}},(this.svgEditorFunc=function(){document.addEventListener("touchstart",touchHandler,!0),document.addEventListener("touchmove",touchHandler,!0),document.addEventListener("touchend",touchHandler,!0),document.addEventListener("touchcancel",touchHandler,!0),window.svgEditor||(window.svgEditor=function($j){function loadSvgString(a,b){var c=svgCanvas.setSvgString(a)!==!1;b=b||$j.noop,c?b(!0):$j.alert(uiStrings.notification.errorLoadingSVG,function(){b(!1)})}var svgCanvas,Editor={},is_ready=!1,defaultPrefs={lang:"en",iconsize:"m",bkgd_color:"none",bkgd_url:"",img_save:"embed"},curPrefs={initStroke:{width:5,color:"000000",opacity:1}},curConfig={canvasName:"default",canvas_expansion:3,dimensions:[640,480],initFill:{color:"#FF0000",opacity:1},initStroke:{width:1,color:"#000000",opacity:1},initBorder:{width:1,color:"#000000",opacity:1},initOpacity:1,imgPath:jspath+"images/",langPath:jspath+"locale/",extPath:jspath+"extensions/",jGraduatePath:jspath+"jgraduate/images/",initTool:"select",wireframe:!1,colorPickerCSS:null,gridSnapping:!1,gridColor:"#000",baseUnit:"px",snappingStep:10,showRulers:!1},uiStrings=Editor.uiStrings={common:{ok:"OK",cancel:"Cancel",key_up:"Up",key_down:"Down",key_backspace:"Backspace",key_del:"Del"},layers:{layer:"Layer"},notification:{invalidAttrValGiven:"Invalid value given",noContentToFitTo:"No content to fit to",dupeLayerName:"There is already a layer named that!",enterUniqueLayerName:"Please enter a unique layer name",enterNewLayerName:"Please enter the new layer name",layerHasThatName:"Layer already has that name",QmoveElemsToLayer:'Move selected elements to layer "%s"?',QwantToClear:"Do you want to clear the design?",QwantToDelete:"Do you want to delete selected artwork?",QwantToOpen:"Do you want to open a new file?\nThis will also erase your undo history!",QerrorsRevertToSource:"There were parsing errors in your SVG source.\nRevert back to original SVG source?",QignoreSourceChanges:"Ignore changes made to SVG source?",featNotSupported:"Feature not supported",enterNewImgURL:"Enter the new image URL",defsFailOnSave:"NOTE: Due to a bug in your browser, this image may appear wrong (missing gradients or elements). It will however appear correct once actually saved.",loadingImage:"Loading image, please wait...",saveFromBrowser:'Select "Save As..." in your browser to save this image as a %s file.',noteTheseIssues:"Also note the following issues: ",unsavedChanges:"There are unsaved changes.",enterNewLinkURL:"Enter the new hyperlink URL",errorLoadingSVG:"Error: Unable to load SVG data",URLloadFail:"Unable to load from URL",retrieving:'Retrieving "%s" ...',designSaved:"Design saved",noBackgroundImageForSize:"No Background Image available for the selected product size.",templateSaved:"Design saved successfully! <br/>Do you want to exit the template builder?",changeSizeRemoveBackground:"has no background images for the selected product size. Changing product size will remove background image(s). \n Continue ?",imageImportEnterKeyword:"Please enter keyword!",specifyDesignName:"Please specify design name.",srcapDesign:"Do you want to scrap your existing design in design area?",changeProduct:"Choosing new product will scrap your existing design in design area. Do you want to proceed?",designExit:"Do you really want to exit?",yourText:"Your Text",noDataFound:"No record found.",ADDTEXT_ALERT:"Please enter Text",printingMethod_LessQty_1:"you have to purchase atleast",printingMethod_LessQty_2:"quantity for the selected printing method.",printingMethod_MoreQty_1:"you cannot purchase more than",printingMethod_MoreQty_2:"quantity for the selected printing method.",requiredDetailsAlert:"Please insert required detail",FillAtleastOneAlert:"Please fill atleast one field",tryAgain:"Please try agian!",WrongImageWarning:"You cannot add this image.",designOverwriteWarn:"Do you want to overwrite the design?"},colorPicker:{text:{title:"Drag Markers To Pick A Color",newColor:"new",currentColor:"current",ok:"OK",cancel:"Cancel"},tooltips:{colors:{newColor:"New Color - Press &ldquo;OK&rdquo; To Commit",currentColor:"Click To Revert To Original Color"},buttons:{ok:"Commit To This Color Selection",cancel:"Cancel And Revert To Original Color"},hue:{radio:"Set To &ldquo;Hue&rdquo; Color Mode",textbox:"Enter A &ldquo;Hue&rdquo; Value (0-360&deg;)"},saturation:{radio:"Set To &ldquo;Saturation&rdquo; Color Mode",textbox:"Enter A &ldquo;Saturation&rdquo; Value (0-100%)"},value:{radio:"Set To &ldquo;Value&rdquo; Color Mode",textbox:"Enter A &ldquo;Value&rdquo; Value (0-100%)"},red:{radio:"Set To &ldquo;Red&rdquo; Color Mode",textbox:"Enter A &ldquo;Red&rdquo; Value (0-255)"},green:{radio:"Set To &ldquo;Green&rdquo; Color Mode",textbox:"Enter A &ldquo;Green&rdquo; Value (0-255)"},blue:{radio:"Set To &ldquo;Blue&rdquo; Color Mode",textbox:"Enter A &ldquo;Blue&rdquo; Value (0-255)"},alpha:{radio:"Set To &ldquo;Alpha&rdquo; Color Mode",textbox:"Enter A &ldquo;Alpha&rdquo; Value (0-100)"},hex:{textbox:"Enter A &ldquo;Hex&rdquo; Color Value (#000000-#ffffff)",alpha:"Enter A &ldquo;Alpha&rdquo; Value (#00-#ff)"}}},optionalParam:{ImportSVG:"Import SVG",ImportSVGInstruction:"Please remove red colored text and click on button below.",UPDATE:"Update",UPDATE_TEXT:"Update Text"},rollOver:{fontSizeCaption:"Font Size"},elementLabel:{YES:"Yes",NO:"No",OK:"Ok",CANCEL:"Cancel",NEXT:"Next",PREV:"Prev",avgPrintPriceCaption:"Avg Print Price",artWorkSetupPriceCaption:"Artwork Setup Price",namePriceCaption:"Name Price",numberPriceCaption:"Number Price",ClipArt:"ClipArt",PhotoBox:"Photo Box",PAGE:"Page",path:"path",line:"line",rect:"rect",ellipse:"ellipse",circle:"circle",CartConfirm:"Are you ready to place your order?",uploadHDCaption:"Upload HD",DesignAreaLabel:"Design Area",CutMarginLabel:"Cut Margin",SafeMarginLabel:"Safe Margin",DesignArea:"Design Area",DesignArea:"Design Area",actualSize:"Actual Size",fitToScreen:"Fit To Screen",DownloadPreview:"Download Preview",productSkuCaption:"<strong>SKU</strong>",totalPriceCaption:"Total Price",selectedSizeCaption:"Selected Size",QuantityCaption:"Quantity",productShortDescCaption:"<strong>Short Description</strong>",productDescCaption:"<strong>Long Description</strong>",HDUploadedMsg:"HD file uploaded successfully. It will be attached with order.",Image:"Image",frontSide:"front",printingMethodCaption:"Printing Method",currentFontSize:"Current Font Size",fontSizeInstruction:"Choose standard font size or use resize handles for custom font size",PickColorButtonCaption:"Pick Color",SELECT_ITEM:"Select Item",imageEffectBtnCaption:"Edit Effect",imageEffectCaption:"Image Effect",MaskCaption:"Mask",EffectCaption:"Effect",CustomEffectCaption:"Custom Effect",posterize:"Posterize",css_brightness:"Brightness",brightness_threshold:"Threshold",css_invert:"Invert",gamma_correct:"Color Correct",gamma_correct2:"Gamma Correct",css_grayscale:"Grayscale",css_sharpen:"Sharpen",css_hue_rotate:"Hue",luminance_mask:"Luminance",css_sepia:"Sepia",dusk:"Dusk",oneColor:"Monotone",twoColor:"Duotone",original:"None",alignmentCaption:"Alignment",font_type_caption:"Font",color_caption:"Color",font_style_caption:"Style",border_style_caption:"Border",font_shape_caption:"Font Shape",pickColorCaption:"Pick Color"},filterlabel:{},colorPicker:{text:{title:"Drag Markers To Pick A Color",newColor:"new",currentColor:"current",ok:"OK",cancel:"Cancel"},tooltips:{colors:{newColor:"New Color - Press &ldquo;OK&rdquo; To Commit",currentColor:"Click To Revert To Original Color"},buttons:{ok:"Commit To This Color Selection",cancel:"Cancel And Revert To Original Color"},hue:{radio:"Set To &ldquo;Hue&rdquo; Color Mode",textbox:"Enter A &ldquo;Hue&rdquo; Value (0-360&deg;)"},saturation:{radio:"Set To &ldquo;Saturation&rdquo; Color Mode",textbox:"Enter A &ldquo;Saturation&rdquo; Value (0-100%)"},value:{radio:"Set To &ldquo;Value&rdquo; Color Mode",textbox:"Enter A &ldquo;Value&rdquo; Value (0-100%)"},red:{radio:"Set To &ldquo;Red&rdquo; Color Mode",textbox:"Enter A &ldquo;Red&rdquo; Value (0-255)"},green:{radio:"Set To &ldquo;Green&rdquo; Color Mode",textbox:"Enter A &ldquo;Green&rdquo; Value (0-255)"},blue:{radio:"Set To &ldquo;Blue&rdquo; Color Mode",textbox:"Enter A &ldquo;Blue&rdquo; Value (0-255)"},alpha:{radio:"Set To &ldquo;Alpha&rdquo; Color Mode",textbox:"Enter A &ldquo;Alpha&rdquo; Value (0-100)"},hex:{textbox:"Enter A &ldquo;Hex&rdquo; Color Value (#000000-#ffffff)",alpha:"Enter A &ldquo;Alpha&rdquo; Value (#00-#ff)"}}}},curPrefs={},customHandlers={};
Editor.curConfig=curConfig,Editor.tool_scale=1,$j.pref=function(a,b){return b?(curPrefs[a]=b,void(Editor.curPrefs=curPrefs)):a in curPrefs?curPrefs[a]:defaultPrefs[a]},Editor.setConfig=function(a){$j.each(a,function(a,b){a in defaultPrefs&&$j.pref(a,b)}),$j.extend(!0,curConfig,a),a.extensions&&(curConfig.extensions=a.extensions)},Editor.setCustomHandlers=function(a){Editor.ready(function(){a.open&&($j('#tool_open > input[type="file"]').remove(),$j("#tool_open").show(),svgCanvas.open=a.open),a.save&&(Editor.show_save_warning=!1,svgCanvas.bind("saved",a.save)),a.pngsave&&svgCanvas.bind("exported",a.pngsave),customHandlers=a})},Editor.randomizeIds=function(){svgCanvas.randomizeIds(arguments)},Editor.init=function(){function setStrokeOpt(a,b){var c=a.id,d=c.split("_"),e=d[0],f=d[1];b&&svgCanvas.setStrokeAttr("stroke-"+e,f),operaRepaint(),setIcon("#cur_"+e,c,20),$j(a).addClass("current").siblings().removeClass("current")}function setBackground(a,b){$j.pref("bkgd_color",a),$j.pref("bkgd_url",b),svgCanvas.setBackground(a,b)}function promptImgURL(){var a=svgCanvas.getHref(selectedElement);a=0===a.indexOf("data:")?"":a,$j.prompt(uiStrings.notification.enterNewImgURL,a,function(a){a&&setImageURL(a)})}function deleteLayer(){svgCanvas.deleteCurrentLayer()&&(updateContextPanel(),populateLayers(),$j("#layerlist tr.layer").removeClass("layersel"),$j("#layerlist tr.layer:first").addClass("layersel"))}function cloneLayer(){var a=svgCanvas.getCurrentDrawing().getCurrentLayerName()+" copy";$j.prompt(uiStrings.notification.enterUniqueLayerName,a,function(a){if(a){if(svgCanvas.getCurrentDrawing().hasLayer(a))return void $j.alert(uiStrings.notification.dupeLayerName);svgCanvas.cloneLayer(a),updateContextPanel(),populateLayers()}})}function mergeLayer(){$j("#layerlist tr.layersel").index()!=svgCanvas.getCurrentDrawing().getNumLayers()-1&&(svgCanvas.mergeLayer(),updateContextPanel(),populateLayers())}function moveLayer(a){var b=$j("#layerlist tr.layersel").index(),c=svgCanvas.getCurrentDrawing().getNumLayers();(b>0||c-1>b)&&(b+=a,svgCanvas.setCurrentLayerPosition(c-b-1),populateLayers())}function stepFontSize(a,b){var c=a.value-0,d=c+b,e=d>=c;return 0===b?c:c>=24?Math.round(e?1.1*c:c/1.1):1>=c?e?2*c:c/2:d}function stepZoom(a,b){var c=a.value-0;if(0===c)return 100;var d=c+b;return 0===b?c:c>=100?d:d>=c?2*c:c/2}function onDragEnter(a){a.stopPropagation(),a.preventDefault()}function onDragOver(a){a.stopPropagation(),a.preventDefault()}function onDragLeave(a){a.stopPropagation(),a.preventDefault()}!function(){var a=window.opener;if(a)try{var b=a.document.createEvent("Event");b.initEvent("svgEditorReady",!0,!0),a.document.documentElement.dispatchEvent(b)}catch(c){}}(),function(){var a=$j.deparam.querystring(!0);if($j.isEmptyObject(a)){"svgedit-"+Editor.curConfig.canvasName}else{a.dimensions&&(a.dimensions=a.dimensions.split(",")),a.extensions&&(a.extensions=a.extensions.split(",")),a.bkgd_color&&(a.bkgd_color="#"+a.bkgd_color),svgEditor.setConfig(a);var b=a.source,c=$j.param.querystring();b||c.indexOf("source=data:")>=0&&(b=c.match(/source=(data:[^&]*)/)[1]),b?0===b.indexOf("data:")?(b=b.replace(/ /g,"+"),Editor.loadFromDataURI(b)):Editor.loadFromString(b):-1!==c.indexOf("paramurl=")?svgEditor.loadFromURL(c.substr(9)):a.url&&svgEditor.loadFromURL(a.url)}}();var extFunc=function(){var a=curConfig.extensions.length,b=0;$j.each(curConfig.extensions,function(){var c=this;$j.getScript(curConfig.extPath+c,function(d){if(!d){var e=document.createElement("script");e.src=curConfig.extPath+c,document.querySelector("head").appendChild(e)}b++,a==b&&init()})});var c=[];$j("#lang_select option").each(function(){c.push(this.value)});var d="lang"in curPrefs?curPrefs.lang:null;Editor.putLocale(d)};"file:"===document.location.protocol?setTimeout(extFunc,100):curConfig.extensions&&extFunc(),$j.svgIcons(curConfig.imgPath+"svg_edit_icons.svg",{w:30,h:30,id_match:!1,no_img:!svgedit.browser.isWebkit(),fallback_path:curConfig.imgPath,fallback:{new_image:"clear.png",save:"save.png",open:"open.png",source:"source.png",docprops:"document-properties.png",wireframe:"wireframe.png",select_node:"select_node.png",undo:"undo.png",redo:"redo.png",pencil:"fhpath.png",pen:"line.png",square:"square.png",rect:"rect.png",fh_rect:"freehand-square.png",circle:"circle.png",ellipse:"ellipse.png",fh_ellipse:"freehand-circle.png",path:"path.png",text:"text.png",image:"image.png",zoom:"zoom.png",clone:"clone.png",blur:"blur.png",node_clone:"node_clone.png","delete":"d_delete.png",node_delete:"d_delete.png",group:"shape_group.png",ungroup:"shape_ungroup.png",move_top:"move_top.png",move_bottom:"move_bottom.png",to_path:"to_path.png",link_controls:"link_controls.png",reorient:"reorient.png",fill:"fill.png",stroke:"stroke.png",opacity:"opacity.png",align:"align.png",align_left:"align-left.png",align_center:"align-center.png",align_right:"align-right.png",align_top:"align-top.png",align_middle:"align-middle.png",align_bottom:"align-bottom.png",tool_ds:"tool_ds.png",go_up:"go-up.png",go_down:"go-down.png",ok:"save.png",cancel:"cancel.png",arrow_right:"flyouth.png",arrow_down:"dropdown.gif"},placement:{"#tool_save div":"save","#tool_export div":"export","#tool_open div div":"open","#tool_import div div":"import","#tool_source":"source","#tool_docprops > div":"docprops","#tool_wireframe":"wireframe","#tool_fhpath":"pencil","#tool_line":"pen","#tool_rect,#tools_rect_show":"rect","#tool_square":"square","#tool_fhrect":"fh_rect","#tool_ellipse,#tools_ellipse_show":"ellipse","#tool_circle":"circle","#tool_fhellipse":"fh_ellipse","#tool_path":"path","#tool_text,#layer_rename":"text","#tool_image":"image","#tool_zoom":"zoom","#tool_clone ,#tool_clone_multi":"clone","#tool_node_clone":"node_clone","#layer_delete,#tool_delete,#tool_delete_multi":"delete","#tool_node_delete":"node_delete","#tool_add_subpath":"add_subpath","#tool_openclose_path":"open_path","#tool_move_top":"move_top","#tool_move_bottom":"move_bottom","#tool_topath":"to_path","#tool_node_link":"link_controls","#tool_reorient":"reorient","#tool_group":"group","#tool_ungroup":"ungroup","#tool_unlink_use":"group","#cur_position":"align","#tools_shapelib_show":"tool_ds","#linecap_butt,#cur_linecap":"linecap_butt","#linecap_round":"linecap_round","#linecap_square":"linecap_square","#linejoin_miter,#cur_linejoin":"linejoin_miter","#linejoin_round":"linejoin_round","#linejoin_bevel":"linejoin_bevel","#url_notice":"warning","#layer_up":"go_up","#layer_down":"go_down","#layer_moreopts":"context_menu","#layerlist td.layervis":"eye","#tool_source_save,#tool_docprops_save,#tool_prefs_save":"ok","#tool_edit_close,#tool_pick_color_close,#tool_add_art_close,#tool_place_text_close,#tool_add_image_close,#tool_add_shape_close,#tool_design_idea_close,#tool_choose_prod_close,#tool_source_cancel,#tool_docprops_cancel,#tool_image_upload_cancel,#tool_login_window_cancel,#tool_addnote_cancel,#tool_beforeaddtocart_cancel, #tool_save_design_window_cancel, #tool_facebook_window_cancel, #tool_flickr_window_cancel, #tool_picasa_window_cancel, #tool_instagram_window_cancel, #tool_preview_window_cancel, #tool_bgImage_window_cancel, #tool_prefs_cancel":"cancel","#rwidthLabel, #iwidthLabel":"width","#rheightLabel, #iheightLabel":"height","#cornerRadiusLabel span":"c_radius","#angleLabel":"angle","#linkLabel,#tool_make_link,#tool_make_link_multi":"globe_link","#zoomLabel":"zoom","#tool_fill label":"fill","#tool_stroke .icon_label":"stroke","#group_opacityLabel":"opacity","#blurLabel":"blur","#font_sizeLabel":"fontsize",".flyout_arrow_horiz":"arrow_right",".dropdown button, #main_button .dropdown":"arrow_down","#palette .palette_item:first, #fill_bg, #stroke_bg":"no_color"},resize:{"#logo .svg_icon":28,".flyout_arrow_horiz .svg_icon":5,".layer_button .svg_icon, #layerlist td.layervis .svg_icon":14,".dropdown button .svg_icon":7,"#main_button .dropdown .svg_icon":9,".palette_item:first .svg_icon":15,"#fill_bg .svg_icon, #stroke_bg .svg_icon":20,".toolbar_button button .svg_icon":16,".stroke_tool div div .svg_icon":20,"#tools_bottom label .svg_icon":18,"#tool_clone":30},callback:function(){$j(".toolbar_button button > svg, .toolbar_button button > img").each(function(){$j(this).parent().prepend(this)});var a=$j("#tools_left");if(0!=a.length){a.offset().top+a.outerHeight()}$j(".tools_flyout").each(function(){var a=$j("#"+this.id+"_show"),b=a.attr("data-curopt");if(!a.children("svg, img").length){var c=$j(b).children().clone();c.length&&(c[0].removeAttribute("style"),a.append(c))}}),svgEditor.runCallbacks(),setTimeout(function(){$j(".flyout_arrow_horiz:empty").each(function(){$j(this).append($j.getSvgIcon("arrow_right").width(5).height(5))})},1)}}),Editor.canvas=svgCanvas=new $j.SvgCanvas(document.getElementById("svgcanvas"),curConfig),Editor.show_save_warning=!1;var palette=["#000000","#3f3f3f","#7f7f7f","#bfbfbf","#ffffff","#ff0000","#ff7f00","#ffff00","#7fff00","#00ff00","#00ff7f","#00ffff","#007fff","#0000ff","#7f00ff","#ff00ff","#ff007f","#7f0000","#7f3f00","#7f7f00","#3f7f00","#007f00","#007f3f","#007f7f","#003f7f","#00007f","#3f007f","#7f007f","#7f003f","#ffaaaa","#ffd4aa","#ffffaa","#d4ffaa","#aaffaa","#aaffd4","#aaffff","#aad4ff","#aaaaff","#d4aaff","#ffaaff","#ffaad4"],isMac=navigator.platform.indexOf("Mac")>=0,isWebkit=navigator.userAgent.indexOf("AppleWebKit")>=0,modKey=isMac?"meta+":"ctrl+",path=svgCanvas.pathActions,undoMgr=svgCanvas.undoMgr,Utils=svgedit.utilities,default_img_url=curConfig.imgPath+"logo.png",workarea=$j("#workarea"),canv_menu=$j("#cmenu_canvas"),layer_menu=$j("#cmenu_layers"),exportWindow=null,tool_scale=1,zoomInIcon="crosshair",zoomOutIcon="crosshair",ui_context="toolbars",orig_source="",paintBox;paintBox="web2print"==toolType?{fill:null,stroke:null,border:null,bgcolor:null,qrcodecolor:null}:{fill:null,stroke:null,qrcodecolor:null,namefillColor:null,numberfillColor:null},Editor.paintBox=paintBox,function(){var a=$j("#dialog_box"),b=$j("#dialog_buttons"),c=function(c,d,e,f){$j("#dialog_content").html("<p>"+d.replace(/\n/g,"</p><p>")+"</p>").toggleClass("prompt","prompt"==c),b.empty();var g=$j('<input type="button" id="btn_ok_dig" value="'+uiStrings.common.ok+'">').appendTo(b);if("alert"!=c&&$j('<input type="button" id="btn_cancel_dig" value="'+uiStrings.common.cancel+'">').appendTo(b).click(function(){a.hide(),e(!1)}),"prompt"==c){var h=$j('<input type="text">').prependTo(b);h.val(f||""),h.bind("keydown","return",function(){g.click()})}"process"==c&&g.hide(),a.show(),g.click(function(){a.hide();var b="prompt"==c?h.val():!0;e&&e(b)}).focus(),"prompt"==c&&h.focus()};$j.alert=function(a,b){c("alert",a,b),$j("#btn_ok_dig").val(uiStrings.elementLabel.OK)},$j.confirm=function(a,b){c("confirm",a,b),$j("#btn_ok_dig").val(uiStrings.elementLabel.OK),$j("#btn_cancel_dig").val(uiStrings.elementLabel.CANCEL)},$j.confirm_custom=function(a,b){c("confirm_custom",a,b),$j("#btn_ok_dig").val(uiStrings.elementLabel.YES),$j("#btn_cancel_dig").val(uiStrings.elementLabel.NO)},$j.process_cancel=function(a,b){c("process",a,b)},$j.prompt=function(a,b,d){c("prompt",a,d,b)}}();var setSelectMode=function(){var a=$j(".tool_button_current");a.length&&"tool_select"!==a[0].id&&a.removeClass("tool_button_current").addClass("tool_button"),svgedit.browser.isIE()||$j("#styleoverrides").text("#svgcanvas svg *{cursor:move;pointer-events:all;}}"),svgCanvas.setMode("select"),workarea.css("cursor","auto")},togglePathEditMode=function(a,b){$j("#path_node_panel").toggle(a),$j("#tools_bottom_2,#tools_bottom_3").toggle(!a),a?($j(".tool_button_current").removeClass("tool_button_current").addClass("tool_button"),setIcon("#tool_select","select_node"),multiselected=!1,b.length&&(selectedElement=b[0])):setIcon("#tool_select","select")},flyoutspeed=1250,textBeingEntered=!1,selectedElement=null,multiselected=!1,editingsource=!1,docprops=!1,preferences=!1,cur_context="",orig_title=$j("title:first").text(),saveHandler=function(a,b){Editor.show_save_warning=!1,b='<?xml version="1.0"?>\n'+b;var c=navigator.userAgent;if(~c.indexOf("Chrome")&&$j.browser.version>=533||~c.indexOf("MSIE"))return void showSourceEditor(0,!0);var d=a.open("data:image/svg+xml;content-disposition: attachment;base64,"+Utils.encode64(b)),e=$j.pref("save_notice_done");if("all"!==e){var f=uiStrings.notification.saveFromBrowser.replace("%s","SVG");-1!==c.indexOf("Gecko/")?-1!==b.indexOf("<defs")?(f+="\n\n"+uiStrings.notification.defsFailOnSave,$j.pref("save_notice_done","all"),e="all"):$j.pref("save_notice_done","part"):$j.pref("save_notice_done","all"),"part"!==e&&d.alert(f)}},exportHandler=function(a,b){var c=b.issues;$("#export_canvas").length||$("<canvas>",{id:"export_canvas"}).hide().appendTo("body");var d=$("#export_canvas")[0];d.width=svgCanvas.contentW,d.height=svgCanvas.contentH,canvg(d,b.svg,{renderCallback:function(){var a=d.toDataURL("image/png");exportWindow.location.href=a;var b=$.pref("export_notice_done");if("all"!==b){var e=uiStrings.notification.saveFromBrowser.replace("%s","PNG");if(c.length){var f="\n • ";e+="\n\n"+uiStrings.notification.noteTheseIssues+f+c.join(f)}$.pref("export_notice_done","all"),exportWindow.alert(e)}}})},selectedChanged=function(a,b){var c=svgCanvas.getMode();"select"===c&&setSelectMode();var d="pathedit"==c;selectedElement=1==b.length||null==b[1]?b[0]:null,multiselected=b.length>=2&&null!=b[1],null!=selectedElement&&(d||updateToolbar()),togglePathEditMode(d,b),updateContextPanel(),svgCanvas.runExtensions("selectedChanged",{elems:b,selectedElement:selectedElement,multiselected:multiselected})},elementTransition=function(a,b){var c=svgCanvas.getMode(),d=b[0];if(d){if(multiselected=b.length>=2&&null!=b[1],!multiselected)switch(c){case"rotate":var e=svgCanvas.getRotationAngle(d);$j("#angle").val(e),$j("#tool_reorient").toggleClass("disabled",0==e)}svgCanvas.runExtensions("elementTransition",{elems:b})}},elementAdded=function(a,b){svgCanvas.runExtensions("elementAdded",{elems:b})},textChanged=function(a,b){svgCanvas.runExtensions("textChanged",{elems:b,multiselected:multiselected})},elementChanged=function(a,b){var c=svgCanvas.getMode();"select"===c&&setSelectMode();for(var d=0;d<b.length;++d){var e=b[d];e&&"svg"===e.tagName?(populateLayers(),updateCanvas()):e&&selectedElement&&null==selectedElement.parentNode&&(selectedElement=e)}Editor.show_save_warning=!0,selectedElement&&"select"===c&&(paintBox.fill.update(),paintBox.stroke.update()),svgCanvas.runExtensions("elementChanged",{elems:b})},zoomChanged=svgCanvas.zoomChanged=function(a,b,c){var d=15,e=(svgCanvas.getResolution(),workarea),f=($j("#svgcanvas").position(),svgCanvas.setBBoxZoom(b,e.width()-d,e.height()-d));if(f){var g=f.zoom,h=f.bbox;if(.001>g)return void changeZoom({value:.1});$j("#zoom").val(100*g),c?updateCanvas():updateCanvas(!1,{x:h.x*g+h.width*g/2,y:h.y*g+h.height*g/2}),"zoom"==svgCanvas.getMode()&&h.width&&setSelectMode(),zoomDone()}};$j("#cur_context_panel").delegate("a","click",function(){var a=$j(this);return a.attr("data-root")?svgCanvas.leaveContext():svgCanvas.setContext(a.text()),svgCanvas.clearSelection(),!1});var contextChanged=function(a,b){var c="";if(b){var d="";c='<a href="#" data-root="y">'+svgCanvas.getCurrentDrawing().getCurrentLayerName()+"</a>",$j(b).parentsUntil("#svgcontent > g").andSelf().each(function(){this.id&&(d+=" > "+this.id,c+=this!==b?' > <a href="#">'+this.id+"</a>":" > "+this.id)}),cur_context=d}else cur_context=null;$j("#cur_context_panel").toggle(!!b).html(c),updateTitle()},prepPaints=function(){paintBox.fill.prep(),paintBox.stroke.prep()},flyout_funcs={},setupFlyouts=function(a){$j.each(a,function(b,c){var d=$j(b).children(),e=b+"_show",f=$j(e),g=!1;d.addClass("tool_button").unbind("click mousedown mouseup").each(function(b){var d=c[b];flyout_funcs[d.sel]=d.fn,d.isDefault&&(g=b);var h=function(b){var c=d;if("keydown"===b.type){var g=$j(c.parent+"_show").hasClass("tool_button_current"),h=$j(c.parent+"_show").attr("data-curopt");$j.each(a[d.parent],function(e,f){f.sel==h&&(c=b.shiftKey&&g?a[d.parent][e+1]||a[d.parent][0]:f)})}if($j(this).hasClass("disabled"))return!1;if(toolButtonClick(e)&&c.fn(),c.icon)var i=$j.getSvgIcon(c.icon,!0);else var i=$j(c.sel).children().eq(0).clone();i[0].setAttribute("width",f.width()),i[0].setAttribute("height",f.height()),f.children(":not(.flyout_arrow_horiz)").remove(),f.append(i).attr("data-curopt",c.sel)};$j(this).mouseup(h),d.key&&$j(document).bind("keydown",d.key[0]+" shift+"+d.key[0],h)}),g?f.attr("data-curopt",c[g].sel):f.attr("data-curopt")||f.attr("data-curopt",c[0].sel);var h,i=$j(e).offset();$j(b).css({left:i.left+34,top:i.top+34-$j(window).scrollTop()}),f.mousedown(function(a){if(f.hasClass("disabled"))return!1;var c=$j(b),d=i.left+34,e=-1*c.width(),g=c.data("shown_popop")?200:0;h=setTimeout(function(){f.data("isLibrary")?c.css("left",d).show():c.css("left",e).show().animate({left:d},150),c.data("shown_popop",!0)},g),a.preventDefault()}).mouseup(function(){clearTimeout(h);var a=$j(this).attr("data-curopt");return f.data("isLibrary")&&$j(e.replace("_show","")).is(":visible")?void toolButtonClick(e,!0):void(toolButtonClick(e)&&a in flyout_funcs&&flyout_funcs[a]())})})},makeFlyoutHolder=function(a,b){var c=$j("<div>",{"class":"tools_flyout",id:a}).appendTo("#tools_left").append(b);return c},setFlyoutPositions=function(){$j(".tools_flyout").each(function(){var a=$j("#"+this.id+"_show"),b=a.offset(),c=a.outerWidth();$j(this).css({left:(b.left+c)*tool_scale,top:b.top})})},setFlyoutTitles=function(){$j(".tools_flyout").each(function(){var a=$j("#"+this.id+"_show");if(!a.data("isLibrary")){var b=[];$j(this).children().each(function(){b.push(this.title)}),a[0].title=b.join(" / ")}})},resize_timer,extAdded=function(a,b){function c(){resize_timer&&(clearTimeout(resize_timer),resize_timer=null),e||(resize_timer=setTimeout(function(){e=!0,setIconSize(curPrefs.iconsize)},50))}var d=!1,e=!1,f=!0,g=function(){b.callback&&!d&&f&&(d=!0,b.callback())},h=[];if(b.context_tools&&$j.each(b.context_tools,function(a,b){var c=b.container_id?' id="'+b.container_id+'"':"",d=$j("#"+b.panel);switch(d.length||(d=$j("<div>",{id:b.panel}).appendTo("#tools_top")),b.type){case"tool_button":var e='<div class="tool_button">'+b.id+"</div>",f=$j(e).appendTo(d);b.events&&$j.each(b.events,function(a,b){$j(f).bind(a,b)});break;case"select":var e="<label"+c+'><select id="'+b.id+'">';$j.each(b.options,function(a,c){var d=a==b.defval?" selected":"";e+='<option value="'+a+'"'+d+">"+c+"</option>"}),e+="</select></label>";var g=$j(e).appendTo(d).find("select");$j.each(b.events,function(a,b){$j(g).bind(a,b)});break;case"button-select":var e='<div id="'+b.id+'" class="dropdown toolset" title="'+b.title+'"><div id="cur_'+b.id+'" class="icon_label"></div><button></button></div>',i=$j('<ul id="'+b.id+'_opts"></ul>').appendTo("#option_lists");b.colnum&&i.addClass("optcols"+b.colnum);{$j(e).appendTo(d).children()}h.push({elem:"#"+b.id,list:"#"+b.id+"_opts",title:b.title,callback:b.events.change,cur:"#cur_"+b.id});break;case"input":var e="<label"+c+'><span id="'+b.id+'_label">'+b.label+':</span><input id="'+b.id+'" title="'+b.title+'" size="'+(b.size||"4")+'" value="'+(b.defval||"")+'" type="text"/></label>',j=$j(e).appendTo(d).find("input");b.spindata&&j.SpinButton(b.spindata),b.events&&$j.each(b.events,function(a,b){j.bind(a,b)})}}),b.buttons){var i={},j={},k=b.svgicons,l={};$j.each(b.buttons,function(a,b){for(var c,d=b.html,e=b.id,f=a;$j("#"+e).length;)e=b.id+"_"+ ++f;if(d)c=d;else if(k){i[e]=b.icon;var g=b.svgicon?b.svgicon:b.id;"app_menu"==b.type?j["#"+e+" > div"]=g:j["#"+e]=g}else c=$j('<img src="'+b.icon+'">');var h,m;switch(b.type){case"mode_flyout":case"mode":h="tool_button",m="#tools_left";break;case"context":h="tool_button",m="#"+b.panel,$j(m).length||$j("<div>",{id:b.panel}).appendTo("#tools_top");break;case"app_menu":h="",m="#main_menu ul"}var n=$j(b.list||"app_menu"==b.type?"<li/>":"<div/>").attr("id",e).attr("title",b.title).addClass(h);if(b.includeWith||b.list){if(b.list){if(n.addClass("push_button"),$j("#"+b.list+"_opts").append(n),b.isDefault){$j("#cur_"+b.list).append(n.children().clone());var g=b.svgicon?b.svgicon:b.id;j["#cur_"+b.list]=g}}else if(b.includeWith){var o=b.includeWith,p=$j(o.button),q=p.parent();if(!p.parent().hasClass("tools_flyout")){var r=p[0].id.replace("tool_","tools_"),s=p.clone().attr("id",r+"_show").append($j("<div>",{"class":"flyout_arrow_horiz"}));p.before(s),q=makeFlyoutHolder(r,p)}var t=Actions.getButtonData(o.button);o.isDefault&&(j["#"+r+"_show"]=b.id);var u=l["#"+q[0].id]=[{sel:"#"+e,fn:b.events.click,icon:b.id,key:b.key,isDefault:b.includeWith?b.includeWith.isDefault:0},t],v="position"in o?o.position:"last",w=q.children().length;!isNaN(v)&&v>=0&&w>v?q.children().eq(v).before(n):(q.append(n),u.reverse())}}else if("position"in b?$j(m).children().eq(b.position).before(n):n.appendTo(m),"mode_flyout"==b.type){var p=$j(n),q=p.parent();if(!p.parent().hasClass("tools_flyout")){var r=p[0].id.replace("tool_","tools_"),s=p.clone().attr("id",r+"_show").append($j("<div>",{"class":"flyout_arrow_horiz"}));p.before(s),q=makeFlyoutHolder(r,p),q.data("isLibrary",!0),s.data("isLibrary",!0)}j["#"+r+"_show"]=b.id;var u=l["#"+q[0].id]=[{sel:"#"+e,fn:b.events.click,icon:b.id,isDefault:!0},t]}else"app_menu"==b.type&&n.append("<div>").append(b.title);k||n.append(c),b.list||$j.each(b.events,function(a,c){"click"==a&&"mode"==b.type?(b.includeWith?n.bind(a,c):n.bind(a,function(){toolButtonClick(n)&&c()}),b.key&&($j(document).bind("keydown",b.key,c),b.title&&n.attr("title",b.title+" ["+b.key+"]"))):n.bind(a,c)}),setupFlyouts(l)}),$j.each(h,function(){addAltDropDown(this.elem,this.list,this.callback,{seticon:!0})}),k&&(f=!1);var m=24,n=24;void 0!=b.iconSize&&(m=b.iconSize[0],n=b.iconSize[1]),$j.svgIcons(k,{w:m,h:n,id_match:!1,no_img:!isWebkit,fallback:i,placement:j,callback:function(){curPrefs.iconsize&&"m"!=curPrefs.iconsize&&c(),f=!0,g()}})}g()},getPaint=Editor.getPaint=function(a,b,c){var d=null;if(0===a.indexOf("url(#")){var e=svgCanvas.getRefElem(a);e=e?e.cloneNode(!0):$j("#"+c+"_color defs *")[0],d={alpha:b},d[e.tagName]=e}else d=0===a.indexOf("#")?{alpha:b,solidColor:a.substr(1)}:{alpha:b,solidColor:"none"};return new $j.jGraduate.Paint(d)},updateToolbar=function(){if(null!=selectedElement)switch(selectedElement.tagName){case"use":case"image":case"foreignObject":break;case"g":case"a":for(var a=null,b=selectedElement.getElementsByTagName("*"),c=0,d=b.length;d>c;c++){var e=b[c].getAttribute("stroke-width");0===c?a=e:a!==e&&(a=null)}$j("#stroke_width").val(null===a?"":a),paintBox.fill.update(!0),paintBox.stroke.update(!0);break;default:paintBox.fill.update(!0),paintBox.stroke.update(!0);var f=selectedElement.getAttribute("stroke-width");f=f?f:1,$j("#stroke_slider").slider("option","value",f),$j("#stroke_width").val(f),$j("#stroke_style").val(selectedElement.getAttribute("stroke-dasharray")||"none");var g=selectedElement.getAttribute("stroke-linejoin")||"miter";0!=$j("#linejoin_"+g).length&&setStrokeOpt($j("#linejoin_"+g)[0]),g=selectedElement.getAttribute("stroke-linecap")||"butt",0!=$j("#linecap_"+g).length&&setStrokeOpt($j("#linecap_"+g)[0])}if(null!=selectedElement){var h=100*(selectedElement.getAttribute("opacity")||1);$j("#group_opacity").val(h),$j("#opac_slider").slider("option","value",100-h),$j("#elem_id").val(selectedElement.id)}updateToolButtonState()},setImageURL=Editor.setImageURL=function(a){a||(a=default_img_url),svgCanvas.setImageURL(a),$j("#image_url").val(a),0===a.indexOf("data:")?($j("#image_url").hide(),$j("#change_image_url").show()):(svgCanvas.embedImage(a,function(b){b?$j("#url_notice").hide():$j("#url_notice").show(),default_img_url=a}),$j("#image_url").show(),$j("#change_image_url").hide())},setInputWidth=function(a){var b=Math.min(Math.max(12+6*a.value.length,50),300);$j(a).width(b)},updateContextPanel=Editor.updateContextPanel=function(){var a=selectedElement;null==a||a.parentNode||(a=null);var b=svgCanvas.getCurrentDrawing().getCurrentLayerName(),c=svgCanvas.getMode(),d="px"!==curConfig.baseUnit?curConfig.baseUnit:null,e="pathedit"==c,f=$j("#cmenu_canvas li");if($j("#selected_panel, #tools_bottom_2, #multiselected_panel, #g_panel, #rect_panel, #circle_panel,					#ellipse_panel, #line_panel, #text_panel, #image_panel, #container_panel, #use_panel, #a_panel, #tool_font_family, #text_size_box").hide(),$j("#common-panel").removeClass("cbp-spmenu-open"),$j("#edit-panel").removeClass("cbp-spmenu-open"),$j("#addtext-panel").removeClass("cbp-spmenu-open"),$j("#objectColorCaption").show(),$j("#tool_group").addClass("disabled"),$j("#tool_ungroup").addClass("disabled"),$j("#tool_delete").removeClass("disabled"),$j("#tool_clone").removeClass("disabled"),$j("#tool_cut").removeClass("disabled"),$j("#tool_copy").removeClass("disabled"),$j("#alignPanel").removeClass("disabled"),null!=a){var g=a.nodeName,h=svgCanvas.getRotationAngle(a);$j("#angle").val(h);var i=svgCanvas.getBlur(a);if($j("#blur").val(i),"g"===g){selected_id=$j(selectedElement).attr("id");var j;svgedit.utilities.walkTree(selectedElement,function(a){"g"!=a.nodeName&&(stroke_width=a.getAttribute("stroke-width"),stroke_color=a.getAttribute("stroke"),fill_color=a.getAttribute("fill"),j=a.getAttribute("stroke-dasharray"))});var k=stroke_width?stroke_width:0;$j("#stroke_width").val(k),$j("#stroke_slider").slider("option","value",k),stroke_color?$j("#stroke_color svg rect").attr("fill",stroke_color):$j("#stroke_color svg rect").attr("fill","none"),$j("#fill_color svg rect").attr("fill",fill_color),$j("#stroke_style").val(j||"none")}if("text"===g){$j("#stroke_width").text(selectedElement.getAttribute("stroke-width")||1),$j("#stroke_slider").slider("option","value",selectedElement.getAttribute("stroke-width"));var l=$j("#font-box");placeholder=l.children("span"),opts=l.find("ul.dropdown > li"),placeholder.text(selectedElement.getAttribute("font-family")),placeholder.css("font-family",selectedElement.getAttribute("font-family"))}if($j("#blur_slider").slider("option","value",i),svgCanvas.addedNew&&"image"===g&&0!==svgCanvas.getHref(a).indexOf("data:")&&promptImgURL(),e||"pathedit"==c){var m=path.getNodePoint();if($j("#tool_add_subpath").removeClass("push_button_pressed").addClass("tool_button"),$j("#tool_node_delete").toggleClass("disabled",!path.canDeleteNodes),setIcon("#tool_openclose_path",path.closed_subpath?"open_path":"close_path"),m){var n=$j("#seg_type");d&&(m.x=svgedit.units.convertUnit(m.x),m.y=svgedit.units.convertUnit(m.y)),$j("#path_node_x").val(m.x),$j("#path_node_y").val(m.y),m.type?n.val(m.type).removeAttr("disabled"):n.val(4).attr("disabled","disabled")}return}if(["line","circle","ellipse"].indexOf(g)>=0)$j("#xy_panel").hide();else{var o,p;if(["g","polyline","path"].indexOf(g)>=0){var q=svgCanvas.getStrokedBBox([a]);q&&(o=q.x,p=q.y)}else o=a.getAttribute("x"),p=a.getAttribute("y");d&&(o=svgedit.units.convertUnit(o),p=svgedit.units.convertUnit(p)),$j("#selected_x").val(o||0),$j("#selected_y").val(p||0),$j("#xy_panel").show()}var r=-1==["image","text","path","g","use"].indexOf(g);$j("#tool_topath").toggle(r),$j("#tool_reorient").toggle("path"==g),$j("#tool_reorient").toggleClass("disabled",0==h);var s={g:[],a:[],rect:["rx","width","height"],image:["width","height"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],line:["x1","y1","x2","y2"],text:[],path:[],use:[]},t=a.tagName,u=null;if("a"===t&&(u=svgCanvas.getHref(a),$j("#tool_ungroup").show(),$j("#tool_ungroup").removeClass("disabled"),$j("#tool_group").hide()),"a"===a.parentNode.tagName&&($j(a).siblings().length||($j("#tool_ungroup").show(),$j("#tool_ungroup").removeClass("disabled"),$j("#tool_group").hide(),u=svgCanvas.getHref(a.parentNode))),$j("#tool_make_link, #tool_make_link").toggle(!u),u&&$j("#link_url").val(u),s[t]){var v=s[t];$j("#"+t+"_panel").show(),$j.each(v,function(b,c){var d=a.getAttribute(c);if("px"!==curConfig.baseUnit&&a[c]){var e=a[c].baseVal.value;d=svgedit.units.convertUnit(e)}$j("#"+t+"_"+c).val(d||0)}),"admin"==user?$j("#font-selector-con").css("margin-left","0%"):$j("#font-selector-con").css("margin-left","-65%"),$j("#fill_box").css("display","block"),$j("#tool_fill").css("display","block"),$j("#tool_stroke").css("display","block"),$j("#border_box").css("display","block"),$j(".opration-1").show(),console.log("ELEM TYPE::"+t),"text"==a.getAttribute("type")?($j("#font_type_caption").show(),$j("#font-size-caption").show(),$j("#font-shape-caption").show(),$j("#font_style_caption").show(),$j(".size-bold-italic").show()):($j("#font_type_caption").hide(),$j("#font-size-caption").hide(),$j("#font-shape-caption").hide(),$j("#font_style_caption").hide(),$j(".size-bold-italic").hide()),"text"==t?($j(".jGraduate_tab_color").trigger("click"),$j("#objectColorCaption").hide(),disableOther("addtext"),$j("#addtext").addClass("active"),$j("#addtext-panel").addClass("cbp-spmenu-open"),$j("#name_num_close").trigger("mousedown"),"producttool"==toolType||$j("#common-panel").css("margin-top","120px"),$j("#common-panel").addClass("cbp-spmenu-open"),$j("#text_panel").css("display","inline"),$j(".cmn-ln-caption").css("display","inline"),$j("#btnAddText").hide(),$j("#tool_font_family").show(),$j("#text_size_box").show(),svgCanvas.getItalic()?$j("#tool_italic").addClass("push_button_pressed").removeClass("tool_button"):$j("#tool_italic").removeClass("push_button_pressed").addClass("tool_button"),svgCanvas.getBold()?$j("#tool_bold").addClass("push_button_pressed").removeClass("tool_button"):$j("#tool_bold").removeClass("push_button_pressed").addClass("tool_button"),$j("#font-selector").val(a.getAttribute("font-family")).attr("selected","selected"),$j("#font_size").val(a.getAttribute("font-size")),$j("#font_size_slider").slider("option","value",a.getAttribute("font-size")),"producttool"==toolType&&$j("#text").val(a.textContent),svgCanvas.addedNew&&setTimeout(function(){$j("#text").focus().select()},100),$j("#stroke_width").text(selectedElement.getAttribute("stroke-width")||1)):"image"==t||"photobox"==a.getAttribute("type")?($j(".opration-1").hide(),disableOther("editpanel"),$j("#addtimage-panel").addClass("cbp-spmenu-open"),showHideImageGallery(),$j("#name_num_close").trigger("mousedown"),"producttool"==toolType||$j("#common-panel").css("margin-top","215px"),$j("#common-panel").addClass("cbp-spmenu-open"),$j("#tool_fill").css("display","none"),$j("#tool_stroke").css("display","none"),$j("#border_box").css("display","none"),$j("#fill_box").css("display","none"),$j("#tool_ungroup").hide(),$j("#tool_group").hide(),$j(".font-size").hide()):"g"===t||"use"===t?(disableOther("editpanel"),$j("#edit-panel").addClass("cbp-spmenu-open"),$j("#name_num_close").trigger("mousedown"),"producttool"==toolType||$j("#common-panel").css("margin-top","0px"),$j("#common-panel").addClass("cbp-spmenu-open"),$j("#container_panel").show(),$j("#tool_ungroup").show(),$j("#tool_ungroup").removeClass("disabled"),$j("#tool_group").hide(),$j(".font-size").hide(),$j(".group_ungroup").show(),1==$j("#"+a.id)[0].childElementCount?$j("#tool_ungroup").hide():$j("#"+a.id)[0].childElementCount>>1&&$j("#tool_ungroup").show()):("path"===t||"line"===t||"rect"===t||"ellipse"===t||"circle"===t)&&(disableOther("addshape"),$j("#addshape").addClass("active"),$j("#addshape-panel").addClass("cbp-spmenu-open"),$j("#name_num_close").trigger("mousedown"),"producttool"==toolType||$j("#common-panel").css("margin-top","0px"),$j("#common-panel").addClass("cbp-spmenu-open"),$j(".font-size").hide(),$j("#tool_group").hide(),$j("#tool_ungroup").hide(),$j("#navaart").hide(),"line"===t&&$j("#tool_fill").css("display","none"))}f[("g"===t?"en":"dis")+"ableContextMenuItems"]("#ungroup"),f[("g"!==t&&multiselected?"en":"dis")+"ableContextMenuItems"]("#group")}else multiselected?($j(".opration-1").hide(),$j("#font_type_caption").hide(),$j("#font-size-caption").hide(),$j("#font-shape-caption").hide(),$j("#font_style_caption").hide(),$j(".size-bold-italic").hide(),trace("mulsti selected"),disableOther("editpanel"),$j("#edit-panel").addClass("cbp-spmenu-open"),"producttool"==toolType,svgCanvas.hasImageSelected()?$j("#tool_fill,#tool_stroke,#border_box,#fill_box").hide():$j("#tool_fill,#tool_stroke,#border_box,#fill_box").show(),$j(".font-size").hide(),$j("#tool_group").show(),$j("#tool_group").removeClass("disabled"),$j("#tool_ungroup").hide(),f.enableContextMenuItems("#group").disableContextMenuItems("#ungroup")):("producttool"==toolType?(disableOther("layerPanel"),$j("#layer-panel").addClass("cbp-spmenu-open")):(disableOther("layerPanel"),$j("#layer-panel").addClass("cbp-spmenu-open")),$j("#tool_delete").addClass("disabled"),$j("#tool_clone").addClass("disabled"),$j("#tool_cut").addClass("disabled"),$j("#tool_copy").addClass("disabled"));
undoMgr.getUndoStackSize()>0&&undoMgr.getRedoStackSize()<1?$j("#tool_undo").removeClass("disabled"):$j("#tool_undo").addClass("disabled"),undoMgr.getRedoStackSize()>0?$j("#tool_redo").removeClass("disabled"):$j("#tool_redo").addClass("disabled"),svgCanvas.addedNew=!1,a&&!e||multiselected?($j("#selLayerNames").removeAttr("disabled").val(b),canv_menu.enableContextMenuItems("#delete,#cut,#copy,#move_front,#move_up,#move_down,#move_back")):$j("#selLayerNames").attr("disabled","disabled")};$j("#text").focus(function(){textBeingEntered=!0}),$j("#text").blur(function(){textBeingEntered=!1}),svgCanvas.bind("selected",selectedChanged),svgCanvas.bind("transition",elementTransition),svgCanvas.bind("changed",elementChanged),svgCanvas.bind("textChanged",textChanged),svgCanvas.bind("saved",saveHandler),svgCanvas.bind("exported",exportHandler),svgCanvas.bind("zoomed",zoomChanged),svgCanvas.bind("contextset",contextChanged),svgCanvas.bind("extension_added",extAdded),svgCanvas.bind("element_added",elementAdded),svgCanvas.textActions.setInputElem($j("#text")[0]);var str='<div class="palette_item" data-rgb="none"></div>';$j.each(palette,function(a,b){str+='<div class="palette_item" style="background-color: '+b+';" data-rgb="'+b+'"></div>'}),$j("#palette").append(str);var color_blocks=["#FFF","#888","#000"],str="";$j.each(color_blocks,function(){str+='<div class="color_block" style="background-color:'+this+';"></div>'}),$j("#bg_blocks").append(str);var blocks=$j("#bg_blocks div"),cur_bg="cur_background";blocks.each(function(){var a=$j(this);a.click(function(){blocks.removeClass(cur_bg),$j(this).addClass(cur_bg)})}),$j.pref("bkgd_color")?setBackground($j.pref("bkgd_color")):$j.pref("bkgd_url"),$j.pref("img_save")&&(curPrefs.img_save=$j.pref("img_save"),$j("#image_save_opts input").val([curPrefs.img_save]));var changeRectRadius=function(a){svgCanvas.setRectRadius(a.value)},changeFontSize=function(a){$j("#font_size").val(a.value),svgCanvas.setFontSize(a.value)},updateStrokeWidth=function(a){$j("#stroke_width").val(a),0==a&&selectedElement&&["line","polyline"].indexOf(selectedElement.nodeName)>=0&&(a=ctl.value=1),svgCanvas.setStrokeWidth(a)},changeStrokeWidth=function(a){var b=a.value;$j("#stroke_width").val(b),0==b&&selectedElement&&["line","polyline"].indexOf(selectedElement.nodeName)>=0&&(b=a.value=1),svgCanvas.setStrokeWidth(b)},changeRotationAngle=function(a){svgCanvas.setRotationAngle(a.value),$j("#tool_reorient").toggleClass("disabled",0==a.value)},changeZoom=svgCanvas.changeZoom=function(a){var b=a.value/100;if(.001>b)return void(a.value=.1);var c=svgCanvas.getZoom(),d=workarea;zoomChanged(window,{width:0,height:0,x:(d[0].scrollLeft+d.width()/2)/c,y:(d[0].scrollTop+d.height()/2)/c,zoom:b},!0)},changeOpacity=function(a,b){null==b&&(b=a.value),$j("#group_opacity").val(b),a&&a.handle||$j("#opac_slider").slider("option","value",b),svgCanvas.setOpacity(b/100)},changeBlur=function(a,b,c){null==b&&(b=a.value),$j("#blur").val(b);var d=!1;a&&a.handle||($j("#blur_slider").slider("option","value",b),d=!0),svgCanvas.setBlurNoUndo(b),c?svgCanvas.setBlurNoUndo(b):svgCanvas.setBlur(b,d)},operaRepaint=function(){window.opera&&$j("<p/>").hide().appendTo("body").remove()};$j("#stroke_linejoin").change(function(){svgCanvas.setStrokeAttr("stroke-linejoin",$j(this).val()),operaRepaint()}),$j("select").change(function(){$j(this).blur()});var promptMoveLayerOnce=!1;$j("#selLayerNames").change(function(){var a=this.options[this.selectedIndex].value,b=uiStrings.notification.QmoveElemsToLayer.replace("%s",a),c=function(b){b&&(promptMoveLayerOnce=!0,svgCanvas.moveSelectedToLayer(a),svgCanvas.clearSelection(),populateLayers())};a&&(promptMoveLayerOnce?c(!0):$j.confirm(b,c))}),$j("#font_family").change(function(){svgCanvas.setFontFamily(this.value)}),$j("#seg_type").change(function(){svgCanvas.setSegType($j(this).val())});var multiTextInterval;$j("#text").keyup(function(){"web2print"==toolType||"producttool"==toolType?svgedit.browser.isTouch()?(clearTimeout(multiTextInterval),multiTextInterval=setTimeout(svgCanvas.setMultiTextContent,1e3,null,this.value)):svgCanvas.setMultiTextContent(null,this.value):svgCanvas.setTextContent(this.value)}),$j("#image_url").change(function(){setImageURL(this.value)}),$j("#link_url").change(function(){this.value.length?svgCanvas.setLinkURL(this.value):svgCanvas.removeHyperlink()}),$j(".attr_changer").change(function(){var a=this.getAttribute("data-attr"),b=this.value,c=svgedit.units.isValidUnit(a,b,selectedElement);if(!c)return $j.alert(uiStrings.notification.invalidAttrValGiven),this.value=selectedElement.getAttribute(a),!1;if("id"!==a)if(isNaN(b))b=svgCanvas.convertToNum(a,b);else if("px"!==curConfig.baseUnit){var d=svgedit.units.getTypeMap();(selectedElement[a]||"pathedit"===svgCanvas.getMode()||"x"===a||"y"===a)&&(b*=d[curConfig.baseUnit])}if("id"===a){var e=selectedElement;svgCanvas.clearSelection(),e.id=b,svgCanvas.addToSelection([e],!0)}else svgCanvas.changeSelectedAttribute(a,b);this.blur()}),$j("#palette").mouseover(function(){var a=$j('<input type="hidden">');$j(this).append(a),a.focus().remove()}),$j(".palette_item").mousedown(function(a){var b=2===a.button,c=a.shiftKey||b,d=c?"stroke":"fill",e=$j(this).attr("data-rgb"),f=null;"none"===e||"transparent"===e||"initial"===e?(e="none",f=new $j.jGraduate.Paint):f=new $j.jGraduate.Paint({alpha:100,solidColor:e.substr(1)}),paintBox[d].setPaint(f),c?(svgCanvas.setColor("stroke",e),"none"!=e&&1!=svgCanvas.getStrokeOpacity()&&svgCanvas.setPaintOpacity("stroke",1)):(svgCanvas.setColor("fill",e),"none"!=e&&1!=svgCanvas.getFillOpacity()&&svgCanvas.setPaintOpacity("fill",1)),updateToolButtonState()}).bind("contextmenu",function(a){a.preventDefault()}),$j("#toggle_stroke_tools").on("click",function(){$j("#tools_bottom").toggleClass("expanded")});var toolButtonClick=function(a,b){if($j(a).hasClass("disabled"))return!1;if($j(a).parent().hasClass("tools_flyout"))return!0;return $j("#styleoverrides").text(""),workarea.css("cursor","auto"),$j(".tool_button_current").removeClass("tool_button_current").addClass("tool_button"),$j(a).addClass("tool_button_current").removeClass("tool_button"),!0};!function(){var a=null,b=null,c=workarea[0],d=!1,e=!1;$j("#svgcanvas").bind("mousemove mouseup",function(e){return d!==!1?(c.scrollLeft-=e.clientX-a,c.scrollTop-=e.clientY-b,a=e.clientX,b=e.clientY,"mouseup"===e.type&&(d=!1),!1):void 0}).mousedown(function(c){return 1===c.button||e===!0?(d=!0,a=c.clientX,b=c.clientY,!1):void 0}),$j(window).mouseup(function(){d=!1}),$j(document).bind("keydown","space",function(a){svgCanvas.spaceKey=e=!0,a.preventDefault()}).bind("keyup","space",function(a){a.preventDefault(),svgCanvas.spaceKey=e=!1}).bind("keydown","shift",function(){"zoom"===svgCanvas.getMode()&&workarea.css("cursor",zoomOutIcon)}).bind("keyup","shift",function(){"zoom"===svgCanvas.getMode()&&workarea.css("cursor",zoomInIcon)})}(),function(){var a=$j("#main_icon"),b=($j("#main_icon span"),$j("#main_menu")),c=!1,d=!0,e=!1;$j(window).mouseup(function(d){var f=$j(d.target).closest("div.tools_flyout, .contextMenu").length;f||$j(".tools_flyout:visible,.contextMenu").hide(),$j(".tools_flyout").hide(),c||(a.removeClass("buttondown"),"INPUT"!=d.target.tagName?b.fadeOut(200):e||(e=!0,$j(d.target).click(function(){b.css("margin-left","-9999px").show()}))),c=!1});var f=$j("#main_menu li");f.mouseover(function(){d="rgba(0, 0, 0, 0)"==$j(this).css("background-color"),f.unbind("mouseover"),d&&f.mouseover(function(){this.style.backgroundColor="#FFC"}).mouseout(function(){return this.style.backgroundColor="transparent",!0})})}(),Editor.addDropDown=function(a,b,c){if(0!=$j(a).length){var d=$j(a).find("button"),e=$j(a).find("ul").attr("id",$j(a)[0].id+"-list");c||$j("#tool_font_family").append(e);var f=!1;c&&$j(a).addClass("dropup"),e.find("li").bind("mouseup",b),$j(window).mouseup(function(){f||(d.removeClass("down"),e.hide()),f=!1}),d.bind("mousedown",function(){if(d.hasClass("down"))d.removeClass("down"),e.hide();else{if(d.addClass("down"),!c){var b=$j(a).position();e.css({top:b.top+24,left:b.left-10})}e.show(),f=!0}}).hover(function(){f=!0}).mouseout(function(){f=!1})}};var addAltDropDown=function(a,b,c,d){var e=$j(a),b=$j(b),f=!1,g=d.dropUp;g&&$j(a).addClass("dropup"),b.find("li").bind("mouseup",function(){d.seticon&&(setIcon("#cur_"+e[0].id,$j(this).children()),$j(this).addClass("current").siblings().removeClass("current")),c.apply(this,arguments)}),$j(window).mouseup(function(){f||(e.removeClass("down"),b.hide(),b.css({top:0,left:0})),f=!1});b.height();$j(a).bind("mousedown",function(){var c=$j(a).offset();return g?(c.top-=b.height(),c.left+=8):c.top+=$j(a).height(),$j(b).offset(c),e.hasClass("down")?(e.removeClass("down"),b.hide(),b.css({top:0,left:0}),void 0):(e.addClass("down"),b.show(),f=!0,!1)}).hover(function(){f=!0}).mouseout(function(){f=!1}),d.multiclick&&b.mousedown(function(){f=!0})};Editor.addDropDown("#font_family_dropdown",function(){$j(this).text();$j("#font_family").val($j(this).text()).change()}),Editor.addDropDown("#opacity_dropdown",function(){if(!$j(this).find("div").length){var a=parseInt($j(this).text().split("%")[0]);changeOpacity(!1,a)}},!0),$j("#opac_slider").slider({min:0,max:100,step:1,range:"min",orientation:"horizontal",start:function(){$j("#opacity_dropdown li:not(.special)").hide()},stop:function(){$j("#opacity_dropdown li").show(),$j(window).mouseup(),updateCanvas()},slide:function(a,b){changeOpacity(b,100-b.value)}}).draggable(),Editor.addDropDown("#blur_dropdown",$j.noop,!0);var slideStart=!1;$j("#blur_slider").slider({max:10,step:.1,range:"min",orientation:"horizontal",stop:function(a,b){slideStart=!1,changeBlur(b),$j("#blur_dropdown li").show(),$j(window).mouseup()},start:function(){slideStart=!0,updateCanvas()},slide:function(a,b){changeBlur(b,null,slideStart)}}).draggable(),Editor.addDropDown("#stroke_dropdown",$j.noop,!0);var slideStart=!1;$j(".border_size_option > button").on("mousedown",function(){var a=parseInt($j("#"+this.id).text());updateStrokeWidth(a),$j("#bordercontrolls").show(),$j(".border_colorpicker").css("left","0px")}),$j(".border_style button").on("mousedown",function(){svgCanvas.setStrokeAttr("stroke-dasharray",$j("#"+this.id).attr("value")),operaRepaint(),$j("#bordercontrolls").show(),$j(".border_colorpicker").css("left","0px")}),$j("#stroke_slider").slider({min:0,max:10,step:1,range:"min",orientation:"horizontal",stop:function(a,b){slideStart=!1,changeStrokeWidth(b),$j("#stroke_dropdown li").show(),$j(window).mouseup(),svgedit.browser.isTouch()&&updateCanvas()},start:function(){slideStart=!0},slide:function(a,b){changeStrokeWidth(b,null,slideStart)}});var slideStart=!1;$j("#font_size_slider").slider({max:50,min:8,step:1,range:"min",orientation:"horizontal",value:$j("#font_size").val(),stop:function(a,b){slideStart=!1,changeFontSize(b),$j("#font_size_dropdown li").show(),$j(window).mouseup(),updateCanvas()},start:function(){slideStart=!0},slide:function(a,b){changeFontSize(b,null,slideStart)}}).draggable(),Editor.addDropDown("#zoom_dropdown",function(){var a=$j(this),b=a.attr("data-val");b?zoomChanged(window,b):changeZoom({value:parseInt(a.text())})},!0),addAltDropDown("#stroke_linecap","#linecap_opts",function(){setStrokeOpt(this,!0)},{dropUp:!0}),addAltDropDown("#stroke_linejoin","#linejoin_opts",function(){setStrokeOpt(this,!0)},{dropUp:!0}),addAltDropDown("#tool_position","#position_opts",function(){var a=this.id.replace("tool_pos","").charAt(0);svgCanvas.alignSelectedElements(a,"page")},{multiclick:!0}),function(){var a,b=function(){$j(a).blur()};$j("#svg_editor").find("button, select, input:not(#text)").focus(function(){a=this,ui_context="toolbars",workarea.mousedown(b)}).blur(function(){ui_context="canvas",workarea.unbind("mousedown",b),"textedit"==svgCanvas.getMode()&&$j("#text").focus()})}();var clickSelect=function(){toolButtonClick("#tool_select")&&svgCanvas.setMode("select")},clickFHPath=function(){toolButtonClick("#tool_fhpath")&&svgCanvas.setMode("fhpath")},clickLine=function(a){if(toolButtonClick("#tool_line")){{window.event||a}svgCanvas.setMode("line"),$j("#tools_line").show()}},clickSquare=function(){toolButtonClick("#tool_square")&&(trace("clcked in svg editor js."),svgCanvas.setMode("square"))},clickRect=function(a){if(toolButtonClick("#tool_rect")){{window.event||a}$j(".tools_flyout").hide(),svgCanvas.setMode("rect"),$j("#tools_rect").show(),$j("#tools_rect_show").removeAttr("class").addClass("flyout_current tool_button_current tool_rect")}},clickFHRect=function(){toolButtonClick("#tool_fhrect")&&svgCanvas.setMode("fhrect")},clickCircle=function(){toolButtonClick("#tool_circle")&&svgCanvas.setMode("circle")},clickEllipse=function(a){if(toolButtonClick("#tool_ellipse")){{window.event||a}$j(".tools_flyout").hide(),svgCanvas.setMode("ellipse"),$j("#tools_ellipse").show()}},clickFHEllipse=function(){toolButtonClick("#tool_fhellipse")&&svgCanvas.setMode("fhellipse")},clickImage=function(){toolButtonClick("#tool_image")&&svgCanvas.setMode("image")},clickZoom=function(){toolButtonClick("#tool_zoom")&&(svgCanvas.setMode("zoom"),workarea.css("cursor",zoomInIcon))},dblclickZoom=function(){toolButtonClick("#tool_zoom")&&(zoomImage(),setSelectMode())},clickText=Editor.clickText=function(){toolButtonClick("#tool_text")&&svgCanvas.setMode("text")},clickPath=function(){toolButtonClick("#tool_path")&&svgCanvas.setMode("path")},deleteSelected=function(){var a=svgCanvas.getSelectedElems();if(a)for(var b=0;b<a.length;b++){var c=a[b];svgCanvas.getPrivateMethods().extensions.imageEffect&&"photobox"==c.getAttribute("type")?svgCanvas.getPrivateMethods().extensions.imageEffect.removeImage(c):$j("#tool_delete").hasClass("disabled")&&"admin"!=user||!c||"true"==c.getAttribute("lock")?svgCanvas.getPrivateMethods().extensions.photoCollage&&svgCanvas.getPrivateMethods().extensions.photoCollage.isSelected()&&svgCanvas.getPrivateMethods().extensions.photoCollage.removeImage():svgCanvas.getPrivateMethods().extensions.nameNumber&&svgCanvas.getPrivateMethods().extensions.nameNumber.isNameNumSelected()||(null!=selectedElement||multiselected)&&$j.confirm(uiStrings.notification.QwantToDelete,function(a){a&&(svgCanvas.deleteSelectedElements(),svgCanvas.runExtensions("elementRemoved"))})}},cutSelected=function(){$j("#tool_cut").hasClass("disabled")&&"admin"!=user||(null!=selectedElement||multiselected)&&svgCanvas.cutSelectedElements()},copySelected=function(){$j("#tool_copy").hasClass("disabled")&&"admin"!=user||(null!=selectedElement||multiselected)&&svgCanvas.copySelectedElements()},pasteInCenter=function(){{var a=svgCanvas.getZoom();(workarea[0].scrollLeft+workarea.width()/2)/a-svgCanvas.contentW,(workarea[0].scrollTop+workarea.height()/2)/a-svgCanvas.contentH}svgCanvas.pasteElements("point",0,0)},moveToTopSelected=function(){null!=selectedElement&&svgCanvas.moveToTopSelectedElement()},moveToBottomSelected=function(){null!=selectedElement&&svgCanvas.moveToBottomSelectedElement()},moveUpDownSelected=function(a){null!=selectedElement&&svgCanvas.moveUpDownSelected(a)},convertToPath=function(){null!=selectedElement&&svgCanvas.convertToPath()},reorientPath=function(){null!=selectedElement&&path.reorient()},makeHyperlink=function(){(null!=selectedElement||multiselected)&&$j.prompt(uiStrings.notification.enterNewLinkURL,"http://",function(a){a&&svgCanvas.makeHyperlink(a)})},moveSelected=function(a,b){if(null!=selectedElement||multiselected){if(curConfig.gridSnapping){var c=svgCanvas.getZoom()*curConfig.snappingStep;a*=c,b*=c}svgCanvas.moveSelectedElements(a,b)}},linkControlPoints=function(){var a=!$j("#tool_node_link").hasClass("push_button_pressed");a?$j("#tool_node_link").addClass("push_button_pressed").removeClass("tool_button"):$j("#tool_node_link").removeClass("push_button_pressed").addClass("tool_button"),path.linkControlPoints(a)},clonePathNode=function(){path.getNodePoint()&&path.clonePathNode()},deletePathNode=function(){path.getNodePoint()&&path.deletePathNode()},addSubPath=function(){var a=$j("#tool_add_subpath"),b=!a.hasClass("push_button_pressed");b?a.addClass("push_button_pressed").removeClass("tool_button"):a.removeClass("push_button_pressed").addClass("tool_button"),path.addSubPath(b)},opencloseSubPath=function(){path.opencloseSubPath()},selectNext=function(){svgCanvas.cycleElement(1)},selectPrev=function(){svgCanvas.cycleElement(0)},rotateSelected=function(a,b){if(null!=selectedElement&&!multiselected){a||(b*=-1);var c=1*$j("#angle").val()+b;svgCanvas.setRotationAngle(c),updateContextPanel()}},clickClear=function(){var a=curConfig.dimensions;$j.confirm(uiStrings.notification.QwantToClear,function(b){b&&(setSelectMode(),svgCanvas.clear(),svgCanvas.setResolution(a[0],a[1]),updateCanvas(!0),zoomImage(),populateLayers(),updateContextPanel(),prepPaints(),svgCanvas.runExtensions("onNewDocument"))})},clickClear_All=Editor.clickClear_All=function(){svgCanvas.clear(),svgCanvas.runExtensions("onNewDocument")},clickBold=function(){return $j("#tool_bold").hasClass("disabled")?void 0:(svgCanvas.setBold(!svgCanvas.getBold()),svgCanvas.getBold()?$j("#tool_bold").addClass("push_button_pressed").removeClass("tool_button"):$j("#tool_bold").removeClass("push_button_pressed").addClass("tool_button"),!1)},clickItalic=function(){return $j("#tool_italic").hasClass("disabled")?void 0:(svgCanvas.setItalic(!svgCanvas.getItalic()),svgCanvas.getItalic()?$j("#tool_italic").addClass("push_button_pressed").removeClass("tool_button"):$j("#tool_italic").removeClass("push_button_pressed").addClass("tool_button"),!1)},clickSave=Editor.clickSave=function(){var a={images:!0,round_digits:6};return svgCanvas.save(a)},clickExport=Editor.clickExport=function(){if(!customHandlers.pngsave){uiStrings.notification.loadingImage}return window.canvg?svgCanvas.rasterExport():void $j.getScript(jspath+"canvg/rgbcolor.js",function(){$j.getScript(jspath+"canvg/canvg.js",function(){return svgCanvas.rasterExport()})})},clickOpen=function(){svgCanvas.open()},clickImport=Editor.clickImport=function(){},clickUndo=function(){undoMgr.getUndoStackSize()>0&&undoMgr.getRedoStackSize()<1&&(undoMgr.undo(),populateLayers())},clickRedo=function(){undoMgr.getRedoStackSize()>0&&(undoMgr.redo(),populateLayers())},clickGroup=function(){parseFloat($j("#common-panel").css("left")),parseFloat($j("#common-panel").css("top"));multiselected?$j("#tool_group").hasClass("disabled")&&"admin"!=user||svgCanvas.groupSelectedElements():selectedElement&&($j("#tool_ungroup").hasClass("disabled")&&"admin"!=user||svgCanvas.ungroupSelectedElement())},clickClone=function(){if(!$j("#tool_clone").hasClass("disabled")||"admin"==user){var a=getStrokedBBox(svgCanvas.getSelectedElems());svgCanvas.cloneSelectedElements(-a.x,-a.y)}},clickAlign=function(){},zoomImage=function(a){var b=svgCanvas.getResolution();a=a?b.zoom*a:1,$j("#zoom").val(100*a),svgCanvas.setZoom(a),zoomDone(),updateCanvas(!0)},zoomDone=function(){updateWireFrame()},clickWireframe=function(){var a=!$j("#tool_wireframe").hasClass("push_button_pressed");if(a?$j("#tool_wireframe").addClass("push_button_pressed").removeClass("tool_button"):$j("#tool_wireframe").removeClass("push_button_pressed").addClass("tool_button"),workarea.toggleClass("wireframe"),!supportsNonSS){var b=$j("#wireframe_rules");b.length?b.empty():b=$j('<style id="wireframe_rules"></style>').appendTo("head"),updateWireFrame()}},updateWireFrame=function(){if(!supportsNonSS){var a="#workarea.wireframe #svgcontent * { stroke-width: "+1/svgCanvas.getZoom()+"px; }";$j("#wireframe_rules").text(workarea.hasClass("wireframe")?a:"")}},showSourceEditor=function(a,b){if(!editingsource){editingsource=!0,$j("#save_output_btns").toggle(!!b),$j("#tool_source_back").toggle(!b);var c=orig_source=svgCanvas.getSvgString();$j("#svg_source_textarea").val(c),$j("#svg_source_editor").fadeIn(),properlySourceSizeTextArea(),$j("#svg_source_textarea").focus()}},showDocProperties=function(){if(!docprops){docprops=!0,$j("#image_save_opts input").val([curPrefs.img_save]);var a=svgCanvas.getResolution();"px"!==curConfig.baseUnit&&(a.w=svgedit.units.convertUnit(a.w)+curConfig.baseUnit,a.h=svgedit.units.convertUnit(a.h)+curConfig.baseUnit),$j("#canvas_width").val(a.w),$j("#canvas_height").val(a.h),$j("#canvas_title").val(svgCanvas.getDocumentTitle()),$j("#svg_docprops").show()}},svgaddnoteProperties=function(a){0==a.button&&$j("#svg_add_note").show()},showPreferences=function(){if(!preferences){preferences=!0,$j("#main_menu").hide();var a=$j("#bg_blocks div"),b="cur_background",c=$j.pref("bkgd_color"),d=$j.pref("bkgd_url");a.each(function(){var a=$j(this),d=a.css("background-color")==c;a.toggleClass(b,d),d&&$j("#canvas_bg_url").removeClass(b)}),c||a.eq(0).addClass(b),d&&$j("#canvas_bg_url").val(d),$j("grid_snapping_step").attr("value",curConfig.snappingStep),1==curConfig.gridSnapping?$j("#grid_snapping_on").attr("checked","checked"):$j("#grid_snapping_on").removeAttr("checked"),$j("#svg_prefs").show()}},properlySourceSizeTextArea=function(){var a=$j("#svg_source_container").height()-80;$j("#svg_source_textarea").css("height",a)},saveSourceEditor=function(){if(editingsource){var a=function(){svgCanvas.clearSelection(),hideSourceEditor(),zoomImage(),populateLayers(),updateTitle(),prepPaints()};svgCanvas.setSvgString($j("#svg_source_textarea").val())?a():$j.confirm(uiStrings.notification.QerrorsRevertToSource,function(b){return b?void a():!1}),setSelectMode()}},updateTitle=function(){},saveDocProperties=function(){var a=$j("#canvas_title").val();updateTitle(a),svgCanvas.setDocumentTitle(a);var b=$j("#canvas_width"),c=b.val(),d=$j("#canvas_height"),e=d.val();return"fit"==c||svgedit.units.isValidUnit("width",c)?(b.parent().removeClass("error"),"fit"==e||svgedit.units.isValidUnit("height",e)?(d.parent().removeClass("error"),svgCanvas.setResolution(c,e)?(curPrefs.img_save=$j("#image_save_opts :checked").val(),$j.pref("img_save",curPrefs.img_save),updateCanvas(),void hideDocProperties()):($j.alert(uiStrings.notification.noContentToFitTo),!1)):($j.alert(uiStrings.notification.invalidAttrValGiven),d.parent().addClass("error"),!1)):($j.alert(uiStrings.notification.invalidAttrValGiven),b.parent().addClass("error"),!1)},showRuler=Editor.showRuler=function(){$j("#rulers").toggle(curConfig.showRulers),curConfig.showRulers&&updateRulers()},savePreferences=function(){var a=$j("#bg_blocks div.cur_background").css("background-color")||"#FFF";setBackground(a,$j("#canvas_bg_url").val());var b=$j("#lang_select").val();b!=curPrefs.lang&&Editor.putLocale(b),setIconSize($j("#iconsize").val()),curConfig.gridSnapping=$j("#grid_snapping_on")[0].checked,curConfig.snappingStep=$j("#grid_snapping_step").val(),$j("#rulers").toggle(curConfig.showRulers),curConfig.showRulers&&updateRulers(),curConfig.baseUnit=$j("#base_unit").val(),svgCanvas.setConfig(curConfig),updateCanvas(),hidePreferences()},setIcon=Editor.setIcon=function(a,b){var c="string"==typeof b?$j.getSvgIcon(b,!0):b.clone();c&&$j(a).empty().append(c)},ua_prefix;ua_prefix=function(){var a=/^(Moz|Webkit|Khtml|O|ms|Icab)(?=[A-Z])/,b=document.getElementsByTagName("script")[0];for(var c in b.style)if(a.test(c))return c.match(a)[0];return"WebkitOpacity"in b.style?"Webkit":"KhtmlOpacity"in b.style?"Khtml":""}();var scaleElements=function(a,b){var c=("-"+ua_prefix.toLowerCase()+"-",["top","left","bottom","right"]);a.each(function(){for(var a=$j(this),d=a.outerWidth()*(b-1),e=a.outerHeight()*(b-1),f=0;4>f;f++){var g=c[f],h=a.data("orig_margin-"+g);null==h&&(h=parseInt(a.css("margin-"+g)),a.data("orig_margin-"+g,h));var i=h*b;"right"===g?i+=d:"bottom"===g&&(i+=e),a.css("margin-"+g,i)}})},setIconSize=Editor.setIconSize=function(a,b){if(a!=curPrefs.size||b){var c="#tools_top .toolset, #editor_panel > *, #history_panel > *,				#main_button, #tools_left > *, #path_node_panel > *, #multiselected_panel > *,				#g_panel > *, #tool_font_size > *, .tools_flyout",d=$j(c),e=1;if("number"==typeof a)e=a;else{var f={s:.75,m:1,l:1.25,xl:1.5};e=f[a]}Editor.tool_scale=tool_scale=e,setFlyoutPositions();var g=d.parents(":hidden");g.css("visibility","hidden").show(),scaleElements(d,e),g.css("visibility","visible").hide(),$j.pref("iconsize",a),$j("#iconsize").val(a);var h={"#tools_top":{left:50,height:72},"#tools_left":{width:31,top:74},"div#workarea":{left:38,top:74}},i=$j("#tool_size_rules");if(i.length?i.empty():i=$j('<style id="tool_size_rules"></style>').appendTo("head"),"m"!=a){var j="";$j.each(h,function(b,c){b="#svg_editor "+b.replace(/,/g,", #svg_editor"),j+=b+"{",$j.each(c,function(b,c){if("number"==typeof c)var d=c*e+"px";else if(c[a]||c.all)var d=c[a]||c.all;j+=b+":"+d+";"}),j+="}"});var k="-"+ua_prefix.toLowerCase()+"-";j+=c+"{"+k+"transform: scale("+e+");} #svg_editor div.toolset .toolset {"+k+"transform: scale(1); margin: 1px !important;} #svg_editor .ui-slider {"+k+"transform: scale("+1/e+");}",i.text(j)}setFlyoutPositions()}},cancelOverlays=function(){return $j("#dialog_box").hide(),editingsource||docprops||preferences?(editingsource?orig_source!==$j("#svg_source_textarea").val()?$j.confirm(uiStrings.notification.QignoreSourceChanges,function(a){a&&hideSourceEditor()}):hideSourceEditor():docprops?hideDocProperties():preferences&&hidePreferences(),void resetScrollPos()):void(cur_context&&svgCanvas.leaveContext())},hideSourceEditor=function(){$j("#svg_source_editor").hide(),editingsource=!1,$j("#svg_source_textarea").blur()},hideDocProperties=function(){$j("#svg_docprops").hide(),$j("#svg_add_note").hide(),$j("#svg_beforeaddtocart").hide(),$j("#svg_login_window").hide(),$j("#svg_image_upload").hide(),$j("#canvas_width,#canvas_height").removeAttr("disabled"),$j("#resolution")[0].selectedIndex=0,$j("#image_save_opts input").val([curPrefs.img_save]),docprops=!1},hidePreferences=function(){$j("#svg_prefs").hide(),preferences=!1},win_wh={width:$j(window).width(),height:$j(window).height()},resetScrollPos=$j.noop,curScrollPos;svgedit.browser.isIE()&&!function(){resetScrollPos=function(){0===workarea[0].scrollLeft&&0===workarea[0].scrollTop&&(workarea[0].scrollLeft=curScrollPos.left,workarea[0].scrollTop=curScrollPos.top)},curScrollPos={left:workarea[0].scrollLeft,top:workarea[0].scrollTop},$j(window).resize(resetScrollPos),svgEditor.ready(function(){setTimeout(function(){resetScrollPos()},500)}),workarea.scroll(function(){curScrollPos={left:workarea[0].scrollLeft,top:workarea[0].scrollTop}})}(),$j(window).resize(function(){editingsource&&properlySourceSizeTextArea(),$j.each(win_wh,function(a,b){var c=$j(window)[a]();workarea[0]["scroll"+("width"===a?"Left":"Top")]-=(c-b)/2,win_wh[a]=c})}),function(){workarea.scroll(function(){0!=$j("#ruler_x").length&&($j("#ruler_x")[0].scrollLeft=workarea[0].scrollLeft),0!=$j("#ruler_y").length&&($j("#ruler_y")[0].scrollTop=workarea[0].scrollTop)})}(),$j("#url_notice").click(function(){$j.alert(this.title)}),$j("#change_image_url").click(promptImgURL);var simplePicker=Editor.simplePicker=function(a,b){var c;switch(a.attr("id")){case"stroke_color":c="stroke";break;case"border_color":c="border";break;case"bgcolor_color":c="bgcolor";break;case"qr_color":c="qrcodecolor";break;case"fill_nameText":c="namefillColor";break;case"fill_numberText":c="numberfillColor";break;default:c="fill"}$j(a).simpleColor({boxHeight:40,cellWidth:40,cellHeight:40,cellMargin:5,columns:10,colors:b,displayCSS:{border:"1px solid red"},displayColorCode:!0,livePreview:!1,onSelect:function(a){var b=new $j.jGraduate.Paint({solidColor:a});paintBox[c].setPaint(b),"border"==c?updateBorder():"bgcolor"==c?updateBg():"qrcodecolor"==c?$j("#qrcolorcode").val("#"+a):"namefillColor"==c?(svgCanvas.getElem("nameText").setAttribute("fill","#"+a),svgedit.utilities.walkTree(svgCanvas.getElem("nameText"),function(b){b.setAttribute("fill","#"+a)})):"numberfillColor"==c?(svgCanvas.getElem("numberText").setAttribute("fill","#"+a),svgedit.utilities.walkTree(svgCanvas.getElem("numberText"),function(b){b.setAttribute("fill","#"+a)})):svgCanvas.setPaint(c,b)}})},colorPicker=Editor.colorPicker=function(a){var b;switch(a.attr("id")){case"stroke_color":b="stroke";break;case"border_color":b="border";break;case"bgcolor_color":b="bgcolor";break;case"qr_color":b="qrcodecolor";break;case"fill_nameText":b="namefillColor";break;case"fill_numberText":b="numberfillColor";break;default:b="fill"}$j.farbtastic("#colorpicker").linkTo(function(){}),checker=paintBox;{var c=paintBox[b].paint;a.offset()}-1==c.solidColor.search("#")?($j.farbtastic("#colorpicker").setColor("#"+c.solidColor),updateColorElements(c.solidColor)):($j.farbtastic("#colorpicker").setColor(c.solidColor),updateColorElements(c.solidColor.substr(1))),updateColorHexCode(),$j("#colorpicker").addClass("displayblock"),$j.farbtastic("#colorpicker").linkTo(function(a){parseFloat($j("#common-panel").css("left")),parseFloat($j("#common-panel").css("top"));a=a.replace("#",""),c=new $j.jGraduate.Paint(c),c.solidColor=a,paintBox[b].setPaint(c),"border"==b?updateBorder():"bgcolor"==b?updateBg():"qrcodecolor"==b?$j("#qrcolorcode").val(paintBox.qrcodecolor.getFillAttr(c)):"namefillColor"==b?(svgCanvas.getElem("nameText").setAttribute("fill","#"+a),svgedit.utilities.walkTree(svgCanvas.getElem("nameText"),function(b){b.setAttribute("fill","#"+a)})):"numberfillColor"==b?(svgCanvas.getElem("numberText").setAttribute("fill","#"+a),svgedit.utilities.walkTree(svgCanvas.getElem("numberText"),function(b){b.setAttribute("fill","#"+a)})):svgCanvas.setPaint(b,c),svgCanvas.runExtensions("elementChanged",{elems:svgCanvas.getSelectedElems()}),updateColorElements(a),updateColorHexCode(),"stroke"==b&&($j("#bordercontrolls").show(),$j(".border_colorpicker").css("left","0px"))})},updateToolButtonState=function(){try{var a="none"==svgCanvas.getColor("fill"),b="none"==svgCanvas.getColor("stroke"),c=["#tool_fhpath","#tool_line"],d=["#tools_rect .tool_button","#tools_ellipse .tool_button","#tool_text","#tool_path"];if(b)for(var e in c){var f=c[e];$j(f).hasClass("tool_button_current")&&clickSelect()}else for(var e in c){var f=c[e];$j(f).removeClass("disabled")}if(b&&a)for(var e in d){var f=d[e];$j(f).hasClass("tool_button_current")&&clickSelect(),$j(f).addClass("disabled")}else for(var e in d){var f=d[e];$j(f).removeClass("disabled")}svgCanvas.runExtensions("toolButtonStateUpdate",{nofill:a,nostroke:b}),$j(".tools_flyout").each(function(){var a=$j("#"+this.id+"_show"),b=!1;$j(this).children().each(function(){$j(this).hasClass("disabled")||(b=!0)}),a.toggleClass("disabled",!b)}),operaRepaint()}catch(g){trace(g),updateToolButtonState()}},PaintBox=function(a,b){var c;switch(b){case"stroke":c=curConfig.initStroke;break;case"border":c=curConfig.initBorder;break;case"bgcolor":c=curConfig.initBg;break;case"qrcodecolor":c=curConfig.initBorder;break;default:c=curConfig.initFill}trace("type = "+b),trace("cur = "+c.color);var d=(new DOMParser).parseFromString('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="20" height="20"><rect width="20" height="20" fill="'+c.color+'" opacity="'+c.opacity+'"/><defs><linearGradient id="gradbox_"/></defs></svg>',"text/xml"),e=d.documentElement;e=$j(a)[0].appendChild(document.importNode(e,!0)),this.rect=e.firstChild,this.defs=e.getElementsByTagName("defs")[0],this.grad=this.defs.firstChild,this.paint=new $j.jGraduate.Paint({solidColor:c.color}),this.type=b,this.getFillAttr=function(a){{var b="none",c=a.type;a.alpha/100}switch("#"==String(a[c]).substr(0,1)&&(a[c]=String(a[c]).substr(1,6)),c){case"solidColor":b="none"!=a[c]?"#"+a[c]:a[c];break;case"linearGradient":case"radialGradient":var d=a[c].id="gradbox_"+this.type;b="url(#"+d+")"}return b},this.setPaint=function(a,b){this.paint=a;var c="none",d=a.type,e=a.alpha/100;switch(d){case"solidColor":c="none"!=a[d]?"#"+a[d]:a[d];break;case"linearGradient":case"radialGradient":this.defs.removeChild(this.grad),this.grad=this.defs.appendChild(a[d]);var f=this.grad.id="gradbox_"+this.type;c="url(#"+f+")"}this.rect.setAttribute("fill",c),this.rect.setAttribute("opacity",e),b&&(svgCanvas.setColor(this.type,paintColor,!0),svgCanvas.setPaintOpacity(this.type,paintOpacity,!0))},this.update=function(a){if(selectedElement){var b=this.type;
switch(selectedElement.tagName){case"use":case"image":case"foreignObject":return;case"g":case"a":for(var c=null,d=selectedElement.getElementsByTagName("*"),e=0,f=d.length;f>e;e++){var g=d[e],h=g.getAttribute(b);if(0===e)c=h;else if(c!==h){c=null;break}}if(null===c){var i=null;return}var i=c,j=1;break;default:var j=parseFloat(selectedElement.getAttribute(b+"-opacity"));isNaN(j)&&(j=1);var k="fill"===b?"black":"none",i=selectedElement.getAttribute(b)||k}a&&(svgCanvas.setColor(b,i,!0),svgCanvas.setPaintOpacity(b,j,!0)),j*=100;var l=getPaint(i,j,b);this.setPaint(l)}},this.prep=function(){var a=this.paint.type;switch(a){case"linearGradient":case"radialGradient":var c=new $j.jGraduate.Paint({copy:this.paint});svgCanvas.setPaint(b,c)}}};paintBox.fill=new PaintBox("#fill_color","fill"),paintBox.stroke=new PaintBox("#stroke_color","stroke"),paintBox.qrcodecolor=new PaintBox("#qr_color","qrcodecolor"),$j("#fill_nameText").length>0&&(paintBox.namefillColor=new PaintBox("#fill_nameText","namefillColor")),$j("#fill_numberText").length>0&&(paintBox.numberfillColor=new PaintBox("#fill_numberText","numberfillColor")),"web2print"==toolType&&(paintBox.border=new PaintBox("#border_color","border"),paintBox.bgcolor=new PaintBox("#bgcolor_color","bgcolor")),$j("#stroke_width").text(curConfig.initStroke.width),$j("#stroke_slider").slider("option","value",curConfig.initStroke.width);var opac_val=100*curConfig.initOpacity;opac_val=opac_val.toFixed(2),$j("#group_opacity").text(opac_val);var test_el=paintBox.fill.rect.cloneNode(!1);test_el.setAttribute("style","vector-effect:non-scaling-stroke");var supportsNonSS="non-scaling-stroke"===test_el.style.vectorEffect;test_el.removeAttribute("style");var svgdocbox=paintBox.fill.rect.ownerDocument,blur_test=svgdocbox.createElementNS("http://www.w3.org/2000/svg","feGaussianBlur");("undefined"==typeof blur_test.stdDeviationX||svgedit.browser.isWebkit()&&!svgedit.browser.isChrome())&&$j("#tool_blur").hide(),$j(blur_test).remove(),function(){var a="-"+ua_prefix.toLowerCase()+"-zoom-",b=a+"in";workarea.css("cursor",b),workarea.css("cursor")===b&&(zoomInIcon=b,zoomOutIcon=a+"out"),workarea.css("cursor","auto")}(),setTimeout(function(){svgCanvas.embedImage(jspath+"images/logo.png",function(a){a||($j("#image_save_opts [value=embed]").attr("disabled","disabled"),$j("#image_save_opts input").val(["ref"]),curPrefs.img_save="ref",$j("#image_opt_embed").css("color","#666").attr("title",uiStrings.notification.featNotSupported))})},1e3),$j("#fill_color, #tool_fill .icon_label").on("mousedown",function(){$j("#fill_color").hasClass("disabled")&&"admin"!=user||("full"==pickerMode?($j("#bordercontrolls").hide(),$j(".border_colorpicker").css("left","60px"),$j(".simpleColorContainer").hide(),$j("#common_upper_open_panel").show(),manageColorPanel(),colorPicker($j("#fill_color")),$j(".border_colorpicker").show(),updateToolButtonState()):"printable"==pickerMode&&(simplePicker($j("#fill_color"),printableColorList),$j("#common_upper_open_panel").show(),$j("#bordercontrolls").hide(),$j(".border_colorpicker").css("left","60px"),$j(".border_colorpicker").hide(),$j(".simpleColorContainer").show(),$j(".simpleColorChooser").jScrollPane(),manageColorPanel()))}),$j("#stroke_color, #tool_stroke .icon_label").on("mousedown",function(){$j("#stroke_color").hasClass("disabled")&&"admin"!=user||("full"==pickerMode?(colorPicker($j("#stroke_color")),$j(".border_colorpicker").show(),updateToolButtonState()):"printable"==pickerMode&&(simplePicker($j("#stroke_color"),printableColorList),$j(".simpleColorChooser").css("width","325px"),$j(".simpleColorChooser").css("left","121px"),$j(".simpleColorChooser").jScrollPane()))}),$j("#qr_color, #tool_qr_color .icon_label").on("mousedown",function(){"full"==pickerMode?(QrcolorPicker($j("#qr_color")),$j("#qr_colorpicker_con").show()):"printable"==pickerMode&&(simplePicker($j("#qr_color"),printableColorList),$j(".simpleColorChooser").jScrollPane())}),$j("#fill_nameText").on("mousedown",function(){"full"==pickerMode?($j("#bordercontrolls").hide(),$j(".border_colorpicker").css("left","60px"),$j(".simpleColorContainer").hide(),$j("#common_upper_open_panel").show(),manageColorPanel(),colorPicker($j("#fill_nameText")),$j(".border_colorpicker").show(),updateToolButtonState()):"printable"==pickerMode&&(simplePicker($j("#fill_nameText"),printableColorList),$j("#common_upper_open_panel").show(),$j("#bordercontrolls").hide(),$j(".border_colorpicker").css("left","60px"),$j(".border_colorpicker").hide(),$j(".simpleColorContainer").show(),$j(".simpleColorChooser").jScrollPane(),manageColorPanel())}),$j("#fill_numberText").on("mousedown",function(){"full"==pickerMode?($j("#bordercontrolls").hide(),$j(".border_colorpicker").css("left","60px"),$j(".simpleColorContainer").hide(),$j("#common_upper_open_panel").show(),manageColorPanel(),colorPicker($j("#fill_numberText")),$j(".border_colorpicker").show(),updateToolButtonState()):"printable"==pickerMode&&(simplePicker($j("#fill_numberText"),printableColorList),$j("#common_upper_open_panel").show(),$j("#bordercontrolls").hide(),$j(".border_colorpicker").css("left","60px"),$j(".border_colorpicker").hide(),$j(".simpleColorContainer").show(),$j(".simpleColorChooser").jScrollPane(),manageColorPanel())});var QrcolorPicker=Editor.QrcolorPicker=function(a){var b;switch(a.attr("id")){case"qr_color":b="qrcodecolor";break;default:b="fill"}$j.farbtastic("#qr_colorpicker").linkTo(function(){});{var c=paintBox[b].paint;a.offset()}$j.farbtastic("#qr_colorpicker").setColor(-1==c.solidColor.search("#")?"#"+c.solidColor:c.solidColor),$j("#qr_colorpicker").addClass("displayblock"),$j.farbtastic("#qr_colorpicker").linkTo(function(a){parseFloat($j("#common-panel").css("left")),parseFloat($j("#common-panel").css("top"));a=a.replace("#",""),c=new $j.jGraduate.Paint(c),c.solidColor=a,paintBox[b].setPaint(c),"qrcodecolor"==b?$j("#qrcolorcode").val(paintBox.qrcodecolor.getFillAttr(c)):svgCanvas.setPaint(b,c)})};"web2print"==toolType&&($j("#border_color, #tool_border_color .icon_label").click(function(){trace(pickerMode),"full"==pickerMode?colorPicker($j("#border_color")):"printable"==pickerMode&&simplePicker($j("#border_color"),printableColorList)}),$j("#bgcolor_color, #tool_bgcolor_color .icon_label").click(function(){"full"==bgpickerMode?colorPicker($j("#bgcolor_color")):"custom"==bgpickerMode?(simplePicker($j("#bgcolor_color"),customColorList),$j(".simpleColorChooser").jScrollPane()):"printable"==bgpickerMode&&(simplePicker($j("#bgcolor_color"),printableColorList),$j(".simpleColorChooser").jScrollPane())})),$j("#group_opacityLabel").click(function(){$j("#opacity_dropdown button").mousedown(),$j(window).mouseup()}),$j("#zoomLabel").click(function(){$j("#zoom_dropdown button").mousedown(),$j(window).mouseup()}),$j("#tool_move_t").mousedown(function(a){$j("#tools_stacking").show(),a.preventDefault()}),$j(".layer_button").mousedown(function(){$j(this).addClass("layer_buttonpressed")}).mouseout(function(){$j(this).removeClass("layer_buttonpressed")}).mouseup(function(){$j(this).removeClass("layer_buttonpressed")}),$j(".push_button").mousedown(function(){$j(this).hasClass("disabled")||$j(this).addClass("push_button_pressed").removeClass("push_button")}).mouseout(function(){$j(this).removeClass("push_button_pressed").addClass("push_button")}).mouseup(function(){$j(this).removeClass("push_button_pressed").addClass("push_button")}),$j("#layer_new").click(function(){var a=svgCanvas.getCurrentDrawing().getNumLayers();do var b=uiStrings.layers.layer+" "+ ++a;while(svgCanvas.getCurrentDrawing().hasLayer(b));$j.prompt(uiStrings.notification.enterUniqueLayerName,b,function(a){if(a){if(svgCanvas.getCurrentDrawing().hasLayer(a))return void $j.alert(uiStrings.notification.dupeLayerName);svgCanvas.createLayer(a),updateContextPanel(),populateLayers()}})}),$j("#layer_delete").click(deleteLayer),$j("#layer_up").click(function(){moveLayer(-1)}),$j("#layer_down").click(function(){moveLayer(1)}),$j("#layer_rename").click(function(){var a=($j("#layerlist tr.layersel").prevAll().length,$j("#layerlist tr.layersel td.layername").text());$j.prompt(uiStrings.notification.enterNewLayerName,"",function(b){if(b){if(a==b||svgCanvas.getCurrentDrawing().hasLayer(b))return void $j.alert(uiStrings.notification.layerHasThatName);svgCanvas.renameCurrentLayer(b),populateLayers()}})});var SIDEPANEL_MAXWIDTH=300,SIDEPANEL_OPENWIDTH=150,sidedrag=-1,sidedragging=!1,allowmove=!1,resizePanel=function(a){if(allowmove&&-1!=sidedrag){sidedragging=!0;var b=sidedrag-a.pageX,c=$j("#sidepanels"),d=parseInt(c.css("width"));if(d+b>SIDEPANEL_MAXWIDTH?(b=SIDEPANEL_MAXWIDTH-d,d=SIDEPANEL_MAXWIDTH):2>d+b&&(b=2-d,d=2),0!=b){sidedrag-=b;var e=$j("#layerpanel");workarea.css("right",parseInt(workarea.css("right"))+b),c.css("width",parseInt(c.css("width"))+b),e.css("width",parseInt(e.css("width"))+b);var f=$j("#ruler_x");f.css("right",parseInt(f.css("right"))+b)}}};$j("#sidepanel_handle").mousedown(function(a){sidedrag=a.pageX,$j(window).mousemove(resizePanel),allowmove=!1,setTimeout(function(){allowmove=!0},20)}).mouseup(function(){sidedragging||toggleSidePanel(),sidedrag=-1,sidedragging=!1}),$j(window).mouseup(function(){sidedrag=-1,sidedragging=!1,$j("#svg_editor").unbind("mousemove",resizePanel)});var toggleSidePanel=function(a){var b=parseInt($j("#sidepanels").css("width")),c=(b>2||a?2:SIDEPANEL_OPENWIDTH)-b,d=$j("#sidepanels"),e=$j("#layerpanel"),f=$j("#ruler_x");workarea.css("right",parseInt(workarea.css("right"))+c),d.css("width",parseInt(d.css("width"))+c),e.css("width",parseInt(e.css("width"))+c),f.css("right",parseInt(f.css("right"))+c)},toggleHighlightLayer=function(a){for(var b=new Array(svgCanvas.getCurrentDrawing().getNumLayers()),c=0;c<b.length;++c)b[c]=svgCanvas.getCurrentDrawing().getLayerName(c);if(a)for(var c=0;c<b.length;++c)b[c]!=a&&svgCanvas.getCurrentDrawing().setLayerOpacity(b[c],.5);else for(var c=0;c<b.length;++c)svgCanvas.getCurrentDrawing().setLayerOpacity(b[c],1)},populateLayers=function(){var a=$j("#layerlist tbody"),b=$j("#selLayerNames");a.empty(),b.empty();for(var c=svgCanvas.getCurrentDrawing().getCurrentLayerName(),d=svgCanvas.getCurrentDrawing().getNumLayers(),e=$j.getSvgIcon("eye");d--;){var f=svgCanvas.getCurrentDrawing().getLayerName(d),g='<tr class="layer';f==c&&(g+=" layersel"),g+='">',g+=svgCanvas.getCurrentDrawing().getLayerVisibility(f)?'<td class="layervis"/><td class="layername" >'+f+"</td></tr>":'<td class="layervis layerinvis"/><td class="layername" >'+f+"</td></tr>",a.append(g),b.append('<option value="'+f+'">'+f+"</option>")}if(void 0!==e){{e.clone()}$j("td.layervis",a).append(e.clone()),$j.resizeSvgIcons({"td.layervis .svg_icon":14})}$j("#layerlist td.layername").mouseup(function(a){$j("#layerlist tr.layer").removeClass("layersel");var b=$j(this.parentNode);b.addClass("layersel"),svgCanvas.setCurrentLayer(this.textContent),a.preventDefault()}).mouseover(function(){$j(this).css({"font-style":"italic",color:"blue"}),toggleHighlightLayer(this.textContent)}).mouseout(function(){$j(this).css({"font-style":"normal",color:"black"}),toggleHighlightLayer()}),$j("#layerlist td.layervis").click(function(){var a=$j(this.parentNode).prevAll().length,b=$j("#layerlist tr.layer:eq("+a+") td.layername").text(),c=$j(this).hasClass("layerinvis");svgCanvas.setLayerVisibility(b,c),c?$j(this).removeClass("layerinvis"):$j(this).addClass("layerinvis")});for(var h=5-$j("#layerlist tr.layer").size();h-->0;)a.append('<tr><td style="color:white">_</td><td/></tr>')};populateLayers();var centerCanvas=function(){workarea.css("line-height","100%")};$j(window).bind("load resize",centerCanvas),$j("#resolution").change(function(){var a=$j("#canvas_width,#canvas_height");if(this.selectedIndex)if("content"==this.value)a.val("fit").attr("disabled","disabled");else{var b=this.value.split("x");$j("#canvas_width").val(b[0]),$j("#canvas_height").val(b[1]),a.removeAttr("disabled")}else"fit"==$j("#canvas_width").val()&&a.removeAttr("disabled").val(100)}),$j("input,select").attr("autocomplete","off");var Actions=function(){var a=[{sel:"#tool_select",fn:clickSelect,evt:"click"},{sel:"#tool_fhpath",fn:clickFHPath,evt:"click"},{sel:"#tool_line",fn:clickLine,evt:"click"},{sel:"#tool_rect",fn:clickRect,evt:"click",parent:"#tools_rect",icon:"rect"},{sel:"#tool_square",fn:clickSquare,evt:"click",parent:"#tools_rect",icon:"square"},{sel:"#tool_fhrect",fn:clickFHRect,evt:"click",parent:"#tools_rect",icon:"fh_rect"},{sel:"#tool_ellipse",fn:clickEllipse,evt:"click",parent:"#tools_ellipse",icon:"ellipse"},{sel:"#tool_circle",fn:clickCircle,evt:"click",parent:"#tools_ellipse",icon:"circle"},{sel:"#tool_fhellipse",fn:clickFHEllipse,evt:"click",parent:"#tools_ellipse",icon:"fh_ellipse"},{sel:"#tool_path",fn:clickPath,evt:"click"},{sel:"#tool_text",fn:clickText,evt:"click"},{sel:"#tool_image",fn:clickImage,evt:"click"},{sel:"#tool_zoom",fn:clickZoom,evt:"click"},{sel:"#tool_clear",fn:clickClear,evt:"click"},{sel:"#tool_open",fn:clickOpen,evt:"click"},{sel:"#tool_import",fn:clickImport,evt:"click"},{sel:"#tool_source",fn:showSourceEditor,evt:"click"},{sel:"#tool_wireframe",fn:clickWireframe,evt:"click"},{sel:"#tool_source_cancel,#svg_source_overlay,#tool_login_window_cancel,#tool_image_upload_cancel,#tool_beforeaddtocart_cancel, #tool_save_design_window_cancel, #tool_facebook_window_cancel, #tool_flickr_window_cancel, #tool_picasa_window_cancel, #tool_instagram_window_cancel, #tool_preview_window_cancel, #tool_bgImage_window_cancel, #tool_prefs_cancel",fn:cancelOverlays,evt:"click",hidekey:!0},{sel:"#tool_source_save",fn:saveSourceEditor,evt:"click"},{sel:"#tool_docprops_save",fn:saveDocProperties,evt:"click"},{sel:"#tool_docprops",fn:showDocProperties,evt:"click"},{sel:"#addNote",fn:svgaddnoteProperties,evt:"click"},{sel:"#tool_prefs_save",fn:savePreferences,evt:"click"},{sel:"#tool_prefs_option",fn:function(){return showPreferences(),!1},evt:"mouseup"},{sel:"#tool_delete_multi",fn:deleteSelected,evt:"click",key:["del",!0]},{sel:"#tool_reorient",fn:reorientPath,evt:"click"},{sel:"#tool_node_link",fn:linkControlPoints,evt:"click"},{sel:"#tool_node_clone",fn:clonePathNode,evt:"click"},{sel:"#tool_node_delete",fn:deletePathNode,evt:"click"},{sel:"#tool_openclose_path",fn:opencloseSubPath,evt:"click"},{sel:"#tool_add_subpath",fn:addSubPath,evt:"click"},{sel:"#tool_move_t",fn:moveToTopSelected,evt:"click"},{sel:"#tool_move_b",fn:moveToBottomSelected,evt:"click"},{sel:"#tool_topath",fn:convertToPath,evt:"click"},{sel:"#tool_make_link,#tool_make_link_multi",fn:makeHyperlink,evt:"mousedown"},{sel:"#tool_undo",fn:clickUndo,evt:"click"},{sel:"#tool_redo",fn:clickRedo,evt:"click"},{sel:"#tool_clone, #tool_clone_multi",fn:clickClone,evt:"click"},{sel:"#tool_group",fn:clickGroup,evt:"click"},{sel:"#tool_ungroup",fn:clickGroup,evt:"click"},{sel:"#tool_unlink_use",fn:clickGroup,evt:"click"},{sel:"[id^=tool_align]",fn:clickAlign,evt:"click"},{sel:"#tool_bold",fn:clickBold,evt:"click"},{sel:"#tool_italic",fn:clickItalic,evt:"click"},{sel:"#sidepanel_handle",fn:toggleSidePanel},{sel:"#copy_save_done",fn:cancelOverlays,evt:"click"},{sel:"#tool_copy",fn:copySelected,evt:"click"},{sel:"#tool_cut",fn:cutSelected,evt:"click"},{sel:"#tool_paste",fn:pasteInCenter,evt:"click"}],b={};return{setAll:function(){var c={};$j.each(a,function(a,d){if(d.sel){var e=$j(d.sel);if(0==e.length)return!0;if(d.evt&&(svgedit.browser.isTouch()&&0==svgedit.browser.isIOS()&&"click"===d.evt&&(d.evt="touchstart"),e.bind(d.evt,d.fn)),d.parent&&0!=$j(d.parent+"_show").length){var f=$j(d.parent);f.length||(f=makeFlyoutHolder(d.parent.substr(1))),f.append(e),$j.isArray(c[d.parent])||(c[d.parent]=[]),c[d.parent].push(d)}}if(d.key){var g,h=!0,i=d.fn,j=!1;if($j.isArray(d.key)?(g=d.key[0],d.key.length>1&&(j=d.key[1]),d.key.length>2&&(h=d.key[2])):g=d.key,g+="",$j.each(g.split("/"),function(a,b){$j(document).bind("keydown",b,function(a){return i(),j&&a.preventDefault(),!1})}),d.sel&&!d.hidekey&&e.attr("title")){var k=e.attr("title").split("[")[0]+" ("+g+")";b[g]=d.sel,e.parents("#main_menu").length||e.attr("title",k)}}}),setupFlyouts(c),$j(".attr_changer, #image_url").bind("keydown","return",function(a){$j(this).change(),a.preventDefault()}),$j(window).bind("keydown","tab",function(a){"canvas"===ui_context&&(a.preventDefault(),selectNext())}).bind("keydown","shift+tab",function(a){"canvas"===ui_context&&(a.preventDefault(),selectPrev())}),$j("#tool_zoom").dblclick(dblclickZoom)},setTitles:function(){$j.each(b,function(a,b){var c=$j(b).parents("#main_menu").length;$j(b).each(function(){if(c)var b=$j(this).text().split(" [")[0];else var b=this.title.split(" [")[0];var d="";$j.each(a.split("/"),function(a,b){var c=b.split("+"),e="";c.length>1&&(e=c[0]+"+",b=c[1]),d+=(a?"/":"")+e+(uiStrings["key_"+b]||b)}),c?this.lastChild.textContent=b+" ["+d+"]":this.title=b+" ["+d+"]"})})},getButtonData:function(b){var c;return $j.each(a,function(a,d){d.sel===b&&(c=d)}),c}}}();Actions.setAll(),Editor.ready(function(){var a,b=curConfig.initTool,c=$j("#tools_left, #svg_editor .tools_flyout"),d=c.find("#tool_"+b),e=c.find("#"+b);a=d.length?d:e.length?e:$j("#tool_select"),a.click().mouseup(),curConfig.wireframe&&$j("#tool_wireframe").click(),curConfig.showlayers&&toggleSidePanel(),$j("#rulers").toggle(!!curConfig.showRulers),curConfig.gridSnapping&&($j("#grid_snapping_on")[0].checked=!0),curConfig.snappingStep&&$j("#grid_snapping_step").val(curConfig.snappingStep)}),$j("#zoom").SpinButton({min:.001,max:1e4,step:50,stepfunc:stepZoom,callback:changeZoom}).val(100*svgCanvas.getZoom());var lmenu_func=function(a){switch(a){case"dupe":cloneLayer();break;case"delete":deleteLayer();break;case"merge_down":mergeLayer();break;case"merge_all":svgCanvas.mergeAllLayers(),updateContextPanel(),populateLayers()}};if($j("#layerlist").contextMenu({menu:"cmenu_layers",inSpeed:0},lmenu_func),$j("#layer_moreopts").contextMenu({menu:"cmenu_layers",inSpeed:0,allowLeft:!0},lmenu_func),$j(".contextMenu li").mousedown(function(a){a.preventDefault()}),$j("#cmenu_canvas li").disableContextMenu(),canv_menu.enableContextMenuItems("#delete,#cut,#copy"),window.onbeforeunload=function(){if("localStorage"in window){{"svgedit-"+Editor.curConfig.canvasName}Editor.show_save_warning=!1}return Editor.show_save_warning=!0,0===undoMgr.getUndoStackSize()&&(Editor.show_save_warning=!1),!curConfig.no_save_warning&&Editor.show_save_warning?uiStrings.notification.unsavedChanges:void 0},Editor.openPrep=function(a){$j("#main_menu").hide(),0===undoMgr.getUndoStackSize()?a(!0):$j.confirm(uiStrings.notification.QwantToOpen,a)},window.FileReader){var import_image=function(a){a.stopPropagation(),a.preventDefault(),$j("#workarea").removeAttr("style"),$j("#main_menu").hide();var b=null;if(b="drop"==a.type?a.dataTransfer.files[0]:this.files[0],b&&-1!=b.type.indexOf("image"))if(-1!=b.type.indexOf("svg")){var c=new FileReader;c.onloadend=function(a){svgCanvas.importSvgString(a.target.result,!0),svgCanvas.ungroupSelectedElement(),svgCanvas.ungroupSelectedElement(),svgCanvas.groupSelectedElements(),svgCanvas.alignSelectedElements("m","page"),svgCanvas.alignSelectedElements("c","page")},c.readAsText(b)}else{var c=new FileReader;c.onloadend=function(a){insertNewImage=function(b,c){var d=svgCanvas.addSvgElementFromJson({element:"image",attr:{x:0,y:0,width:b,height:c,id:svgCanvas.getNextId(),style:"pointer-events:inherit"}});svgCanvas.setHref(d,a.target.result),svgCanvas.selectOnly([d]),svgCanvas.alignSelectedElements("m","page"),svgCanvas.alignSelectedElements("c","page"),updateContextPanel()};var b=100,c=100,d=new Image;d.src=a.target.result,d.style.opacity=0,d.onload=function(){b=d.offsetWidth,c=d.offsetHeight,insertNewImage(b,c)}},c.readAsDataURL(b)}};workarea[0].addEventListener("dragenter",onDragEnter,!1),workarea[0].addEventListener("dragover",onDragOver,!1),workarea[0].addEventListener("dragleave",onDragLeave,!1),workarea[0].addEventListener("drop",import_image,!1);var open=$j('<input type="file">').change(function(){var a=this;Editor.openPrep(function(b){if(b&&(svgCanvas.clear(),1==a.files.length)){var c=new FileReader;c.onloadend=function(a){loadSvgString(a.target.result),updateCanvas()},c.readAsText(a.files[0])}})});$j("#tool_open").show().prepend(open);var img_import=$j('<input type="file">').change(import_image);$j("#tool_import").show().prepend(img_import)}for(var updateCanvas=Editor.updateCanvas=function(a,b){var c=workarea.width(),d=workarea.height(),e=c,f=d,g=svgCanvas.getZoom(),h=workarea,i=$j("#svgcanvas"),j={x:h[0].scrollLeft+e/2,y:h[0].scrollTop+f/2},k=1;"web2print"==toolType&&(k=curConfig.canvas_expansion),trace("zoom  = "+g),c=Math.max(e,svgCanvas.contentW*g*k),d=Math.max(f,svgCanvas.contentH*g*k),trace("multi = "+k),trace("w = "+c),trace("h = "+d),trace("w_orig = "+e),trace("h_orig = "+f),c==e&&d==f?(trace("overflow hidden"),workarea.css("overflow","hidden")):(trace("overflow scroll"),workarea.css("overflow","scroll"));var l=i.height()/2,m=i.width()/2;i.width(c).height(d);var n=d/2,o=c/2,p=svgCanvas.updateCanvas(c,d),q=o/m,r=c/2-e/2,s=d/2-f/2;if(b)b.x+=p.x,b.y+=p.y;else{var t=j.x-m,u=o+t*q,v=j.y-l,w=n+v*q;b={x:u,y:w}}svgedit.browser.isIE()&&"producttool"==toolType?(h[0].scrollLeft=0,h[0].scrollTop=0):a?svgCanvas.contentW>h.width()?(workarea[0].scrollLeft=p.x-10,workarea[0].scrollTop=p.y-10):(h[0].scrollLeft=r,h[0].scrollTop=s):(h[0].scrollLeft=b.x-e/2,h[0].scrollTop=b.y-f/2),curConfig.showRulers&&(updateRulers(i,g),workarea.scroll()),svgCanvas.runExtensions("canvasUpdated")},r_intervals=[],i=.1;1e5>i;i*=10)r_intervals.push(1*i),r_intervals.push(2*i),r_intervals.push(5*i);var updateRulers=Editor.updateRulers=function(a,b){b||(b=svgCanvas.getZoom()),a||(a=$j("#svgcanvas"));for(var c=3e4,d=svgCanvas.getContentElem(),e=svgedit.units.getTypeMap(),f=e[curConfig.baseUnit],g=0;2>g;g++){var h=0===g,i=h?"x":"y",j=h?"width":"height",k=d.getAttribute(i)-0,l=$j("#ruler_"+i+" canvas:first");$hcanv=l.clone(),l.replaceWith($hcanv);var m=$hcanv[0],n=a[j](),o=n;m.parentNode.style[j]=o+"px";var p,q=0,r=m.getContext("2d");if(r.fillStyle="rgb(200,0,0)",r.fillRect(0,0,m.width,m.height),$hcanv.siblings().remove(),n>=c){var s=parseInt(n/c)+1;p=Array(s),p[0]=r;for(var t=1;s>t;t++){m[j]=c;var u=m.cloneNode(!0);m.parentNode.appendChild(u),p[t]=u.getContext("2d")}u[j]=n%c,n=c}m[j]=n;for(var v=f*b,w=50/v,x=1,t=0;t<r_intervals.length;t++){var s=r_intervals[t];if(x=s,s>=w)break}var y=x*v;r.font="9px sans-serif";for(var z=k/v%x*v,A=z-y;o>z;z+=y){A+=y;var B=Math.round(z)+.5;h?(r.moveTo(B,15),r.lineTo(B,0)):(r.moveTo(15,B),r.lineTo(0,B));var C,s=(A-k)/v;if(x>=1)C=Math.round(s);else{var D=(x+"").split(".")[1].length;C=s.toFixed(D)-0}if(0!==C&&1e3!==C&&C%1e3===0&&(C=C/1e3+"K"),h)r.fillText(C,z+2,8);else for(var E=(C+"").split(""),t=0;t<E.length;t++)r.fillText(E[t],1,z+9+9*t);for(var F=y/10,t=1;10>t;t++){var G=Math.round(z+F*t)+.5;if(p&&G>n){if(q++,r.stroke(),q>=p.length){t=10,z=o;continue}r=p[q],z-=c,G=Math.round(z+F*t)+.5}var H=t%2?12:10;h?(r.moveTo(G,15),r.lineTo(G,H)):(r.moveTo(15,G),r.lineTo(H,G))}}r.strokeStyle="#000",r.stroke()}};updateCanvas(!0);try{var json_encode=function(a){if(window.JSON&&JSON.stringify)return JSON.stringify(a);var b=arguments.callee;if("boolean"==typeof a||"number"==typeof a)return a+"";if("string"==typeof a)return'"'+a.replace(/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"';if(a.length){for(var c=0;c<a.length;c++)a[c]=b(a[c]);return"["+a.join(",")+"]"}var d=[];for(var e in a)d.push(b(e)+":"+b(a[e]));return"{"+d.join(",")+"}"};window.addEventListener("message",function(e){var cbid=parseInt(e.data.substr(0,e.data.indexOf(";")));try{e.source.postMessage("SVGe"+cbid+";"+json_encode(eval(e.data)),"*")}catch(err){e.source.postMessage("SVGe"+cbid+";error:"+err.message,"*")}},!1)}catch(err){window.embed_error=err}$j(function(){window.svgCanvas=svgCanvas,svgCanvas.ready=svgEditor.ready}),Editor.setLang=function(a,b){if($j.pref("lang",a),$j("#lang_select").val(a),b){var c=(b.notification,$j("#layerlist tr.layersel td.layername").text()),d=c==uiStrings.common.layer+" 1";$j.extend(uiStrings,b),svgCanvas.setUiStrings(b),Actions.setTitles(),d&&(svgCanvas.renameCurrentLayer(uiStrings.common.layer+" 1"),populateLayers()),svgCanvas.runExtensions("langChanged",a)}}};var callbacks=[];return Editor.ready=function(a){is_ready?a():callbacks.push(a)},Editor.runCallbacks=function(){$j.each(callbacks,function(){this()}),is_ready=!0},Editor.loadFromString=function(a){Editor.ready(function(){loadSvgString(a)})},Editor.disableUI=function(){},Editor.loadFromURL=function(a,b){b||(b={});var c=b.cache,d=b.callback;Editor.ready(function(){$j.ajax({url:a,dataType:"text",cache:!!c,success:function(a){loadSvgString(a,d)},error:function(a,b,c){404!=a.status&&a.responseText?loadSvgString(a.responseText,d):$j.alert(uiStrings.notification.URLloadFail+": \n"+c,d)}})})},Editor.loadFromDataURI=function(a){Editor.ready(function(){var b="data:image/svg+xml;base64,",c=a.substring(b.length);loadSvgString(svgedit.utilities.decode64(c))})},Editor.addExtension=function(){var a=arguments;$j(function(){svgCanvas&&svgCanvas.addExtension.apply(this,a)})},Editor}(jQuery)),0==extensionArray.length&&$j(svgEditor.init)})();var svgEditor=function(a,b){function c(b,c,d){var e=a("body");for(var f in c){var g=c[f];d&&(f="#"+f);var h=e.find(f);if(h.length){var i=e.find(f)[0];switch(b){case"content":i.innerHTML=g;break;case"rollOver":i.title=g;break;case"label":i.value=g}}}}var d;return b.readLang=function(e){var f=b.canvas.runExtensions("addlangData",d,!0);a.each(f,function(b,c){c.data&&(e=a.merge(e,c.data))});{var g=e.elementLabel,h=e.qrCodePanel,i=(e.popUp,e.rollOver);e.inputValue}c("content",{productsettingCaption:g.productsettingCaption,changeproductCaption:g.changeproductCaption,prodCat_label:g.prodCat_label,chooseProdPopup:g.chooseProductCaption,addmainproduct:g.changeproductCaption,chooseArtCaption:g.chooseArtCaption,chooseartpopup:g.chooseArtCaption,clipCat_label:g.clipCat_label,addTextCaption:g.addTextCaption,addTextPopupCaption:g.addTextPopupCaption,addImageCaption:g.addImageCaption,addNameNumberCaption:g.addNameNumberCaption,designIdeaCaption:g.designIdeaCaption,qrCodeCaption:g.qrCodeCaption,choosedesignpopup:g.choosedesignpopup,chooseDesignCaption:g.chooseDesignCaption,shapeToolCaption:g.shapeToolCaption,borderstyle:g.borderstyle,bordersize:g.bordersize,btnAddText:g.addTextBtnCaption,chooseFontCaption:g.chooseFontCaption,objectSizeCaption:g.objectSizeCaption,objectXCaption:g.objectXCaption,objectYCaption:g.objectYCaption,objectWCaption:g.objectWCaption,objectHCaption:g.objectHCaption,objectborderCaption:g.objectborderCaption,objectRotateCaption:g.objectRotateCaption,objectCurveCaption:g.objectCurveCaption,objectCurveReverseCaption:g.objectCurveReverseCaption,objectLineSpaceCaptioon:g.objectLineSpaceCaptioon,objectMoveCaption:g.objectMoveCaption,objectTextShapeCaption:g.objectTextShapeCaption,objectColorCaption:g.objectColorCaption,rightsCaption:g.rightsCaption,uploadImageInfoPopupCaption:g.uploadImageInfoPopupCaption,uploadBtnPopup:g.uploadBtnPopup,galleryBtnPopup:g.galleryBtnPopup,imageUploadPrecaution1:g.imageUploadPrecaution1,imageUploadPrecaution2:g.imageUploadPrecaution2,imageUploadPrecaution3:g.imageUploadPrecaution3,uploadImageInstructionCaption:g.uploadImageInstructionCaption,imageGallerCaption:g.imageGallerCaption,imageGalleryPopupInfoCaption:g.imageGalleryPopupInfoCaption,uploadHDCaption:g.uploadHDCaption,printQualityCaption:g.printQualityCaption,printQualityPoorCaption:g.printQualityPoorCaption,printQualityFairCaption:g.printQualityFairCaption,printQualityGoodCaption:g.printQualityGoodCaption,addToCartCaption:g.addToCartCaption,cartProceed:g.PROCEED,gallery_warn_msg:g.gallery_warn_msg,back_to_cart:g.back_to_cart,cart_next:g.cart_next,qrcodeDataTypeCaption:h.qrcodeDataTypeCaption,websiteUrl:h.websiteUrl,youtubeVideo:h.youtubeVideo,plaintext:h.plaintext,emailAdd:h.emailAdd,telephone:h.telephone,emailMsg:h.emailMsg,socialMedia:h.socialMedia,gmap:h.gmap,websiteCaption:h.websiteCaption,videoIdCaption:h.videoIdCaption,videoUrlCaption:h.videoUrlCaption,textCaption:h.textCaption,emailaddreCaption:h.emailaddreCaption,telephoneCaption:h.telephoneCaption,subjectCaption:h.subjectCaption,bodyCaption:h.bodyCaption,socialMediaCaption:h.socialMediaCaption,twitterProfileCaption:h.twitterProfileCaption,facebookProfileCaption:h.facebookProfileCaption,myspaceProfileCaption:h.myspaceProfileCaption,linkedlinProfileCaption:h.linkedlinProfileCaption,profileCaption:h.profileCaption,gmaplocationCaption:h.gmaplocationCaption,rqcodeColorCaption:h.rqcodeColorCaption,productInfoCaption:g.productInfoCaption,productZoomCaption:g.productZoomCaption,productPreviewCaption:g.productPreviewCaption,productSaveCaption:g.productSaveCaption,fbShareCaption:g.fbShareCaption,twitterShareCaption:g.twitterShareCaption,pinitShareCaption:g.pinitShareCaption,chooseSideCaption:g.chooseSideCaption,printingMethodCaption:g.printingMethodCaption,sizeQtyCaption:g.sizeQtyCaption,avgPrintPriceCaption:g.avgPrintPriceCaption,artWorkSetupPriceCaption:g.artWorkSetupPriceCaption,addNoteCaption:g.addNoteCaption,supportedFormatCaption:g.supportedFormatCaption,optimalResolutionCaption:g.optimalResolutionCaption,recommendedSizeCaption:g.recommendedSizeCaption,imageGalleryPopupInfoContent:g.imageGalleryPopupInfoContent,imageQualityInfoCaption:g.imageQualityInfoCaption,imageQualityInfoContent:g.imageQualityInfoContent,saveDesignCaption:g.saveDesignCaption,designDetailsCaption:g.designDetailsCaption,designNameCaption:g.designNameCaption,btn_save_design:g.SUBMIT,loginRegisterPopupCaption:g.loginRegisterPopupCaption,loginCaption:g.loginCaption,lEmailCaption:g.EmailCaption,lPasswordCaption:g.PasswordCaption,forgetPasswordCaption:g.forgetPasswordCaption,registerCaption:g.registerCaption,fNameCaption:g.fNameCaption,lNameCaption:g.lNameCaption,rEmailCaption:g.EmailCaption,rPasswordCaption:g.PasswordCaption,rConfirmPasswordCaption:g.ConfirmPasswordCaption,productColor:g.productColorCaption,productInformation:g.productInformation,productSku:g.productSkuCaption,productShortDesc:g.productShortDescCaption,productDesc:g.productDescCaption,productNameCaption:g.productNameCaption,previewPopupCaption:g.previewPopupCaption,duplicateSideCaption:g.duplicateSideCaption,detailInfoCaption:g.productInformation,addImagePopupcaption:i.addImageCaption,facebookUploadCaption:g.facebookUploadCaption,flickrUploadCaption:g.flickrUploadCaption,picasaUploadCaption:g.picasaUploadCaption,instagramUploadCaption:g.instagramUploadCaption,fit_to_all:g.fitToAll,fit_to_canvas:g.fitToCanvas,fit_to_sel:g.fitToSel,relativeToLabel:g.relativeToLabel,selected_objects:g.selected_objects,largest_object:g.largest_object,smallest_object:g.smallest_object,page:g.page,page_cutMargin:g.CutMarginLabel,page_safeMargin:g.SafeMarginLabel,downloadPreviewCaption:g.downloadPreviewCaption,name_control_btn:g.name_control_btn,num_control_btn:g.num_control_btn,name_num_close:g.name_num_close,enter_custom_list_btn:g.enter_custom_list_btn,sizeTableCaption:g.sizeTableCaption,nameTableCaption:g.nameTableCaption,numberTableCaption:g.numberTableCaption,addNewNameNumber:g.addNewNameNumber,name_num_backBtn:g.name_num_backBtn,namePriceCaption:g.namePriceCaption,numberPriceCaption:g.numberPriceCaption,nameNumberCloseButton:g.nameNumberCloseButton,fontSizeInstruction:g.fontSizeInstruction,backgroundImageCaption:g.backgroundImageCaption,borderCaption:g.borderCaption,sizeCaption:g.sizeCaption,marginCaption:g.marginCaption,backgroundCaption:g.backgroundCaption,colorCaption:g.colorCaption,manageLayersCaption:g.manageLayersCaption,alignmentCaption:g.alignmentCaption,font_type_caption:g.font_type_caption,color_caption:g.color_caption,font_style_caption:g.font_style_caption,border_style_caption:g.border_style_caption,font_shape_caption:g.font_shape_caption,pickColorCaption:g.pickColorCaption},!0),c("label",{picasa_go:g.GO,flicker_go:g.GO,addcart:g.addcart,btn_login:g.loginCaption,btn_login_gallery:g.loginCaption,btn_cancel:g.CANCEL,tool_qrCode:h.tool_qrCode,btn_submit:g.SUBMIT},!0),c("rollOver",{productSettingTab:i.productsettingCaption,changeImageCaption:i.changeImageCaption,removeImageCaption:i.removeImageCaption,layerPanel:i.layerPanel,alignPanel:i.alignPanel,tool_ungroup:i.tool_ungroup,tool_group:i.tool_group,tool_undo_custom:i.tool_undo_custom,tool_redo_custom:i.tool_redo_custom,tool_delete:i.tool_delete,tool_clone:i.tool_clone,tool_cut:i.tool_cut,tool_copy:i.tool_copy,tool_paste:i.tool_paste,tool_clear:i.tool_clear,help_window:i.Help,zoomButton:i.productZoomCaption,preview:i.productPreviewCaption,save_image:i.productSaveCaption,facebook_share:i.fbShareCaption,twitter_share:i.twitterShareCaption,pinterest_share:i.pinitShareCaption,addart:i.chooseArtCaption,addtimage:i.addImageCaption,addshape:i.addShapesCaption,desingidea:i.designIdeaCaption,tool_bold:g.BOLD,tool_italic:g.ITALIC,text_align_left:g.ALIGN_LEFT,text_align_center:g.ALIGN_CENTER,text_align_right:g.ALIGN_RIGHT,tool_posleft:g.ALIGN_LEFT,tool_poscenter:g.ALIGN_CENTER,tool_posright:g.ALIGN_RIGHT,tool_postop:g.ALIGN_TOP,tool_posmiddle:g.ALIGN_MIDDLE,tool_posbottom:g.ALIGN_BOTTOM,fill_color:g.FILL_COLOR,stroke_color:g.STROKE_COLOR,stroke_style:g.STROKE_STYLE,border_color:g.STROKE_COLOR,border_stroke_style:g.STROKE_STYLE,bgcolor_color:i.BG_FILL_COLOR,bgImageBtn:i.BG_IMAGE,removeImageBtn:i.REMOVE_BG_IMAGE,tool_fhpath:i.PENCIL_TOOL,tool_line:i.LINE_TOOL,tools_rect_show:i.RECT_GROUP_TOOL,tool_rect:i.RECT,tool_square:i.SQUARE,tool_fhrect:i.FHRECT,tools_ellipse_show:i.ELLIPSE_GROUP_TOOL,tool_ellipse:i.ELLIPSE,tool_circle:i.CIRCLE,tool_fhellipse:i.FHELLIPSE,addtocart_btn:g.addToCartCaption,qr_color:i.QR_FILL_COLOR,firstPage:i.FIRSTPAGE,prevPage:i.PREVPAGE,nextPage:i.NEXTPAGE,lastPage:i.LASTPAGE,textFontSize:i.fontSizeCaption,tool_clone_side:i.tool_clone_side},!0),b.setLang(d,e)
},b.putLocale=function(c,e){if(c)d=c;else{if(d=a.pref("lang"),!d&&(navigator.userLanguage?d=navigator.userLanguage:navigator.language&&(d=navigator.language),""==d))return;if(-1==a.inArray(d,e)&&"test"!==d&&(d="en"),0==d.indexOf("en"))return}var f=b.curConfig,g=f.langPath+"lang_tool.js";a.getScript(g,function(a){if(!a){var b=document.createElement("script");b.src=g}})},b}(jQuery,svgEditor),svgedit=svgedit||{};!function(){var a=this;svgedit.contextmenu||(svgedit.contextmenu={}),a.contextMenuExtensions={};var b=function(b){return f(b)?b.id in a.contextMenuExtensions?void console.error('Cannot add extension "'+b.id+'", an extension by that name already exists"'):void(a.contextMenuExtensions[b.id]=b):void console.error("Menu items must be defined and have at least properties: id, label, action, where action must be a function")},c=function(b){return a.contextMenuExtensions[b]&&!0},d=function(b){return a.contextMenuExtensions[b].action},e=function(b){0==Object.keys(a.contextMenuExtensions).length&&$j("#cmenu_canvas").append("<li class='separator'>");var c=b.shortcut||"";$j("#cmenu_canvas").append("<li class='disabled'><a href='#"+b.id+"'>"+b.label+"<span class='shortcut'>"+c+"</span></a></li>")},f=function(a){return a&&a.id&&a.label&&a.action&&"function"==typeof a.action};svgEditor.ready(function(){for(menuItem in contextMenuExtensions)e(contextMenuExtensions[menuItem])}),svgedit.contextmenu.resetCustomMenus=function(){a.contextMenuExtensions={}},svgedit.contextmenu.add=b,svgedit.contextmenu.hasCustomHandler=c,svgedit.contextmenu.getCustomHandler=d}(),window.googleLT_||(window.googleLT_=(new Date).getTime()),window.google||(window.google={}),window.google.loader||(window.google.loader={},google.loader.ServiceBase="http://www.google.com/uds",google.loader.GoogleApisBase="http://ajax.googleapis.com/ajax",google.loader.ApiKey="notsupplied",google.loader.KeyVerified=!0,google.loader.LoadFailure=!1,google.loader.Secure=!1,google.loader.GoogleLocale="www.google.com",google.loader.ClientLocation={latitude:23.05,longitude:72.667,address:{city:"Ahmedabad",region:"Gujarat",country:"India",country_code:"IN"}},google.loader.AdditionalParams="",function(){function a(a,b){return a.load=b}function b(a){return a in G?G[a]:G[a]=-1!=navigator.userAgent[F]()[v](a)}function c(a,b){var c=function(){};c.prototype=b[A],a.U=b[A],a.prototype=new c}function d(a,b){var c=Array[A].slice.call(arguments,2)||[];return function(){var d=c.concat(Array[A].slice.call(arguments));return a.apply(b,d)}}function e(a){return a=Error(a),a.toString=function(){return this.message},a}function f(a,b){for(var c=a.split(/\./),d=q,e=0;e<c[z]-1;e++)d[c[e]]||(d[c[e]]={}),d=d[c[e]];d[c[c[z]-1]]=b}function g(a,b,c){a[b]=c}function h(a,b,c){if(a.addEventListener)a.addEventListener(b,c,!1);else if(a.attachEvent)a.attachEvent("on"+b,c);else{var d=a["on"+b];a["on"+b]=null!=d?i([c,d]):c}}function i(a){return function(){for(var b=0;b<a[z];b++)a[b]()}}function j(){M[r.readyState]?k():0<L[z]&&q[B](j,10)}function k(){for(var a=0;a<L[z];a++)L[a]();L.length=0}function l(a){this.b=a,this.o=[],this.n={},this.e={},this.f={},this.j=!0,this.c=-1}function m(a){this.F=a,this.q={},this.r=0}function n(a,b,c){this.name=a,this.D=b,this.p=c,this.u=this.h=!1,this.k=[],google[C].v[this[x]]=d(this.l,this)}function o(a,b){this.b=a,this.i=b,this.h=!1}var p=encodeURIComponent,q=window,r=document,s="push",t="replace",u="charAt",v="indexOf",w="ServiceBase",x="name",y="getTime",z="length",A="prototype",B="setTimeout",C="loader",D="substring",E="join",F="toLowerCase",G={};if(!H)var H=f;if(!I)var I=g;google[C].v={},H("google.loader.callbacks",google[C].v);var J={},K={};google[C].eval={},H("google.loader.eval",google[C].eval),a(google,function(a,b,c){function d(a){var b=a.split(".");if(2<b[z])throw e("Module: '"+a+"' not found!");"undefined"!=typeof b[1]&&(f=b[0],c.packages=c.packages||[],c.packages[s](b[1]))}var f=a;if(c=c||{},a instanceof Array||a&&"object"==typeof a&&"function"==typeof a[E]&&"function"==typeof a.reverse)for(var g=0;g<a[z];g++)d(a[g]);else d(a);if(!(a=J[":"+f]))throw e("Module: '"+f+"' not found!");if(c&&!c.language&&c.locale&&(c.language=c.locale),c&&"string"==typeof c.callback&&(g=c.callback,g.match(/^[[\]A-Za-z0-9._]+$/)&&(g=q.eval(g),c.callback=g)),(g=c&&null!=c.callback)&&!a.s(b))throw e("Module: '"+f+"' must be loaded before DOM onLoad!");g?a.m(b,c)?q[B](c.callback,0):a.load(b,c):a.m(b,c)||a.load(b,c)}),H("google.load",google.load),google.T=function(a,c){c?(0==L[z]&&(h(q,"load",k),!b("msie")&&!b("safari")&&!b("konqueror")&&b("mozilla")||q.opera?q.addEventListener("DOMContentLoaded",k,!1):b("msie")?r.write("<script defer onreadystatechange='google.loader.domReady()' src=//:></script>"):(b("safari")||b("konqueror"))&&q[B](j,10)),L[s](a)):h(q,"load",a)},H("google.setOnLoadCallback",google.T);var L=[];google[C].P=function(){var a=q.event.srcElement;"complete"==a.readyState&&(a.onreadystatechange=null,a.parentNode.removeChild(a),k())},H("google.loader.domReady",google[C].P);var M={loaded:!0,complete:!0};google[C].d=function(a,b,c){if(c){var d;"script"==a?(d=r.createElement("script"),d.type="text/javascript",d.src=b):"css"==a&&(d=r.createElement("link"),d.type="text/css",d.href=b,d.rel="stylesheet"),(a=r.getElementsByTagName("head")[0])||(a=r.body.parentNode.appendChild(r.createElement("head"))),a.appendChild(d)}else"script"==a?r.write('<script src="'+b+'" type="text/javascript"></script>'):"css"==a&&r.write('<link href="'+b+'" type="text/css" rel="stylesheet"></link>')},H("google.loader.writeLoadTag",google[C].d),google[C].Q=function(a){K=a},H("google.loader.rfm",google[C].Q),google[C].S=function(a){for(var b in a)"string"==typeof b&&b&&":"==b[u](0)&&!J[b]&&(J[b]=new o(b[D](1),a[b]))},H("google.loader.rpl",google[C].S),google[C].R=function(a){if((a=a.specs)&&a[z])for(var b=0;b<a[z];++b){var c=a[b];"string"==typeof c?J[":"+c]=new l(c):(c=new n(c[x],c.baseSpec,c.customSpecs),J[":"+c[x]]=c)}},H("google.loader.rm",google[C].R),google[C].loaded=function(a){J[":"+a.module].l(a)},H("google.loader.loaded",google[C].loaded),google[C].O=function(){return"qid="+((new Date)[y]().toString(16)+Math.floor(1e7*Math.random()).toString(16))},H("google.loader.createGuidArg_",google[C].O),f("google_exportSymbol",f),f("google_exportProperty",g),google[C].a={},H("google.loader.themes",google[C].a),google[C].a.I="//www.google.com/cse/style/look/bubblegum.css",I(google[C].a,"BUBBLEGUM",google[C].a.I),google[C].a.K="//www.google.com/cse/style/look/greensky.css",I(google[C].a,"GREENSKY",google[C].a.K),google[C].a.J="//www.google.com/cse/style/look/espresso.css",I(google[C].a,"ESPRESSO",google[C].a.J),google[C].a.M="//www.google.com/cse/style/look/shiny.css",I(google[C].a,"SHINY",google[C].a.M),google[C].a.L="//www.google.com/cse/style/look/minimalist.css",I(google[C].a,"MINIMALIST",google[C].a.L),google[C].a.N="//www.google.com/cse/style/look/v2/default.css",I(google[C].a,"V2_DEFAULT",google[C].a.N),l[A].g=function(a,b){var c="";if(void 0!=b&&(void 0!=b.language&&(c+="&hl="+p(b.language)),void 0!=b.nocss&&(c+="&output="+p("nocss="+b.nocss)),void 0!=b.nooldnames&&(c+="&nooldnames="+p(b.nooldnames)),void 0!=b.packages&&(c+="&packages="+p(b.packages)),null!=b.callback&&(c+="&async=2"),void 0!=b.style&&(c+="&style="+p(b.style)),void 0!=b.noexp&&(c+="&noexp=true"),void 0!=b.other_params&&(c+="&"+b.other_params)),!this.j){google[this.b]&&google[this.b].JSHash&&(c+="&sig="+p(google[this.b].JSHash));var d,e=[];for(d in this.n)":"==d[u](0)&&e[s](d[D](1));for(d in this.e)":"==d[u](0)&&this.e[d]&&e[s](d[D](1));c+="&have="+p(e[E](","))}return google[C][w]+"/?file="+this.b+"&v="+a+google[C].AdditionalParams+c},l[A].t=function(a){var b=null;a&&(b=a.packages);var c=null;if(b)if("string"==typeof b)c=[a.packages];else if(b[z])for(c=[],a=0;a<b[z];a++)"string"==typeof b[a]&&c[s](b[a][t](/^\s*|\s*$/,"")[F]());for(c||(c=["default"]),b=[],a=0;a<c[z];a++)this.n[":"+c[a]]||b[s](c[a]);return b},a(l[A],function(a,b){var c=this.t(b),d=b&&null!=b.callback;if(d)var e=new m(b.callback);for(var f=[],g=c[z]-1;g>=0;g--){var h=c[g];d&&e.B(h),this.e[":"+h]?(c.splice(g,1),d&&this.f[":"+h][s](e)):f[s](h)}if(c[z]){for(b&&b.packages&&(b.packages=c.sort()[E](",")),g=0;g<f[z];g++)h=f[g],this.f[":"+h]=[],d&&this.f[":"+h][s](e);if(b||null==K[":"+this.b]||null==K[":"+this.b].versions[":"+a]||google[C].AdditionalParams||!this.j)b&&b.autoloaded||google[C].d("script",this.g(a,b),d);else{c=K[":"+this.b],google[this.b]=google[this.b]||{};for(var i in c.properties)i&&":"==i[u](0)&&(google[this.b][i[D](1)]=c.properties[i]);google[C].d("script",google[C][w]+c.path+c.js,d),c.css&&google[C].d("css",google[C][w]+c.path+c.css,d)}for(this.j&&(this.j=!1,this.c=(new Date)[y](),1!=this.c%100&&(this.c=-1)),g=0;g<f[z];g++)h=f[g],this.e[":"+h]=!0}}),l[A].l=function(a){-1!=this.c&&(T("al_"+this.b,"jl."+((new Date)[y]()-this.c),!0),this.c=-1),this.o=this.o.concat(a.components),google[C][this.b]||(google[C][this.b]={}),google[C][this.b].packages=this.o.slice(0);for(var b=0;b<a.components[z];b++){this.n[":"+a.components[b]]=!0,this.e[":"+a.components[b]]=!1;var c=this.f[":"+a.components[b]];if(c){for(var d=0;d<c[z];d++)c[d].C(a.components[b]);delete this.f[":"+a.components[b]]}}},l[A].m=function(a,b){return 0==this.t(b)[z]},l[A].s=function(){return!0},m[A].B=function(a){this.r++,this.q[":"+a]=!0},m[A].C=function(a){this.q[":"+a]&&(this.q[":"+a]=!1,this.r--,0==this.r&&q[B](this.F,0))},c(n,l),a(n[A],function(a,b){var c=b&&null!=b.callback;c?(this.k[s](b.callback),b.callback="google.loader.callbacks."+this[x]):this.h=!0,b&&b.autoloaded||google[C].d("script",this.g(a,b),c)}),n[A].m=function(a,b){return b&&null!=b.callback?this.u:this.h},n[A].l=function(){this.u=!0;for(var a=0;a<this.k[z];a++)q[B](this.k[a],0);this.k=[]};var N=function(a,b){return a.string?p(a.string)+"="+p(b):a.regex?b[t](/(^.*$)/,a.regex):""};n[A].g=function(a,b){return this.G(this.w(a),a,b)},n[A].G=function(a,b,c){var d="";if(a.key&&(d+="&"+N(a.key,google[C].ApiKey)),a.version&&(d+="&"+N(a.version,b)),b=google[C].Secure&&a.ssl?a.ssl:a.uri,null!=c)for(var e in c)a.params[e]?d+="&"+N(a.params[e],c[e]):"other_params"==e?d+="&"+c[e]:"base_domain"==e&&(b="http://"+c[e]+a.uri[D](a.uri[v]("/",7)));return google[this[x]]={},-1==b[v]("?")&&d&&(d="?"+d[D](1)),b+d},n[A].s=function(a){return this.w(a).deferred},n[A].w=function(a){if(this.p)for(var b=0;b<this.p[z];++b){var c=this.p[b];if(RegExp(c.pattern).test(a))return c}return this.D},c(o,l),a(o[A],function(a,b){this.h=!0,google[C].d("script",this.g(a,b),!1)}),o[A].m=function(){return this.h},o[A].l=function(){},o[A].g=function(a,b){if(!this.i.versions[":"+a]){if(this.i.aliases){var c=this.i.aliases[":"+a];c&&(a=c)}if(!this.i.versions[":"+a])throw e("Module: '"+this.b+"' with version '"+a+"' not found!")}return google[C].GoogleApisBase+"/libs/"+this.b+"/"+a+"/"+this.i.versions[":"+a][b&&b.uncompressed?"uncompressed":"compressed"]},o[A].s=function(){return!1};var O=!1,P=[],Q=(new Date)[y](),R=function(){O||(h(q,"unload",U),O=!0)},S=function(a,b){if(R(),!(google[C].Secure||google[C].Options&&!1!==google[C].Options.csi)){for(var c=0;c<a[z];c++)a[c]=p(a[c][F]()[t](/[^a-z0-9_.]+/g,"_"));for(c=0;c<b[z];c++)b[c]=p(b[c][F]()[t](/[^a-z0-9_.]+/g,"_"));q[B](d(V,null,"//gg.google.com/csi?s=uds&v=2&action="+a[E](",")+"&it="+b[E](",")),1e4)}},T=function(a,b,c){c?S([a],[b]):(R(),P[s]("r"+P[z]+"="+p(a+(b?"|"+b:""))),q[B](U,5<P[z]?0:15e3))},U=function(){if(P[z]){var a=google[C][w];0==a[v]("http:")&&(a=a[t](/^http:/,"https:")),V(a+"/stats?"+P[E]("&")+"&nc="+(new Date)[y]()+"_"+((new Date)[y]()-Q)),P.length=0}},V=function(a){var b=new Image,c=V.H++;V.A[c]=b,b.onload=b.onerror=function(){delete V.A[c]},b.src=a,b=null};V.A={},V.H=0,f("google.loader.recordCsiStat",S),f("google.loader.recordStat",T),f("google.loader.createImageForLogging",V)}(),google.loader.rm({specs:["feeds","spreadsheets","gdata","visualization",{name:"sharing",baseSpec:{uri:"http://www.google.com/s2/sharing/js",ssl:null,key:{string:"key"},version:{string:"v"},deferred:!1,params:{language:{string:"hl"}}}},"search","orkut","ads","elements",{name:"books",baseSpec:{uri:"http://books.google.com/books/api.js",ssl:"https://encrypted.google.com/books/api.js",key:{string:"key"},version:{string:"v"},deferred:!0,params:{callback:{string:"callback"},language:{string:"hl"}}}},{name:"friendconnect",baseSpec:{uri:"http://www.google.com/friendconnect/script/friendconnect.js",ssl:null,key:{string:"key"},version:{string:"v"},deferred:!1,params:{}}},"identitytoolkit","ima",{name:"maps",baseSpec:{uri:"http://maps.google.com/maps?file=googleapi",ssl:"https://maps-api-ssl.google.com/maps?file=googleapi",key:{string:"key"},version:{string:"v"},deferred:!0,params:{callback:{regex:"callback=$1&async=2"},language:{string:"hl"}}},customSpecs:[{uri:"http://maps.googleapis.com/maps/api/js",ssl:"https://maps.googleapis.com/maps/api/js",version:{string:"v"},deferred:!0,params:{callback:{string:"callback"},language:{string:"hl"}},pattern:"^(3|3..*)$"}]},"payments","wave","annotations_v2","earth","language",{name:"annotations",baseSpec:{uri:"http://www.google.com/reviews/scripts/annotations_bootstrap.js",ssl:null,key:{string:"key"},version:{string:"v"},deferred:!0,params:{callback:{string:"callback"},language:{string:"hl"},country:{string:"gl"}}}},"picker"]}),google.loader.rfm({":search":{versions:{":1":"1",":1.0":"1"},path:"/api/search/1.0/cf717ce13f86fb2ebeed8f0046aba6ef/",js:"default+en.I.js",css:"default+en.css",properties:{":JSHash":"cf717ce13f86fb2ebeed8f0046aba6ef",":NoOldNames":!1,":Version":"1.0"}},":language":{versions:{":1":"1",":1.0":"1"},path:"/api/language/1.0/f66252f80431973fa38526a329b0a47b/",js:"default+en.I.js",properties:{":JSHash":"f66252f80431973fa38526a329b0a47b",":Version":"1.0"}},":feeds":{versions:{":1":"1",":1.0":"1"},path:"/api/feeds/1.0/e658fb253c8b588196cf534cc43ab319/",js:"default+en.I.js",css:"default+en.css",properties:{":JSHash":"e658fb253c8b588196cf534cc43ab319",":Version":"1.0"}},":spreadsheets":{versions:{":0":"1",":0.4":"1"},path:"/api/spreadsheets/0.4/87ff7219e9f8a8164006cbf28d5e911a/",js:"default.I.js",properties:{":JSHash":"87ff7219e9f8a8164006cbf28d5e911a",":Version":"0.4"}},":ima":{versions:{":3":"1",":3.0":"1"},path:"/api/ima/3.0/28a914332232c9a8ac0ae8da68b1006e/",js:"default.I.js",properties:{":JSHash":"28a914332232c9a8ac0ae8da68b1006e",":Version":"3.0"}},":wave":{versions:{":1":"1",":1.0":"1"},path:"/api/wave/1.0/3b6f7573ff78da6602dda5e09c9025bf/",js:"default.I.js",properties:{":JSHash":"3b6f7573ff78da6602dda5e09c9025bf",":Version":"1.0"}},":earth":{versions:{":1":"1",":1.0":"1"},path:"/api/earth/1.0/109c7b2bae7fe6cc34ea875176165d81/",js:"default.I.js",properties:{":JSHash":"109c7b2bae7fe6cc34ea875176165d81",":Version":"1.0"}},":annotations":{versions:{":1":"1",":1.0":"1"},path:"/api/annotations/1.0/bacce7b6155a1bbadda3c05d65391b22/",js:"default+en.I.js",properties:{":JSHash":"bacce7b6155a1bbadda3c05d65391b22",":Version":"1.0"}},":picker":{versions:{":1":"1",":1.0":"1"},path:"/api/picker/1.0/1c635e91b9d0c082c660a42091913907/",js:"default.I.js",css:"default.css",properties:{":JSHash":"1c635e91b9d0c082c660a42091913907",":Version":"1.0"}}}),google.loader.rpl({":scriptaculous":{versions:{":1.8.3":{uncompressed:"scriptaculous.js",compressed:"scriptaculous.js"},":1.9.0":{uncompressed:"scriptaculous.js",compressed:"scriptaculous.js"},":1.8.2":{uncompressed:"scriptaculous.js",compressed:"scriptaculous.js"},":1.8.1":{uncompressed:"scriptaculous.js",compressed:"scriptaculous.js"}},aliases:{":1.8":"1.8.3",":1":"1.9.0",":1.9":"1.9.0"}},":yui":{versions:{":2.6.0":{uncompressed:"build/yuiloader/yuiloader.js",compressed:"build/yuiloader/yuiloader-min.js"},":2.9.0":{uncompressed:"build/yuiloader/yuiloader.js",compressed:"build/yuiloader/yuiloader-min.js"},":2.7.0":{uncompressed:"build/yuiloader/yuiloader.js",compressed:"build/yuiloader/yuiloader-min.js"},":2.8.0r4":{uncompressed:"build/yuiloader/yuiloader.js",compressed:"build/yuiloader/yuiloader-min.js"},":2.8.2r1":{uncompressed:"build/yuiloader/yuiloader.js",compressed:"build/yuiloader/yuiloader-min.js"},":2.8.1":{uncompressed:"build/yuiloader/yuiloader.js",compressed:"build/yuiloader/yuiloader-min.js"},":3.3.0":{uncompressed:"build/yui/yui.js",compressed:"build/yui/yui-min.js"}},aliases:{":3":"3.3.0",":2":"2.9.0",":2.7":"2.7.0",":2.8.2":"2.8.2r1",":2.6":"2.6.0",":2.9":"2.9.0",":2.8":"2.8.2r1",":2.8.0":"2.8.0r4",":3.3":"3.3.0"}},":swfobject":{versions:{":2.1":{uncompressed:"swfobject_src.js",compressed:"swfobject.js"},":2.2":{uncompressed:"swfobject_src.js",compressed:"swfobject.js"}},aliases:{":2":"2.2"}},":ext-core":{versions:{":3.1.0":{uncompressed:"ext-core-debug.js",compressed:"ext-core.js"},":3.0.0":{uncompressed:"ext-core-debug.js",compressed:"ext-core.js"}},aliases:{":3":"3.1.0",":3.0":"3.0.0",":3.1":"3.1.0"}},":webfont":{versions:{":1.0.28":{uncompressed:"webfont_debug.js",compressed:"webfont.js"},":1.0.27":{uncompressed:"webfont_debug.js",compressed:"webfont.js"},":1.0.29":{uncompressed:"webfont_debug.js",compressed:"webfont.js"},":1.0.12":{uncompressed:"webfont_debug.js",compressed:"webfont.js"},":1.0.13":{uncompressed:"webfont_debug.js",compressed:"webfont.js"},":1.0.14":{uncompressed:"webfont_debug.js",compressed:"webfont.js"},":1.0.15":{uncompressed:"webfont_debug.js",compressed:"webfont.js"},":1.0.10":{uncompressed:"webfont_debug.js",compressed:"webfont.js"},":1.0.11":{uncompressed:"webfont_debug.js",compressed:"webfont.js"},":1.0.2":{uncompressed:"webfont_debug.js",compressed:"webfont.js"},":1.0.1":{uncompressed:"webfont_debug.js",compressed:"webfont.js"},":1.0.0":{uncompressed:"webfont_debug.js",compressed:"webfont.js"},":1.0.6":{uncompressed:"webfont_debug.js",compressed:"webfont.js"},":1.0.19":{uncompressed:"webfont_debug.js",compressed:"webfont.js"},":1.0.5":{uncompressed:"webfont_debug.js",compressed:"webfont.js"},":1.0.18":{uncompressed:"webfont_debug.js",compressed:"webfont.js"},":1.0.4":{uncompressed:"webfont_debug.js",compressed:"webfont.js"},":1.0.17":{uncompressed:"webfont_debug.js",compressed:"webfont.js"},":1.0.3":{uncompressed:"webfont_debug.js",compressed:"webfont.js"},":1.0.16":{uncompressed:"webfont_debug.js",compressed:"webfont.js"},":1.0.9":{uncompressed:"webfont_debug.js",compressed:"webfont.js"},":1.0.21":{uncompressed:"webfont_debug.js",compressed:"webfont.js"},":1.0.22":{uncompressed:"webfont_debug.js",compressed:"webfont.js"},":1.0.25":{uncompressed:"webfont_debug.js",compressed:"webfont.js"},":1.0.26":{uncompressed:"webfont_debug.js",compressed:"webfont.js"},":1.0.23":{uncompressed:"webfont_debug.js",compressed:"webfont.js"},":1.0.24":{uncompressed:"webfont_debug.js",compressed:"webfont.js"}},aliases:{":1":"1.0.29",":1.0":"1.0.29"}},":mootools":{versions:{":1.3.1":{uncompressed:"mootools.js",compressed:"mootools-yui-compressed.js"},":1.1.1":{uncompressed:"mootools.js",compressed:"mootools-yui-compressed.js"},":1.3.0":{uncompressed:"mootools.js",compressed:"mootools-yui-compressed.js"},":1.3.2":{uncompressed:"mootools.js",compressed:"mootools-yui-compressed.js"},":1.1.2":{uncompressed:"mootools.js",compressed:"mootools-yui-compressed.js"},":1.2.3":{uncompressed:"mootools.js",compressed:"mootools-yui-compressed.js"},":1.2.4":{uncompressed:"mootools.js",compressed:"mootools-yui-compressed.js"},":1.2.1":{uncompressed:"mootools.js",compressed:"mootools-yui-compressed.js"},":1.2.2":{uncompressed:"mootools.js",compressed:"mootools-yui-compressed.js"},":1.2.5":{uncompressed:"mootools.js",compressed:"mootools-yui-compressed.js"},":1.4.0":{uncompressed:"mootools.js",compressed:"mootools-yui-compressed.js"},":1.4.1":{uncompressed:"mootools.js",compressed:"mootools-yui-compressed.js"},":1.4.2":{uncompressed:"mootools.js",compressed:"mootools-yui-compressed.js"}},aliases:{":1":"1.1.2",":1.11":"1.1.1",":1.4":"1.4.2",":1.3":"1.3.2",":1.2":"1.2.5",":1.1":"1.1.2"}},":jqueryui":{versions:{":1.8.0":{uncompressed:"jquery-ui.js",compressed:"jquery-ui.min.js"},":1.8.2":{uncompressed:"jquery-ui.js",compressed:"jquery-ui.min.js"},":1.8.1":{uncompressed:"jquery-ui.js",compressed:"jquery-ui.min.js"},":1.8.15":{uncompressed:"jquery-ui.js",compressed:"jquery-ui.min.js"},":1.8.14":{uncompressed:"jquery-ui.js",compressed:"jquery-ui.min.js"},":1.8.13":{uncompressed:"jquery-ui.js",compressed:"jquery-ui.min.js"},":1.8.12":{uncompressed:"jquery-ui.js",compressed:"jquery-ui.min.js"},":1.8.11":{uncompressed:"jquery-ui.js",compressed:"jquery-ui.min.js"},":1.8.10":{uncompressed:"jquery-ui.js",compressed:"jquery-ui.min.js"},":1.8.17":{uncompressed:"jquery-ui.js",compressed:"jquery-ui.min.js"},":1.8.16":{uncompressed:"jquery-ui.js",compressed:"jquery-ui.min.js"},":1.6.0":{uncompressed:"jquery-ui.js",compressed:"jquery-ui.min.js"},":1.8.9":{uncompressed:"jquery-ui.js",compressed:"jquery-ui.min.js"},":1.8.7":{uncompressed:"jquery-ui.js",compressed:"jquery-ui.min.js"},":1.8.8":{uncompressed:"jquery-ui.js",compressed:"jquery-ui.min.js"},":1.7.2":{uncompressed:"jquery-ui.js",compressed:"jquery-ui.min.js"},":1.8.5":{uncompressed:"jquery-ui.js",compressed:"jquery-ui.min.js"},":1.7.3":{uncompressed:"jquery-ui.js",compressed:"jquery-ui.min.js"},":1.8.6":{uncompressed:"jquery-ui.js",compressed:"jquery-ui.min.js"},":1.7.0":{uncompressed:"jquery-ui.js",compressed:"jquery-ui.min.js"},":1.7.1":{uncompressed:"jquery-ui.js",compressed:"jquery-ui.min.js"},":1.8.4":{uncompressed:"jquery-ui.js",compressed:"jquery-ui.min.js"},":1.5.3":{uncompressed:"jquery-ui.js",compressed:"jquery-ui.min.js"},":1.5.2":{uncompressed:"jquery-ui.js",compressed:"jquery-ui.min.js"}},aliases:{":1.8":"1.8.17",":1.7":"1.7.3",":1.6":"1.6.0",":1":"1.8.17",":1.5":"1.5.3",":1.8.3":"1.8.4"}},":chrome-frame":{versions:{":1.0.2":{uncompressed:"CFInstall.js",compressed:"CFInstall.min.js"},":1.0.1":{uncompressed:"CFInstall.js",compressed:"CFInstall.min.js"},":1.0.0":{uncompressed:"CFInstall.js",compressed:"CFInstall.min.js"}},aliases:{":1":"1.0.2",":1.0":"1.0.2"}},":dojo":{versions:{":1.3.1":{uncompressed:"dojo/dojo.xd.js.uncompressed.js",compressed:"dojo/dojo.xd.js"},":1.3.0":{uncompressed:"dojo/dojo.xd.js.uncompressed.js",compressed:"dojo/dojo.xd.js"},":1.6.1":{uncompressed:"dojo/dojo.xd.js.uncompressed.js",compressed:"dojo/dojo.xd.js"},":1.1.1":{uncompressed:"dojo/dojo.xd.js.uncompressed.js",compressed:"dojo/dojo.xd.js"},":1.3.2":{uncompressed:"dojo/dojo.xd.js.uncompressed.js",compressed:"dojo/dojo.xd.js"},":1.6.0":{uncompressed:"dojo/dojo.xd.js.uncompressed.js",compressed:"dojo/dojo.xd.js"},":1.2.3":{uncompressed:"dojo/dojo.xd.js.uncompressed.js",compressed:"dojo/dojo.xd.js"},":1.7.2":{uncompressed:"dojo/dojo.js.uncompressed.js",compressed:"dojo/dojo.js"},":1.7.0":{uncompressed:"dojo/dojo.js.uncompressed.js",compressed:"dojo/dojo.js"},":1.7.1":{uncompressed:"dojo/dojo.js.uncompressed.js",compressed:"dojo/dojo.js"},":1.4.3":{uncompressed:"dojo/dojo.xd.js.uncompressed.js",compressed:"dojo/dojo.xd.js"},":1.5.1":{uncompressed:"dojo/dojo.xd.js.uncompressed.js",compressed:"dojo/dojo.xd.js"},":1.5.0":{uncompressed:"dojo/dojo.xd.js.uncompressed.js",compressed:"dojo/dojo.xd.js"},":1.2.0":{uncompressed:"dojo/dojo.xd.js.uncompressed.js",compressed:"dojo/dojo.xd.js"},":1.4.0":{uncompressed:"dojo/dojo.xd.js.uncompressed.js",compressed:"dojo/dojo.xd.js"},":1.4.1":{uncompressed:"dojo/dojo.xd.js.uncompressed.js",compressed:"dojo/dojo.xd.js"}},aliases:{":1.7":"1.7.2",":1":"1.6.1",":1.6":"1.6.1",":1.5":"1.5.1",":1.4":"1.4.3",":1.3":"1.3.2",":1.2":"1.2.3",":1.1":"1.1.1"}},":jquery":{versions:{":1.6.2":{uncompressed:"jquery.js",compressed:"jquery.min.js"},":1.3.1":{uncompressed:"jquery.js",compressed:"jquery.min.js"},":1.6.1":{uncompressed:"jquery.js",compressed:"jquery.min.js"},":1.3.0":{uncompressed:"jquery.js",compressed:"jquery.min.js"},":1.6.4":{uncompressed:"jquery.js",compressed:"jquery.min.js"},":1.6.3":{uncompressed:"jquery.js",compressed:"jquery.min.js"},":1.3.2":{uncompressed:"jquery.js",compressed:"jquery.min.js"},":1.6.0":{uncompressed:"jquery.js",compressed:"jquery.min.js"},":1.2.3":{uncompressed:"jquery.js",compressed:"jquery.min.js"},":1.7.0":{uncompressed:"jquery.js",compressed:"jquery.min.js"},":1.7.1":{uncompressed:"jquery.js",compressed:"jquery.min.js"},":1.2.6":{uncompressed:"jquery.js",compressed:"jquery.min.js"},":1.4.3":{uncompressed:"jquery.js",compressed:"jquery.min.js"},":1.4.4":{uncompressed:"jquery.js",compressed:"jquery.min.js"},":1.5.1":{uncompressed:"jquery.js",compressed:"jquery.min.js"},":1.5.0":{uncompressed:"jquery.js",compressed:"jquery.min.js"},":1.4.0":{uncompressed:"jquery.js",compressed:"jquery.min.js"},":1.5.2":{uncompressed:"jquery.js",compressed:"jquery.min.js"},":1.4.1":{uncompressed:"jquery.js",compressed:"jquery.min.js"},":1.4.2":{uncompressed:"jquery.js",compressed:"jquery.min.js"}},aliases:{":1.7":"1.7.1",":1.6":"1.6.4",":1":"1.7.1",":1.5":"1.5.2",":1.4":"1.4.4",":1.3":"1.3.2",":1.2":"1.2.6"}},":prototype":{versions:{":1.7.0.0":{uncompressed:"prototype.js",compressed:"prototype.js"},":1.6.0.2":{uncompressed:"prototype.js",compressed:"prototype.js"},":1.6.1.0":{uncompressed:"prototype.js",compressed:"prototype.js"},":1.6.0.3":{uncompressed:"prototype.js",compressed:"prototype.js"}},aliases:{":1.7":"1.7.0.0",":1.6.1":"1.6.1.0",":1":"1.7.0.0",":1.6":"1.6.1.0",":1.7.0":"1.7.0.0",":1.6.0":"1.6.0.3"}}})),Smm.loadFont=function(a,b,c){Smm.fonts[a].loaded===!1?(Smm.fonts[a].loaded=!0,WebFont.load({custom:{families:[a],urls:[Smm.fontDirectory+Smm.fonts[a].cssFile]},loading:c,active:b})):b()};var fontscrollerapi;Smm.init=function(){trace("Smm.init"),Smm.fonts=fontData;var a=!1;$j("#font-box").css("position","relative").append('<div id="font-selector-con" > <ul tabindex="1" class="dropdown select-small" id="font-selector"> </div>');var b=$j("#"+Smm.selectorId);$j.each(Smm.fonts,function(c,d){0==a&&(first_font=c,a=!0),$j("head").append("<link>");var e=$j("head").children(":last");e.attr({rel:"stylesheet",type:"text/css",href:Smm.fontDirectory+""+d.cssFile}),b.append('<li font-name="'+c+'"><a class="font-item" font-name="'+c+'" style="font-family:'+c+'">'+c+"</a></li>")}),$j.getScript(Smm.fontDirectory+fontData[first_font].jsFile),$j("#close-selector").click(Smm.hideSelector),$j(".font-item").click(Smm.selectFont),$j("#font_family_dropdown button").unbind("mousedown").bind("mousedown",function(){}),$j(window).mouseup(function(){}),$j("#"+Smm.selectorId).mouseup(function(){})},Smm.showSelector=function(){$j("#"+Smm.selectorId).show(),Smm.visible=!0},Smm.hideSelector=function(){$j("#"+Smm.selectorId).hide(),Smm.visible=!1},Smm.selectFont=function(){var a=$j(this).attr("font-name");$j("#selectedFont").text(a),$j("#selectedFont").css("font-family",a);svgedit.browser.isTouch()&&$j("#font-box").removeClass("active")},DropDown.prototype={initEvents:function(){var a=this;a.dd.on("click",function(){return $j("#font-box").hasClass("disabled")?void 0:($j(this).addClass("active"),svgedit.browser.isTouch()||hideDdOnClick($j("#font-box")),!1)}),a.opts.on("click",function(){var b=$j(this);return a.val=b.text(),a.index=b.index(),a.placeholder.text(a.val),a.placeholder.css("font-family",a.val),!1})},getValue:function(){return this.val},getIndex:function(){return this.index}},nameSmm.loadFont=function(a,b,c){nameSmm.fonts[a].loaded===!1?(nameSmm.fonts[a].loaded=!0,WebFont.load({custom:{families:[a],urls:[nameSmm.fontDirectory+nameSmm.fonts[a].cssFile]},loading:c,active:b})):b()},nameSmm.init=function(){nameSmm.fonts=fontData;var a=!1;$j("#nameFonts").css("position","relative").append('<div id="name-font-selector-con" > <ul tabindex="1" class="dropdown select-small" id="name-font-selector"></div>');var b=$j("#name-font-selector");$j.each(nameSmm.fonts,function(c,d){0==a&&(first_font=c,a=!0),$j("head").append("<link>");var e=$j("head").children(":last");e.attr({rel:"stylesheet",type:"text/css",href:nameSmm.fontDirectory+d.cssFile}),b.append('<li font-name="'+c+'"><a class="name-font-item" font-name="'+c+'" style="font-family:'+c+'">'+c+"</a></li>")}),$j.getScript(nameSmm.fontDirectory+fontData[first_font].jsFile),$j("#close-selector").click(nameSmm.hideSelector),$j(".name-font-item").click(nameSmm.selectFont),$j("#font_family_dropdown button").unbind("mousedown").bind("mousedown",function(){}),$j(window).mouseup(function(){}),$j("#"+nameSmm.selectorId).mouseup(function(){})},nameSmm.showSelector=function(){$j("#"+nameSmm.selectorId).show(),nameSmm.visible=!0},nameSmm.hideSelector=function(){$j("#"+nameSmm.selectorId).hide(),nameSmm.visible=!1},nameSmm.selectFont=function(){var a=$j(this).attr("font-name");$j("#selectedNameFont").text(a),$j("#selectedNameFont").css("font-family",a);svgedit.browser.isTouch()&&$j("#font-box").removeClass("active")},numberSmm.loadFont=function(a,b,c){numberSmm.fonts[a].loaded===!1?(numberSmm.fonts[a].loaded=!0,WebFont.load({custom:{families:[a],urls:[numberSmm.fontDirectory+numberSmm.fonts[a].cssFile]},loading:c,active:b})):b()},numberSmm.init=function(){numberSmm.fonts=fontData;var a=!1;$j("#numberFonts").css("position","relative").append('<div id="number-font-selector-con" > <ul tabindex="1" class="dropdown select-small" id="number-font-selector"></div>');var b=$j("#number-font-selector");$j.each(numberSmm.fonts,function(c){0==a&&(first_font=c,a=!0),$j("head").append("<link>"),b.append('<li font-name="'+c+'"><a class="number-font-item" font-name="'+c+'" style="font-family:'+c+'">'+c+"</a></li>")}),$j.getScript(numberSmm.fontDirectory+fontData[first_font].jsFile),$j("#close-selector").click(numberSmm.hideSelector),$j(".number-font-item").click(numberSmm.selectFont),$j("#font_family_dropdown button").unbind("mousedown").bind("mousedown",function(){}),$j(window).mouseup(function(){}),$j("#"+numberSmm.selectorId).mouseup(function(){})},numberSmm.showSelector=function(){$j("#"+numberSmm.selectorId).show(),numberSmm.visible=!0},numberSmm.hideSelector=function(){$j("#"+numberSmm.selectorId).hide(),numberSmm.visible=!1},numberSmm.selectFont=function(){var a=$j(this).attr("font-name");$j("#selectedNumberFont").text(a),$j("#selectedNumberFont").css("font-family",a);svgedit.browser.isTouch()&&$j("#font-box").removeClass("active")},function(a){var b,c,d="0.4.2",e="hasOwnProperty",f=/[\.\/]/,g="*",h=function(){},i=function(a,b){return a-b},j={n:{}},k=function(a,d){a=String(a);var e,f=c,g=Array.prototype.slice.call(arguments,2),h=k.listeners(a),j=0,l=[],m={},n=[],o=b;b=a,c=0;for(var p=0,q=h.length;q>p;p++)"zIndex"in h[p]&&(l.push(h[p].zIndex),h[p].zIndex<0&&(m[h[p].zIndex]=h[p]));for(l.sort(i);l[j]<0;)if(e=m[l[j++]],n.push(e.apply(d,g)),c)return c=f,n;for(p=0;q>p;p++)if(e=h[p],"zIndex"in e)if(e.zIndex==l[j]){if(n.push(e.apply(d,g)),c)break;do if(j++,e=m[l[j]],e&&n.push(e.apply(d,g)),c)break;while(e)}else m[e.zIndex]=e;else if(n.push(e.apply(d,g)),c)break;return c=f,b=o,n.length?n:null};k._events=j,k.listeners=function(a){var b,c,d,e,h,i,k,l,m=a.split(f),n=j,o=[n],p=[];for(e=0,h=m.length;h>e;e++){for(l=[],i=0,k=o.length;k>i;i++)for(n=o[i].n,c=[n[m[e]],n[g]],d=2;d--;)b=c[d],b&&(l.push(b),p=p.concat(b.f||[]));o=l}return p},k.on=function(a,b){if(a=String(a),"function"!=typeof b)return function(){};for(var c=a.split(f),d=j,e=0,g=c.length;g>e;e++)d=d.n,d=d.hasOwnProperty(c[e])&&d[c[e]]||(d[c[e]]={n:{}});for(d.f=d.f||[],e=0,g=d.f.length;g>e;e++)if(d.f[e]==b)return h;return d.f.push(b),function(a){+a==+a&&(b.zIndex=+a)}},k.f=function(a){var b=[].slice.call(arguments,1);return function(){k.apply(null,[a,null].concat(b).concat([].slice.call(arguments,0)))}},k.stop=function(){c=1},k.nt=function(a){return a?new RegExp("(?:\\.|\\/|^)"+a+"(?:\\.|\\/|$)").test(b):b},k.nts=function(){return b.split(f)},k.off=k.unbind=function(a,b){if(!a)return void(k._events=j={n:{}});var c,d,h,i,l,m,n,o=a.split(f),p=[j];for(i=0,l=o.length;l>i;i++)for(m=0;m<p.length;m+=h.length-2){if(h=[m,1],c=p[m].n,o[i]!=g)c[o[i]]&&h.push(c[o[i]]);else for(d in c)c[e](d)&&h.push(c[d]);p.splice.apply(p,h)}for(i=0,l=p.length;l>i;i++)for(c=p[i];c.n;){if(b){if(c.f){for(m=0,n=c.f.length;n>m;m++)if(c.f[m]==b){c.f.splice(m,1);break}!c.f.length&&delete c.f}for(d in c.n)if(c.n[e](d)&&c.n[d].f){var q=c.n[d].f;for(m=0,n=q.length;n>m;m++)if(q[m]==b){q.splice(m,1);
break}!q.length&&delete c.n[d].f}}else{delete c.f;for(d in c.n)c.n[e](d)&&c.n[d].f&&delete c.n[d].f}c=c.n}},k.once=function(a,b){var c=function(){return k.unbind(a,c),b.apply(this,arguments)};return k.on(a,c)},k.version=d,k.toString=function(){return"You are running Eve "+d},"undefined"!=typeof module&&module.exports?module.exports=k:"undefined"!=typeof define?define("eve",[],function(){return k}):a.eve=k}(window||this),function(a,b){"function"==typeof define&&define.amd?define(["eve"],function(c){return b(a,c)}):b(a,a.eve)}(this,function(a,b){function c(a){if(c.is(a,"function"))return u?a():b.on("raphael.DOMload",a);if(c.is(a,V))return c._engine.create[D](c,a.splice(0,3+c.is(a[0],T))).add(a);var d=Array.prototype.slice.call(arguments,0);if(c.is(d[d.length-1],"function")){var e=d.pop();return u?e.call(c._engine.create[D](c,d)):b.on("raphael.DOMload",function(){e.call(c._engine.create[D](c,d))})}return c._engine.create[D](c,arguments)}function d(a){if("function"==typeof a||Object(a)!==a)return a;var b=new a.constructor;for(var c in a)a[z](c)&&(b[c]=d(a[c]));return b}function e(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return a.push(a.splice(c,1)[0])}function f(a,b,c){function d(){var f=Array.prototype.slice.call(arguments,0),g=f.join("␀"),h=d.cache=d.cache||{},i=d.count=d.count||[];return h[z](g)?(e(i,g),c?c(h[g]):h[g]):(i.length>=1e3&&delete h[i.shift()],i.push(g),h[g]=a[D](b,f),c?c(h[g]):h[g])}return d}function g(){return this.hex}function h(a,b){for(var c=[],d=0,e=a.length;e-2*!b>d;d+=2){var f=[{x:+a[d-2],y:+a[d-1]},{x:+a[d],y:+a[d+1]},{x:+a[d+2],y:+a[d+3]},{x:+a[d+4],y:+a[d+5]}];b?d?e-4==d?f[3]={x:+a[0],y:+a[1]}:e-2==d&&(f[2]={x:+a[0],y:+a[1]},f[3]={x:+a[2],y:+a[3]}):f[0]={x:+a[e-2],y:+a[e-1]}:e-4==d?f[3]=f[2]:d||(f[0]={x:+a[d],y:+a[d+1]}),c.push(["C",(-f[0].x+6*f[1].x+f[2].x)/6,(-f[0].y+6*f[1].y+f[2].y)/6,(f[1].x+6*f[2].x-f[3].x)/6,(f[1].y+6*f[2].y-f[3].y)/6,f[2].x,f[2].y])}return c}function i(a,b,c,d,e){var f=-3*b+9*c-9*d+3*e,g=a*f+6*b-12*c+6*d;return a*g-3*b+3*c}function j(a,b,c,d,e,f,g,h,j){null==j&&(j=1),j=j>1?1:0>j?0:j;for(var k=j/2,l=12,m=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],n=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],o=0,p=0;l>p;p++){var q=k*m[p]+k,r=i(q,a,c,e,g),s=i(q,b,d,f,h),t=r*r+s*s;o+=n[p]*N.sqrt(t)}return k*o}function k(a,b,c,d,e,f,g,h,i){if(!(0>i||j(a,b,c,d,e,f,g,h)<i)){var k,l=1,m=l/2,n=l-m,o=.01;for(k=j(a,b,c,d,e,f,g,h,n);Q(k-i)>o;)m/=2,n+=(i>k?1:-1)*m,k=j(a,b,c,d,e,f,g,h,n);return n}}function l(a,b,c,d,e,f,g,h){if(!(O(a,c)<P(e,g)||P(a,c)>O(e,g)||O(b,d)<P(f,h)||P(b,d)>O(f,h))){var i=(a*d-b*c)*(e-g)-(a-c)*(e*h-f*g),j=(a*d-b*c)*(f-h)-(b-d)*(e*h-f*g),k=(a-c)*(f-h)-(b-d)*(e-g);if(k){var l=i/k,m=j/k,n=+l.toFixed(2),o=+m.toFixed(2);if(!(n<+P(a,c).toFixed(2)||n>+O(a,c).toFixed(2)||n<+P(e,g).toFixed(2)||n>+O(e,g).toFixed(2)||o<+P(b,d).toFixed(2)||o>+O(b,d).toFixed(2)||o<+P(f,h).toFixed(2)||o>+O(f,h).toFixed(2)))return{x:l,y:m}}}}function m(a,b,d){var e=c.bezierBBox(a),f=c.bezierBBox(b);if(!c.isBBoxIntersect(e,f))return d?0:[];for(var g=j.apply(0,a),h=j.apply(0,b),i=O(~~(g/5),1),k=O(~~(h/5),1),m=[],n=[],o={},p=d?0:[],q=0;i+1>q;q++){var r=c.findDotsAtSegment.apply(c,a.concat(q/i));m.push({x:r.x,y:r.y,t:q/i})}for(q=0;k+1>q;q++)r=c.findDotsAtSegment.apply(c,b.concat(q/k)),n.push({x:r.x,y:r.y,t:q/k});for(q=0;i>q;q++)for(var s=0;k>s;s++){var t=m[q],u=m[q+1],v=n[s],w=n[s+1],x=Q(u.x-t.x)<.001?"y":"x",y=Q(w.x-v.x)<.001?"y":"x",z=l(t.x,t.y,u.x,u.y,v.x,v.y,w.x,w.y);if(z){if(o[z.x.toFixed(4)]==z.y.toFixed(4))continue;o[z.x.toFixed(4)]=z.y.toFixed(4);var A=t.t+Q((z[x]-t[x])/(u[x]-t[x]))*(u.t-t.t),B=v.t+Q((z[y]-v[y])/(w[y]-v[y]))*(w.t-v.t);A>=0&&1.001>=A&&B>=0&&1.001>=B&&(d?p++:p.push({x:z.x,y:z.y,t1:P(A,1),t2:P(B,1)}))}}return p}function n(a,b,d){a=c._path2curve(a),b=c._path2curve(b);for(var e,f,g,h,i,j,k,l,n,o,p=d?0:[],q=0,r=a.length;r>q;q++){var s=a[q];if("M"==s[0])e=i=s[1],f=j=s[2];else{"C"==s[0]?(n=[e,f].concat(s.slice(1)),e=n[6],f=n[7]):(n=[e,f,e,f,i,j,i,j],e=i,f=j);for(var t=0,u=b.length;u>t;t++){var v=b[t];if("M"==v[0])g=k=v[1],h=l=v[2];else{"C"==v[0]?(o=[g,h].concat(v.slice(1)),g=o[6],h=o[7]):(o=[g,h,g,h,k,l,k,l],g=k,h=l);var w=m(n,o,d);if(d)p+=w;else{for(var x=0,y=w.length;y>x;x++)w[x].segment1=q,w[x].segment2=t,w[x].bez1=n,w[x].bez2=o;p=p.concat(w)}}}}}return p}function o(a,b,c,d,e,f){null!=a?(this.a=+a,this.b=+b,this.c=+c,this.d=+d,this.e=+e,this.f=+f):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0)}function p(){return this.x+H+this.y+H+this.width+" × "+this.height}function q(a,b,c,d,e,f){function g(a){return((l*a+k)*a+j)*a}function h(a,b){var c=i(a,b);return((o*c+n)*c+m)*c}function i(a,b){var c,d,e,f,h,i;for(e=a,i=0;8>i;i++){if(f=g(e)-a,Q(f)<b)return e;if(h=(3*l*e+2*k)*e+j,Q(h)<1e-6)break;e-=f/h}if(c=0,d=1,e=a,c>e)return c;if(e>d)return d;for(;d>c;){if(f=g(e),Q(f-a)<b)return e;a>f?c=e:d=e,e=(d-c)/2+c}return e}var j=3*b,k=3*(d-b)-j,l=1-j-k,m=3*c,n=3*(e-c)-m,o=1-m-n;return h(a,1/(200*f))}function r(a,b){var c=[],d={};if(this.ms=b,this.times=1,a){for(var e in a)a[z](e)&&(d[_(e)]=a[e],c.push(_(e)));c.sort(lb)}this.anim=d,this.top=c[c.length-1],this.percents=c}function s(a,d,e,f,g,h){e=_(e);var i,j,k,l,m,n,p=a.ms,r={},s={},t={};if(f)for(v=0,x=ic.length;x>v;v++){var u=ic[v];if(u.el.id==d.id&&u.anim==a){u.percent!=e?(ic.splice(v,1),k=1):j=u,d.attr(u.totalOrigin);break}}else f=+s;for(var v=0,x=a.percents.length;x>v;v++){if(a.percents[v]==e||a.percents[v]>f*a.top){e=a.percents[v],m=a.percents[v-1]||0,p=p/a.top*(e-m),l=a.percents[v+1],i=a.anim[e];break}f&&d.attr(a.anim[a.percents[v]])}if(i){if(j)j.initstatus=f,j.start=new Date-j.ms*f;else{for(var y in i)if(i[z](y)&&(db[z](y)||d.paper.customAttributes[z](y)))switch(r[y]=d.attr(y),null==r[y]&&(r[y]=cb[y]),s[y]=i[y],db[y]){case T:t[y]=(s[y]-r[y])/p;break;case"colour":r[y]=c.getRGB(r[y]);var A=c.getRGB(s[y]);t[y]={r:(A.r-r[y].r)/p,g:(A.g-r[y].g)/p,b:(A.b-r[y].b)/p};break;case"path":var B=Kb(r[y],s[y]),C=B[1];for(r[y]=B[0],t[y]=[],v=0,x=r[y].length;x>v;v++){t[y][v]=[0];for(var D=1,F=r[y][v].length;F>D;D++)t[y][v][D]=(C[v][D]-r[y][v][D])/p}break;case"transform":var G=d._,H=Pb(G[y],s[y]);if(H)for(r[y]=H.from,s[y]=H.to,t[y]=[],t[y].real=!0,v=0,x=r[y].length;x>v;v++)for(t[y][v]=[r[y][v][0]],D=1,F=r[y][v].length;F>D;D++)t[y][v][D]=(s[y][v][D]-r[y][v][D])/p;else{var K=d.matrix||new o,L={_:{transform:G.transform},getBBox:function(){return d.getBBox(1)}};r[y]=[K.a,K.b,K.c,K.d,K.e,K.f],Nb(L,s[y]),s[y]=L._.transform,t[y]=[(L.matrix.a-K.a)/p,(L.matrix.b-K.b)/p,(L.matrix.c-K.c)/p,(L.matrix.d-K.d)/p,(L.matrix.e-K.e)/p,(L.matrix.f-K.f)/p]}break;case"csv":var M=I(i[y])[J](w),N=I(r[y])[J](w);if("clip-rect"==y)for(r[y]=N,t[y]=[],v=N.length;v--;)t[y][v]=(M[v]-r[y][v])/p;s[y]=M;break;default:for(M=[][E](i[y]),N=[][E](r[y]),t[y]=[],v=d.paper.customAttributes[y].length;v--;)t[y][v]=((M[v]||0)-(N[v]||0))/p}var O=i.easing,P=c.easing_formulas[O];if(!P)if(P=I(O).match(Z),P&&5==P.length){var Q=P;P=function(a){return q(a,+Q[1],+Q[2],+Q[3],+Q[4],p)}}else P=nb;if(n=i.start||a.start||+new Date,u={anim:a,percent:e,timestamp:n,start:n+(a.del||0),status:0,initstatus:f||0,stop:!1,ms:p,easing:P,from:r,diff:t,to:s,el:d,callback:i.callback,prev:m,next:l,repeat:h||a.times,origin:d.attr(),totalOrigin:g},ic.push(u),f&&!j&&!k&&(u.stop=!0,u.start=new Date-p*f,1==ic.length))return kc();k&&(u.start=new Date-u.ms*f),1==ic.length&&jc(kc)}b("raphael.anim.start."+d.id,d,a)}}function t(a){for(var b=0;b<ic.length;b++)ic[b].el.paper==a&&ic.splice(b--,1)}c.version="2.1.2",c.eve=b;var u,v,w=/[, ]+/,x={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},y=/\{(\d+)\}/g,z="hasOwnProperty",A={doc:document,win:a},B={was:Object.prototype[z].call(A.win,"Raphael"),is:A.win.Raphael},C=function(){this.ca=this.customAttributes={}},D="apply",E="concat",F="ontouchstart"in A.win||A.win.DocumentTouch&&A.doc instanceof DocumentTouch,G="",H=" ",I=String,J="split",K="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[J](H),L={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},M=I.prototype.toLowerCase,N=Math,O=N.max,P=N.min,Q=N.abs,R=N.pow,S=N.PI,T="number",U="string",V="array",W=Object.prototype.toString,X=(c._ISURL=/^url\(['"]?([^\)]+?)['"]?\)$/i,/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i),Y={NaN:1,Infinity:1,"-Infinity":1},Z=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,$=N.round,_=parseFloat,ab=parseInt,bb=I.prototype.toUpperCase,cb=c._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,right:0,x:0,y:0},db=c._availableAnimAttrs={blur:T,"clip-rect":"csv",cx:T,cy:T,fill:"colour","fill-opacity":T,"font-size":T,height:T,opacity:T,path:"path",r:T,rx:T,ry:T,stroke:"colour","stroke-opacity":T,"stroke-width":T,transform:"transform",width:T,x:T,y:T},eb=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,fb={hs:1,rg:1},gb=/,?([achlmqrstvxz]),?/gi,hb=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,ib=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,jb=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/gi,kb=(c._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,{}),lb=function(a,b){return _(a)-_(b)},mb=function(){},nb=function(a){return a},ob=c._rectPath=function(a,b,c,d,e){return e?[["M",a+e,b],["l",c-2*e,0],["a",e,e,0,0,1,e,e],["l",0,d-2*e],["a",e,e,0,0,1,-e,e],["l",2*e-c,0],["a",e,e,0,0,1,-e,-e],["l",0,2*e-d],["a",e,e,0,0,1,e,-e],["z"]]:[["M",a,b],["l",c,0],["l",0,d],["l",-c,0],["z"]]},pb=function(a,b,c,d){return null==d&&(d=c),[["M",a,b],["m",0,-d],["a",c,d,0,1,1,0,2*d],["a",c,d,0,1,1,0,-2*d],["z"]]},qb=c._getPath={path:function(a){return a.attr("path")},circle:function(a){var b=a.attrs;return pb(b.cx,b.cy,b.r)},ellipse:function(a){var b=a.attrs;return pb(b.cx,b.cy,b.rx,b.ry)},rect:function(a){var b=a.attrs;return ob(b.x,b.y,b.width,b.height,b.r)},image:function(a){var b=a.attrs;return ob(b.x,b.y,b.width,b.height)},text:function(a){var b=a._getBBox();return ob(b.x,b.y,b.width,b.height)},set:function(a){var b=a._getBBox();return ob(b.x,b.y,b.width,b.height)}},rb=c.mapPath=function(a,b){if(!b)return a;var c,d,e,f,g,h,i;for(a=Kb(a),e=0,g=a.length;g>e;e++)for(i=a[e],f=1,h=i.length;h>f;f+=2)c=b.x(i[f],i[f+1]),d=b.y(i[f],i[f+1]),i[f]=c,i[f+1]=d;return a};if(c._g=A,c.type=A.win.SVGAngle||A.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML","VML"==c.type){var sb,tb=A.doc.createElement("div");if(tb.innerHTML='<v:shape adj="1"/>',sb=tb.firstChild,sb.style.behavior="url(#default#VML)",!sb||"object"!=typeof sb.adj)return c.type=G;tb=null}c.svg=!(c.vml="VML"==c.type),c._Paper=C,c.fn=v=C.prototype=c.prototype,c._id=0,c._oid=0,c.is=function(a,b){return b=M.call(b),"finite"==b?!Y[z](+a):"array"==b?a instanceof Array:"null"==b&&null===a||b==typeof a&&null!==a||"object"==b&&a===Object(a)||"array"==b&&Array.isArray&&Array.isArray(a)||W.call(a).slice(8,-1).toLowerCase()==b},c.angle=function(a,b,d,e,f,g){if(null==f){var h=a-d,i=b-e;return h||i?(180+180*N.atan2(-i,-h)/S+360)%360:0}return c.angle(a,b,f,g)-c.angle(d,e,f,g)},c.rad=function(a){return a%360*S/180},c.deg=function(a){return 180*a/S%360},c.snapTo=function(a,b,d){if(d=c.is(d,"finite")?d:10,c.is(a,V)){for(var e=a.length;e--;)if(Q(a[e]-b)<=d)return a[e]}else{a=+a;var f=b%a;if(d>f)return b-f;if(f>a-d)return b-f+a}return b};c.createUUID=function(a,b){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(a,b).toUpperCase()}}(/[xy]/g,function(a){var b=16*N.random()|0,c="x"==a?b:3&b|8;return c.toString(16)});c.setWindow=function(a){b("raphael.setWindow",c,A.win,a),A.win=a,A.doc=A.win.document,c._engine.initWin&&c._engine.initWin(A.win)};var ub=function(a){if(c.vml){var b,d=/^\s+|\s+$/g;try{var e=new ActiveXObject("htmlfile");e.write("<body>"),e.close(),b=e.body}catch(g){b=createPopup().document.body}var h=b.createTextRange();ub=f(function(a){try{b.style.color=I(a).replace(d,G);var c=h.queryCommandValue("ForeColor");return c=(255&c)<<16|65280&c|(16711680&c)>>>16,"#"+("000000"+c.toString(16)).slice(-6)}catch(e){return"none"}})}else{var i=A.doc.createElement("i");i.title="Raphaël Colour Picker",i.style.display="none",A.doc.body.appendChild(i),ub=f(function(a){return i.style.color=a,A.doc.defaultView.getComputedStyle(i,G).getPropertyValue("color")})}return ub(a)},vb=function(){return"hsb("+[this.h,this.s,this.b]+")"},wb=function(){return"hsl("+[this.h,this.s,this.l]+")"},xb=function(){return this.hex},yb=function(a,b,d){if(null==b&&c.is(a,"object")&&"r"in a&&"g"in a&&"b"in a&&(d=a.b,b=a.g,a=a.r),null==b&&c.is(a,U)){var e=c.getRGB(a);a=e.r,b=e.g,d=e.b}return(a>1||b>1||d>1)&&(a/=255,b/=255,d/=255),[a,b,d]},zb=function(a,b,d,e){a*=255,b*=255,d*=255;var f={r:a,g:b,b:d,hex:c.rgb(a,b,d),toString:xb};return c.is(e,"finite")&&(f.opacity=e),f};c.color=function(a){var b;return c.is(a,"object")&&"h"in a&&"s"in a&&"b"in a?(b=c.hsb2rgb(a),a.r=b.r,a.g=b.g,a.b=b.b,a.hex=b.hex):c.is(a,"object")&&"h"in a&&"s"in a&&"l"in a?(b=c.hsl2rgb(a),a.r=b.r,a.g=b.g,a.b=b.b,a.hex=b.hex):(c.is(a,"string")&&(a=c.getRGB(a)),c.is(a,"object")&&"r"in a&&"g"in a&&"b"in a?(b=c.rgb2hsl(a),a.h=b.h,a.s=b.s,a.l=b.l,b=c.rgb2hsb(a),a.v=b.b):(a={hex:"none"},a.r=a.g=a.b=a.h=a.s=a.v=a.l=-1)),a.toString=xb,a},c.hsb2rgb=function(a,b,c,d){this.is(a,"object")&&"h"in a&&"s"in a&&"b"in a&&(c=a.b,b=a.s,a=a.h,d=a.o),a*=360;var e,f,g,h,i;return a=a%360/60,i=c*b,h=i*(1-Q(a%2-1)),e=f=g=c-i,a=~~a,e+=[i,h,0,0,h,i][a],f+=[h,i,i,h,0,0][a],g+=[0,0,h,i,i,h][a],zb(e,f,g,d)},c.hsl2rgb=function(a,b,c,d){this.is(a,"object")&&"h"in a&&"s"in a&&"l"in a&&(c=a.l,b=a.s,a=a.h),(a>1||b>1||c>1)&&(a/=360,b/=100,c/=100),a*=360;var e,f,g,h,i;return a=a%360/60,i=2*b*(.5>c?c:1-c),h=i*(1-Q(a%2-1)),e=f=g=c-i/2,a=~~a,e+=[i,h,0,0,h,i][a],f+=[h,i,i,h,0,0][a],g+=[0,0,h,i,i,h][a],zb(e,f,g,d)},c.rgb2hsb=function(a,b,c){c=yb(a,b,c),a=c[0],b=c[1],c=c[2];var d,e,f,g;return f=O(a,b,c),g=f-P(a,b,c),d=0==g?null:f==a?(b-c)/g:f==b?(c-a)/g+2:(a-b)/g+4,d=(d+360)%6*60/360,e=0==g?0:g/f,{h:d,s:e,b:f,toString:vb}},c.rgb2hsl=function(a,b,c){c=yb(a,b,c),a=c[0],b=c[1],c=c[2];var d,e,f,g,h,i;return g=O(a,b,c),h=P(a,b,c),i=g-h,d=0==i?null:g==a?(b-c)/i:g==b?(c-a)/i+2:(a-b)/i+4,d=(d+360)%6*60/360,f=(g+h)/2,e=0==i?0:.5>f?i/(2*f):i/(2-2*f),{h:d,s:e,l:f,toString:wb}},c._path2string=function(){return this.join(",").replace(gb,"$1")};c._preload=function(a,b){var c=A.doc.createElement("img");c.style.cssText="position:absolute;left:-9999em;top:-9999em",c.onload=function(){b.call(this),this.onload=null,A.doc.body.removeChild(this)},c.onerror=function(){A.doc.body.removeChild(this)},A.doc.body.appendChild(c),c.src=a};c.getRGB=f(function(a){if(!a||(a=I(a)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:g};if("none"==a)return{r:-1,g:-1,b:-1,hex:"none",toString:g};!(fb[z](a.toLowerCase().substring(0,2))||"#"==a.charAt())&&(a=ub(a));var b,d,e,f,h,i,j=a.match(X);return j?(j[2]&&(e=ab(j[2].substring(5),16),d=ab(j[2].substring(3,5),16),b=ab(j[2].substring(1,3),16)),j[3]&&(e=ab((h=j[3].charAt(3))+h,16),d=ab((h=j[3].charAt(2))+h,16),b=ab((h=j[3].charAt(1))+h,16)),j[4]&&(i=j[4][J](eb),b=_(i[0]),"%"==i[0].slice(-1)&&(b*=2.55),d=_(i[1]),"%"==i[1].slice(-1)&&(d*=2.55),e=_(i[2]),"%"==i[2].slice(-1)&&(e*=2.55),"rgba"==j[1].toLowerCase().slice(0,4)&&(f=_(i[3])),i[3]&&"%"==i[3].slice(-1)&&(f/=100)),j[5]?(i=j[5][J](eb),b=_(i[0]),"%"==i[0].slice(-1)&&(b*=2.55),d=_(i[1]),"%"==i[1].slice(-1)&&(d*=2.55),e=_(i[2]),"%"==i[2].slice(-1)&&(e*=2.55),("deg"==i[0].slice(-3)||"°"==i[0].slice(-1))&&(b/=360),"hsba"==j[1].toLowerCase().slice(0,4)&&(f=_(i[3])),i[3]&&"%"==i[3].slice(-1)&&(f/=100),c.hsb2rgb(b,d,e,f)):j[6]?(i=j[6][J](eb),b=_(i[0]),"%"==i[0].slice(-1)&&(b*=2.55),d=_(i[1]),"%"==i[1].slice(-1)&&(d*=2.55),e=_(i[2]),"%"==i[2].slice(-1)&&(e*=2.55),("deg"==i[0].slice(-3)||"°"==i[0].slice(-1))&&(b/=360),"hsla"==j[1].toLowerCase().slice(0,4)&&(f=_(i[3])),i[3]&&"%"==i[3].slice(-1)&&(f/=100),c.hsl2rgb(b,d,e,f)):(j={r:b,g:d,b:e,toString:g},j.hex="#"+(16777216|e|d<<8|b<<16).toString(16).slice(1),c.is(f,"finite")&&(j.opacity=f),j)):{r:-1,g:-1,b:-1,hex:"none",error:1,toString:g}},c),c.hsb=f(function(a,b,d){return c.hsb2rgb(a,b,d).hex}),c.hsl=f(function(a,b,d){return c.hsl2rgb(a,b,d).hex}),c.rgb=f(function(a,b,c){return"#"+(16777216|c|b<<8|a<<16).toString(16).slice(1)}),c.getColor=function(a){var b=this.getColor.start=this.getColor.start||{h:0,s:1,b:a||.75},c=this.hsb2rgb(b.h,b.s,b.b);return b.h+=.075,b.h>1&&(b.h=0,b.s-=.2,b.s<=0&&(this.getColor.start={h:0,s:1,b:b.b})),c.hex},c.getColor.reset=function(){delete this.start},c.parsePathString=function(a){if(!a)return null;var b=Ab(a);if(b.arr)return Cb(b.arr);var d={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},e=[];return c.is(a,V)&&c.is(a[0],V)&&(e=Cb(a)),e.length||I(a).replace(hb,function(a,b,c){var f=[],g=b.toLowerCase();if(c.replace(jb,function(a,b){b&&f.push(+b)}),"m"==g&&f.length>2&&(e.push([b][E](f.splice(0,2))),g="l",b="m"==b?"l":"L"),"r"==g)e.push([b][E](f));else for(;f.length>=d[g]&&(e.push([b][E](f.splice(0,d[g]))),d[g]););}),e.toString=c._path2string,b.arr=Cb(e),e},c.parseTransformString=f(function(a){if(!a)return null;var b=[];return c.is(a,V)&&c.is(a[0],V)&&(b=Cb(a)),b.length||I(a).replace(ib,function(a,c,d){{var e=[];M.call(c)}d.replace(jb,function(a,b){b&&e.push(+b)}),b.push([c][E](e))}),b.toString=c._path2string,b});var Ab=function(a){var b=Ab.ps=Ab.ps||{};return b[a]?b[a].sleep=100:b[a]={sleep:100},setTimeout(function(){for(var c in b)b[z](c)&&c!=a&&(b[c].sleep--,!b[c].sleep&&delete b[c])}),b[a]};c.findDotsAtSegment=function(a,b,c,d,e,f,g,h,i){var j=1-i,k=R(j,3),l=R(j,2),m=i*i,n=m*i,o=k*a+3*l*i*c+3*j*i*i*e+n*g,p=k*b+3*l*i*d+3*j*i*i*f+n*h,q=a+2*i*(c-a)+m*(e-2*c+a),r=b+2*i*(d-b)+m*(f-2*d+b),s=c+2*i*(e-c)+m*(g-2*e+c),t=d+2*i*(f-d)+m*(h-2*f+d),u=j*a+i*c,v=j*b+i*d,w=j*e+i*g,x=j*f+i*h,y=90-180*N.atan2(q-s,r-t)/S;return(q>s||t>r)&&(y+=180),{x:o,y:p,m:{x:q,y:r},n:{x:s,y:t},start:{x:u,y:v},end:{x:w,y:x},alpha:y}},c.bezierBBox=function(a,b,d,e,f,g,h,i){c.is(a,"array")||(a=[a,b,d,e,f,g,h,i]);var j=Jb.apply(null,a);return{x:j.min.x,y:j.min.y,x2:j.max.x,y2:j.max.y,width:j.max.x-j.min.x,height:j.max.y-j.min.y}},c.isPointInsideBBox=function(a,b,c){return b>=a.x&&b<=a.x2&&c>=a.y&&c<=a.y2},c.isBBoxIntersect=function(a,b){var d=c.isPointInsideBBox;return d(b,a.x,a.y)||d(b,a.x2,a.y)||d(b,a.x,a.y2)||d(b,a.x2,a.y2)||d(a,b.x,b.y)||d(a,b.x2,b.y)||d(a,b.x,b.y2)||d(a,b.x2,b.y2)||(a.x<b.x2&&a.x>b.x||b.x<a.x2&&b.x>a.x)&&(a.y<b.y2&&a.y>b.y||b.y<a.y2&&b.y>a.y)},c.pathIntersection=function(a,b){return n(a,b)},c.pathIntersectionNumber=function(a,b){return n(a,b,1)},c.isPointInsidePath=function(a,b,d){var e=c.pathBBox(a);return c.isPointInsideBBox(e,b,d)&&n(a,[["M",b,d],["H",e.x2+10]],1)%2==1},c._removedFactory=function(a){return function(){b("raphael.log",null,"Raphaël: you are calling to method “"+a+"” of removed object",a)}};var Bb=c.pathBBox=function(a){var b=Ab(a);if(b.bbox)return d(b.bbox);if(!a)return{x:0,y:0,width:0,height:0,x2:0,y2:0};a=Kb(a);for(var c,e=0,f=0,g=[],h=[],i=0,j=a.length;j>i;i++)if(c=a[i],"M"==c[0])e=c[1],f=c[2],g.push(e),h.push(f);else{var k=Jb(e,f,c[1],c[2],c[3],c[4],c[5],c[6]);g=g[E](k.min.x,k.max.x),h=h[E](k.min.y,k.max.y),e=c[5],f=c[6]}var l=P[D](0,g),m=P[D](0,h),n=O[D](0,g),o=O[D](0,h),p=n-l,q=o-m,r={x:l,y:m,x2:n,y2:o,width:p,height:q,cx:l+p/2,cy:m+q/2};return b.bbox=d(r),r},Cb=function(a){var b=d(a);return b.toString=c._path2string,b},Db=c._pathToRelative=function(a){var b=Ab(a);if(b.rel)return Cb(b.rel);c.is(a,V)&&c.is(a&&a[0],V)||(a=c.parsePathString(a));var d=[],e=0,f=0,g=0,h=0,i=0;"M"==a[0][0]&&(e=a[0][1],f=a[0][2],g=e,h=f,i++,d.push(["M",e,f]));for(var j=i,k=a.length;k>j;j++){var l=d[j]=[],m=a[j];if(m[0]!=M.call(m[0]))switch(l[0]=M.call(m[0]),l[0]){case"a":l[1]=m[1],l[2]=m[2],l[3]=m[3],l[4]=m[4],l[5]=m[5],l[6]=+(m[6]-e).toFixed(3),l[7]=+(m[7]-f).toFixed(3);break;case"v":l[1]=+(m[1]-f).toFixed(3);break;case"m":g=m[1],h=m[2];default:for(var n=1,o=m.length;o>n;n++)l[n]=+(m[n]-(n%2?e:f)).toFixed(3)}else{l=d[j]=[],"m"==m[0]&&(g=m[1]+e,h=m[2]+f);for(var p=0,q=m.length;q>p;p++)d[j][p]=m[p]}var r=d[j].length;switch(d[j][0]){case"z":e=g,f=h;break;case"h":e+=+d[j][r-1];break;case"v":f+=+d[j][r-1];break;default:e+=+d[j][r-2],f+=+d[j][r-1]}}return d.toString=c._path2string,b.rel=Cb(d),d},Eb=c._pathToAbsolute=function(a){var b=Ab(a);if(b.abs)return Cb(b.abs);if(c.is(a,V)&&c.is(a&&a[0],V)||(a=c.parsePathString(a)),!a||!a.length)return[["M",0,0]];var d=[],e=0,f=0,g=0,i=0,j=0;"M"==a[0][0]&&(e=+a[0][1],f=+a[0][2],g=e,i=f,j++,d[0]=["M",e,f]);for(var k,l,m=3==a.length&&"M"==a[0][0]&&"R"==a[1][0].toUpperCase()&&"Z"==a[2][0].toUpperCase(),n=j,o=a.length;o>n;n++){if(d.push(k=[]),l=a[n],l[0]!=bb.call(l[0]))switch(k[0]=bb.call(l[0]),k[0]){case"A":k[1]=l[1],k[2]=l[2],k[3]=l[3],k[4]=l[4],k[5]=l[5],k[6]=+(l[6]+e),k[7]=+(l[7]+f);break;case"V":k[1]=+l[1]+f;break;case"H":k[1]=+l[1]+e;break;case"R":for(var p=[e,f][E](l.slice(1)),q=2,r=p.length;r>q;q++)p[q]=+p[q]+e,p[++q]=+p[q]+f;d.pop(),d=d[E](h(p,m));break;case"M":g=+l[1]+e,i=+l[2]+f;default:for(q=1,r=l.length;r>q;q++)k[q]=+l[q]+(q%2?e:f)}else if("R"==l[0])p=[e,f][E](l.slice(1)),d.pop(),d=d[E](h(p,m)),k=["R"][E](l.slice(-2));else for(var s=0,t=l.length;t>s;s++)k[s]=l[s];switch(k[0]){case"Z":e=g,f=i;break;case"H":e=k[1];break;case"V":f=k[1];break;case"M":g=k[k.length-2],i=k[k.length-1];default:e=k[k.length-2],f=k[k.length-1]}}return d.toString=c._path2string,b.abs=Cb(d),d},Fb=function(a,b,c,d){return[a,b,c,d,c,d]},Gb=function(a,b,c,d,e,f){var g=1/3,h=2/3;return[g*a+h*c,g*b+h*d,g*e+h*c,g*f+h*d,e,f]},Hb=function(a,b,c,d,e,g,h,i,j,k){var l,m=120*S/180,n=S/180*(+e||0),o=[],p=f(function(a,b,c){var d=a*N.cos(c)-b*N.sin(c),e=a*N.sin(c)+b*N.cos(c);return{x:d,y:e}});if(k)y=k[0],z=k[1],w=k[2],x=k[3];else{l=p(a,b,-n),a=l.x,b=l.y,l=p(i,j,-n),i=l.x,j=l.y;var q=(N.cos(S/180*e),N.sin(S/180*e),(a-i)/2),r=(b-j)/2,s=q*q/(c*c)+r*r/(d*d);s>1&&(s=N.sqrt(s),c=s*c,d=s*d);var t=c*c,u=d*d,v=(g==h?-1:1)*N.sqrt(Q((t*u-t*r*r-u*q*q)/(t*r*r+u*q*q))),w=v*c*r/d+(a+i)/2,x=v*-d*q/c+(b+j)/2,y=N.asin(((b-x)/d).toFixed(9)),z=N.asin(((j-x)/d).toFixed(9));y=w>a?S-y:y,z=w>i?S-z:z,0>y&&(y=2*S+y),0>z&&(z=2*S+z),h&&y>z&&(y-=2*S),!h&&z>y&&(z-=2*S)}var A=z-y;if(Q(A)>m){var B=z,C=i,D=j;z=y+m*(h&&z>y?1:-1),i=w+c*N.cos(z),j=x+d*N.sin(z),o=Hb(i,j,c,d,e,0,h,C,D,[z,B,w,x])}A=z-y;var F=N.cos(y),G=N.sin(y),H=N.cos(z),I=N.sin(z),K=N.tan(A/4),L=4/3*c*K,M=4/3*d*K,O=[a,b],P=[a+L*G,b-M*F],R=[i+L*I,j-M*H],T=[i,j];if(P[0]=2*O[0]-P[0],P[1]=2*O[1]-P[1],k)return[P,R,T][E](o);o=[P,R,T][E](o).join()[J](",");for(var U=[],V=0,W=o.length;W>V;V++)U[V]=V%2?p(o[V-1],o[V],n).y:p(o[V],o[V+1],n).x;return U},Ib=function(a,b,c,d,e,f,g,h,i){var j=1-i;return{x:R(j,3)*a+3*R(j,2)*i*c+3*j*i*i*e+R(i,3)*g,y:R(j,3)*b+3*R(j,2)*i*d+3*j*i*i*f+R(i,3)*h}},Jb=f(function(a,b,c,d,e,f,g,h){var i,j=e-2*c+a-(g-2*e+c),k=2*(c-a)-2*(e-c),l=a-c,m=(-k+N.sqrt(k*k-4*j*l))/2/j,n=(-k-N.sqrt(k*k-4*j*l))/2/j,o=[b,h],p=[a,g];return Q(m)>"1e12"&&(m=.5),Q(n)>"1e12"&&(n=.5),m>0&&1>m&&(i=Ib(a,b,c,d,e,f,g,h,m),p.push(i.x),o.push(i.y)),n>0&&1>n&&(i=Ib(a,b,c,d,e,f,g,h,n),p.push(i.x),o.push(i.y)),j=f-2*d+b-(h-2*f+d),k=2*(d-b)-2*(f-d),l=b-d,m=(-k+N.sqrt(k*k-4*j*l))/2/j,n=(-k-N.sqrt(k*k-4*j*l))/2/j,Q(m)>"1e12"&&(m=.5),Q(n)>"1e12"&&(n=.5),m>0&&1>m&&(i=Ib(a,b,c,d,e,f,g,h,m),p.push(i.x),o.push(i.y)),n>0&&1>n&&(i=Ib(a,b,c,d,e,f,g,h,n),p.push(i.x),o.push(i.y)),{min:{x:P[D](0,p),y:P[D](0,o)},max:{x:O[D](0,p),y:O[D](0,o)}}}),Kb=c._path2curve=f(function(a,b){var c=!b&&Ab(a);if(!b&&c.curve)return Cb(c.curve);for(var d=Eb(a),e=b&&Eb(b),f={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},g={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},h=(function(a,b,c){var d,e,f={T:1,Q:1};if(!a)return["C",b.x,b.y,b.x,b.y,b.x,b.y];switch(!(a[0]in f)&&(b.qx=b.qy=null),a[0]){case"M":b.X=a[1],b.Y=a[2];break;case"A":a=["C"][E](Hb[D](0,[b.x,b.y][E](a.slice(1))));break;case"S":"C"==c||"S"==c?(d=2*b.x-b.bx,e=2*b.y-b.by):(d=b.x,e=b.y),a=["C",d,e][E](a.slice(1));break;case"T":"Q"==c||"T"==c?(b.qx=2*b.x-b.qx,b.qy=2*b.y-b.qy):(b.qx=b.x,b.qy=b.y),a=["C"][E](Gb(b.x,b.y,b.qx,b.qy,a[1],a[2]));break;case"Q":b.qx=a[1],b.qy=a[2],a=["C"][E](Gb(b.x,b.y,a[1],a[2],a[3],a[4]));break;case"L":a=["C"][E](Fb(b.x,b.y,a[1],a[2]));break;case"H":a=["C"][E](Fb(b.x,b.y,a[1],b.y));break;case"V":a=["C"][E](Fb(b.x,b.y,b.x,a[1]));break;case"Z":a=["C"][E](Fb(b.x,b.y,b.X,b.Y))}return a}),i=function(a,b){if(a[b].length>7){a[b].shift();for(var c=a[b];c.length;)a.splice(b++,0,["C"][E](c.splice(0,6)));a.splice(b,1),l=O(d.length,e&&e.length||0)}},j=function(a,b,c,f,g){a&&b&&"M"==a[g][0]&&"M"!=b[g][0]&&(b.splice(g,0,["M",f.x,f.y]),c.bx=0,c.by=0,c.x=a[g][1],c.y=a[g][2],l=O(d.length,e&&e.length||0))},k=0,l=O(d.length,e&&e.length||0);l>k;k++){d[k]=h(d[k],f),i(d,k),e&&(e[k]=h(e[k],g)),e&&i(e,k),j(d,e,f,g,k),j(e,d,g,f,k);var m=d[k],n=e&&e[k],o=m.length,p=e&&n.length;f.x=m[o-2],f.y=m[o-1],f.bx=_(m[o-4])||f.x,f.by=_(m[o-3])||f.y,g.bx=e&&(_(n[p-4])||g.x),g.by=e&&(_(n[p-3])||g.y),g.x=e&&n[p-2],g.y=e&&n[p-1]}return e||(c.curve=Cb(d)),e?[d,e]:d},null,Cb),Lb=(c._parseDots=f(function(a){for(var b=[],d=0,e=a.length;e>d;d++){var f={},g=a[d].match(/^([^:]*):?([\d\.]*)/);if(f.color=c.getRGB(g[1]),f.color.error)return null;f.color=f.color.hex,g[2]&&(f.offset=g[2]+"%"),b.push(f)}for(d=1,e=b.length-1;e>d;d++)if(!b[d].offset){for(var h=_(b[d-1].offset||0),i=0,j=d+1;e>j;j++)if(b[j].offset){i=b[j].offset;break}i||(i=100,j=e),i=_(i);for(var k=(i-h)/(j-d+1);j>d;d++)h+=k,b[d].offset=h+"%"}return b}),c._tear=function(a,b){a==b.top&&(b.top=a.prev),a==b.bottom&&(b.bottom=a.next),a.next&&(a.next.prev=a.prev),a.prev&&(a.prev.next=a.next)}),Mb=(c._tofront=function(a,b){b.top!==a&&(Lb(a,b),a.next=null,a.prev=b.top,b.top.next=a,b.top=a)},c._toback=function(a,b){b.bottom!==a&&(Lb(a,b),a.next=b.bottom,a.prev=null,b.bottom.prev=a,b.bottom=a)},c._insertafter=function(a,b,c){Lb(a,c),b==c.top&&(c.top=a),b.next&&(b.next.prev=a),a.next=b.next,a.prev=b,b.next=a},c._insertbefore=function(a,b,c){Lb(a,c),b==c.bottom&&(c.bottom=a),b.prev&&(b.prev.next=a),a.prev=b.prev,b.prev=a,a.next=b},c.toMatrix=function(a,b){var c=Bb(a),d={_:{transform:G},getBBox:function(){return c}};return Nb(d,b),d.matrix}),Nb=(c.transformPath=function(a,b){return rb(a,Mb(a,b))},c._extractTransform=function(a,b){if(null==b)return a._.transform;b=I(b).replace(/\.{3}|\u2026/g,a._.transform||G);var d=c.parseTransformString(b),e=0,f=0,g=0,h=1,i=1,j=a._,k=new o;if(j.transform=d||[],d)for(var l=0,m=d.length;m>l;l++){var n,p,q,r,s,t=d[l],u=t.length,v=I(t[0]).toLowerCase(),w=t[0]!=v,x=w?k.invert():0;"t"==v&&3==u?w?(n=x.x(0,0),p=x.y(0,0),q=x.x(t[1],t[2]),r=x.y(t[1],t[2]),k.translate(q-n,r-p)):k.translate(t[1],t[2]):"r"==v?2==u?(s=s||a.getBBox(1),k.rotate(t[1],s.x+s.width/2,s.y+s.height/2),e+=t[1]):4==u&&(w?(q=x.x(t[2],t[3]),r=x.y(t[2],t[3]),k.rotate(t[1],q,r)):k.rotate(t[1],t[2],t[3]),e+=t[1]):"s"==v?2==u||3==u?(s=s||a.getBBox(1),k.scale(t[1],t[u-1],s.x+s.width/2,s.y+s.height/2),h*=t[1],i*=t[u-1]):5==u&&(w?(q=x.x(t[3],t[4]),r=x.y(t[3],t[4]),k.scale(t[1],t[2],q,r)):k.scale(t[1],t[2],t[3],t[4]),h*=t[1],i*=t[2]):"m"==v&&7==u&&k.add(t[1],t[2],t[3],t[4],t[5],t[6]),j.dirtyT=1,a.matrix=k}a.matrix=k,j.sx=h,j.sy=i,j.deg=e,j.dx=f=k.e,j.dy=g=k.f,1==h&&1==i&&!e&&j.bbox?(j.bbox.x+=+f,j.bbox.y+=+g):j.dirtyT=1}),Ob=function(a){var b=a[0];switch(b.toLowerCase()){case"t":return[b,0,0];case"m":return[b,1,0,0,1,0,0];case"r":return 4==a.length?[b,0,a[2],a[3]]:[b,0];case"s":return 5==a.length?[b,1,1,a[3],a[4]]:3==a.length?[b,1,1]:[b,1]}},Pb=c._equaliseTransform=function(a,b){b=I(b).replace(/\.{3}|\u2026/g,a),a=c.parseTransformString(a)||[],b=c.parseTransformString(b)||[];for(var d,e,f,g,h=O(a.length,b.length),i=[],j=[],k=0;h>k;k++){if(f=a[k]||Ob(b[k]),g=b[k]||Ob(f),f[0]!=g[0]||"r"==f[0].toLowerCase()&&(f[2]!=g[2]||f[3]!=g[3])||"s"==f[0].toLowerCase()&&(f[3]!=g[3]||f[4]!=g[4]))return;for(i[k]=[],j[k]=[],d=0,e=O(f.length,g.length);e>d;d++)d in f&&(i[k][d]=f[d]),d in g&&(j[k][d]=g[d])}return{from:i,to:j}};c._getContainer=function(a,b,d,e){var f;return f=null!=e||c.is(a,"object")?a:A.doc.getElementById(a),null!=f?f.tagName?null==b?{container:f,width:f.style.pixelWidth||f.offsetWidth,height:f.style.pixelHeight||f.offsetHeight}:{container:f,width:b,height:d}:{container:1,x:a,y:b,width:d,height:e}:void 0},c.pathToRelative=Db,c._engine={},c.path2curve=Kb,c.matrix=function(a,b,c,d,e,f){return new o(a,b,c,d,e,f)},function(a){function b(a){return a[0]*a[0]+a[1]*a[1]}function d(a){var c=N.sqrt(b(a));a[0]&&(a[0]/=c),a[1]&&(a[1]/=c)}a.add=function(a,b,c,d,e,f){var g,h,i,j,k=[[],[],[]],l=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],m=[[a,c,e],[b,d,f],[0,0,1]];for(a&&a instanceof o&&(m=[[a.a,a.c,a.e],[a.b,a.d,a.f],[0,0,1]]),g=0;3>g;g++)for(h=0;3>h;h++){for(j=0,i=0;3>i;i++)j+=l[g][i]*m[i][h];k[g][h]=j}this.a=k[0][0],this.b=k[1][0],this.c=k[0][1],this.d=k[1][1],this.e=k[0][2],this.f=k[1][2]},a.invert=function(){var a=this,b=a.a*a.d-a.b*a.c;return new o(a.d/b,-a.b/b,-a.c/b,a.a/b,(a.c*a.f-a.d*a.e)/b,(a.b*a.e-a.a*a.f)/b)},a.clone=function(){return new o(this.a,this.b,this.c,this.d,this.e,this.f)},a.translate=function(a,b){this.add(1,0,0,1,a,b)},a.scale=function(a,b,c,d){null==b&&(b=a),(c||d)&&this.add(1,0,0,1,c,d),this.add(a,0,0,b,0,0),(c||d)&&this.add(1,0,0,1,-c,-d)},a.rotate=function(a,b,d){a=c.rad(a),b=b||0,d=d||0;var e=+N.cos(a).toFixed(9),f=+N.sin(a).toFixed(9);this.add(e,f,-f,e,b,d),this.add(1,0,0,1,-b,-d)},a.x=function(a,b){return a*this.a+b*this.c+this.e},a.y=function(a,b){return a*this.b+b*this.d+this.f},a.get=function(a){return+this[I.fromCharCode(97+a)].toFixed(4)},a.toString=function(){return c.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()},a.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"
},a.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},a.split=function(){var a={};a.dx=this.e,a.dy=this.f;var e=[[this.a,this.c],[this.b,this.d]];a.scalex=N.sqrt(b(e[0])),d(e[0]),a.shear=e[0][0]*e[1][0]+e[0][1]*e[1][1],e[1]=[e[1][0]-e[0][0]*a.shear,e[1][1]-e[0][1]*a.shear],a.scaley=N.sqrt(b(e[1])),d(e[1]),a.shear/=a.scaley;var f=-e[0][1],g=e[1][1];return 0>g?(a.rotate=c.deg(N.acos(g)),0>f&&(a.rotate=360-a.rotate)):a.rotate=c.deg(N.asin(f)),a.isSimple=!(+a.shear.toFixed(9)||a.scalex.toFixed(9)!=a.scaley.toFixed(9)&&a.rotate),a.isSuperSimple=!+a.shear.toFixed(9)&&a.scalex.toFixed(9)==a.scaley.toFixed(9)&&!a.rotate,a.noRotation=!+a.shear.toFixed(9)&&!a.rotate,a},a.toTransformString=function(a){var b=a||this[J]();return b.isSimple?(b.scalex=+b.scalex.toFixed(4),b.scaley=+b.scaley.toFixed(4),b.rotate=+b.rotate.toFixed(4),(b.dx||b.dy?"t"+[b.dx,b.dy]:G)+(1!=b.scalex||1!=b.scaley?"s"+[b.scalex,b.scaley,0,0]:G)+(b.rotate?"r"+[b.rotate,0,0]:G)):"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}(o.prototype);var Qb=navigator.userAgent.match(/Version\/(.*?)\s/)||navigator.userAgent.match(/Chrome\/(\d+)/);v.safari="Apple Computer, Inc."==navigator.vendor&&(Qb&&Qb[1]<4||"iP"==navigator.platform.slice(0,2))||"Google Inc."==navigator.vendor&&Qb&&Qb[1]<8?function(){var a=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});setTimeout(function(){a.remove()})}:mb;for(var Rb=function(){this.returnValue=!1},Sb=function(){return this.originalEvent.preventDefault()},Tb=function(){this.cancelBubble=!0},Ub=function(){return this.originalEvent.stopPropagation()},Vb=function(a){var b=A.doc.documentElement.scrollTop||A.doc.body.scrollTop,c=A.doc.documentElement.scrollLeft||A.doc.body.scrollLeft;return{x:a.clientX+c,y:a.clientY+b}},Wb=function(){return A.doc.addEventListener?function(a,b,c,d){var e=function(a){var b=Vb(a);return c.call(d,a,b.x,b.y)};if(a.addEventListener(b,e,!1),F&&L[b]){var f=function(b){for(var e=Vb(b),f=b,g=0,h=b.targetTouches&&b.targetTouches.length;h>g;g++)if(b.targetTouches[g].target==a){b=b.targetTouches[g],b.originalEvent=f,b.preventDefault=Sb,b.stopPropagation=Ub;break}return c.call(d,b,e.x,e.y)};a.addEventListener(L[b],f,!1)}return function(){return a.removeEventListener(b,e,!1),F&&L[b]&&a.removeEventListener(L[b],e,!1),!0}}:A.doc.attachEvent?function(a,b,c,d){var e=function(a){a=a||A.win.event;var b=A.doc.documentElement.scrollTop||A.doc.body.scrollTop,e=A.doc.documentElement.scrollLeft||A.doc.body.scrollLeft,f=a.clientX+e,g=a.clientY+b;return a.preventDefault=a.preventDefault||Rb,a.stopPropagation=a.stopPropagation||Tb,c.call(d,a,f,g)};a.attachEvent("on"+b,e);var f=function(){return a.detachEvent("on"+b,e),!0};return f}:void 0}(),Xb=[],Yb=function(a){for(var c,d=a.clientX,e=a.clientY,f=A.doc.documentElement.scrollTop||A.doc.body.scrollTop,g=A.doc.documentElement.scrollLeft||A.doc.body.scrollLeft,h=Xb.length;h--;){if(c=Xb[h],F&&a.touches){for(var i,j=a.touches.length;j--;)if(i=a.touches[j],i.identifier==c.el._drag.id){d=i.clientX,e=i.clientY,(a.originalEvent?a.originalEvent:a).preventDefault();break}}else a.preventDefault();var k,l=c.el.node,m=l.nextSibling,n=l.parentNode,o=l.style.display;A.win.opera&&n.removeChild(l),l.style.display="none",k=c.el.paper.getElementByPoint(d,e),l.style.display=o,A.win.opera&&(m?n.insertBefore(l,m):n.appendChild(l)),k&&b("raphael.drag.over."+c.el.id,c.el,k),d+=g,e+=f,b("raphael.drag.move."+c.el.id,c.move_scope||c.el,d-c.el._drag.x,e-c.el._drag.y,d,e,a)}},Zb=function(a){c.unmousemove(Yb).unmouseup(Zb);for(var d,e=Xb.length;e--;)d=Xb[e],d.el._drag={},b("raphael.drag.end."+d.el.id,d.end_scope||d.start_scope||d.move_scope||d.el,a);Xb=[]},$b=c.el={},_b=K.length;_b--;)!function(a){c[a]=$b[a]=function(b,d){return c.is(b,"function")&&(this.events=this.events||[],this.events.push({name:a,f:b,unbind:Wb(this.shape||this.node||A.doc,a,b,d||this)})),this},c["un"+a]=$b["un"+a]=function(b){for(var d=this.events||[],e=d.length;e--;)d[e].name!=a||!c.is(b,"undefined")&&d[e].f!=b||(d[e].unbind(),d.splice(e,1),!d.length&&delete this.events);return this}}(K[_b]);$b.data=function(a,d){var e=kb[this.id]=kb[this.id]||{};if(0==arguments.length)return e;if(1==arguments.length){if(c.is(a,"object")){for(var f in a)a[z](f)&&this.data(f,a[f]);return this}return b("raphael.data.get."+this.id,this,e[a],a),e[a]}return e[a]=d,b("raphael.data.set."+this.id,this,d,a),this},$b.removeData=function(a){return null==a?kb[this.id]={}:kb[this.id]&&delete kb[this.id][a],this},$b.getData=function(){return d(kb[this.id]||{})},$b.hover=function(a,b,c,d){return this.mouseover(a,c).mouseout(b,d||c)},$b.unhover=function(a,b){return this.unmouseover(a).unmouseout(b)};var ac=[];$b.drag=function(a,d,e,f,g,h){function i(i){(i.originalEvent||i).preventDefault();var j=i.clientX,k=i.clientY,l=A.doc.documentElement.scrollTop||A.doc.body.scrollTop,m=A.doc.documentElement.scrollLeft||A.doc.body.scrollLeft;if(this._drag.id=i.identifier,F&&i.touches)for(var n,o=i.touches.length;o--;)if(n=i.touches[o],this._drag.id=n.identifier,n.identifier==this._drag.id){j=n.clientX,k=n.clientY;break}this._drag.x=j+m,this._drag.y=k+l,!Xb.length&&c.mousemove(Yb).mouseup(Zb),Xb.push({el:this,move_scope:f,start_scope:g,end_scope:h}),d&&b.on("raphael.drag.start."+this.id,d),a&&b.on("raphael.drag.move."+this.id,a),e&&b.on("raphael.drag.end."+this.id,e),b("raphael.drag.start."+this.id,g||f||this,i.clientX+m,i.clientY+l,i)}return this._drag={},ac.push({el:this,start:i}),this.mousedown(i),this},$b.onDragOver=function(a){a?b.on("raphael.drag.over."+this.id,a):b.unbind("raphael.drag.over."+this.id)},$b.undrag=function(){for(var a=ac.length;a--;)ac[a].el==this&&(this.unmousedown(ac[a].start),ac.splice(a,1),b.unbind("raphael.drag.*."+this.id));!ac.length&&c.unmousemove(Yb).unmouseup(Zb),Xb=[]},v.circle=function(a,b,d){var e=c._engine.circle(this,a||0,b||0,d||0);return this.__set__&&this.__set__.push(e),e},v.rect=function(a,b,d,e,f){var g=c._engine.rect(this,a||0,b||0,d||0,e||0,f||0);return this.__set__&&this.__set__.push(g),g},v.ellipse=function(a,b,d,e){var f=c._engine.ellipse(this,a||0,b||0,d||0,e||0);return this.__set__&&this.__set__.push(f),f},v.path=function(a){a&&!c.is(a,U)&&!c.is(a[0],V)&&(a+=G);var b=c._engine.path(c.format[D](c,arguments),this);return this.__set__&&this.__set__.push(b),b},v.image=function(a,b,d,e,f){var g=c._engine.image(this,a||"about:blank",b||0,d||0,e||0,f||0);return this.__set__&&this.__set__.push(g),g},v.text=function(a,b,d){var e=c._engine.text(this,a||0,b||0,I(d));return this.__set__&&this.__set__.push(e),e},v.set=function(a){!c.is(a,"array")&&(a=Array.prototype.splice.call(arguments,0,arguments.length));var b=new mc(a);return this.__set__&&this.__set__.push(b),b.paper=this,b.type="set",b},v.setStart=function(a){this.__set__=a||this.set()},v.setFinish=function(){var a=this.__set__;return delete this.__set__,a},v.setSize=function(a,b){return c._engine.setSize.call(this,a,b)},v.setViewBox=function(a,b,d,e,f){return c._engine.setViewBox.call(this,a,b,d,e,f)},v.top=v.bottom=null,v.raphael=c;var bc=function(a){var b=a.getBoundingClientRect(),c=a.ownerDocument,d=c.body,e=c.documentElement,f=e.clientTop||d.clientTop||0,g=e.clientLeft||d.clientLeft||0,h=b.top+(A.win.pageYOffset||e.scrollTop||d.scrollTop)-f,i=b.left+(A.win.pageXOffset||e.scrollLeft||d.scrollLeft)-g;return{y:h,x:i}};v.getElementByPoint=function(a,b){var c=this,d=c.canvas,e=A.doc.elementFromPoint(a,b);if(A.win.opera&&"svg"==e.tagName){var f=bc(d),g=d.createSVGRect();g.x=a-f.x,g.y=b-f.y,g.width=g.height=1;var h=d.getIntersectionList(g,null);h.length&&(e=h[h.length-1])}if(!e)return null;for(;e.parentNode&&e!=d.parentNode&&!e.raphael;)e=e.parentNode;return e==c.canvas.parentNode&&(e=d),e=e&&e.raphael?c.getById(e.raphaelid):null},v.getElementsByBBox=function(a){var b=this.set();return this.forEach(function(d){c.isBBoxIntersect(d.getBBox(),a)&&b.push(d)}),b},v.getById=function(a){for(var b=this.bottom;b;){if(b.id==a)return b;b=b.next}return null},v.forEach=function(a,b){for(var c=this.bottom;c;){if(a.call(b,c)===!1)return this;c=c.next}return this},v.getElementsByPoint=function(a,b){var c=this.set();return this.forEach(function(d){d.isPointInside(a,b)&&c.push(d)}),c},$b.isPointInside=function(a,b){var d=this.realPath=qb[this.type](this);return this.attr("transform")&&this.attr("transform").length&&(d=c.transformPath(d,this.attr("transform"))),c.isPointInsidePath(d,a,b)},$b.getBBox=function(a){if(this.removed)return{};var b=this._;return a?((b.dirty||!b.bboxwt)&&(this.realPath=qb[this.type](this),b.bboxwt=Bb(this.realPath),b.bboxwt.toString=p,b.dirty=0),b.bboxwt):((b.dirty||b.dirtyT||!b.bbox)&&((b.dirty||!this.realPath)&&(b.bboxwt=0,this.realPath=qb[this.type](this)),b.bbox=Bb(rb(this.realPath,this.matrix)),b.bbox.toString=p,b.dirty=b.dirtyT=0),b.bbox)},$b.clone=function(){if(this.removed)return null;var a=this.paper[this.type]().attr(this.attr());return this.__set__&&this.__set__.push(a),a},$b.glow=function(a){if("text"==this.type)return null;a=a||{};var b={width:(a.width||10)+(+this.attr("stroke-width")||1),fill:a.fill||!1,opacity:a.opacity||.5,offsetx:a.offsetx||0,offsety:a.offsety||0,color:a.color||"#000"},c=b.width/2,d=this.paper,e=d.set(),f=this.realPath||qb[this.type](this);f=this.matrix?rb(f,this.matrix):f;for(var g=1;c+1>g;g++)e.push(d.path(f).attr({stroke:b.color,fill:b.fill?b.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(b.width/c*g).toFixed(3),opacity:+(b.opacity/c).toFixed(3)}));return e.insertBefore(this).translate(b.offsetx,b.offsety)};var cc=function(a,b,d,e,f,g,h,i,l){return null==l?j(a,b,d,e,f,g,h,i):c.findDotsAtSegment(a,b,d,e,f,g,h,i,k(a,b,d,e,f,g,h,i,l))},dc=function(a,b){return function(d,e,f){d=Kb(d);for(var g,h,i,j,k,l="",m={},n=0,o=0,p=d.length;p>o;o++){if(i=d[o],"M"==i[0])g=+i[1],h=+i[2];else{if(j=cc(g,h,i[1],i[2],i[3],i[4],i[5],i[6]),n+j>e){if(b&&!m.start){if(k=cc(g,h,i[1],i[2],i[3],i[4],i[5],i[6],e-n),l+=["C"+k.start.x,k.start.y,k.m.x,k.m.y,k.x,k.y],f)return l;m.start=l,l=["M"+k.x,k.y+"C"+k.n.x,k.n.y,k.end.x,k.end.y,i[5],i[6]].join(),n+=j,g=+i[5],h=+i[6];continue}if(!a&&!b)return k=cc(g,h,i[1],i[2],i[3],i[4],i[5],i[6],e-n),{x:k.x,y:k.y,alpha:k.alpha}}n+=j,g=+i[5],h=+i[6]}l+=i.shift()+i}return m.end=l,k=a?n:b?m:c.findDotsAtSegment(g,h,i[0],i[1],i[2],i[3],i[4],i[5],1),k.alpha&&(k={x:k.x,y:k.y,alpha:k.alpha}),k}},ec=dc(1),fc=dc(),gc=dc(0,1);c.getTotalLength=ec,c.getPointAtLength=fc,c.getSubpath=function(a,b,c){if(this.getTotalLength(a)-c<1e-6)return gc(a,b).end;var d=gc(a,c,1);return b?gc(d,b).end:d},$b.getTotalLength=function(){var a=this.getPath();if(a)return this.node.getTotalLength?this.node.getTotalLength():ec(a)},$b.getPointAtLength=function(a){var b=this.getPath();if(b)return fc(b,a)},$b.getPath=function(){var a,b=c._getPath[this.type];if("text"!=this.type&&"set"!=this.type)return b&&(a=b(this)),a},$b.getSubpath=function(a,b){var d=this.getPath();if(d)return c.getSubpath(d,a,b)};var hc=c.easing_formulas={linear:function(a){return a},"<":function(a){return R(a,1.7)},">":function(a){return R(a,.48)},"<>":function(a){var b=.48-a/1.04,c=N.sqrt(.1734+b*b),d=c-b,e=R(Q(d),1/3)*(0>d?-1:1),f=-c-b,g=R(Q(f),1/3)*(0>f?-1:1),h=e+g+.5;return 3*(1-h)*h*h+h*h*h},backIn:function(a){var b=1.70158;return a*a*((b+1)*a-b)},backOut:function(a){a-=1;var b=1.70158;return a*a*((b+1)*a+b)+1},elastic:function(a){return a==!!a?a:R(2,-10*a)*N.sin(2*(a-.075)*S/.3)+1},bounce:function(a){var b,c=7.5625,d=2.75;return 1/d>a?b=c*a*a:2/d>a?(a-=1.5/d,b=c*a*a+.75):2.5/d>a?(a-=2.25/d,b=c*a*a+.9375):(a-=2.625/d,b=c*a*a+.984375),b}};hc.easeIn=hc["ease-in"]=hc["<"],hc.easeOut=hc["ease-out"]=hc[">"],hc.easeInOut=hc["ease-in-out"]=hc["<>"],hc["back-in"]=hc.backIn,hc["back-out"]=hc.backOut;var ic=[],jc=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||function(a){setTimeout(a,16)},kc=function(){for(var a=+new Date,d=0;d<ic.length;d++){var e=ic[d];if(!e.el.removed&&!e.paused){var f,g,h=a-e.start,i=e.ms,j=e.easing,k=e.from,l=e.diff,m=e.to,n=(e.t,e.el),o={},p={};if(e.initstatus?(h=(e.initstatus*e.anim.top-e.prev)/(e.percent-e.prev)*i,e.status=e.initstatus,delete e.initstatus,e.stop&&ic.splice(d--,1)):e.status=(e.prev+(e.percent-e.prev)*(h/i))/e.anim.top,!(0>h))if(i>h){var q=j(h/i);for(var r in k)if(k[z](r)){switch(db[r]){case T:f=+k[r]+q*i*l[r];break;case"colour":f="rgb("+[lc($(k[r].r+q*i*l[r].r)),lc($(k[r].g+q*i*l[r].g)),lc($(k[r].b+q*i*l[r].b))].join(",")+")";break;case"path":f=[];for(var t=0,u=k[r].length;u>t;t++){f[t]=[k[r][t][0]];for(var v=1,w=k[r][t].length;w>v;v++)f[t][v]=+k[r][t][v]+q*i*l[r][t][v];f[t]=f[t].join(H)}f=f.join(H);break;case"transform":if(l[r].real)for(f=[],t=0,u=k[r].length;u>t;t++)for(f[t]=[k[r][t][0]],v=1,w=k[r][t].length;w>v;v++)f[t][v]=k[r][t][v]+q*i*l[r][t][v];else{var x=function(a){return+k[r][a]+q*i*l[r][a]};f=[["m",x(0),x(1),x(2),x(3),x(4),x(5)]]}break;case"csv":if("clip-rect"==r)for(f=[],t=4;t--;)f[t]=+k[r][t]+q*i*l[r][t];break;default:var y=[][E](k[r]);for(f=[],t=n.paper.customAttributes[r].length;t--;)f[t]=+y[t]+q*i*l[r][t]}o[r]=f}n.attr(o),function(a,c,d){setTimeout(function(){b("raphael.anim.frame."+a,c,d)})}(n.id,n,e.anim)}else{if(function(a,d,e){setTimeout(function(){b("raphael.anim.frame."+d.id,d,e),b("raphael.anim.finish."+d.id,d,e),c.is(a,"function")&&a.call(d)})}(e.callback,n,e.anim),n.attr(m),ic.splice(d--,1),e.repeat>1&&!e.next){for(g in m)m[z](g)&&(p[g]=e.totalOrigin[g]);e.el.attr(p),s(e.anim,e.el,e.anim.percents[0],null,e.totalOrigin,e.repeat-1)}e.next&&!e.stop&&s(e.anim,e.el,e.next,null,e.totalOrigin,e.repeat)}}}c.svg&&n&&n.paper&&n.paper.safari(),ic.length&&jc(kc)},lc=function(a){return a>255?255:0>a?0:a};$b.animateWith=function(a,b,d,e,f,g){var h=this;if(h.removed)return g&&g.call(h),h;var i=d instanceof r?d:c.animation(d,e,f,g);s(i,h,i.percents[0],null,h.attr());for(var j=0,k=ic.length;k>j;j++)if(ic[j].anim==b&&ic[j].el==a){ic[k-1].start=ic[j].start;break}return h},$b.onAnimation=function(a){return a?b.on("raphael.anim.frame."+this.id,a):b.unbind("raphael.anim.frame."+this.id),this},r.prototype.delay=function(a){var b=new r(this.anim,this.ms);return b.times=this.times,b.del=+a||0,b},r.prototype.repeat=function(a){var b=new r(this.anim,this.ms);return b.del=this.del,b.times=N.floor(O(a,0))||1,b},c.animation=function(a,b,d,e){if(a instanceof r)return a;(c.is(d,"function")||!d)&&(e=e||d||null,d=null),a=Object(a),b=+b||0;var f,g,h={};for(g in a)a[z](g)&&_(g)!=g&&_(g)+"%"!=g&&(f=!0,h[g]=a[g]);return f?(d&&(h.easing=d),e&&(h.callback=e),new r({100:h},b)):new r(a,b)},$b.animate=function(a,b,d,e){var f=this;if(f.removed)return e&&e.call(f),f;var g=a instanceof r?a:c.animation(a,b,d,e);return s(g,f,g.percents[0],null,f.attr()),f},$b.setTime=function(a,b){return a&&null!=b&&this.status(a,P(b,a.ms)/a.ms),this},$b.status=function(a,b){var c,d,e=[],f=0;if(null!=b)return s(a,this,-1,P(b,1)),this;for(c=ic.length;c>f;f++)if(d=ic[f],d.el.id==this.id&&(!a||d.anim==a)){if(a)return d.status;e.push({anim:d.anim,status:d.status})}return a?0:e},$b.pause=function(a){for(var c=0;c<ic.length;c++)ic[c].el.id!=this.id||a&&ic[c].anim!=a||b("raphael.anim.pause."+this.id,this,ic[c].anim)!==!1&&(ic[c].paused=!0);return this},$b.resume=function(a){for(var c=0;c<ic.length;c++)if(ic[c].el.id==this.id&&(!a||ic[c].anim==a)){var d=ic[c];b("raphael.anim.resume."+this.id,this,d.anim)!==!1&&(delete d.paused,this.status(d.anim,d.status))}return this},$b.stop=function(a){for(var c=0;c<ic.length;c++)ic[c].el.id!=this.id||a&&ic[c].anim!=a||b("raphael.anim.stop."+this.id,this,ic[c].anim)!==!1&&ic.splice(c--,1);return this},b.on("raphael.remove",t),b.on("raphael.clear",t),$b.toString=function(){return"Raphaël’s object"};var mc=function(a){if(this.items=[],this.length=0,this.type="set",a)for(var b=0,c=a.length;c>b;b++)!a[b]||a[b].constructor!=$b.constructor&&a[b].constructor!=mc||(this[this.items.length]=this.items[this.items.length]=a[b],this.length++)},nc=mc.prototype;nc.push=function(){for(var a,b,c=0,d=arguments.length;d>c;c++)a=arguments[c],!a||a.constructor!=$b.constructor&&a.constructor!=mc||(b=this.items.length,this[b]=this.items[b]=a,this.length++);return this},nc.pop=function(){return this.length&&delete this[this.length--],this.items.pop()},nc.forEach=function(a,b){for(var c=0,d=this.items.length;d>c;c++)if(a.call(b,this.items[c],c)===!1)return this;return this};for(var oc in $b)$b[z](oc)&&(nc[oc]=function(a){return function(){var b=arguments;return this.forEach(function(c){c[a][D](c,b)})}}(oc));return nc.attr=function(a,b){if(a&&c.is(a,V)&&c.is(a[0],"object"))for(var d=0,e=a.length;e>d;d++)this.items[d].attr(a[d]);else for(var f=0,g=this.items.length;g>f;f++)this.items[f].attr(a,b);return this},nc.clear=function(){for(;this.length;)this.pop()},nc.splice=function(a,b){a=0>a?O(this.length+a,0):a,b=O(0,P(this.length-a,b));var c,d=[],e=[],f=[];for(c=2;c<arguments.length;c++)f.push(arguments[c]);for(c=0;b>c;c++)e.push(this[a+c]);for(;c<this.length-a;c++)d.push(this[a+c]);var g=f.length;for(c=0;c<g+d.length;c++)this.items[a+c]=this[a+c]=g>c?f[c]:d[c-g];for(c=this.items.length=this.length-=b-g;this[c];)delete this[c++];return new mc(e)},nc.exclude=function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]==a)return this.splice(b,1),!0},nc.animate=function(a,b,d,e){(c.is(d,"function")||!d)&&(e=d||null);var f,g,h=this.items.length,i=h,j=this;if(!h)return this;e&&(g=function(){!--h&&e.call(j)}),d=c.is(d,U)?d:g;var k=c.animation(a,b,d,g);for(f=this.items[--i].animate(k);i--;)this.items[i]&&!this.items[i].removed&&this.items[i].animateWith(f,k,k),this.items[i]&&!this.items[i].removed||h--;return this},nc.insertAfter=function(a){for(var b=this.items.length;b--;)this.items[b].insertAfter(a);return this},nc.getBBox=function(){for(var a=[],b=[],c=[],d=[],e=this.items.length;e--;)if(!this.items[e].removed){var f=this.items[e].getBBox();a.push(f.x),b.push(f.y),c.push(f.x+f.width),d.push(f.y+f.height)}return a=P[D](0,a),b=P[D](0,b),c=O[D](0,c),d=O[D](0,d),{x:a,y:b,x2:c,y2:d,width:c-a,height:d-b}},nc.clone=function(a){a=this.paper.set();for(var b=0,c=this.items.length;c>b;b++)a.push(this.items[b].clone());return a},nc.toString=function(){return"Raphaël‘s set"},nc.glow=function(a){var b=this.paper.set();return this.forEach(function(c){var d=c.glow(a);null!=d&&d.forEach(function(a){b.push(a)})}),b},nc.isPointInside=function(a,b){var c=!1;return this.forEach(function(d){return d.isPointInside(a,b)?(c=!0,!1):void 0}),c},c.registerFont=function(a){if(!a.face)return a;this.fonts=this.fonts||{};var b={w:a.w,face:{},glyphs:{}},c=a.face["font-family"];for(var d in a.face)a.face[z](d)&&(b.face[d]=a.face[d]);if(this.fonts[c]?this.fonts[c].push(b):this.fonts[c]=[b],!a.svg){b.face["units-per-em"]=ab(a.face["units-per-em"],10);for(var e in a.glyphs)if(a.glyphs[z](e)){var f=a.glyphs[e];if(b.glyphs[e]={w:f.w,k:{},d:f.d&&"M"+f.d.replace(/[mlcxtrv]/g,function(a){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[a]||"M"})+"z"},f.k)for(var g in f.k)f[z](g)&&(b.glyphs[e].k[g]=f.k[g])}}return a},v.getFont=function(a,b,d,e){if(e=e||"normal",d=d||"normal",b=+b||{normal:400,bold:700,lighter:300,bolder:800}[b]||400,c.fonts){var f=c.fonts[a];if(!f){var g=new RegExp("(^|\\s)"+a.replace(/[^\w\d\s+!~.:_-]/g,G)+"(\\s|$)","i");for(var h in c.fonts)if(c.fonts[z](h)&&g.test(h)){f=c.fonts[h];break}}var i;if(f){for(var j=0,k=f.length;k>j&&(i=f[j],i.face["font-weight"]!=b||i.face["font-style"]!=d||i.face["font-stretch"]!=e);j++);if(j>=k)for(var j=0,k=f.length;k>j&&(i=f[j],i.face["font-weight"]!=b||i.face["font-style"]!=d&&i.face["font-style"]||i.face["font-stretch"]!=e);j++);}return i}},v.print=function(a,b,d,e,f,g,h,i,j){g=g||"middle",j=j||"ltr",h=O(P(h||0,1),-1),i=O(P(i||1,3),1);var k,l=I(d)[J](G),m=0,n=0,o=G;if(c.is(e,"string")&&(e=this.getFont(e)),e){k=(f||16)/e.face["units-per-em"];for(var p,q=e.face.bbox[J](w),r=+q[0],s=q[3]-q[1],t=0,u=+q[1]+("baseline"==g?s+ +e.face.descent:s/2),v=0,x=l.length;x>v;v++){if(p="rtl"==j?x-v-1:v,"\n"==l[p])m=0,z=0,n=0,t+=s*i;else{var y;y="rtl"==j?n&&e.glyphs[l[p+1]]||{}:n&&e.glyphs[l[p-1]]||{};var z=e.glyphs[l[p]];m+=n?(y.w||e.w)+(y.k&&y.k[l[p]]||0)+e.w*h:0,n=1}z&&z.d&&(o+=c.transformPath(z.d,["t",m*k,t*k,"s",k,k,r,u,"t",(a-r)/k,(b-u)/k]))}var A;A=z?m+((z.w||e.w)+(z.k&&z.k[l[p]]||0)+e.w*h):m+e.w}return this.path(o).attr({fill:"#000",right:A*k,stroke:"none"})},v.add=function(a){if(c.is(a,"array"))for(var b,d=this.set(),e=0,f=a.length;f>e;e++)b=a[e]||{},x[z](b.type)&&d.push(this[b.type]().attr(b));return d},c.format=function(a,b){var d=c.is(b,V)?[0][E](b):arguments;return a&&c.is(a,U)&&d.length-1&&(a=a.replace(y,function(a,b){return null==d[++b]?G:d[b]})),a||G},c.fullfill=function(){var a=/\{([^\}]+)\}/g,b=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,c=function(a,c,d){var e=d;return c.replace(b,function(a,b,c,d,f){b=b||d,e&&(b in e&&(e=e[b]),"function"==typeof e&&f&&(e=e()))}),e=(null==e||e==d?a:e)+""};return function(b,d){return String(b).replace(a,function(a,b){return c(a,b,d)})}}(),c.ninja=function(){return B.was?A.win.Raphael=B.is:delete Raphael,c},c.st=nc,function(a,b,d){function e(){/in/.test(a.readyState)?setTimeout(e,9):c.eve("raphael.DOMload")}null==a.readyState&&a.addEventListener&&(a.addEventListener(b,d=function(){a.removeEventListener(b,d,!1),a.readyState="complete"},!1),a.readyState="loading"),e()}(document,"DOMContentLoaded"),b.on("raphael.DOMload",function(){u=!0}),function(){if(c.svg){var a="hasOwnProperty",b=String,d=parseFloat,e=parseInt,f=Math,g=f.max,h=f.abs,i=f.pow,j=/[, ]+/,k=c.eve,l="",m=" ",n="http://www.w3.org/1999/xlink",o={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},p={};c.toString=function(){return"Your browser supports SVG.\nYou are running Raphaël "+this.version};var q=function(d,e){if(e){"string"==typeof d&&(d=q(d));for(var f in e)e[a](f)&&("xlink:"==f.substring(0,6)?d.setAttributeNS(n,f.substring(6),b(e[f])):d.setAttribute(f,b(e[f])))}else d=c._g.doc.createElementNS("http://www.w3.org/2000/svg",d),d.style&&(d.style.webkitTapHighlightColor="rgba(0,0,0,0)");return d},r=function(a,e){var j="linear",k=a.id+e,m=.5,n=.5,o=a.node,p=a.paper,r=o.style,s=c._g.doc.getElementById(k);if(!s){if(e=b(e).replace(c._radial_gradient,function(a,b,c){if(j="radial",b&&c){m=d(b),n=d(c);var e=2*(n>.5)-1;i(m-.5,2)+i(n-.5,2)>.25&&(n=f.sqrt(.25-i(m-.5,2))*e+.5)&&.5!=n&&(n=n.toFixed(5)-1e-5*e)}return l}),e=e.split(/\s*\-\s*/),"linear"==j){var t=e.shift();if(t=-d(t),isNaN(t))return null;var u=[0,0,f.cos(c.rad(t)),f.sin(c.rad(t))],v=1/(g(h(u[2]),h(u[3]))||1);u[2]*=v,u[3]*=v,u[2]<0&&(u[0]=-u[2],u[2]=0),u[3]<0&&(u[1]=-u[3],u[3]=0)}var w=c._parseDots(e);if(!w)return null;if(k=k.replace(/[\(\)\s,\xb0#]/g,"_"),a.gradient&&k!=a.gradient.id&&(p.defs.removeChild(a.gradient),delete a.gradient),!a.gradient){s=q(j+"Gradient",{id:k}),a.gradient=s,q(s,"radial"==j?{fx:m,fy:n}:{x1:u[0],y1:u[1],x2:u[2],y2:u[3],gradientTransform:a.matrix.invert()}),p.defs.appendChild(s);for(var x=0,y=w.length;y>x;x++)s.appendChild(q("stop",{offset:w[x].offset?w[x].offset:x?"100%":"0%","stop-color":w[x].color||"#fff"}))}}return q(o,{fill:"url(#"+k+")",opacity:1,"fill-opacity":1}),r.fill=l,r.opacity=1,r.fillOpacity=1,1},s=function(a){var b=a.getBBox(1);q(a.pattern,{patternTransform:a.matrix.invert()+" translate("+b.x+","+b.y+")"})},t=function(d,e,f){if("path"==d.type){for(var g,h,i,j,k,m=b(e).toLowerCase().split("-"),n=d.paper,r=f?"end":"start",s=d.node,t=d.attrs,u=t["stroke-width"],v=m.length,w="classic",x=3,y=3,z=5;v--;)switch(m[v]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":w=m[v];break;case"wide":y=5;break;case"narrow":y=2;break;case"long":x=5;break;case"short":x=2}if("open"==w?(x+=2,y+=2,z+=2,i=1,j=f?4:1,k={fill:"none",stroke:t.stroke}):(j=i=x/2,k={fill:t.stroke,stroke:"none"}),d._.arrows?f?(d._.arrows.endPath&&p[d._.arrows.endPath]--,d._.arrows.endMarker&&p[d._.arrows.endMarker]--):(d._.arrows.startPath&&p[d._.arrows.startPath]--,d._.arrows.startMarker&&p[d._.arrows.startMarker]--):d._.arrows={},"none"!=w){var A="raphael-marker-"+w,B="raphael-marker-"+r+w+x+y;c._g.doc.getElementById(A)?p[A]++:(n.defs.appendChild(q(q("path"),{"stroke-linecap":"round",d:o[w],id:A})),p[A]=1);var C,D=c._g.doc.getElementById(B);D?(p[B]++,C=D.getElementsByTagName("use")[0]):(D=q(q("marker"),{id:B,markerHeight:y,markerWidth:x,orient:"auto",refX:j,refY:y/2}),C=q(q("use"),{"xlink:href":"#"+A,transform:(f?"rotate(180 "+x/2+" "+y/2+") ":l)+"scale("+x/z+","+y/z+")","stroke-width":(1/((x/z+y/z)/2)).toFixed(4)}),D.appendChild(C),n.defs.appendChild(D),p[B]=1),q(C,k);var E=i*("diamond"!=w&&"oval"!=w);f?(g=d._.arrows.startdx*u||0,h=c.getTotalLength(t.path)-E*u):(g=E*u,h=c.getTotalLength(t.path)-(d._.arrows.enddx*u||0)),k={},k["marker-"+r]="url(#"+B+")",(h||g)&&(k.d=c.getSubpath(t.path,g,h)),q(s,k),d._.arrows[r+"Path"]=A,d._.arrows[r+"Marker"]=B,d._.arrows[r+"dx"]=E,d._.arrows[r+"Type"]=w,d._.arrows[r+"String"]=e}else f?(g=d._.arrows.startdx*u||0,h=c.getTotalLength(t.path)-g):(g=0,h=c.getTotalLength(t.path)-(d._.arrows.enddx*u||0)),d._.arrows[r+"Path"]&&q(s,{d:c.getSubpath(t.path,g,h)}),delete d._.arrows[r+"Path"],delete d._.arrows[r+"Marker"],delete d._.arrows[r+"dx"],delete d._.arrows[r+"Type"],delete d._.arrows[r+"String"];for(k in p)if(p[a](k)&&!p[k]){var F=c._g.doc.getElementById(k);F&&F.parentNode.removeChild(F)}}},u={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},v=function(a,c,d){if(c=u[b(c).toLowerCase()]){for(var e=a.attrs["stroke-width"]||"1",f={round:e,square:e,butt:0}[a.attrs["stroke-linecap"]||d["stroke-linecap"]]||0,g=[],h=c.length;h--;)g[h]=c[h]*e+(h%2?1:-1)*f;q(a.node,{"stroke-dasharray":g.join(",")})}},w=function(d,f){var i=d.node,k=d.attrs,m=i.style.visibility;i.style.visibility="hidden";for(var o in f)if(f[a](o)){if(!c._availableAttrs[a](o))continue;var p=f[o];switch(k[o]=p,o){case"blur":d.blur(p);break;case"title":var u=i.getElementsByTagName("title");if(u.length&&(u=u[0]))u.firstChild.nodeValue=p;else{u=q("title");var w=c._g.doc.createTextNode(p);u.appendChild(w),i.appendChild(u)}break;case"href":case"target":var x=i.parentNode;if("a"!=x.tagName.toLowerCase()){var z=q("a");x.insertBefore(z,i),z.appendChild(i),x=z}"target"==o?x.setAttributeNS(n,"show","blank"==p?"new":p):x.setAttributeNS(n,o,p);break;case"cursor":i.style.cursor=p;break;case"transform":d.transform(p);break;case"arrow-start":t(d,p);break;case"arrow-end":t(d,p,1);break;case"clip-rect":var A=b(p).split(j);if(4==A.length){d.clip&&d.clip.parentNode.parentNode.removeChild(d.clip.parentNode);var B=q("clipPath"),C=q("rect");B.id=c.createUUID(),q(C,{x:A[0],y:A[1],width:A[2],height:A[3]}),B.appendChild(C),d.paper.defs.appendChild(B),q(i,{"clip-path":"url(#"+B.id+")"}),d.clip=C}if(!p){var D=i.getAttribute("clip-path");if(D){var E=c._g.doc.getElementById(D.replace(/(^url\(#|\)$)/g,l));E&&E.parentNode.removeChild(E),q(i,{"clip-path":l}),delete d.clip}}break;case"path":"path"==d.type&&(q(i,{d:p?k.path=c._pathToAbsolute(p):"M0,0"}),d._.dirty=1,d._.arrows&&("startString"in d._.arrows&&t(d,d._.arrows.startString),"endString"in d._.arrows&&t(d,d._.arrows.endString,1)));break;case"width":if(i.setAttribute(o,p),d._.dirty=1,!k.fx)break;o="x",p=k.x;case"x":k.fx&&(p=-k.x-(k.width||0));case"rx":if("rx"==o&&"rect"==d.type)break;case"cx":i.setAttribute(o,p),d.pattern&&s(d),d._.dirty=1;break;case"height":if(i.setAttribute(o,p),d._.dirty=1,!k.fy)break;o="y",p=k.y;case"y":k.fy&&(p=-k.y-(k.height||0));case"ry":if("ry"==o&&"rect"==d.type)break;case"cy":i.setAttribute(o,p),d.pattern&&s(d),d._.dirty=1;break;case"r":"rect"==d.type?q(i,{rx:p,ry:p}):i.setAttribute(o,p),d._.dirty=1;break;case"src":"image"==d.type&&i.setAttributeNS(n,"href",p);break;case"stroke-width":(1!=d._.sx||1!=d._.sy)&&(p/=g(h(d._.sx),h(d._.sy))||1),d.paper._vbSize&&(p*=d.paper._vbSize),i.setAttribute(o,p),k["stroke-dasharray"]&&v(d,k["stroke-dasharray"],f),d._.arrows&&("startString"in d._.arrows&&t(d,d._.arrows.startString),"endString"in d._.arrows&&t(d,d._.arrows.endString,1));break;case"stroke-dasharray":v(d,p,f);break;case"fill":var F=b(p).match(c._ISURL);if(F){B=q("pattern");var G=q("image");B.id=c.createUUID(),q(B,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),q(G,{x:0,y:0,"xlink:href":F[1]}),B.appendChild(G),function(a){c._preload(F[1],function(){var b=this.offsetWidth,c=this.offsetHeight;q(a,{width:b,height:c}),q(G,{width:b,height:c}),d.paper.safari()})}(B),d.paper.defs.appendChild(B),q(i,{fill:"url(#"+B.id+")"}),d.pattern=B,d.pattern&&s(d);break}var H=c.getRGB(p);if(H.error){if(("circle"==d.type||"ellipse"==d.type||"r"!=b(p).charAt())&&r(d,p)){if("opacity"in k||"fill-opacity"in k){var I=c._g.doc.getElementById(i.getAttribute("fill").replace(/^url\(#|\)$/g,l));if(I){var J=I.getElementsByTagName("stop");q(J[J.length-1],{"stop-opacity":("opacity"in k?k.opacity:1)*("fill-opacity"in k?k["fill-opacity"]:1)})}}k.gradient=p,k.fill="none";break}}else delete f.gradient,delete k.gradient,!c.is(k.opacity,"undefined")&&c.is(f.opacity,"undefined")&&q(i,{opacity:k.opacity}),!c.is(k["fill-opacity"],"undefined")&&c.is(f["fill-opacity"],"undefined")&&q(i,{"fill-opacity":k["fill-opacity"]});H[a]("opacity")&&q(i,{"fill-opacity":H.opacity>1?H.opacity/100:H.opacity});case"stroke":H=c.getRGB(p),i.setAttribute(o,H.hex),"stroke"==o&&H[a]("opacity")&&q(i,{"stroke-opacity":H.opacity>1?H.opacity/100:H.opacity}),"stroke"==o&&d._.arrows&&("startString"in d._.arrows&&t(d,d._.arrows.startString),"endString"in d._.arrows&&t(d,d._.arrows.endString,1));break;case"gradient":("circle"==d.type||"ellipse"==d.type||"r"!=b(p).charAt())&&r(d,p);break;case"opacity":k.gradient&&!k[a]("stroke-opacity")&&q(i,{"stroke-opacity":p>1?p/100:p});case"fill-opacity":if(k.gradient){I=c._g.doc.getElementById(i.getAttribute("fill").replace(/^url\(#|\)$/g,l)),I&&(J=I.getElementsByTagName("stop"),q(J[J.length-1],{"stop-opacity":p}));break}default:"font-size"==o&&(p=e(p,10)+"px");var K=o.replace(/(\-.)/g,function(a){return a.substring(1).toUpperCase()});i.style[K]=p,d._.dirty=1,i.setAttribute(o,p)}}y(d,f),i.style.visibility=m},x=1.2,y=function(d,f){if("text"==d.type&&(f[a]("text")||f[a]("font")||f[a]("font-size")||f[a]("x")||f[a]("y"))){var g=d.attrs,h=d.node,i=h.firstChild?e(c._g.doc.defaultView.getComputedStyle(h.firstChild,l).getPropertyValue("font-size"),10):10;if(f[a]("text")){for(g.text=f.text;h.firstChild;)h.removeChild(h.firstChild);for(var j,k=b(f.text).split("\n"),m=[],n=0,o=k.length;o>n;n++)j=q("tspan"),n&&q(j,{dy:i*x,x:g.x}),j.appendChild(c._g.doc.createTextNode(k[n])),h.appendChild(j),m[n]=j}else for(m=h.getElementsByTagName("tspan"),n=0,o=m.length;o>n;n++)n?q(m[n],{dy:i*x,x:g.x}):q(m[0],{dy:0});q(h,{x:g.x,y:g.y}),d._.dirty=1;var p=d._getBBox(),r=g.y-(p.y+p.height/2);r&&c.is(r,"finite")&&q(m[0],{dy:r})}},z=function(a,b){this[0]=this.node=a,a.raphael=!0,this.id=c._oid++,a.raphaelid=this.id,this.matrix=c.matrix(),this.realPath=null,this.paper=b,this.attrs=this.attrs||{},this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1},!b.bottom&&(b.bottom=this),this.prev=b.top,b.top&&(b.top.next=this),b.top=this,this.next=null},A=c.el;z.prototype=A,A.constructor=z,c._engine.path=function(a,b){var c=q("path");b.canvas&&b.canvas.appendChild(c);var d=new z(c,b);return d.type="path",w(d,{fill:"none",stroke:"#000",path:a}),d},A.rotate=function(a,c,e){if(this.removed)return this;if(a=b(a).split(j),a.length-1&&(c=d(a[1]),e=d(a[2])),a=d(a[0]),null==e&&(c=e),null==c||null==e){var f=this.getBBox(1);c=f.x+f.width/2,e=f.y+f.height/2}return this.transform(this._.transform.concat([["r",a,c,e]])),this},A.scale=function(a,c,e,f){if(this.removed)return this;if(a=b(a).split(j),a.length-1&&(c=d(a[1]),e=d(a[2]),f=d(a[3])),a=d(a[0]),null==c&&(c=a),null==f&&(e=f),null==e||null==f)var g=this.getBBox(1);return e=null==e?g.x+g.width/2:e,f=null==f?g.y+g.height/2:f,this.transform(this._.transform.concat([["s",a,c,e,f]])),this},A.translate=function(a,c){return this.removed?this:(a=b(a).split(j),a.length-1&&(c=d(a[1])),a=d(a[0])||0,c=+c||0,this.transform(this._.transform.concat([["t",a,c]])),this)
},A.transform=function(b){var d=this._;if(null==b)return d.transform;if(c._extractTransform(this,b),this.clip&&q(this.clip,{transform:this.matrix.invert()}),this.pattern&&s(this),this.node&&q(this.node,{transform:this.matrix}),1!=d.sx||1!=d.sy){var e=this.attrs[a]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":e})}return this},A.hide=function(){return!this.removed&&this.paper.safari(this.node.style.display="none"),this},A.show=function(){return!this.removed&&this.paper.safari(this.node.style.display=""),this},A.remove=function(){if(!this.removed&&this.node.parentNode){var a=this.paper;a.__set__&&a.__set__.exclude(this),k.unbind("raphael.*.*."+this.id),this.gradient&&a.defs.removeChild(this.gradient),c._tear(this,a),"a"==this.node.parentNode.tagName.toLowerCase()?this.node.parentNode.parentNode.removeChild(this.node.parentNode):this.node.parentNode.removeChild(this.node);for(var b in this)this[b]="function"==typeof this[b]?c._removedFactory(b):null;this.removed=!0}},A._getBBox=function(){if("none"==this.node.style.display){this.show();var a=!0}var b={};try{b=this.node.getBBox()}catch(c){}finally{b=b||{}}return a&&this.hide(),b},A.attr=function(b,d){if(this.removed)return this;if(null==b){var e={};for(var f in this.attrs)this.attrs[a](f)&&(e[f]=this.attrs[f]);return e.gradient&&"none"==e.fill&&(e.fill=e.gradient)&&delete e.gradient,e.transform=this._.transform,e}if(null==d&&c.is(b,"string")){if("fill"==b&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;if("transform"==b)return this._.transform;for(var g=b.split(j),h={},i=0,l=g.length;l>i;i++)b=g[i],h[b]=b in this.attrs?this.attrs[b]:c.is(this.paper.customAttributes[b],"function")?this.paper.customAttributes[b].def:c._availableAttrs[b];return l-1?h:h[g[0]]}if(null==d&&c.is(b,"array")){for(h={},i=0,l=b.length;l>i;i++)h[b[i]]=this.attr(b[i]);return h}if(null!=d){var m={};m[b]=d}else null!=b&&c.is(b,"object")&&(m=b);for(var n in m)k("raphael.attr."+n+"."+this.id,this,m[n]);for(n in this.paper.customAttributes)if(this.paper.customAttributes[a](n)&&m[a](n)&&c.is(this.paper.customAttributes[n],"function")){var o=this.paper.customAttributes[n].apply(this,[].concat(m[n]));this.attrs[n]=m[n];for(var p in o)o[a](p)&&(m[p]=o[p])}return w(this,m),this},A.toFront=function(){if(this.removed)return this;"a"==this.node.parentNode.tagName.toLowerCase()?this.node.parentNode.parentNode.appendChild(this.node.parentNode):this.node.parentNode.appendChild(this.node);var a=this.paper;return a.top!=this&&c._tofront(this,a),this},A.toBack=function(){if(this.removed)return this;var a=this.node.parentNode;"a"==a.tagName.toLowerCase()?a.parentNode.insertBefore(this.node.parentNode,this.node.parentNode.parentNode.firstChild):a.firstChild!=this.node&&a.insertBefore(this.node,this.node.parentNode.firstChild),c._toback(this,this.paper);this.paper;return this},A.insertAfter=function(a){if(this.removed)return this;var b=a.node||a[a.length-1].node;return b.nextSibling?b.parentNode.insertBefore(this.node,b.nextSibling):b.parentNode.appendChild(this.node),c._insertafter(this,a,this.paper),this},A.insertBefore=function(a){if(this.removed)return this;var b=a.node||a[0].node;return b.parentNode.insertBefore(this.node,b),c._insertbefore(this,a,this.paper),this},A.blur=function(a){var b=this;if(0!==+a){var d=q("filter"),e=q("feGaussianBlur");b.attrs.blur=a,d.id=c.createUUID(),q(e,{stdDeviation:+a||1.5}),d.appendChild(e),b.paper.defs.appendChild(d),b._blur=d,q(b.node,{filter:"url(#"+d.id+")"})}else b._blur&&(b._blur.parentNode.removeChild(b._blur),delete b._blur,delete b.attrs.blur),b.node.removeAttribute("filter");return b},c._engine.circle=function(a,b,c,d){var e=q("circle");a.canvas&&a.canvas.appendChild(e);var f=new z(e,a);return f.attrs={cx:b,cy:c,r:d,fill:"none",stroke:"#000"},f.type="circle",q(e,f.attrs),f},c._engine.rect=function(a,b,c,d,e,f){var g=q("rect");a.canvas&&a.canvas.appendChild(g);var h=new z(g,a);return h.attrs={x:b,y:c,width:d,height:e,r:f||0,rx:f||0,ry:f||0,fill:"none",stroke:"#000"},h.type="rect",q(g,h.attrs),h},c._engine.ellipse=function(a,b,c,d,e){var f=q("ellipse");a.canvas&&a.canvas.appendChild(f);var g=new z(f,a);return g.attrs={cx:b,cy:c,rx:d,ry:e,fill:"none",stroke:"#000"},g.type="ellipse",q(f,g.attrs),g},c._engine.image=function(a,b,c,d,e,f){var g=q("image");q(g,{x:c,y:d,width:e,height:f,preserveAspectRatio:"none"}),g.setAttributeNS(n,"href",b),a.canvas&&a.canvas.appendChild(g);var h=new z(g,a);return h.attrs={x:c,y:d,width:e,height:f,src:b},h.type="image",h},c._engine.text=function(a,b,d,e){var f=q("text");a.canvas&&a.canvas.appendChild(f);var g=new z(f,a);return g.attrs={x:b,y:d,"text-anchor":"middle",text:e,font:c._availableAttrs.font,stroke:"none",fill:"#000"},g.type="text",w(g,g.attrs),g},c._engine.setSize=function(a,b){return this.width=a||this.width,this.height=b||this.height,this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this._viewBox&&this.setViewBox.apply(this,this._viewBox),this},c._engine.create=function(){var a=c._getContainer.apply(0,arguments),b=a&&a.container,d=a.x,e=a.y,f=a.width,g=a.height;if(!b)throw new Error("SVG container not found.");var h,i=q("svg"),j="overflow:hidden;";return d=d||0,e=e||0,f=f||512,g=g||342,q(i,{height:g,version:1.1,width:f,xmlns:"http://www.w3.org/2000/svg"}),1==b?(i.style.cssText=j+"position:absolute;left:"+d+"px;top:"+e+"px",c._g.doc.body.appendChild(i),h=1):(i.style.cssText=j+"position:relative",b.firstChild?b.insertBefore(i,b.firstChild):b.appendChild(i)),b=new c._Paper,b.width=f,b.height=g,b.canvas=i,b.clear(),b._left=b._top=0,h&&(b.renderfix=function(){}),b.renderfix(),b},c._engine.setViewBox=function(a,b,c,d,e){k("raphael.setViewBox",this,this._viewBox,[a,b,c,d,e]);var f,h,i=g(c/this.width,d/this.height),j=this.top,l=e?"xMidYMid meet":"xMinYMin";for(null==a?(this._vbSize&&(i=1),delete this._vbSize,f="0 0 "+this.width+m+this.height):(this._vbSize=i,f=a+m+b+m+c+m+d),q(this.canvas,{viewBox:f,preserveAspectRatio:l});i&&j;)h="stroke-width"in j.attrs?j.attrs["stroke-width"]:1,j.attr({"stroke-width":h}),j._.dirty=1,j._.dirtyT=1,j=j.prev;return this._viewBox=[a,b,c,d,!!e],this},c.prototype.renderfix=function(){var a,b=this.canvas,c=b.style;try{a=b.getScreenCTM()||b.createSVGMatrix()}catch(d){a=b.createSVGMatrix()}var e=-a.e%1,f=-a.f%1;(e||f)&&(e&&(this._left=(this._left+e)%1,c.left=this._left+"px"),f&&(this._top=(this._top+f)%1,c.top=this._top+"px"))},c.prototype.clear=function(){c.eve("raphael.clear",this);for(var a=this.canvas;a.firstChild;)a.removeChild(a.firstChild);this.bottom=this.top=null,(this.desc=q("desc")).appendChild(c._g.doc.createTextNode("Created with Raphaël "+c.version)),a.appendChild(this.desc),a.appendChild(this.defs=q("defs"))},c.prototype.remove=function(){k("raphael.remove",this),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var a in this)this[a]="function"==typeof this[a]?c._removedFactory(a):null};var B=c.st;for(var C in A)A[a](C)&&!B[a](C)&&(B[C]=function(a){return function(){var b=arguments;return this.forEach(function(c){c[a].apply(c,b)})}}(C))}}(),function(){if(c.vml){var a="hasOwnProperty",b=String,d=parseFloat,e=Math,f=e.round,g=e.max,h=e.min,i=e.abs,j="fill",k=/[, ]+/,l=c.eve,m=" progid:DXImageTransform.Microsoft",n=" ",o="",p={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},q=/([clmz]),?([^clmz]*)/gi,r=/ progid:\S+Blur\([^\)]+\)/g,s=/-?[^,\s-]+/g,t="position:absolute;left:0;top:0;width:1px;height:1px",u=21600,v={path:1,rect:1,image:1},w={circle:1,ellipse:1},x=function(a){var d=/[ahqstv]/gi,e=c._pathToAbsolute;if(b(a).match(d)&&(e=c._path2curve),d=/[clmz]/g,e==c._pathToAbsolute&&!b(a).match(d)){var g=b(a).replace(q,function(a,b,c){var d=[],e="m"==b.toLowerCase(),g=p[b];return c.replace(s,function(a){e&&2==d.length&&(g+=d+p["m"==b?"l":"L"],d=[]),d.push(f(a*u))}),g+d});return g}var h,i,j=e(a);g=[];for(var k=0,l=j.length;l>k;k++){h=j[k],i=j[k][0].toLowerCase(),"z"==i&&(i="x");for(var m=1,r=h.length;r>m;m++)i+=f(h[m]*u)+(m!=r-1?",":o);g.push(i)}return g.join(n)},y=function(a,b,d){var e=c.matrix();return e.rotate(-a,.5,.5),{dx:e.x(b,d),dy:e.y(b,d)}},z=function(a,b,c,d,e,f){var g=a._,h=a.matrix,k=g.fillpos,l=a.node,m=l.style,o=1,p="",q=u/b,r=u/c;if(m.visibility="hidden",b&&c){if(l.coordsize=i(q)+n+i(r),m.rotation=f*(0>b*c?-1:1),f){var s=y(f,d,e);d=s.dx,e=s.dy}if(0>b&&(p+="x"),0>c&&(p+=" y")&&(o=-1),m.flip=p,l.coordorigin=d*-q+n+e*-r,k||g.fillsize){var t=l.getElementsByTagName(j);t=t&&t[0],l.removeChild(t),k&&(s=y(f,h.x(k[0],k[1]),h.y(k[0],k[1])),t.position=s.dx*o+n+s.dy*o),g.fillsize&&(t.size=g.fillsize[0]*i(b)+n+g.fillsize[1]*i(c)),l.appendChild(t)}m.visibility="visible"}};c.toString=function(){return"Your browser doesn’t support SVG. Falling down to VML.\nYou are running Raphaël "+this.version};var A=function(a,c,d){for(var e=b(c).toLowerCase().split("-"),f=d?"end":"start",g=e.length,h="classic",i="medium",j="medium";g--;)switch(e[g]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":h=e[g];break;case"wide":case"narrow":j=e[g];break;case"long":case"short":i=e[g]}var k=a.node.getElementsByTagName("stroke")[0];k[f+"arrow"]=h,k[f+"arrowlength"]=i,k[f+"arrowwidth"]=j},B=function(e,i){e.attrs=e.attrs||{};var l=e.node,m=e.attrs,p=l.style,q=v[e.type]&&(i.x!=m.x||i.y!=m.y||i.width!=m.width||i.height!=m.height||i.cx!=m.cx||i.cy!=m.cy||i.rx!=m.rx||i.ry!=m.ry||i.r!=m.r),r=w[e.type]&&(m.cx!=i.cx||m.cy!=i.cy||m.r!=i.r||m.rx!=i.rx||m.ry!=i.ry),s=e;for(var t in i)i[a](t)&&(m[t]=i[t]);if(q&&(m.path=c._getPath[e.type](e),e._.dirty=1),i.href&&(l.href=i.href),i.title&&(l.title=i.title),i.target&&(l.target=i.target),i.cursor&&(p.cursor=i.cursor),"blur"in i&&e.blur(i.blur),(i.path&&"path"==e.type||q)&&(l.path=x(~b(m.path).toLowerCase().indexOf("r")?c._pathToAbsolute(m.path):m.path),"image"==e.type&&(e._.fillpos=[m.x,m.y],e._.fillsize=[m.width,m.height],z(e,1,1,0,0,0))),"transform"in i&&e.transform(i.transform),r){var y=+m.cx,B=+m.cy,D=+m.rx||+m.r||0,E=+m.ry||+m.r||0;l.path=c.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",f((y-D)*u),f((B-E)*u),f((y+D)*u),f((B+E)*u),f(y*u)),e._.dirty=1}if("clip-rect"in i){var G=b(i["clip-rect"]).split(k);if(4==G.length){G[2]=+G[2]+ +G[0],G[3]=+G[3]+ +G[1];var H=l.clipRect||c._g.doc.createElement("div"),I=H.style;I.clip=c.format("rect({1}px {2}px {3}px {0}px)",G),l.clipRect||(I.position="absolute",I.top=0,I.left=0,I.width=e.paper.width+"px",I.height=e.paper.height+"px",l.parentNode.insertBefore(H,l),H.appendChild(l),l.clipRect=H)}i["clip-rect"]||l.clipRect&&(l.clipRect.style.clip="auto")}if(e.textpath){var J=e.textpath.style;i.font&&(J.font=i.font),i["font-family"]&&(J.fontFamily='"'+i["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,o)+'"'),i["font-size"]&&(J.fontSize=i["font-size"]),i["font-weight"]&&(J.fontWeight=i["font-weight"]),i["font-style"]&&(J.fontStyle=i["font-style"])}if("arrow-start"in i&&A(s,i["arrow-start"]),"arrow-end"in i&&A(s,i["arrow-end"],1),null!=i.opacity||null!=i["stroke-width"]||null!=i.fill||null!=i.src||null!=i.stroke||null!=i["stroke-width"]||null!=i["stroke-opacity"]||null!=i["fill-opacity"]||null!=i["stroke-dasharray"]||null!=i["stroke-miterlimit"]||null!=i["stroke-linejoin"]||null!=i["stroke-linecap"]){var K=l.getElementsByTagName(j),L=!1;if(K=K&&K[0],!K&&(L=K=F(j)),"image"==e.type&&i.src&&(K.src=i.src),i.fill&&(K.on=!0),(null==K.on||"none"==i.fill||null===i.fill)&&(K.on=!1),K.on&&i.fill){var M=b(i.fill).match(c._ISURL);if(M){K.parentNode==l&&l.removeChild(K),K.rotate=!0,K.src=M[1],K.type="tile";var N=e.getBBox(1);K.position=N.x+n+N.y,e._.fillpos=[N.x,N.y],c._preload(M[1],function(){e._.fillsize=[this.offsetWidth,this.offsetHeight]})}else K.color=c.getRGB(i.fill).hex,K.src=o,K.type="solid",c.getRGB(i.fill).error&&(s.type in{circle:1,ellipse:1}||"r"!=b(i.fill).charAt())&&C(s,i.fill,K)&&(m.fill="none",m.gradient=i.fill,K.rotate=!1)}if("fill-opacity"in i||"opacity"in i){var O=((+m["fill-opacity"]+1||2)-1)*((+m.opacity+1||2)-1)*((+c.getRGB(i.fill).o+1||2)-1);O=h(g(O,0),1),K.opacity=O,K.src&&(K.color="none")}l.appendChild(K);var P=l.getElementsByTagName("stroke")&&l.getElementsByTagName("stroke")[0],Q=!1;!P&&(Q=P=F("stroke")),(i.stroke&&"none"!=i.stroke||i["stroke-width"]||null!=i["stroke-opacity"]||i["stroke-dasharray"]||i["stroke-miterlimit"]||i["stroke-linejoin"]||i["stroke-linecap"])&&(P.on=!0),("none"==i.stroke||null===i.stroke||null==P.on||0==i.stroke||0==i["stroke-width"])&&(P.on=!1);var R=c.getRGB(i.stroke);P.on&&i.stroke&&(P.color=R.hex),O=((+m["stroke-opacity"]+1||2)-1)*((+m.opacity+1||2)-1)*((+R.o+1||2)-1);var S=.75*(d(i["stroke-width"])||1);if(O=h(g(O,0),1),null==i["stroke-width"]&&(S=m["stroke-width"]),i["stroke-width"]&&(P.weight=S),S&&1>S&&(O*=S)&&(P.weight=1),P.opacity=O,i["stroke-linejoin"]&&(P.joinstyle=i["stroke-linejoin"]||"miter"),P.miterlimit=i["stroke-miterlimit"]||8,i["stroke-linecap"]&&(P.endcap="butt"==i["stroke-linecap"]?"flat":"square"==i["stroke-linecap"]?"square":"round"),"stroke-dasharray"in i){var T={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};P.dashstyle=T[a](i["stroke-dasharray"])?T[i["stroke-dasharray"]]:o}Q&&l.appendChild(P)}if("text"==s.type){s.paper.canvas.style.display=o;var U=s.paper.span,V=100,W=m.font&&m.font.match(/\d+(?:\.\d*)?(?=px)/);p=U.style,m.font&&(p.font=m.font),m["font-family"]&&(p.fontFamily=m["font-family"]),m["font-weight"]&&(p.fontWeight=m["font-weight"]),m["font-style"]&&(p.fontStyle=m["font-style"]),W=d(m["font-size"]||W&&W[0])||10,p.fontSize=W*V+"px",s.textpath.string&&(U.innerHTML=b(s.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var X=U.getBoundingClientRect();s.W=m.w=(X.right-X.left)/V,s.H=m.h=(X.bottom-X.top)/V,s.X=m.x,s.Y=m.y+s.H/2,("x"in i||"y"in i)&&(s.path.v=c.format("m{0},{1}l{2},{1}",f(m.x*u),f(m.y*u),f(m.x*u)+1));for(var Y=["x","y","text","font","font-family","font-weight","font-style","font-size"],Z=0,$=Y.length;$>Z;Z++)if(Y[Z]in i){s._.dirty=1;break}switch(m["text-anchor"]){case"start":s.textpath.style["v-text-align"]="left",s.bbx=s.W/2;break;case"end":s.textpath.style["v-text-align"]="right",s.bbx=-s.W/2;break;default:s.textpath.style["v-text-align"]="center",s.bbx=0}s.textpath.style["v-text-kern"]=!0}},C=function(a,f,g){a.attrs=a.attrs||{};var h=(a.attrs,Math.pow),i="linear",j=".5 .5";if(a.attrs.gradient=f,f=b(f).replace(c._radial_gradient,function(a,b,c){return i="radial",b&&c&&(b=d(b),c=d(c),h(b-.5,2)+h(c-.5,2)>.25&&(c=e.sqrt(.25-h(b-.5,2))*(2*(c>.5)-1)+.5),j=b+n+c),o}),f=f.split(/\s*\-\s*/),"linear"==i){var k=f.shift();if(k=-d(k),isNaN(k))return null}var l=c._parseDots(f);if(!l)return null;if(a=a.shape||a.node,l.length){a.removeChild(g),g.on=!0,g.method="none",g.color=l[0].color,g.color2=l[l.length-1].color;for(var m=[],p=0,q=l.length;q>p;p++)l[p].offset&&m.push(l[p].offset+n+l[p].color);g.colors=m.length?m.join():"0% "+g.color,"radial"==i?(g.type="gradientTitle",g.focus="100%",g.focussize="0 0",g.focusposition=j,g.angle=0):(g.type="gradient",g.angle=(270-k)%360),a.appendChild(g)}return 1},D=function(a,b){this[0]=this.node=a,a.raphael=!0,this.id=c._oid++,a.raphaelid=this.id,this.X=0,this.Y=0,this.attrs={},this.paper=b,this.matrix=c.matrix(),this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1},!b.bottom&&(b.bottom=this),this.prev=b.top,b.top&&(b.top.next=this),b.top=this,this.next=null},E=c.el;D.prototype=E,E.constructor=D,E.transform=function(a){if(null==a)return this._.transform;var d,e=this.paper._viewBoxShift,f=e?"s"+[e.scale,e.scale]+"-1-1t"+[e.dx,e.dy]:o;e&&(d=a=b(a).replace(/\.{3}|\u2026/g,this._.transform||o)),c._extractTransform(this,f+a);var g,h=this.matrix.clone(),i=this.skew,j=this.node,k=~b(this.attrs.fill).indexOf("-"),l=!b(this.attrs.fill).indexOf("url(");if(h.translate(1,1),l||k||"image"==this.type)if(i.matrix="1 0 0 1",i.offset="0 0",g=h.split(),k&&g.noRotation||!g.isSimple){j.style.filter=h.toFilter();var m=this.getBBox(),p=this.getBBox(1),q=m.x-p.x,r=m.y-p.y;j.coordorigin=q*-u+n+r*-u,z(this,1,1,q,r,0)}else j.style.filter=o,z(this,g.scalex,g.scaley,g.dx,g.dy,g.rotate);else j.style.filter=o,i.matrix=b(h),i.offset=h.offset();return d&&(this._.transform=d),this},E.rotate=function(a,c,e){if(this.removed)return this;if(null!=a){if(a=b(a).split(k),a.length-1&&(c=d(a[1]),e=d(a[2])),a=d(a[0]),null==e&&(c=e),null==c||null==e){var f=this.getBBox(1);c=f.x+f.width/2,e=f.y+f.height/2}return this._.dirtyT=1,this.transform(this._.transform.concat([["r",a,c,e]])),this}},E.translate=function(a,c){return this.removed?this:(a=b(a).split(k),a.length-1&&(c=d(a[1])),a=d(a[0])||0,c=+c||0,this._.bbox&&(this._.bbox.x+=a,this._.bbox.y+=c),this.transform(this._.transform.concat([["t",a,c]])),this)},E.scale=function(a,c,e,f){if(this.removed)return this;if(a=b(a).split(k),a.length-1&&(c=d(a[1]),e=d(a[2]),f=d(a[3]),isNaN(e)&&(e=null),isNaN(f)&&(f=null)),a=d(a[0]),null==c&&(c=a),null==f&&(e=f),null==e||null==f)var g=this.getBBox(1);return e=null==e?g.x+g.width/2:e,f=null==f?g.y+g.height/2:f,this.transform(this._.transform.concat([["s",a,c,e,f]])),this._.dirtyT=1,this},E.hide=function(){return!this.removed&&(this.node.style.display="none"),this},E.show=function(){return!this.removed&&(this.node.style.display=o),this},E._getBBox=function(){return this.removed?{}:{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}},E.remove=function(){if(!this.removed&&this.node.parentNode){this.paper.__set__&&this.paper.__set__.exclude(this),c.eve.unbind("raphael.*.*."+this.id),c._tear(this,this.paper),this.node.parentNode.removeChild(this.node),this.shape&&this.shape.parentNode.removeChild(this.shape);for(var a in this)this[a]="function"==typeof this[a]?c._removedFactory(a):null;this.removed=!0}},E.attr=function(b,d){if(this.removed)return this;if(null==b){var e={};for(var f in this.attrs)this.attrs[a](f)&&(e[f]=this.attrs[f]);return e.gradient&&"none"==e.fill&&(e.fill=e.gradient)&&delete e.gradient,e.transform=this._.transform,e}if(null==d&&c.is(b,"string")){if(b==j&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;for(var g=b.split(k),h={},i=0,m=g.length;m>i;i++)b=g[i],h[b]=b in this.attrs?this.attrs[b]:c.is(this.paper.customAttributes[b],"function")?this.paper.customAttributes[b].def:c._availableAttrs[b];return m-1?h:h[g[0]]}if(this.attrs&&null==d&&c.is(b,"array")){for(h={},i=0,m=b.length;m>i;i++)h[b[i]]=this.attr(b[i]);return h}var n;null!=d&&(n={},n[b]=d),null==d&&c.is(b,"object")&&(n=b);for(var o in n)l("raphael.attr."+o+"."+this.id,this,n[o]);if(n){for(o in this.paper.customAttributes)if(this.paper.customAttributes[a](o)&&n[a](o)&&c.is(this.paper.customAttributes[o],"function")){var p=this.paper.customAttributes[o].apply(this,[].concat(n[o]));this.attrs[o]=n[o];for(var q in p)p[a](q)&&(n[q]=p[q])}n.text&&"text"==this.type&&(this.textpath.string=n.text),B(this,n)}return this},E.toFront=function(){return!this.removed&&this.node.parentNode.appendChild(this.node),this.paper&&this.paper.top!=this&&c._tofront(this,this.paper),this},E.toBack=function(){return this.removed?this:(this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),c._toback(this,this.paper)),this)},E.insertAfter=function(a){return this.removed?this:(a.constructor==c.st.constructor&&(a=a[a.length-1]),a.node.nextSibling?a.node.parentNode.insertBefore(this.node,a.node.nextSibling):a.node.parentNode.appendChild(this.node),c._insertafter(this,a,this.paper),this)},E.insertBefore=function(a){return this.removed?this:(a.constructor==c.st.constructor&&(a=a[0]),a.node.parentNode.insertBefore(this.node,a.node),c._insertbefore(this,a,this.paper),this)},E.blur=function(a){var b=this.node.runtimeStyle,d=b.filter;return d=d.replace(r,o),0!==+a?(this.attrs.blur=a,b.filter=d+n+m+".Blur(pixelradius="+(+a||1.5)+")",b.margin=c.format("-{0}px 0 0 -{0}px",f(+a||1.5))):(b.filter=d,b.margin=0,delete this.attrs.blur),this},c._engine.path=function(a,b){var c=F("shape");c.style.cssText=t,c.coordsize=u+n+u,c.coordorigin=b.coordorigin;var d=new D(c,b),e={fill:"none",stroke:"#000"};a&&(e.path=a),d.type="path",d.path=[],d.Path=o,B(d,e),b.canvas.appendChild(c);var f=F("skew");return f.on=!0,c.appendChild(f),d.skew=f,d.transform(o),d},c._engine.rect=function(a,b,d,e,f,g){var h=c._rectPath(b,d,e,f,g),i=a.path(h),j=i.attrs;return i.X=j.x=b,i.Y=j.y=d,i.W=j.width=e,i.H=j.height=f,j.r=g,j.path=h,i.type="rect",i},c._engine.ellipse=function(a,b,c,d,e){{var f=a.path();f.attrs}return f.X=b-d,f.Y=c-e,f.W=2*d,f.H=2*e,f.type="ellipse",B(f,{cx:b,cy:c,rx:d,ry:e}),f},c._engine.circle=function(a,b,c,d){{var e=a.path();e.attrs}return e.X=b-d,e.Y=c-d,e.W=e.H=2*d,e.type="circle",B(e,{cx:b,cy:c,r:d}),e},c._engine.image=function(a,b,d,e,f,g){var h=c._rectPath(d,e,f,g),i=a.path(h).attr({stroke:"none"}),k=i.attrs,l=i.node,m=l.getElementsByTagName(j)[0];return k.src=b,i.X=k.x=d,i.Y=k.y=e,i.W=k.width=f,i.H=k.height=g,k.path=h,i.type="image",m.parentNode==l&&l.removeChild(m),m.rotate=!0,m.src=b,m.type="tile",i._.fillpos=[d,e],i._.fillsize=[f,g],l.appendChild(m),z(i,1,1,0,0,0),i},c._engine.text=function(a,d,e,g){var h=F("shape"),i=F("path"),j=F("textpath");d=d||0,e=e||0,g=g||"",i.v=c.format("m{0},{1}l{2},{1}",f(d*u),f(e*u),f(d*u)+1),i.textpathok=!0,j.string=b(g),j.on=!0,h.style.cssText=t,h.coordsize=u+n+u,h.coordorigin="0 0";var k=new D(h,a),l={fill:"#000",stroke:"none",font:c._availableAttrs.font,text:g};k.shape=h,k.path=i,k.textpath=j,k.type="text",k.attrs.text=b(g),k.attrs.x=d,k.attrs.y=e,k.attrs.w=1,k.attrs.h=1,B(k,l),h.appendChild(j),h.appendChild(i),a.canvas.appendChild(h);var m=F("skew");return m.on=!0,h.appendChild(m),k.skew=m,k.transform(o),k},c._engine.setSize=function(a,b){var d=this.canvas.style;return this.width=a,this.height=b,a==+a&&(a+="px"),b==+b&&(b+="px"),d.width=a,d.height=b,d.clip="rect(0 "+a+" "+b+" 0)",this._viewBox&&c._engine.setViewBox.apply(this,this._viewBox),this},c._engine.setViewBox=function(a,b,d,e,f){c.eve("raphael.setViewBox",this,this._viewBox,[a,b,d,e,f]);var h,i,j=this.width,k=this.height,l=1/g(d/j,e/k);return f&&(h=k/e,i=j/d,j>d*h&&(a-=(j-d*h)/2/h),k>e*i&&(b-=(k-e*i)/2/i)),this._viewBox=[a,b,d,e,!!f],this._viewBoxShift={dx:-a,dy:-b,scale:l},this.forEach(function(a){a.transform("...")}),this};var F;c._engine.initWin=function(a){var b=a.document;b.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!b.namespaces.rvml&&b.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),F=function(a){return b.createElement("<rvml:"+a+' class="rvml">')}}catch(c){F=function(a){return b.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}},c._engine.initWin(c._g.win),c._engine.create=function(){var a=c._getContainer.apply(0,arguments),b=a.container,d=a.height,e=a.width,f=a.x,g=a.y;if(!b)throw new Error("VML container not found.");var h=new c._Paper,i=h.canvas=c._g.doc.createElement("div"),j=i.style;return f=f||0,g=g||0,e=e||512,d=d||342,h.width=e,h.height=d,e==+e&&(e+="px"),d==+d&&(d+="px"),h.coordsize=1e3*u+n+1e3*u,h.coordorigin="0 0",h.span=c._g.doc.createElement("span"),h.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;",i.appendChild(h.span),j.cssText=c.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",e,d),1==b?(c._g.doc.body.appendChild(i),j.left=f+"px",j.top=g+"px",j.position="absolute"):b.firstChild?b.insertBefore(i,b.firstChild):b.appendChild(i),h.renderfix=function(){},h},c.prototype.clear=function(){c.eve("raphael.clear",this),this.canvas.innerHTML=o,this.span=c._g.doc.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas.appendChild(this.span),this.bottom=this.top=null},c.prototype.remove=function(){c.eve("raphael.remove",this),this.canvas.parentNode.removeChild(this.canvas);for(var a in this)this[a]="function"==typeof this[a]?c._removedFactory(a):null;return!0};var G=c.st;for(var H in E)E[a](H)&&!G[a](H)&&(G[H]=function(a){return function(){var b=arguments;return this.forEach(function(c){c[a].apply(c,b)})}}(H))}}(),B.was?A.win.Raphael=c:Raphael=c,c}),function(a,b){"use strict";function c(a,b){for(var c,d=[],f=0;f<a.length;++f){if(c=g[a[f]]||e(a[f]),!c)throw"module definition dependecy not found: "+a[f];d.push(c)}b.apply(null,d)}function d(a,d,e){if("string"!=typeof a)throw"invalid module definition, module id must be defined and be a string";if(d===b)throw"invalid module definition, dependencies must be specified";if(e===b)throw"invalid module definition, definition function must be specified";c(d,function(){g[a]=e.apply(null,arguments)})}function e(b){for(var c=a,d=b.split(/[.\/]/),e=0;e<d.length;++e){if(!c[d[e]])return;c=c[d[e]]}return c}function f(c){for(var d=0;d<c.length;d++){for(var e=a,f=c[d],h=f.split(/[.\/]/),i=0;i<h.length-1;++i)e[h[i]]===b&&(e[h[i]]={}),e=e[h[i]];e[h[h.length-1]]=g[f]}}var g={};d("moxie/core/utils/Basic",[],function(){var a=function(a){var b;return a===b?"undefined":null===a?"null":a.nodeType?"node":{}.toString.call(a).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},b=function(d){var e;return c(arguments,function(f,h){h>0&&c(f,function(c,f){c!==e&&(a(d[f])===a(c)&&~g(a(c),["array","object"])?b(d[f],c):d[f]=c)})}),d},c=function(a,b){var c,d,e,f;if(a){try{c=a.length}catch(g){c=f}if(c===f){for(d in a)if(a.hasOwnProperty(d)&&b(a[d],d)===!1)return}else for(e=0;c>e;e++)if(b(a[e],e)===!1)return}},d=function(b){var c;if(!b||"object"!==a(b))return!0;for(c in b)return!1;return!0},e=function(b,c){function d(e){"function"===a(b[e])&&b[e](function(a){++e<f&&!a?d(e):c(a)})}var e=0,f=b.length;"function"!==a(c)&&(c=function(){}),b&&b.length||c(),d(e)},f=function(a,b){var d=0,e=a.length,f=new Array(e);c(a,function(a,c){a(function(a){if(a)return b(a);var g=[].slice.call(arguments);g.shift(),f[c]=g,d++,d===e&&(f.unshift(null),b.apply(this,f))})})},g=function(a,b){if(b){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(b,a);for(var c=0,d=b.length;d>c;c++)if(b[c]===a)return c}return-1},h=function(b,c){var d=[];"array"!==a(b)&&(b=[b]),"array"!==a(c)&&(c=[c]);for(var e in b)-1===g(b[e],c)&&d.push(b[e]);return d.length?d:!1},i=function(a,b){var d=[];return c(a,function(a){-1!==g(a,b)&&d.push(a)}),d.length?d:null},j=function(a){var b,c=[];for(b=0;b<a.length;b++)c[b]=a[b];return c},k=function(){var a=0;return function(b){var c,d=(new Date).getTime().toString(32);for(c=0;5>c;c++)d+=Math.floor(65535*Math.random()).toString(32);return(b||"o_")+d+(a++).toString(32)}}(),l=function(a){return a?String.prototype.trim?String.prototype.trim.call(a):a.toString().replace(/^\s*/,"").replace(/\s*$/,""):a},m=function(a){if("string"!=typeof a)return a;var b,c={t:1099511627776,g:1073741824,m:1048576,k:1024};return a=/^([0-9]+)([mgk]?)$/.exec(a.toLowerCase().replace(/[^0-9mkg]/g,"")),b=a[2],a=+a[1],c.hasOwnProperty(b)&&(a*=c[b]),a};return{guid:k,typeOf:a,extend:b,each:c,isEmptyObj:d,inSeries:e,inParallel:f,inArray:g,arrayDiff:h,arrayIntersect:i,toArray:j,trim:l,parseSizeStr:m}}),d("moxie/core/I18n",["moxie/core/utils/Basic"],function(a){var b={};return{addI18n:function(c){return a.extend(b,c)},translate:function(a){return b[a]||a},_:function(a){return this.translate(a)},sprintf:function(b){var c=[].slice.call(arguments,1);return b.replace(/%[a-z]/g,function(){var b=c.shift();return"undefined"!==a.typeOf(b)?b:""})}}}),d("moxie/core/utils/Mime",["moxie/core/utils/Basic","moxie/core/I18n"],function(a,b){var c="application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe",d={mimes:{},extensions:{},addMimeType:function(a){var b,c,d,e=a.split(/,/);for(b=0;b<e.length;b+=2){for(d=e[b+1].split(/ /),c=0;c<d.length;c++)this.mimes[d[c]]=e[b];this.extensions[e[b]]=d}},extList2mimes:function(b,c){var d,e,f,g,h=this,i=[];for(e=0;e<b.length;e++)for(d=b[e].extensions.split(/\s*,\s*/),f=0;f<d.length;f++){if("*"===d[f])return[];if(g=h.mimes[d[f]])-1===a.inArray(g,i)&&i.push(g);else{if(!c||!/^\w+$/.test(d[f]))return[];i.push("."+d[f])}}return i},mimes2exts:function(b){var c=this,d=[];return a.each(b,function(b){if("*"===b)return d=[],!1;var e=b.match(/^(\w+)\/(\*|\w+)$/);e&&("*"===e[2]?a.each(c.extensions,function(a,b){new RegExp("^"+e[1]+"/").test(b)&&[].push.apply(d,c.extensions[b])}):c.extensions[b]&&[].push.apply(d,c.extensions[b]))}),d},mimes2extList:function(c){var d=[],e=[];return"string"===a.typeOf(c)&&(c=a.trim(c).split(/\s*,\s*/)),e=this.mimes2exts(c),d.push({title:b.translate("Files"),extensions:e.length?e.join(","):"*"}),d.mimes=c,d},getFileExtension:function(a){var b=a&&a.match(/\.([^.]+)$/);return b?b[1].toLowerCase():""},getFileMime:function(a){return this.mimes[this.getFileExtension(a)]||""}};return d.addMimeType(c),d}),d("moxie/core/utils/Env",["moxie/core/utils/Basic"],function(a){function b(a,b,c){var d=0,e=0,f=0,g={dev:-6,alpha:-5,a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},h=function(a){return a=(""+a).replace(/[_\-+]/g,"."),a=a.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,"."),a.length?a.split("."):[-8]},i=function(a){return a?isNaN(a)?g[a]||-7:parseInt(a,10):0};for(a=h(a),b=h(b),e=Math.max(a.length,b.length),d=0;e>d;d++)if(a[d]!=b[d]){if(a[d]=i(a[d]),b[d]=i(b[d]),a[d]<b[d]){f=-1;break}if(a[d]>b[d]){f=1;break}}if(!c)return f;switch(c){case">":case"gt":return f>0;case">=":case"ge":return f>=0;case"<=":case"le":return 0>=f;case"==":case"=":case"eq":return 0===f;case"<>":case"!=":case"ne":return 0!==f;case"":case"<":case"lt":return 0>f;default:return null}}var c=function(a){var b="",c="?",d="function",e="undefined",f="object",g="major",h="name",i="version",j={has:function(a,b){return-1!==b.toLowerCase().indexOf(a.toLowerCase())},lowerize:function(a){return a.toLowerCase()}},k={rgx:function(){for(var b,c,g,h,i,j,k,l=0,m=arguments;l<m.length;l+=2){var n=m[l],o=m[l+1];if(typeof b===e){b={};for(h in o)i=o[h],typeof i===f?b[i[0]]=a:b[i]=a}for(c=g=0;c<n.length;c++)if(j=n[c].exec(this.getUA())){for(h=0;h<o.length;h++)k=j[++g],i=o[h],typeof i===f&&i.length>0?2==i.length?b[i[0]]=typeof i[1]==d?i[1].call(this,k):i[1]:3==i.length?b[i[0]]=typeof i[1]!==d||i[1].exec&&i[1].test?k?k.replace(i[1],i[2]):a:k?i[1].call(this,k,i[2]):a:4==i.length&&(b[i[0]]=k?i[3].call(this,k.replace(i[1],i[2])):a):b[i]=k?k:a;break}if(j)break}return b},str:function(b,d){for(var e in d)if(typeof d[e]===f&&d[e].length>0){for(var g=0;g<d[e].length;g++)if(j.has(d[e][g],b))return e===c?a:e}else if(j.has(d[e],b))return e===c?a:e;return b}},l={browser:{oldsafari:{major:{1:["/8","/1","/3"],2:"/4","?":"/"},version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",RT:"ARM"}}}},m={browser:[[/(opera\smini)\/((\d+)?[\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/((\d+)?[\w\.-]+)/i,/(opera).+version\/((\d+)?[\w\.]+)/i,/(opera)[\/\s]+((\d+)?[\w\.]+)/i],[h,i,g],[/\s(opr)\/((\d+)?[\w\.]+)/i],[[h,"Opera"],i,g],[/(kindle)\/((\d+)?[\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?((\d+)?[\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?((\d+)?[\w\.]*)/i,/(?:ms|\()(ie)\s((\d+)?[\w\.]+)/i,/(rekonq)((?:\/)[\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron)\/((\d+)?[\w\.-]+)/i],[h,i,g],[/(trident).+rv[:\s]((\d+)?[\w\.]+).+like\sgecko/i],[[h,"IE"],i,g],[/(yabrowser)\/((\d+)?[\w\.]+)/i],[[h,"Yandex"],i,g],[/(comodo_dragon)\/((\d+)?[\w\.]+)/i],[[h,/_/g," "],i,g],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?((\d+)?[\w\.]+)/i],[h,i,g],[/(dolfin)\/((\d+)?[\w\.]+)/i],[[h,"Dolphin"],i,g],[/((?:android.+)crmo|crios)\/((\d+)?[\w\.]+)/i],[[h,"Chrome"],i,g],[/((?:android.+))version\/((\d+)?[\w\.]+)\smobile\ssafari/i],[[h,"Android Browser"],i,g],[/version\/((\d+)?[\w\.]+).+?mobile\/\w+\s(safari)/i],[i,g,[h,"Mobile Safari"]],[/version\/((\d+)?[\w\.]+).+?(mobile\s?safari|safari)/i],[i,g,h],[/webkit.+?(mobile\s?safari|safari)((\/[\w\.]+))/i],[h,[g,k.str,l.browser.oldsafari.major],[i,k.str,l.browser.oldsafari.version]],[/(konqueror)\/((\d+)?[\w\.]+)/i,/(webkit|khtml)\/((\d+)?[\w\.]+)/i],[h,i,g],[/(navigator|netscape)\/((\d+)?[\w\.-]+)/i],[[h,"Netscape"],i,g],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?((\d+)?[\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/((\d+)?[\w\.-]+)/i,/(mozilla)\/((\d+)?[\w\.]+).+rv\:.+gecko\/\d+/i,/(uc\s?browser|polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|qqbrowser)[\/\s]?((\d+)?[\w\.]+)/i,/(links)\s\(((\d+)?[\w\.]+)/i,/(gobrowser)\/?((\d+)?[\w\.]+)*/i,/(ice\s?browser)\/v?((\d+)?[\w\._]+)/i,/(mosaic)[\/\s]((\d+)?[\w\.]+)/i],[h,i,g]],engine:[[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[h,i],[/rv\:([\w\.]+).*(gecko)/i],[i,h]],os:[[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[h,[i,k.str,l.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[h,"Windows"],[i,k.str,l.os.windows.version]],[/\((bb)(10);/i],[[h,"BlackBerry"],i],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)\/([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego)[\/\s-]?([\w\.]+)*/i],[h,i],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[h,"Symbian"],i],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[h,"Firefox OS"],i],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[h,i],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[h,"Chromium OS"],i],[/(sunos)\s?([\w\.]+\d)*/i],[[h,"Solaris"],i],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[h,i],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[h,"iOS"],[i,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i],[h,[i,/_/g,"."]],[/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(macintosh|mac(?=_powerpc)|plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos)/i,/(unix)\s?([\w\.]+)*/i],[h,i]]},n=function(a){var c=a||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:b);
this.getBrowser=function(){return k.rgx.apply(this,m.browser)},this.getEngine=function(){return k.rgx.apply(this,m.engine)},this.getOS=function(){return k.rgx.apply(this,m.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}},this.getUA=function(){return c},this.setUA=function(a){return c=a,this},this.setUA(c)};return(new n).getResult()}(),d=function(){var b={define_property:function(){return!1}(),create_canvas:function(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}(),return_response_type:function(b){try{if(-1!==a.inArray(b,["","text","document"]))return!0;if(window.XMLHttpRequest){var c=new XMLHttpRequest;if(c.open("get","/"),"responseType"in c)return c.responseType=b,c.responseType!==b?!1:!0}}catch(d){}return!1},use_data_uri:function(){var a=new Image;return a.onload=function(){b.use_data_uri=1===a.width&&1===a.height},setTimeout(function(){a.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1),!1}(),use_data_uri_over32kb:function(){return b.use_data_uri&&("IE"!==e.browser||e.version>=9)},use_data_uri_of:function(a){return b.use_data_uri&&33e3>a||b.use_data_uri_over32kb()},use_fileinput:function(){var a=document.createElement("input");return a.setAttribute("type","file"),!a.disabled}};return function(c){var d=[].slice.call(arguments);return d.shift(),"function"===a.typeOf(b[c])?b[c].apply(this,d):!!b[c]}}(),e={can:d,browser:c.browser.name,version:parseFloat(c.browser.major),os:c.os.name,osVersion:c.os.version,verComp:b,swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};return e.OS=e.os,e}),d("moxie/core/utils/Dom",["moxie/core/utils/Env"],function(a){var b=function(a){return"string"!=typeof a?a:document.getElementById(a)},c=function(a,b){if(!a.className)return!1;var c=new RegExp("(^|\\s+)"+b+"(\\s+|$)");return c.test(a.className)},d=function(a,b){c(a,b)||(a.className=a.className?a.className.replace(/\s+$/,"")+" "+b:b)},e=function(a,b){if(a.className){var c=new RegExp("(^|\\s+)"+b+"(\\s+|$)");a.className=a.className.replace(c,function(a,b,c){return" "===b&&" "===c?" ":""})}},f=function(a,b){return a.currentStyle?a.currentStyle[b]:window.getComputedStyle?window.getComputedStyle(a,null)[b]:void 0},g=function(b,c){function d(a){var b,c,d=0,e=0;return a&&(c=a.getBoundingClientRect(),b="CSS1Compat"===j.compatMode?j.documentElement:j.body,d=c.left+b.scrollLeft,e=c.top+b.scrollTop),{x:d,y:e}}var e,f,g,h=0,i=0,j=document;if(b=b,c=c||j.body,b&&b.getBoundingClientRect&&"IE"===a.browser&&(!j.documentMode||j.documentMode<8))return f=d(b),g=d(c),{x:f.x-g.x,y:f.y-g.y};for(e=b;e&&e!=c&&e.nodeType;)h+=e.offsetLeft||0,i+=e.offsetTop||0,e=e.offsetParent;for(e=b.parentNode;e&&e!=c&&e.nodeType;)h-=e.scrollLeft||0,i-=e.scrollTop||0,e=e.parentNode;return{x:h,y:i}},h=function(a){return{w:a.offsetWidth||a.clientWidth,h:a.offsetHeight||a.clientHeight}};return{get:b,hasClass:c,addClass:d,removeClass:e,getStyle:f,getPos:g,getSize:h}}),d("moxie/core/Exceptions",["moxie/core/utils/Basic"],function(a){function b(a,b){var c;for(c in a)if(a[c]===b)return c;return null}return{RuntimeError:function(){function c(a){this.code=a,this.name=b(d,a),this.message=this.name+": RuntimeError "+this.code}var d={NOT_INIT_ERR:1,NOT_SUPPORTED_ERR:9,JS_ERR:4};return a.extend(c,d),c.prototype=Error.prototype,c}(),OperationNotAllowedException:function(){function b(a){this.code=a,this.name="OperationNotAllowedException"}return a.extend(b,{NOT_ALLOWED_ERR:1}),b.prototype=Error.prototype,b}(),ImageError:function(){function c(a){this.code=a,this.name=b(d,a),this.message=this.name+": ImageError "+this.code}var d={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2};return a.extend(c,d),c.prototype=Error.prototype,c}(),FileException:function(){function c(a){this.code=a,this.name=b(d,a),this.message=this.name+": FileException "+this.code}var d={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,INVALID_STATE_ERR:7,SYNTAX_ERR:8};return a.extend(c,d),c.prototype=Error.prototype,c}(),DOMException:function(){function c(a){this.code=a,this.name=b(d,a),this.message=this.name+": DOMException "+this.code}var d={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};return a.extend(c,d),c.prototype=Error.prototype,c}(),EventException:function(){function b(a){this.code=a,this.name="EventException"}return a.extend(b,{UNSPECIFIED_EVENT_TYPE_ERR:0}),b.prototype=Error.prototype,b}()}}),d("moxie/core/EventTarget",["moxie/core/Exceptions","moxie/core/utils/Basic"],function(a,b){function c(){var c={};b.extend(this,{uid:null,init:function(){this.uid||(this.uid=b.guid("uid_"))},addEventListener:function(a,d,e,f){var g,h=this;return a=b.trim(a),/\s/.test(a)?void b.each(a.split(/\s+/),function(a){h.addEventListener(a,d,e,f)}):(a=a.toLowerCase(),e=parseInt(e,10)||0,g=c[this.uid]&&c[this.uid][a]||[],g.push({fn:d,priority:e,scope:f||this}),c[this.uid]||(c[this.uid]={}),void(c[this.uid][a]=g))},hasEventListener:function(a){return a?!(!c[this.uid]||!c[this.uid][a]):!!c[this.uid]},removeEventListener:function(a,d){a=a.toLowerCase();var e,f=c[this.uid]&&c[this.uid][a];if(f){if(d){for(e=f.length-1;e>=0;e--)if(f[e].fn===d){f.splice(e,1);break}}else f=[];f.length||(delete c[this.uid][a],b.isEmptyObj(c[this.uid])&&delete c[this.uid])}},removeAllEventListeners:function(){c[this.uid]&&delete c[this.uid]},dispatchEvent:function(d){var e,f,g,h,i,j={},k=!0;if("string"!==b.typeOf(d)){if(h=d,"string"!==b.typeOf(h.type))throw new a.EventException(a.EventException.UNSPECIFIED_EVENT_TYPE_ERR);d=h.type,h.total!==i&&h.loaded!==i&&(j.total=h.total,j.loaded=h.loaded),j.async=h.async||!1}if(-1!==d.indexOf("::")?!function(a){e=a[0],d=a[1]}(d.split("::")):e=this.uid,d=d.toLowerCase(),f=c[e]&&c[e][d]){f.sort(function(a,b){return b.priority-a.priority}),g=[].slice.call(arguments),g.shift(),j.type=d,g.unshift(j);var l=[];b.each(f,function(a){g[0].target=a.scope,l.push(j.async?function(b){setTimeout(function(){b(a.fn.apply(a.scope,g)===!1)},1)}:function(b){b(a.fn.apply(a.scope,g)===!1)})}),l.length&&b.inSeries(l,function(a){k=!a})}return k},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},trigger:function(){return this.dispatchEvent.apply(this,arguments)},convertEventPropsToHandlers:function(a){var c;"array"!==b.typeOf(a)&&(a=[a]);for(var d=0;d<a.length;d++)c="on"+a[d],"function"===b.typeOf(this[c])?this.addEventListener(a[d],this[c]):"undefined"===b.typeOf(this[c])&&(this[c]=null)}})}return c.instance=new c,c}),d("moxie/core/utils/Encode",[],function(){var a=function(a){return unescape(encodeURIComponent(a))},b=function(a){return decodeURIComponent(escape(a))},c=function(a,c){if("function"==typeof window.atob)return c?b(window.atob(a)):window.atob(a);var d,e,f,g,h,i,j,k,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",m=0,n=0,o="",p=[];if(!a)return a;a+="";do g=l.indexOf(a.charAt(m++)),h=l.indexOf(a.charAt(m++)),i=l.indexOf(a.charAt(m++)),j=l.indexOf(a.charAt(m++)),k=g<<18|h<<12|i<<6|j,d=k>>16&255,e=k>>8&255,f=255&k,p[n++]=64==i?String.fromCharCode(d):64==j?String.fromCharCode(d,e):String.fromCharCode(d,e,f);while(m<a.length);return o=p.join(""),c?b(o):o},d=function(b,c){if(c&&a(b),"function"==typeof window.btoa)return window.btoa(b);var d,e,f,g,h,i,j,k,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",m=0,n=0,o="",p=[];if(!b)return b;do d=b.charCodeAt(m++),e=b.charCodeAt(m++),f=b.charCodeAt(m++),k=d<<16|e<<8|f,g=k>>18&63,h=k>>12&63,i=k>>6&63,j=63&k,p[n++]=l.charAt(g)+l.charAt(h)+l.charAt(i)+l.charAt(j);while(m<b.length);o=p.join("");var q=b.length%3;return(q?o.slice(0,q-3):o)+"===".slice(q||3)};return{utf8_encode:a,utf8_decode:b,atob:c,btoa:d}}),d("moxie/runtime/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/EventTarget"],function(a,b,c){function d(c,e,g,h,i){var j,k=this,l=a.guid(e+"_"),m=i||"browser";c=c||{},f[l]=this,g=a.extend({access_binary:!1,access_image_binary:!1,display_media:!1,do_cors:!1,drag_and_drop:!1,filter_by_extension:!0,resize_image:!1,report_upload_progress:!1,return_response_headers:!1,return_response_type:!1,return_status_code:!0,send_custom_headers:!1,select_file:!1,select_folder:!1,select_multiple:!0,send_binary_string:!1,send_browser_cookies:!0,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:!0,use_http_method:!0},g),c.preferred_caps&&(m=d.getMode(h,c.preferred_caps,m)),j=function(){var b={};return{exec:function(a,c,d,e){return j[c]&&(b[a]||(b[a]={context:this,instance:new j[c]}),b[a].instance[d])?b[a].instance[d].apply(this,e):void 0},removeInstance:function(a){delete b[a]},removeAllInstances:function(){var c=this;a.each(b,function(b,d){"function"===a.typeOf(b.instance.destroy)&&b.instance.destroy.call(b.context),c.removeInstance(d)})}}}(),a.extend(this,{initialized:!1,uid:l,type:e,mode:d.getMode(h,c.required_caps,m),shimid:l+"_container",clients:0,options:c,can:function(b,c){var e=arguments[2]||g;if("string"===a.typeOf(b)&&"undefined"===a.typeOf(c)&&(b=d.parseCaps(b)),"object"===a.typeOf(b)){for(var f in b)if(!this.can(f,b[f],e))return!1;return!0}return"function"===a.typeOf(e[b])?e[b].call(this,c):c===e[b]},getShimContainer:function(){var c,d=b.get(this.shimid);return d||(c=this.options.container?b.get(this.options.container):document.body,d=document.createElement("div"),d.id=this.shimid,d.className="moxie-shim moxie-shim-"+this.type,a.extend(d.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),c.appendChild(d),c=null),d},getShim:function(){return j},shimExec:function(a,b){var c=[].slice.call(arguments,2);return k.getShim().exec.call(this,this.uid,a,b,c)},exec:function(a,b){var c=[].slice.call(arguments,2);return k[a]&&k[a][b]?k[a][b].apply(this,c):k.shimExec.apply(this,arguments)},destroy:function(){if(k){var a=b.get(this.shimid);a&&a.parentNode.removeChild(a),j&&j.removeAllInstances(),this.unbindAll(),delete f[this.uid],this.uid=null,l=k=j=a=null}}}),this.mode&&c.required_caps&&!this.can(c.required_caps)&&(this.mode=!1)}var e={},f={};return d.order="html5,flash,silverlight,html4",d.getRuntime=function(a){return f[a]?f[a]:!1},d.addConstructor=function(a,b){b.prototype=c.instance,e[a]=b},d.getConstructor=function(a){return e[a]||null},d.getInfo=function(a){var b=d.getRuntime(a);return b?{uid:b.uid,type:b.type,mode:b.mode,can:function(){return b.can.apply(b,arguments)}}:null},d.parseCaps=function(b){var c={};return"string"!==a.typeOf(b)?b||{}:(a.each(b.split(","),function(a){c[a]=!0}),c)},d.can=function(a,b){var c,e,f=d.getConstructor(a);return f?(c=new f({required_caps:b}),e=c.mode,c.destroy(),!!e):!1},d.thatCan=function(a,b){var c=(b||d.order).split(/\s*,\s*/);for(var e in c)if(d.can(c[e],a))return c[e];return null},d.getMode=function(b,c,d){var e=null;if("undefined"===a.typeOf(d)&&(d="browser"),c&&!a.isEmptyObj(b)){if(a.each(c,function(c,d){if(b.hasOwnProperty(d)){var f=b[d](c);if("string"==typeof f&&(f=[f]),e){if(!(e=a.arrayIntersect(e,f)))return e=!1}else e=f}}),e)return-1!==a.inArray(d,e)?d:e[0];if(e===!1)return!1}return d},d.capTrue=function(){return!0},d.capFalse=function(){return!1},d.capTest=function(a){return function(){return!!a}},d}),d("moxie/runtime/RuntimeClient",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/Runtime"],function(a,b,c){return function(){var d;b.extend(this,{connectRuntime:function(e){function f(b){var g,i;return b.length?(g=b.shift(),(i=c.getConstructor(g))?(d=new i(e),d.bind("Init",function(){d.initialized=!0,setTimeout(function(){d.clients++,h.trigger("RuntimeInit",d)},1)}),d.bind("Error",function(){d.destroy(),f(b)}),d.mode?void d.init():void d.trigger("Error")):void f(b)):(h.trigger("RuntimeError",new a.RuntimeError(a.RuntimeError.NOT_INIT_ERR)),void(d=null))}var g,h=this;if("string"===b.typeOf(e)?g=e:"string"===b.typeOf(e.ruid)&&(g=e.ruid),g){if(d=c.getRuntime(g))return d.clients++,d;throw new a.RuntimeError(a.RuntimeError.NOT_INIT_ERR)}f((e.runtime_order||c.order).split(/\s*,\s*/))},getRuntime:function(){return d&&d.uid?d:(d=null,null)},disconnectRuntime:function(){d&&--d.clients<=0&&(d.destroy(),d=null)}})}}),d("moxie/file/Blob",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient"],function(a,b,c){function d(f,g){function h(b,c,f){var g,h=e[this.uid];return"string"===a.typeOf(h)&&h.length?(g=new d(null,{type:f,size:c-b}),g.detach(h.substr(b,g.size)),g):null}c.call(this),f&&this.connectRuntime(f),g?"string"===a.typeOf(g)&&(g={data:g}):g={},a.extend(this,{uid:g.uid||a.guid("uid_"),ruid:f,size:g.size||0,type:g.type||"",slice:function(a,b,c){return this.isDetached()?h.apply(this,arguments):this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),a,b,c)},getSource:function(){return e[this.uid]?e[this.uid]:null},detach:function(a){this.ruid&&(this.getRuntime().exec.call(this,"Blob","destroy"),this.disconnectRuntime(),this.ruid=null),a=a||"";var c=a.match(/^data:([^;]*);base64,/);c&&(this.type=c[1],a=b.atob(a.substring(a.indexOf("base64,")+7))),this.size=a.length,e[this.uid]=a},isDetached:function(){return!this.ruid&&"string"===a.typeOf(e[this.uid])},destroy:function(){this.detach(),delete e[this.uid]}}),g.data?this.detach(g.data):e[this.uid]=g}var e={};return d}),d("moxie/file/File",["moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/file/Blob"],function(a,b,c){function d(d,e){var f,g;if(e||(e={}),g=e.type&&""!==e.type?e.type:b.getFileMime(e.name),e.name)f=e.name.replace(/\\/g,"/"),f=f.substr(f.lastIndexOf("/")+1);else{var h=g.split("/")[0];f=a.guid((""!==h?h:"file")+"_"),b.extensions[g]&&(f+="."+b.extensions[g][0])}c.apply(this,arguments),a.extend(this,{type:g||"",name:f||a.guid("file_"),lastModifiedDate:e.lastModifiedDate||(new Date).toLocaleString()})}return d.prototype=c.prototype,d}),d("moxie/file/FileInput",["moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/EventTarget","moxie/core/I18n","moxie/file/File","moxie/runtime/Runtime","moxie/runtime/RuntimeClient"],function(a,b,c,d,e,f,g,h,i){function j(e){var j,l,m,n=this;if(-1!==a.inArray(a.typeOf(e),["string","node"])&&(e={browse_button:e}),l=c.get(e.browse_button),!l)throw new d.DOMException(d.DOMException.NOT_FOUND_ERR);m={accept:[{title:f.translate("All Files"),extensions:"*"}],name:"file",multiple:!1,required_caps:!1,container:l.parentNode||document.body},e=a.extend({},m,e),"string"==typeof e.required_caps&&(e.required_caps=h.parseCaps(e.required_caps)),"string"==typeof e.accept&&(e.accept=b.mimes2extList(e.accept)),j=c.get(e.container),j||(j=document.body),"static"===c.getStyle(j,"position")&&(j.style.position="relative"),j=l=null,i.call(n),a.extend(n,{uid:a.guid("uid_"),ruid:null,shimid:null,files:null,init:function(){n.convertEventPropsToHandlers(k),n.bind("RuntimeInit",function(b,d){n.ruid=d.uid,n.shimid=d.shimid,n.bind("Ready",function(){n.trigger("Refresh")},999),n.bind("Change",function(){var b=d.exec.call(n,"FileInput","getFiles");n.files=[],a.each(b,function(a){return 0===a.size?!0:void n.files.push(new g(n.ruid,a))})},999),n.bind("Refresh",function(){var b,f,g,h;g=c.get(e.browse_button),h=c.get(d.shimid),g&&(b=c.getPos(g,c.get(e.container)),f=c.getSize(g),h&&a.extend(h.style,{top:b.y+"px",left:b.x+"px",width:f.w+"px",height:f.h+"px"})),h=g=null}),d.exec.call(n,"FileInput","init",e)}),n.connectRuntime(a.extend({},e,{required_caps:{select_file:!0}}))},disable:function(b){var c=this.getRuntime();c&&c.exec.call(this,"FileInput","disable","undefined"===a.typeOf(b)?!0:b)},refresh:function(){n.trigger("Refresh")},destroy:function(){var b=this.getRuntime();b&&(b.exec.call(this,"FileInput","destroy"),this.disconnectRuntime()),"array"===a.typeOf(this.files)&&a.each(this.files,function(a){a.destroy()}),this.files=null}})}var k=["ready","change","cancel","mouseenter","mouseleave","mousedown","mouseup"];return j.prototype=e.instance,j}),d("moxie/file/FileDrop",["moxie/core/I18n","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/utils/Basic","moxie/file/File","moxie/runtime/RuntimeClient","moxie/core/EventTarget","moxie/core/utils/Mime"],function(a,b,c,d,e,f,g,h){function i(c){var g,i=this;"string"==typeof c&&(c={drop_zone:c}),g={accept:[{title:a.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:!0}},c="object"==typeof c?d.extend({},g,c):g,c.container=b.get(c.drop_zone)||document.body,"static"===b.getStyle(c.container,"position")&&(c.container.style.position="relative"),"string"==typeof c.accept&&(c.accept=h.mimes2extList(c.accept)),f.call(i),d.extend(i,{uid:d.guid("uid_"),ruid:null,files:null,init:function(){i.convertEventPropsToHandlers(j),i.bind("RuntimeInit",function(a,b){i.ruid=b.uid,i.bind("Drop",function(){var a=b.exec.call(i,"FileDrop","getFiles");i.files=[],d.each(a,function(a){i.files.push(new e(i.ruid,a))})},999),b.exec.call(i,"FileDrop","init",c),i.dispatchEvent("ready")}),i.connectRuntime(c)},destroy:function(){var a=this.getRuntime();a&&(a.exec.call(this,"FileDrop","destroy"),this.disconnectRuntime()),this.files=null}})}var j=["ready","dragenter","dragleave","drop","error"];return i.prototype=g.instance,i}),d("moxie/runtime/RuntimeTarget",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(a,b,c){function d(){this.uid=a.guid("uid_"),b.call(this),this.destroy=function(){this.disconnectRuntime(),this.unbindAll()}}return d.prototype=c.instance,d}),d("moxie/file/FileReader",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/core/Exceptions","moxie/core/EventTarget","moxie/file/Blob","moxie/file/File","moxie/runtime/RuntimeTarget"],function(a,b,c,d,e,f,g){function h(){function d(a,d){function k(a){j.readyState=h.DONE,j.error=a,j.trigger("error"),l()}function l(){f.destroy(),f=null,j.trigger("loadend")}function m(b){f.bind("Error",function(a,b){k(b)}),f.bind("Progress",function(a){j.result=b.exec.call(f,"FileReader","getResult"),j.trigger(a)}),f.bind("Load",function(a){j.readyState=h.DONE,j.result=b.exec.call(f,"FileReader","getResult"),j.trigger(a),l()}),b.exec.call(f,"FileReader","read",a,d)}if(f=new g,this.convertEventPropsToHandlers(i),this.readyState===h.LOADING)return k(new c.DOMException(c.DOMException.INVALID_STATE_ERR));if(this.readyState=h.LOADING,this.trigger("loadstart"),d instanceof e)if(d.isDetached()){var n=d.getSource();switch(a){case"readAsText":case"readAsBinaryString":this.result=n;break;case"readAsDataURL":this.result="data:"+d.type+";base64,"+b.btoa(n)}this.readyState=h.DONE,this.trigger("load"),l()}else m(f.connectRuntime(d.ruid));else k(new c.DOMException(c.DOMException.NOT_FOUND_ERR))}var f,j=this;a.extend(this,{uid:a.guid("uid_"),readyState:h.EMPTY,result:null,error:null,readAsBinaryString:function(a){d.call(this,"readAsBinaryString",a)},readAsDataURL:function(a){d.call(this,"readAsDataURL",a)},readAsText:function(a){d.call(this,"readAsText",a)},abort:function(){this.result=null,-1===a.inArray(this.readyState,[h.EMPTY,h.DONE])&&(this.readyState===h.LOADING&&(this.readyState=h.DONE),f&&f.getRuntime().exec.call(this,"FileReader","abort"),this.trigger("abort"),this.trigger("loadend"))},destroy:function(){this.abort(),f&&(f.getRuntime().exec.call(this,"FileReader","destroy"),f.disconnectRuntime()),j=f=null}})}var i=["loadstart","progress","load","abort","error","loadend"];return h.EMPTY=0,h.LOADING=1,h.DONE=2,h.prototype=d.instance,h}),d("moxie/core/utils/Url",[],function(){var a=function(b,c){for(var d=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"],e=d.length,f={http:80,https:443},g={},h=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,i=h.exec(b||"");e--;)i[e]&&(g[d[e]]=i[e]);if(!g.scheme){c&&"string"!=typeof c||(c=a(c||document.location.href)),g.scheme=c.scheme,g.host=c.host,g.port=c.port;var j="";/^[^\/]/.test(g.path)&&(j=c.path,/(\/|\/[^\.]+)$/.test(j)?j+="/":j=j.replace(/\/[^\/]+$/,"/")),g.path=j+(g.path||"")}return g.port||(g.port=f[g.scheme]||80),g.port=parseInt(g.port,10),g.path||(g.path="/"),delete g.source,g},b=function(b){var c={http:80,https:443},d=a(b);return d.scheme+"://"+d.host+(d.port!==c[d.scheme]?":"+d.port:"")+d.path+(d.query?d.query:"")},c=function(b){function c(a){return[a.scheme,a.host,a.port].join("/")}return"string"==typeof b&&(b=a(b)),c(a())===c(b)};return{parseUrl:a,resolveUrl:b,hasSameOrigin:c}}),d("moxie/file/FileReaderSync",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/utils/Encode"],function(a,b,c){return function(){function d(a,b){if(!b.isDetached()){var d=this.connectRuntime(b.ruid).exec.call(this,"FileReaderSync","read",a,b);return this.disconnectRuntime(),d}var e=b.getSource();switch(a){case"readAsBinaryString":return e;case"readAsDataURL":return"data:"+b.type+";base64,"+c.btoa(e);case"readAsText":for(var f="",g=0,h=e.length;h>g;g++)f+=String.fromCharCode(e[g]);return f}}b.call(this),a.extend(this,{uid:a.guid("uid_"),readAsBinaryString:function(a){return d.call(this,"readAsBinaryString",a)},readAsDataURL:function(a){return d.call(this,"readAsDataURL",a)},readAsText:function(a){return d.call(this,"readAsText",a)}})}}),d("moxie/xhr/FormData",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/file/Blob"],function(a,b,c){function d(){var a,d=[];b.extend(this,{append:function(e,f){var g=this,h=b.typeOf(f);f instanceof c?a={name:e,value:f}:"array"===h?(e+="[]",b.each(f,function(a){g.append(e,a)})):"object"===h?b.each(f,function(a,b){g.append(e+"["+b+"]",a)}):"null"===h||"undefined"===h||"number"===h&&isNaN(f)?g.append(e,"false"):d.push({name:e,value:f.toString()})},hasBlob:function(){return!!this.getBlob()},getBlob:function(){return a&&a.value||null},getBlobName:function(){return a&&a.name||null},each:function(c){b.each(d,function(a){c(a.value,a.name)}),a&&c(a.value,a.name)},destroy:function(){a=null,d=[]}})}return d}),d("moxie/xhr/XMLHttpRequest",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/core/EventTarget","moxie/core/utils/Encode","moxie/core/utils/Url","moxie/runtime/Runtime","moxie/runtime/RuntimeTarget","moxie/file/Blob","moxie/file/FileReaderSync","moxie/xhr/FormData","moxie/core/utils/Env","moxie/core/utils/Mime"],function(a,b,c,d,e,f,g,h,i,j,k,l){function m(){this.uid=a.guid("uid_")}function n(){function c(a,b){return A.hasOwnProperty(a)?1===arguments.length?k.can("define_property")?A[a]:z[a]:void(k.can("define_property")?A[a]=b:z[a]=b):void 0}function i(b){function d(){x&&(x.destroy(),x=null),h.dispatchEvent("loadend"),h=null}function e(e){x.bind("LoadStart",function(a){c("readyState",n.LOADING),h.dispatchEvent("readystatechange"),h.dispatchEvent(a),H&&h.upload.dispatchEvent(a)}),x.bind("Progress",function(a){c("readyState")!==n.LOADING&&(c("readyState",n.LOADING),h.dispatchEvent("readystatechange")),h.dispatchEvent(a)}),x.bind("UploadProgress",function(a){H&&h.upload.dispatchEvent({type:"progress",lengthComputable:!1,total:a.total,loaded:a.loaded})}),x.bind("Load",function(b){c("readyState",n.DONE),c("status",Number(e.exec.call(x,"XMLHttpRequest","getStatus")||0)),c("statusText",o[c("status")]||""),c("response",e.exec.call(x,"XMLHttpRequest","getResponse",c("responseType"))),~a.inArray(c("responseType"),["text",""])?c("responseText",c("response")):"document"===c("responseType")&&c("responseXML",c("response")),O=e.exec.call(x,"XMLHttpRequest","getAllResponseHeaders"),h.dispatchEvent("readystatechange"),c("status")>0?(H&&h.upload.dispatchEvent(b),h.dispatchEvent(b)):(J=!0,h.dispatchEvent("error")),d()}),x.bind("Abort",function(a){h.dispatchEvent(a),d()}),x.bind("Error",function(a){J=!0,c("readyState",n.DONE),h.dispatchEvent("readystatechange"),I=!0,h.dispatchEvent(a),d()}),e.exec.call(x,"XMLHttpRequest","send",{url:r,method:s,async:B,user:t,password:u,headers:C,mimeType:E,encoding:D,responseType:h.responseType,withCredentials:h.withCredentials,options:N},b)}var h=this;v=(new Date).getTime(),x=new g,"string"==typeof N.required_caps&&(N.required_caps=f.parseCaps(N.required_caps)),N.required_caps=a.extend({},N.required_caps,{return_response_type:h.responseType}),b instanceof j&&(N.required_caps.send_multipart=!0),K||(N.required_caps.do_cors=!0),N.ruid?e(x.connectRuntime(N)):(x.bind("RuntimeInit",function(a,b){e(b)}),x.bind("RuntimeError",function(a,b){h.dispatchEvent("RuntimeError",b)}),x.connectRuntime(N))}function q(){c("responseText",""),c("responseXML",null),c("response",null),c("status",0),c("statusText",""),v=w=null}var r,s,t,u,v,w,x,y,z=this,A={timeout:0,readyState:n.UNSENT,withCredentials:!1,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},B=!0,C={},D=null,E=null,F=!1,G=!1,H=!1,I=!1,J=!1,K=!1,L=null,M=null,N={},O="";a.extend(this,A,{uid:a.guid("uid_"),upload:new m,open:function(f,g,h,i,j){var k;if(!f||!g)throw new b.DOMException(b.DOMException.SYNTAX_ERR);if(/[\u0100-\uffff]/.test(f)||d.utf8_encode(f)!==f)throw new b.DOMException(b.DOMException.SYNTAX_ERR);if(~a.inArray(f.toUpperCase(),["CONNECT","DELETE","GET","HEAD","OPTIONS","POST","PUT","TRACE","TRACK"])&&(s=f.toUpperCase()),~a.inArray(s,["CONNECT","TRACE","TRACK"]))throw new b.DOMException(b.DOMException.SECURITY_ERR);if(g=d.utf8_encode(g),k=e.parseUrl(g),K=e.hasSameOrigin(k),r=e.resolveUrl(g),(i||j)&&!K)throw new b.DOMException(b.DOMException.INVALID_ACCESS_ERR);if(t=i||k.user,u=j||k.pass,B=h||!0,B===!1&&(c("timeout")||c("withCredentials")||""!==c("responseType")))throw new b.DOMException(b.DOMException.INVALID_ACCESS_ERR);F=!B,G=!1,C={},q.call(this),c("readyState",n.OPENED),this.convertEventPropsToHandlers(["readystatechange"]),this.dispatchEvent("readystatechange")},setRequestHeader:function(e,f){var g=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"];if(c("readyState")!==n.OPENED||G)throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);if(/[\u0100-\uffff]/.test(e)||d.utf8_encode(e)!==e)throw new b.DOMException(b.DOMException.SYNTAX_ERR);return e=a.trim(e).toLowerCase(),~a.inArray(e,g)||/^(proxy\-|sec\-)/.test(e)?!1:(C[e]?C[e]+=", "+f:C[e]=f,!0)},getAllResponseHeaders:function(){return O||""},getResponseHeader:function(b){return b=b.toLowerCase(),J||~a.inArray(b,["set-cookie","set-cookie2"])?null:O&&""!==O&&(y||(y={},a.each(O.split(/\r\n/),function(b){var c=b.split(/:\s+/);2===c.length&&(c[0]=a.trim(c[0]),y[c[0].toLowerCase()]={header:c[0],value:a.trim(c[1])})})),y.hasOwnProperty(b))?y[b].header+": "+y[b].value:null},overrideMimeType:function(d){var e,f;if(~a.inArray(c("readyState"),[n.LOADING,n.DONE]))throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);if(d=a.trim(d.toLowerCase()),/;/.test(d)&&(e=d.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))&&(d=e[1],e[2]&&(f=e[2])),!l.mimes[d])throw new b.DOMException(b.DOMException.SYNTAX_ERR);L=d,M=f},send:function(c,e){if(N="string"===a.typeOf(e)?{ruid:e}:e?e:{},this.convertEventPropsToHandlers(p),this.upload.convertEventPropsToHandlers(p),this.readyState!==n.OPENED||G)throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);if(c instanceof h)N.ruid=c.ruid,E=c.type||"application/octet-stream";else if(c instanceof j){if(c.hasBlob()){var f=c.getBlob();N.ruid=f.ruid,E=f.type||"application/octet-stream"}}else"string"==typeof c&&(D="UTF-8",E="text/plain;charset=UTF-8",c=d.utf8_encode(c));this.withCredentials||(this.withCredentials=N.required_caps&&N.required_caps.send_browser_cookies&&!K),H=!F&&this.upload.hasEventListener(),J=!1,I=!c,F||(G=!0),i.call(this,c)},abort:function(){if(J=!0,F=!1,~a.inArray(c("readyState"),[n.UNSENT,n.OPENED,n.DONE]))c("readyState",n.UNSENT);else{if(c("readyState",n.DONE),G=!1,!x)throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);x.getRuntime().exec.call(x,"XMLHttpRequest","abort",I),I=!0}},destroy:function(){x&&("function"===a.typeOf(x.destroy)&&x.destroy(),x=null),this.unbindAll(),this.upload&&(this.upload.unbindAll(),this.upload=null)}})}var o={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};m.prototype=c.instance;var p=["loadstart","progress","abort","error","load","timeout","loadend"];return n.UNSENT=0,n.OPENED=1,n.HEADERS_RECEIVED=2,n.LOADING=3,n.DONE=4,n.prototype=c.instance,n}),d("moxie/runtime/Transporter",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(a,b,c,d){function e(){function d(){k=l=0,j=this.result=null}function f(b,c){var d=this;i=c,d.bind("TransportingProgress",function(b){l=b.loaded,k>l&&-1===a.inArray(d.state,[e.IDLE,e.DONE])&&g.call(d)},999),d.bind("TransportingComplete",function(){l=k,d.state=e.DONE,j=null,d.result=i.exec.call(d,"Transporter","getAsBlob",b||"")},999),d.state=e.BUSY,d.trigger("TransportingStarted"),g.call(d)}function g(){var a,c=this,d=k-l;m>d&&(m=d),a=b.btoa(j.substr(l,m)),i.exec.call(c,"Transporter","receive",a,k)}var h,i,j,k,l,m;c.call(this),a.extend(this,{uid:a.guid("uid_"),state:e.IDLE,result:null,transport:function(b,c,e){var g=this;if(e=a.extend({chunk_size:204798},e),(h=e.chunk_size%3)&&(e.chunk_size+=3-h),m=e.chunk_size,d.call(this),j=b,k=b.length,"string"===a.typeOf(e)||e.ruid)f.call(g,c,this.connectRuntime(e));else{var i=function(a,b){g.unbind("RuntimeInit",i),f.call(g,c,b)};this.bind("RuntimeInit",i),this.connectRuntime(e)}},abort:function(){var a=this;a.state=e.IDLE,i&&(i.exec.call(a,"Transporter","clear"),a.trigger("TransportingAborted")),d.call(a)},destroy:function(){this.unbindAll(),i=null,this.disconnectRuntime(),d.call(this)}})}return e.IDLE=0,e.BUSY=1,e.DONE=2,e.prototype=d.instance,e}),d("moxie/image/Image",["moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/file/FileReaderSync","moxie/xhr/XMLHttpRequest","moxie/runtime/Runtime","moxie/runtime/RuntimeClient","moxie/runtime/Transporter","moxie/core/utils/Env","moxie/core/EventTarget","moxie/file/Blob","moxie/file/File","moxie/core/utils/Encode"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){function d(a){a||(a=this.getRuntime().exec.call(this,"Image","getInfo")),this.size=a.size,this.width=a.width,this.height=a.height,this.type=a.type,this.meta=a.meta,""===this.name&&(this.name=a.name)
}function j(b){var d=a.typeOf(b);try{if(b instanceof n){if(!b.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);p.apply(this,arguments)}else if(b instanceof k){if(!~a.inArray(b.type,["image/jpeg","image/png"]))throw new c.ImageError(c.ImageError.WRONG_FORMAT);q.apply(this,arguments)}else if(-1!==a.inArray(d,["blob","file"]))j.call(this,new l(null,b),arguments[1]);else if("string"===d)/^data:[^;]*;base64,/.test(b)?j.call(this,new k(null,{data:b}),arguments[1]):r.apply(this,arguments);else{if("node"!==d||"img"!==b.nodeName.toLowerCase())throw new c.DOMException(c.DOMException.TYPE_MISMATCH_ERR);j.call(this,b.src,arguments[1])}}catch(e){this.trigger("error",e.code)}}function p(b,c){var d=this.connectRuntime(b.ruid);this.ruid=d.uid,d.exec.call(this,"Image","loadFromImage",b,"undefined"===a.typeOf(c)?!0:c)}function q(b,c){function d(a){e.ruid=a.uid,a.exec.call(e,"Image","loadFromBlob",b)}var e=this;e.name=b.name||"",b.isDetached()?(this.bind("RuntimeInit",function(a,b){d(b)}),c&&"string"==typeof c.required_caps&&(c.required_caps=f.parseCaps(c.required_caps)),this.connectRuntime(a.extend({required_caps:{access_image_binary:!0,resize_image:!0}},c))):d(this.connectRuntime(b.ruid))}function r(a,b){var c,d=this;c=new e,c.open("get",a),c.responseType="blob",c.onprogress=function(a){d.trigger(a)},c.onload=function(){q.call(d,c.response,!0)},c.onerror=function(a){d.trigger(a)},c.onloadend=function(){c.destroy()},c.bind("RuntimeError",function(a,b){d.trigger("RuntimeError",b)}),c.send(null,b)}g.call(this),a.extend(this,{uid:a.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){this.bind("Load Resize",function(){d.call(this)},999),this.convertEventPropsToHandlers(o),j.apply(this,arguments)},downsize:function(b){var d={width:this.width,height:this.height,crop:!1,preserveHeaders:!0};b="object"==typeof b?a.extend(d,b):a.extend(d,{width:arguments[0],height:arguments[1],crop:arguments[2],preserveHeaders:arguments[3]});try{if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);if(this.width>n.MAX_RESIZE_WIDTH||this.height>n.MAX_RESIZE_HEIGHT)throw new c.ImageError(c.ImageError.MAX_RESOLUTION_ERR);this.getRuntime().exec.call(this,"Image","downsize",b.width,b.height,b.crop,b.preserveHeaders)}catch(e){this.trigger("error",e.code)}},crop:function(a,b,c){this.downsize(a,b,!0,c)},getAsCanvas:function(){if(!i.can("create_canvas"))throw new c.RuntimeError(c.RuntimeError.NOT_SUPPORTED_ERR);var a=this.connectRuntime(this.ruid);return a.exec.call(this,"Image","getAsCanvas")},getAsBlob:function(a,b){if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);return a||(a="image/jpeg"),"image/jpeg"!==a||b||(b=90),this.getRuntime().exec.call(this,"Image","getAsBlob",a,b)},getAsDataURL:function(a,b){if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);return this.getRuntime().exec.call(this,"Image","getAsDataURL",a,b)},getAsBinaryString:function(a,b){var c=this.getAsDataURL(a,b);return m.atob(c.substring(c.indexOf("base64,")+7))},embed:function(d){function e(){if(i.can("create_canvas")){var b=f.getAsCanvas();if(b)return d.appendChild(b),b=null,f.destroy(),void o.trigger("embedded")}var e=f.getAsDataURL(g,j);if(!e)throw new c.ImageError(c.ImageError.WRONG_FORMAT);if(i.can("use_data_uri_of",e.length))d.innerHTML='<img src="'+e+'" width="'+f.width+'" height="'+f.height+'" />',f.destroy(),o.trigger("embedded");else{var k=new h;k.bind("TransportingComplete",function(){l=o.connectRuntime(this.result.ruid),o.bind("Embedded",function(){a.extend(l.getShimContainer().style,{top:"0px",left:"0px",width:f.width+"px",height:f.height+"px"}),l=null},999),l.exec.call(o,"ImageView","display",this.result.uid,q,r),f.destroy()}),k.transport(m.atob(e.substring(e.indexOf("base64,")+7)),g,a.extend({},p,{required_caps:{display_media:!0},runtime_order:"flash,silverlight",container:d}))}}var f,g,j,k,l,o=this,p=arguments[1]||{},q=this.width,r=this.height;try{if(!(d=b.get(d)))throw new c.DOMException(c.DOMException.INVALID_NODE_TYPE_ERR);if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);if(this.width>n.MAX_RESIZE_WIDTH||this.height>n.MAX_RESIZE_HEIGHT)throw new c.ImageError(c.ImageError.MAX_RESOLUTION_ERR);if(g=p.type||this.type||"image/jpeg",j=p.quality||90,k="undefined"!==a.typeOf(p.crop)?p.crop:!1,p.width)q=p.width,r=p.height||q;else{var s=b.getSize(d);s.w&&s.h&&(q=s.w,r=s.h)}return f=new n,f.bind("Resize",function(){e.call(o)}),f.bind("Load",function(){f.downsize(q,r,k,!1)}),f.clone(this,!1),f}catch(t){this.trigger("error",t.code)}},destroy:function(){this.ruid&&(this.getRuntime().exec.call(this,"Image","destroy"),this.disconnectRuntime()),this.unbindAll()}})}var o=["progress","load","error","resize","embedded"];return n.MAX_RESIZE_WIDTH=6500,n.MAX_RESIZE_HEIGHT=6500,n.prototype=j.instance,n}),d("moxie/runtime/html5/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(a,b,c,d){function e(b){var e=this,h=c.capTest,i=c.capTrue,j=a.extend({access_binary:h(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return e.can("access_binary")&&!!g.Image},display_media:h(d.can("create_canvas")||d.can("use_data_uri_over32kb")),do_cors:h(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),drag_and_drop:h(function(){var a=document.createElement("div");return("draggable"in a||"ondragstart"in a&&"ondrop"in a)&&("IE"!==d.browser||d.version>9)}()),filter_by_extension:h(function(){return"Chrome"===d.browser&&d.version>=28||"IE"===d.browser&&d.version>=10}()),return_response_headers:i,return_response_type:function(a){return"json"===a&&window.JSON?!0:d.can("return_response_type",a)},return_status_code:i,report_upload_progress:h(window.XMLHttpRequest&&(new XMLHttpRequest).upload),resize_image:function(){return e.can("access_binary")&&d.can("create_canvas")},select_file:function(){return d.can("use_fileinput")&&window.File},select_folder:function(){return e.can("select_file")&&"Chrome"===d.browser&&d.version>=21},select_multiple:function(){return!(!e.can("select_file")||"Safari"===d.browser&&"Windows"===d.os||"iOS"===d.os&&d.verComp(d.osVersion,"7.0.4","<"))},send_binary_string:h(window.XMLHttpRequest&&((new XMLHttpRequest).sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:h(window.XMLHttpRequest),send_multipart:function(){return!!(window.XMLHttpRequest&&(new XMLHttpRequest).upload&&window.FormData)||e.can("send_binary_string")},slice_blob:h(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return e.can("slice_blob")&&e.can("send_multipart")},summon_file_dialog:h(function(){return"Firefox"===d.browser&&d.version>=4||"Opera"===d.browser&&d.version>=12||"IE"===d.browser&&d.version>=10||!!~a.inArray(d.browser,["Chrome","Safari"])}()),upload_filesize:i},arguments[2]);c.call(this,b,arguments[1]||f,j),a.extend(this,{init:function(){this.trigger("Init")},destroy:function(a){return function(){a.call(e),a=e=null}}(this.destroy)}),a.extend(this.getShim(),g)}var f="html5",g={};return c.addConstructor(f,e),g}),d("moxie/runtime/html5/file/Blob",["moxie/runtime/html5/Runtime","moxie/file/Blob"],function(a,b){function c(){function a(a,b,c){var d;if(!window.File.prototype.slice)return(d=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)?d.call(a,b,c):null;try{return a.slice(),a.slice(b,c)}catch(e){return a.slice(b,c-b)}}this.slice=function(){return new b(this.getRuntime().uid,a.apply(this,arguments))}}return a.Blob=c}),d("moxie/core/utils/Events",["moxie/core/utils/Basic"],function(a){function b(){this.returnValue=!1}function c(){this.cancelBubble=!0}var d={},e="moxie_"+a.guid(),f=function(f,g,h,i){var j,k;g=g.toLowerCase(),f.addEventListener?(j=h,f.addEventListener(g,j,!1)):f.attachEvent&&(j=function(){var a=window.event;a.target||(a.target=a.srcElement),a.preventDefault=b,a.stopPropagation=c,h(a)},f.attachEvent("on"+g,j)),f[e]||(f[e]=a.guid()),d.hasOwnProperty(f[e])||(d[f[e]]={}),k=d[f[e]],k.hasOwnProperty(g)||(k[g]=[]),k[g].push({func:j,orig:h,key:i})},g=function(b,c,f){var g,h;if(c=c.toLowerCase(),b[e]&&d[b[e]]&&d[b[e]][c]){g=d[b[e]][c];for(var i=g.length-1;i>=0&&(g[i].orig!==f&&g[i].key!==f||(b.removeEventListener?b.removeEventListener(c,g[i].func,!1):b.detachEvent&&b.detachEvent("on"+c,g[i].func),g[i].orig=null,g[i].func=null,g.splice(i,1),f===h));i--);if(g.length||delete d[b[e]][c],a.isEmptyObj(d[b[e]])){delete d[b[e]];try{delete b[e]}catch(j){b[e]=h}}}},h=function(b,c){b&&b[e]&&a.each(d[b[e]],function(a,d){g(b,d,c)})};return{addEvent:f,removeEvent:g,removeAllEvents:h}}),d("moxie/runtime/html5/file/FileInput",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime","moxie/core/utils/Env"],function(a,b,c,d,e,f){function g(){var a,g=[];b.extend(this,{init:function(h){var i,j,k,l,m,n,o=this,p=o.getRuntime();a=h,g=[],k=a.accept.mimes||e.extList2mimes(a.accept,p.can("filter_by_extension")),j=p.getShimContainer(),j.innerHTML='<input id="'+p.uid+'" type="file" style="font-size:999px;opacity:0;"'+(a.multiple&&p.can("select_multiple")?"multiple":"")+(a.directory&&p.can("select_folder")?"webkitdirectory directory":"")+(k?' accept="'+k.join(",")+'"':"")+" />",i=c.get(p.uid),b.extend(i.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),l=c.get(a.browse_button),p.can("summon_file_dialog")?("static"===c.getStyle(l,"position")&&(l.style.position="relative"),m=parseInt(c.getStyle(l,"z-index"),10)||1,l.style.zIndex=m,j.style.zIndex=m-1,d.addEvent(l,"click",function(a){var b=c.get(p.uid);b&&!b.disabled&&b.click(),a.preventDefault()},o.uid)):d.addEvent(l,"click",function(a){var b=c.get(p.uid);b&&!b.disabled&&b.click(),a.preventDefault()},o.uid),n=p.can("summon_file_dialog")?l:j,d.addEvent(n,"mouseover",function(){o.trigger("mouseenter")},o.uid),d.addEvent(n,"mouseout",function(){o.trigger("mouseleave")},o.uid),d.addEvent(n,"mousedown",function(){o.trigger("mousedown")},o.uid),d.addEvent(c.get(a.container),"mouseup",function(){o.trigger("mouseup")},o.uid),i.onchange=function q(){if(g=[],a.directory?b.each(this.files,function(a){"."!==a.name&&g.push(a)}):g=[].slice.call(this.files),"IE"!==f.browser&&"IEMobile"!==f.browser)this.value="";else{var c=this.cloneNode(!0);this.parentNode.replaceChild(c,this),c.onchange=q}o.trigger("change")},o.trigger({type:"ready",async:!0}),j=null},getFiles:function(){return g},disable:function(a){var b,d=this.getRuntime();(b=c.get(d.uid))&&(b.disabled=!!a)},destroy:function(){var b=this.getRuntime(),e=b.getShim(),f=b.getShimContainer();d.removeAllEvents(f,this.uid),d.removeAllEvents(a&&c.get(a.container),this.uid),d.removeAllEvents(a&&c.get(a.browse_button),this.uid),f&&(f.innerHTML=""),e.removeInstance(this.uid),g=a=f=e=null}})}return a.FileInput=g}),d("moxie/runtime/html5/file/FileDrop",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime"],function(a,b,c,d,e){function f(){function a(a){if(!a.dataTransfer||!a.dataTransfer.types)return!1;var c=b.toArray(a.dataTransfer.types||[]);return-1!==b.inArray("Files",c)||-1!==b.inArray("public.file-url",c)||-1!==b.inArray("application/x-moz-file",c)}function f(a){for(var c=[],d=0;d<a.length;d++)[].push.apply(c,a[d].extensions.split(/\s*,\s*/));return-1===b.inArray("*",c)?c:[]}function g(a){if(!n.length)return!0;var c=e.getFileExtension(a.name);return!c||-1!==b.inArray(c,n)}function h(a,c){var d=[];b.each(a,function(a){var b=a.webkitGetAsEntry();if(b)if(b.isFile){var c=a.getAsFile();g(c)&&m.push(c)}else d.push(b)}),d.length?i(d,c):c()}function i(a,c){var d=[];b.each(a,function(a){d.push(function(b){j(a,b)})}),b.inSeries(d,function(){c()})}function j(a,b){a.isFile?a.file(function(a){g(a)&&m.push(a),b()},function(){b()}):a.isDirectory?k(a,b):b()}function k(a,b){function c(a){e.readEntries(function(b){b.length?([].push.apply(d,b),c(a)):a()},a)}var d=[],e=a.createReader();c(function(){i(d,b)})}var l,m=[],n=[];b.extend(this,{init:function(c){var e,i=this;l=c,n=f(l.accept),e=l.container,d.addEvent(e,"dragover",function(b){a(b)&&(b.preventDefault(),b.dataTransfer.dropEffect="copy")},i.uid),d.addEvent(e,"drop",function(c){a(c)&&(c.preventDefault(),m=[],c.dataTransfer.items&&c.dataTransfer.items[0].webkitGetAsEntry?h(c.dataTransfer.items,function(){i.trigger("drop")}):(b.each(c.dataTransfer.files,function(a){g(a)&&m.push(a)}),i.trigger("drop")))},i.uid),d.addEvent(e,"dragenter",function(){i.trigger("dragenter")},i.uid),d.addEvent(e,"dragleave",function(){i.trigger("dragleave")},i.uid)},getFiles:function(){return m},destroy:function(){d.removeAllEvents(l&&c.get(l.container),this.uid),m=n=l=null}})}return a.FileDrop=f}),d("moxie/runtime/html5/file/FileReader",["moxie/runtime/html5/Runtime","moxie/core/utils/Encode","moxie/core/utils/Basic"],function(a,b,c){function d(){function a(a){return b.atob(a.substring(a.indexOf("base64,")+7))}var d,e=!1;c.extend(this,{read:function(a,b){var f=this;d=new window.FileReader,d.addEventListener("progress",function(a){f.trigger(a)}),d.addEventListener("load",function(a){f.trigger(a)}),d.addEventListener("error",function(a){f.trigger(a,d.error)}),d.addEventListener("loadend",function(){d=null}),"function"===c.typeOf(d[a])?(e=!1,d[a](b.getSource())):"readAsBinaryString"===a&&(e=!0,d.readAsDataURL(b.getSource()))},getResult:function(){return d&&d.result?e?a(d.result):d.result:null},abort:function(){d&&d.abort()},destroy:function(){d=null}})}return a.FileReader=d}),d("moxie/runtime/html5/xhr/XMLHttpRequest",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/core/utils/Url","moxie/file/File","moxie/file/Blob","moxie/xhr/FormData","moxie/core/Exceptions","moxie/core/utils/Env"],function(a,b,c,d,e,f,g,h,i){function j(){function a(a,b){var c,d,e=this;c=b.getBlob().getSource(),d=new window.FileReader,d.onload=function(){b.append(b.getBlobName(),new f(null,{type:c.type,data:d.result})),o.send.call(e,a,b)},d.readAsBinaryString(c)}function j(){return!window.XMLHttpRequest||"IE"===i.browser&&i.version<8?function(){for(var a=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"],b=0;b<a.length;b++)try{return new ActiveXObject(a[b])}catch(c){}}():new window.XMLHttpRequest}function k(a){var b=a.responseXML,c=a.responseText;return"IE"===i.browser&&c&&b&&!b.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(a.getResponseHeader("Content-Type"))&&(b=new window.ActiveXObject("Microsoft.XMLDOM"),b.async=!1,b.validateOnParse=!1,b.loadXML(c)),b&&("IE"===i.browser&&0!==b.parseError||!b.documentElement||"parsererror"===b.documentElement.tagName)?null:b}function l(a){var b="----moxieboundary"+(new Date).getTime(),c="--",d="\r\n",e="",g=this.getRuntime();if(!g.can("send_binary_string"))throw new h.RuntimeError(h.RuntimeError.NOT_SUPPORTED_ERR);return m.setRequestHeader("Content-Type","multipart/form-data; boundary="+b),a.each(function(a,g){e+=a instanceof f?c+b+d+'Content-Disposition: form-data; name="'+g+'"; filename="'+unescape(encodeURIComponent(a.name||"blob"))+'"'+d+"Content-Type: "+(a.type||"application/octet-stream")+d+d+a.getSource()+d:c+b+d+'Content-Disposition: form-data; name="'+g+'"'+d+d+unescape(encodeURIComponent(a))+d}),e+=c+b+c+d}var m,n,o=this;b.extend(this,{send:function(c,e){var h=this,k="Mozilla"===i.browser&&i.version>=4&&i.version<7,o="Android Browser"===i.browser,p=!1;if(n=c.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase(),m=j(),m.open(c.method,c.url,c.async,c.user,c.password),e instanceof f)e.isDetached()&&(p=!0),e=e.getSource();else if(e instanceof g){if(e.hasBlob())if(e.getBlob().isDetached())e=l.call(h,e),p=!0;else if((k||o)&&"blob"===b.typeOf(e.getBlob().getSource())&&window.FileReader)return void a.call(h,c,e);if(e instanceof g){var q=new window.FormData;e.each(function(a,b){a instanceof f?q.append(b,a.getSource()):q.append(b,a)}),e=q}}m.upload?(c.withCredentials&&(m.withCredentials=!0),m.addEventListener("load",function(a){h.trigger(a)}),m.addEventListener("error",function(a){h.trigger(a)}),m.addEventListener("progress",function(a){h.trigger(a)}),m.upload.addEventListener("progress",function(a){h.trigger({type:"UploadProgress",loaded:a.loaded,total:a.total})})):m.onreadystatechange=function(){switch(m.readyState){case 1:break;case 2:break;case 3:var a,b;try{d.hasSameOrigin(c.url)&&(a=m.getResponseHeader("Content-Length")||0),m.responseText&&(b=m.responseText.length)}catch(e){a=b=0}h.trigger({type:"progress",lengthComputable:!!a,total:parseInt(a,10),loaded:b});break;case 4:m.onreadystatechange=function(){},h.trigger(0===m.status?"error":"load")}},b.isEmptyObj(c.headers)||b.each(c.headers,function(a,b){m.setRequestHeader(b,a)}),""!==c.responseType&&"responseType"in m&&(m.responseType="json"!==c.responseType||i.can("return_response_type","json")?c.responseType:"text"),p?m.sendAsBinary?m.sendAsBinary(e):!function(){for(var a=new Uint8Array(e.length),b=0;b<e.length;b++)a[b]=255&e.charCodeAt(b);m.send(a.buffer)}():m.send(e),h.trigger("loadstart")},getStatus:function(){try{if(m)return m.status}catch(a){}return 0},getResponse:function(a){var b=this.getRuntime();try{switch(a){case"blob":var d=new e(b.uid,m.response),f=m.getResponseHeader("Content-Disposition");if(f){var g=f.match(/filename=([\'\"'])([^\1]+)\1/);g&&(n=g[2])}return d.name=n,d.type||(d.type=c.getFileMime(n)),d;case"json":return i.can("return_response_type","json")?m.response:200===m.status&&window.JSON?JSON.parse(m.responseText):null;case"document":return k(m);default:return""!==m.responseText?m.responseText:null}}catch(h){return null}},getAllResponseHeaders:function(){try{return m.getAllResponseHeaders()}catch(a){}return""},abort:function(){m&&m.abort()},destroy:function(){o=n=null}})}return a.XMLHttpRequest=j}),d("moxie/runtime/html5/utils/BinaryReader",[],function(){return function(){function a(a,b){var c,d=f?0:-8*(b-1),g=0;for(c=0;b>c;c++)g|=e.charCodeAt(a+c)<<Math.abs(d+8*c);return g}function c(a,b,c){c=3===arguments.length?c:e.length-b-1,e=e.substr(0,b)+a+e.substr(c+b)}function d(a,b,d){var e,g="",h=f?0:-8*(d-1);for(e=0;d>e;e++)g+=String.fromCharCode(b>>Math.abs(h+8*e)&255);c(g,a,d)}var e,f=!1;return{II:function(a){return a===b?f:void(f=a)},init:function(a){f=!1,e=a},SEGMENT:function(a,b,d){switch(arguments.length){case 1:return e.substr(a,e.length-a-1);case 2:return e.substr(a,b);case 3:c(d,a,b);break;default:return e}},BYTE:function(b){return a(b,1)},SHORT:function(b){return a(b,2)},LONG:function(c,e){return e===b?a(c,4):void d(c,e,4)},SLONG:function(b){var c=a(b,4);return c>2147483647?c-4294967296:c},STRING:function(b,c){var d="";for(c+=b;c>b;b++)d+=String.fromCharCode(a(b,1));return d}}}}),d("moxie/runtime/html5/image/JPEGHeaders",["moxie/runtime/html5/utils/BinaryReader"],function(a){return function b(c){var d,e,f,g=[],h=0;if(d=new a,d.init(c),65496===d.SHORT(0)){for(e=2;e<=c.length;)if(f=d.SHORT(e),f>=65488&&65495>=f)e+=2;else{if(65498===f||65497===f)break;h=d.SHORT(e+2)+2,f>=65505&&65519>=f&&g.push({hex:f,name:"APP"+(15&f),start:e,length:h,segment:d.SEGMENT(e,h)}),e+=h}return d.init(null),{headers:g,restore:function(a){var b,c;for(d.init(a),e=65504==d.SHORT(2)?4+d.SHORT(4):2,c=0,b=g.length;b>c;c++)d.SEGMENT(e,0,g[c].segment),e+=g[c].length;return a=d.SEGMENT(),d.init(null),a},strip:function(a){var c,e,f;for(e=new b(a),c=e.headers,e.purge(),d.init(a),f=c.length;f--;)d.SEGMENT(c[f].start,c[f].length,"");return a=d.SEGMENT(),d.init(null),a},get:function(a){for(var b=[],c=0,d=g.length;d>c;c++)g[c].name===a.toUpperCase()&&b.push(g[c].segment);return b},set:function(a,b){var c,d,e,f=[];for("string"==typeof b?f.push(b):f=b,c=d=0,e=g.length;e>c&&(g[c].name===a.toUpperCase()&&(g[c].segment=f[d],g[c].length=f[d].length,d++),!(d>=f.length));c++);},purge:function(){g=[],d.init(null),d=null}}}}}),d("moxie/runtime/html5/image/ExifParser",["moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(a,c){return function(){function d(a,c){var d,e,f,h,i,l,m,n,o=g.SHORT(a),p=[],q={};for(d=0;o>d;d++)if(m=l=a+12*d+2,f=c[g.SHORT(m)],f!==b){switch(h=g.SHORT(m+=2),i=g.LONG(m+=2),m+=4,p=[],h){case 1:case 7:for(i>4&&(m=g.LONG(m)+k.tiffHeader),e=0;i>e;e++)p[e]=g.BYTE(m+e);break;case 2:i>4&&(m=g.LONG(m)+k.tiffHeader),q[f]=g.STRING(m,i-1);continue;case 3:for(i>2&&(m=g.LONG(m)+k.tiffHeader),e=0;i>e;e++)p[e]=g.SHORT(m+2*e);break;case 4:for(i>1&&(m=g.LONG(m)+k.tiffHeader),e=0;i>e;e++)p[e]=g.LONG(m+4*e);break;case 5:for(m=g.LONG(m)+k.tiffHeader,e=0;i>e;e++)p[e]=g.LONG(m+4*e)/g.LONG(m+4*e+4);break;case 9:for(m=g.LONG(m)+k.tiffHeader,e=0;i>e;e++)p[e]=g.SLONG(m+4*e);break;case 10:for(m=g.LONG(m)+k.tiffHeader,e=0;i>e;e++)p[e]=g.SLONG(m+4*e)/g.SLONG(m+4*e+4);break;default:continue}n=1==i?p[0]:p,q[f]=j.hasOwnProperty(f)&&"object"!=typeof n?j[f][n]:n}return q}function e(){var a=k.tiffHeader;return g.II(18761==g.SHORT(a)),42!==g.SHORT(a+=2)?!1:(k.IFD0=k.tiffHeader+g.LONG(a+=2),i=d(k.IFD0,h.tiff),"ExifIFDPointer"in i&&(k.exifIFD=k.tiffHeader+i.ExifIFDPointer,delete i.ExifIFDPointer),"GPSInfoIFDPointer"in i&&(k.gpsIFD=k.tiffHeader+i.GPSInfoIFDPointer,delete i.GPSInfoIFDPointer),!0)}function f(a,b,c){var d,e,f,i=0;if("string"==typeof b){var j=h[a.toLowerCase()];for(var l in j)if(j[l]===b){b=l;break}}d=k[a.toLowerCase()+"IFD"],e=g.SHORT(d);for(var m=0;e>m;m++)if(f=d+12*m+2,g.SHORT(f)==b){i=f+8;break}return i?(g.LONG(i,c),!0):!1}var g,h,i,j,k={};return g=new c,h={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}},j={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}},{init:function(a){return k={tiffHeader:10},a!==b&&a.length?(g.init(a),65505===g.SHORT(0)&&"EXIF\x00"===g.STRING(4,5).toUpperCase()?e():!1):!1},TIFF:function(){return i},EXIF:function(){var b;if(b=d(k.exifIFD,h.exif),b.ExifVersion&&"array"===a.typeOf(b.ExifVersion)){for(var c=0,e="";c<b.ExifVersion.length;c++)e+=String.fromCharCode(b.ExifVersion[c]);b.ExifVersion=e}return b},GPS:function(){var b;return b=d(k.gpsIFD,h.gps),b.GPSVersionID&&"array"===a.typeOf(b.GPSVersionID)&&(b.GPSVersionID=b.GPSVersionID.join(".")),b},setExif:function(a,b){return"PixelXDimension"!==a&&"PixelYDimension"!==a?!1:f("exif",a,b)},getBinary:function(){return g.SEGMENT()},purge:function(){g.init(null),g=i=null,k={}}}}}),d("moxie/runtime/html5/image/JPEG",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEGHeaders","moxie/runtime/html5/utils/BinaryReader","moxie/runtime/html5/image/ExifParser"],function(a,b,c,d,e){function f(f){function g(){for(var a,b,c=0;c<=i.length;){if(a=j.SHORT(c+=2),a>=65472&&65475>=a)return c+=5,{height:j.SHORT(c),width:j.SHORT(c+=2)};b=j.SHORT(c+=2),c+=b-2}return null}function h(){l&&k&&j&&(l.purge(),k.purge(),j.init(null),i=m=k=l=j=null)}var i,j,k,l,m,n;if(i=f,j=new d,j.init(i),65496!==j.SHORT(0))throw new b.ImageError(b.ImageError.WRONG_FORMAT);k=new c(f),l=new e,n=!!l.init(k.get("app1")[0]),m=g.call(this),a.extend(this,{type:"image/jpeg",size:i.length,width:m&&m.width||0,height:m&&m.height||0,setExif:function(b,c){return n?("object"===a.typeOf(b)?a.each(b,function(a,b){l.setExif(b,a)}):l.setExif(b,c),void k.set("app1",l.getBinary())):!1},writeHeaders:function(){return arguments.length?k.restore(arguments[0]):i=k.restore(i)},stripHeaders:function(a){return k.strip(a)},purge:function(){h.call(this)}}),n&&(this.meta={tiff:l.TIFF(),exif:l.EXIF(),gps:l.GPS()})}return f}),d("moxie/runtime/html5/image/PNG",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(a,b,c){function d(d){function e(){var a,b;return a=g.call(this,8),"IHDR"==a.type?(b=a.start,{width:i.LONG(b),height:i.LONG(b+=4)}):null}function f(){i&&(i.init(null),h=l=j=k=i=null)}function g(a){var b,c,d,e;return b=i.LONG(a),c=i.STRING(a+=4,4),d=a+=4,e=i.LONG(a+b),{length:b,type:c,start:d,CRC:e}}var h,i,j,k,l;h=d,i=new c,i.init(h),function(){var b=0,c=0,d=[35152,20039,3338,6666];for(c=0;c<d.length;c++,b+=2)if(d[c]!=i.SHORT(b))throw new a.ImageError(a.ImageError.WRONG_FORMAT)}(),l=e.call(this),b.extend(this,{type:"image/png",size:h.length,width:l.width,height:l.height,purge:function(){f.call(this)}}),f.call(this)}return d}),d("moxie/runtime/html5/image/ImageInfo",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEG","moxie/runtime/html5/image/PNG"],function(a,b,c,d){return function(e){var f,g=[c,d];f=function(){for(var a=0;a<g.length;a++)try{return new g[a](e)}catch(c){}throw new b.ImageError(b.ImageError.WRONG_FORMAT)}(),a.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(a){return a},stripHeaders:function(a){return a},purge:function(){}}),a.extend(this,f),this.purge=function(){f.purge(),f=null}}}),d("moxie/runtime/html5/image/MegaPixel",[],function(){function a(a,d,e){var f=a.naturalWidth,g=a.naturalHeight,h=e.width,i=e.height,j=e.x||0,k=e.y||0,l=d.getContext("2d");b(a)&&(f/=2,g/=2);var m=1024,n=document.createElement("canvas");n.width=n.height=m;for(var o=n.getContext("2d"),p=c(a,f,g),q=0;g>q;){for(var r=q+m>g?g-q:m,s=0;f>s;){var t=s+m>f?f-s:m;o.clearRect(0,0,m,m),o.drawImage(a,-s,-q);var u=s*h/f+j<<0,v=Math.ceil(t*h/f),w=q*i/g/p+k<<0,x=Math.ceil(r*i/g/p);l.drawImage(n,0,0,t,r,u,w,v,x),s+=m}q+=m}n=o=null}function b(a){var b=a.naturalWidth,c=a.naturalHeight;if(b*c>1048576){var d=document.createElement("canvas");d.width=d.height=1;var e=d.getContext("2d");return e.drawImage(a,-b+1,0),0===e.getImageData(0,0,1,1).data[3]}return!1}function c(a,b,c){var d=document.createElement("canvas");d.width=1,d.height=c;var e=d.getContext("2d");e.drawImage(a,0,0);for(var f=e.getImageData(0,0,1,c).data,g=0,h=c,i=c;i>g;){var j=f[4*(i-1)+3];0===j?h=i:g=i,i=h+g>>1}d=null;var k=i/c;return 0===k?1:k}return{isSubsampled:b,renderTo:a}}),d("moxie/runtime/html5/image/Image",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/Exceptions","moxie/core/utils/Encode","moxie/file/File","moxie/runtime/html5/image/ImageInfo","moxie/runtime/html5/image/MegaPixel","moxie/core/utils/Mime","moxie/core/utils/Env"],function(a,b,c,d,e,f,g,h,i){function j(){function a(){if(!t&&!r)throw new c.ImageError(c.DOMException.INVALID_STATE_ERR);return t||r}function j(a){return d.atob(a.substring(a.indexOf("base64,")+7))}function k(a,b){return"data:"+(b||"")+";base64,"+d.btoa(a)}function l(a){var b=this;r=new Image,r.onerror=function(){q.call(this),b.trigger("error",c.ImageError.WRONG_FORMAT)},r.onload=function(){b.trigger("load")},r.src=/^data:[^;]*;base64,/.test(a)?a:k(a,v.type)}function m(a,b){var d,e=this;return window.FileReader?(d=new FileReader,d.onload=function(){b(this.result)},d.onerror=function(){e.trigger("error",c.ImageError.WRONG_FORMAT)},d.readAsDataURL(a),void 0):b(a.getAsDataURL())}function n(c,d,e,f){var g,h,i,j,k,l=this,m=0,n=0;if(y=f,k=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1,-1!==b.inArray(k,[5,6,7,8])){var q=c;c=d,d=q}return h=a(),e?(c=Math.min(c,h.width),d=Math.min(d,h.height),g=Math.max(c/h.width,d/h.height)):g=Math.min(c/h.width,d/h.height),g>1&&!e&&f?void this.trigger("Resize"):(t||(t=document.createElement("canvas")),i=Math.round(h.width*g),j=Math.round(h.height*g),e?(t.width=c,t.height=d,i>c&&(m=Math.round((i-c)/2)),j>d&&(n=Math.round((j-d)/2))):(t.width=i,t.height=j),y||p(t.width,t.height,k),o.call(this,h,t,-m,-n,i,j),this.width=t.width,this.height=t.height,x=!0,void l.trigger("Resize"))}function o(a,b,c,d,e,f){if("iOS"===i.OS)g.renderTo(a,b,{width:e,height:f,x:c,y:d});else{var h=b.getContext("2d");h.drawImage(a,c,d,e,f)}}function p(a,b,c){switch(c){case 5:case 6:case 7:case 8:t.width=b,t.height=a;break;default:t.width=a,t.height=b}var d=t.getContext("2d");switch(c){case 2:d.translate(a,0),d.scale(-1,1);break;case 3:d.translate(a,b),d.rotate(Math.PI);break;case 4:d.translate(0,b),d.scale(1,-1);break;case 5:d.rotate(.5*Math.PI),d.scale(1,-1);break;case 6:d.rotate(.5*Math.PI),d.translate(0,-b);break;case 7:d.rotate(.5*Math.PI),d.translate(a,-b),d.scale(-1,1);break;case 8:d.rotate(-.5*Math.PI),d.translate(-a,0)}}function q(){s&&(s.purge(),s=null),u=r=t=v=null,x=!1}var r,s,t,u,v,w=this,x=!1,y=!0;b.extend(this,{loadFromBlob:function(a){var b=this,d=b.getRuntime(),e=arguments.length>1?arguments[1]:!0;if(!d.can("access_binary"))throw new c.RuntimeError(c.RuntimeError.NOT_SUPPORTED_ERR);return v=a,a.isDetached()?(u=a.getSource(),void l.call(this,u)):void m.call(this,a.getSource(),function(a){e&&(u=j(a)),l.call(b,a)})},loadFromImage:function(a,b){this.meta=a.meta,v=new e(null,{name:a.name,size:a.size,type:a.type}),l.call(this,b?u=a.getAsBinaryString():a.getAsDataURL())},getInfo:function(){var b,c=this.getRuntime();return!s&&u&&c.can("access_image_binary")&&(s=new f(u)),b={width:a().width||0,height:a().height||0,type:v.type||h.getFileMime(v.name),size:u&&u.length||v.size||0,name:v.name||"",meta:s&&s.meta||this.meta||{}}},downsize:function(){n.apply(this,arguments)},getAsCanvas:function(){return t&&(t.id=this.uid+"_canvas"),t},getAsBlob:function(a,b){return a!==this.type&&n.call(this,this.width,this.height,!1),new e(null,{name:v.name||"",type:a,data:w.getAsBinaryString.call(this,a,b)})},getAsDataURL:function(a){var b=arguments[1]||90;if(!x)return r.src;if("image/jpeg"!==a)return t.toDataURL("image/png");try{return t.toDataURL("image/jpeg",b/100)
}catch(c){return t.toDataURL("image/jpeg")}},getAsBinaryString:function(a,b){if(!x)return u||(u=j(w.getAsDataURL(a,b))),u;if("image/jpeg"!==a)u=j(w.getAsDataURL(a,b));else{var c;b||(b=90);try{c=t.toDataURL("image/jpeg",b/100)}catch(d){c=t.toDataURL("image/jpeg")}u=j(c),s&&(u=s.stripHeaders(u),y&&(s.meta&&s.meta.exif&&s.setExif({PixelXDimension:this.width,PixelYDimension:this.height}),u=s.writeHeaders(u)),s.purge(),s=null)}return x=!1,u},destroy:function(){w=null,q.call(this),this.getRuntime().getShim().removeInstance(this.uid)}})}return a.Image=j}),d("moxie/runtime/flash/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(a,b,c,d,e){function f(){var a;try{a=navigator.plugins["Shockwave Flash"],a=a.description}catch(b){try{a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(c){a="0.0"}}return a=a.match(/\d+/g),parseFloat(a[0]+"."+a[1])}function g(g){var j,k=this;g=a.extend({swf_url:b.swf_url},g),e.call(this,g,h,{access_binary:function(a){return a&&"browser"===k.mode},access_image_binary:function(a){return a&&"browser"===k.mode},display_media:e.capTrue,do_cors:e.capTrue,drag_and_drop:!1,report_upload_progress:function(){return"client"===k.mode},resize_image:e.capTrue,return_response_headers:!1,return_response_type:function(b){return"json"===b&&window.JSON?!0:!a.arrayDiff(b,["","text","document"])||"browser"===k.mode},return_status_code:function(b){return"browser"===k.mode||!a.arrayDiff(b,[200,404])},select_file:e.capTrue,select_multiple:e.capTrue,send_binary_string:function(a){return a&&"browser"===k.mode},send_browser_cookies:function(a){return a&&"browser"===k.mode},send_custom_headers:function(a){return a&&"browser"===k.mode},send_multipart:e.capTrue,slice_blob:function(a){return a&&"browser"===k.mode},stream_upload:function(a){return a&&"browser"===k.mode},summon_file_dialog:!1,upload_filesize:function(b){return a.parseSizeStr(b)<=2097152||"client"===k.mode},use_http_method:function(b){return!a.arrayDiff(b,["GET","POST"])}},{access_binary:function(a){return a?"browser":"client"},access_image_binary:function(a){return a?"browser":"client"},report_upload_progress:function(a){return a?"browser":"client"},return_response_type:function(b){return a.arrayDiff(b,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function(b){return a.arrayDiff(b,[200,404])?"browser":["client","browser"]},send_binary_string:function(a){return a?"browser":"client"},send_browser_cookies:function(a){return a?"browser":"client"},send_custom_headers:function(a){return a?"browser":"client"},stream_upload:function(a){return a?"client":"browser"},upload_filesize:function(b){return a.parseSizeStr(b)>=2097152?"client":"browser"}},"client"),f()<10&&(this.mode=!1),a.extend(this,{getShim:function(){return c.get(this.uid)},shimExec:function(a,b){var c=[].slice.call(arguments,2);return k.getShim().exec(this.uid,a,b,c)},init:function(){var c,e,f;f=this.getShimContainer(),a.extend(f.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"}),c='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+g.swf_url+'" ',"IE"===b.browser&&(c+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '),c+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+g.swf_url+'" /><param name="flashvars" value="uid='+escape(this.uid)+"&target="+b.global_event_dispatcher+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>',"IE"===b.browser?(e=document.createElement("div"),f.appendChild(e),e.outerHTML=c,e=f=null):f.innerHTML=c,j=setTimeout(function(){k&&!k.initialized&&k.trigger("Error",new d.RuntimeError(d.RuntimeError.NOT_INIT_ERR))},5e3)},destroy:function(a){return function(){a.call(k),clearTimeout(j),g=j=a=k=null}}(this.destroy)},i)}var h="flash",i={};return e.addConstructor(h,g),i}),d("moxie/runtime/flash/file/Blob",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(a,b){var c={slice:function(a,c,d,e){var f=this.getRuntime();return 0>c?c=Math.max(a.size+c,0):c>0&&(c=Math.min(c,a.size)),0>d?d=Math.max(a.size+d,0):d>0&&(d=Math.min(d,a.size)),a=f.shimExec.call(this,"Blob","slice",c,d,e||""),a&&(a=new b(f.uid,a)),a}};return a.Blob=c}),d("moxie/runtime/flash/file/FileInput",["moxie/runtime/flash/Runtime"],function(a){var b={init:function(a){this.getRuntime().shimExec.call(this,"FileInput","init",{name:a.name,accept:a.accept,multiple:a.multiple}),this.trigger("ready")}};return a.FileInput=b}),d("moxie/runtime/flash/file/FileReader",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(a,b){function c(a,c){switch(c){case"readAsText":return b.atob(a,"utf8");case"readAsBinaryString":return b.atob(a);case"readAsDataURL":return a}return null}var d="",e={read:function(a,b){var e=this,f=e.getRuntime();return"readAsDataURL"===a&&(d="data:"+(b.type||"")+";base64,"),e.bind("Progress",function(b,e){e&&(d+=c(e,a))}),f.shimExec.call(this,"FileReader","readAsBase64",b.uid)},getResult:function(){return d},destroy:function(){d=null}};return a.FileReader=e}),d("moxie/runtime/flash/file/FileReaderSync",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(a,b){function c(a,c){switch(c){case"readAsText":return b.atob(a,"utf8");case"readAsBinaryString":return b.atob(a);case"readAsDataURL":return a}return null}var d={read:function(a,b){var d,e=this.getRuntime();return(d=e.shimExec.call(this,"FileReaderSync","readAsBase64",b.uid))?("readAsDataURL"===a&&(d="data:"+(b.type||"")+";base64,"+d),c(d,a,b.type)):null}};return a.FileReaderSync=d}),d("moxie/runtime/flash/xhr/XMLHttpRequest",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/file/Blob","moxie/file/File","moxie/file/FileReaderSync","moxie/xhr/FormData","moxie/runtime/Transporter"],function(a,b,c,d,e,f,g){var h={send:function(a,d){function e(){a.transport=k.mode,k.shimExec.call(j,"XMLHttpRequest","send",a,d)}function h(a,b){k.shimExec.call(j,"XMLHttpRequest","appendBlob",a,b.uid),d=null,e()}function i(a,b){var c=new g;c.bind("TransportingComplete",function(){b(this.result)}),c.transport(a.getSource(),a.type,{ruid:k.uid})}var j=this,k=j.getRuntime();if(b.isEmptyObj(a.headers)||b.each(a.headers,function(a,b){k.shimExec.call(j,"XMLHttpRequest","setRequestHeader",b,a.toString())}),d instanceof f){var l;if(d.each(function(a,b){a instanceof c?l=b:k.shimExec.call(j,"XMLHttpRequest","append",b,a)}),d.hasBlob()){var m=d.getBlob();m.isDetached()?i(m,function(a){m.destroy(),h(l,a)}):h(l,m)}else d=null,e()}else d instanceof c?d.isDetached()?i(d,function(a){d.destroy(),d=a.uid,e()}):(d=d.uid,e()):e()},getResponse:function(a){var c,f,g=this.getRuntime();if(f=g.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob")){if(f=new d(g.uid,f),"blob"===a)return f;try{if(c=new e,~b.inArray(a,["","text"]))return c.readAsText(f);if("json"===a&&window.JSON)return JSON.parse(c.readAsText(f))}finally{f.destroy()}}return null},abort:function(){var a=this.getRuntime();a.shimExec.call(this,"XMLHttpRequest","abort"),this.dispatchEvent("readystatechange"),this.dispatchEvent("abort")}};return a.XMLHttpRequest=h}),d("moxie/runtime/flash/runtime/Transporter",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(a,b){var c={getAsBlob:function(a){var c=this.getRuntime(),d=c.shimExec.call(this,"Transporter","getAsBlob",a);return d?new b(c.uid,d):null}};return a.Transporter=c}),d("moxie/runtime/flash/image/Image",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/runtime/Transporter","moxie/file/Blob","moxie/file/FileReaderSync"],function(a,b,c,d,e){var f={loadFromBlob:function(a){function b(a){e.shimExec.call(d,"Image","loadFromBlob",a.uid),d=e=null}var d=this,e=d.getRuntime();if(a.isDetached()){var f=new c;f.bind("TransportingComplete",function(){b(f.result.getSource())}),f.transport(a.getSource(),a.type,{ruid:e.uid})}else b(a.getSource())},loadFromImage:function(a){var b=this.getRuntime();return b.shimExec.call(this,"Image","loadFromImage",a.uid)},getAsBlob:function(a,b){var c=this.getRuntime(),e=c.shimExec.call(this,"Image","getAsBlob",a,b);return e?new d(c.uid,e):null},getAsDataURL:function(){var a,b=this.getRuntime(),c=b.Image.getAsBlob.apply(this,arguments);return c?(a=new e,a.readAsDataURL(c)):null}};return a.Image=f}),d("moxie/runtime/silverlight/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(a,b,c,d,e){function f(a){var b,c,d,e,f,g=!1,h=null,i=0;try{try{h=new ActiveXObject("AgControl.AgControl"),h.IsVersionSupported(a)&&(g=!0),h=null}catch(j){var k=navigator.plugins["Silverlight Plug-In"];if(k){for(b=k.description,"1.0.30226.2"===b&&(b="2.0.30226.2"),c=b.split(".");c.length>3;)c.pop();for(;c.length<4;)c.push(0);for(d=a.split(".");d.length>4;)d.pop();do e=parseInt(d[i],10),f=parseInt(c[i],10),i++;while(i<d.length&&e===f);f>=e&&!isNaN(e)&&(g=!0)}}}catch(l){g=!1}return g}function g(g){var j,k=this;g=a.extend({xap_url:b.xap_url},g),e.call(this,g,h,{access_binary:e.capTrue,access_image_binary:e.capTrue,display_media:e.capTrue,do_cors:e.capTrue,drag_and_drop:!1,report_upload_progress:e.capTrue,resize_image:e.capTrue,return_response_headers:function(a){return a&&"client"===k.mode},return_response_type:function(a){return"json"!==a?!0:!!window.JSON},return_status_code:function(b){return"client"===k.mode||!a.arrayDiff(b,[200,404])},select_file:e.capTrue,select_multiple:e.capTrue,send_binary_string:e.capTrue,send_browser_cookies:function(a){return a&&"browser"===k.mode},send_custom_headers:function(a){return a&&"client"===k.mode},send_multipart:e.capTrue,slice_blob:e.capTrue,stream_upload:!0,summon_file_dialog:!1,upload_filesize:e.capTrue,use_http_method:function(b){return"client"===k.mode||!a.arrayDiff(b,["GET","POST"])}},{return_response_headers:function(a){return a?"client":"browser"},return_status_code:function(b){return a.arrayDiff(b,[200,404])?"client":["client","browser"]},send_browser_cookies:function(a){return a?"browser":"client"},send_custom_headers:function(a){return a?"client":"browser"},use_http_method:function(b){return a.arrayDiff(b,["GET","POST"])?"client":["client","browser"]}}),f("2.0.31005.0")&&"Opera"!==b.browser||(this.mode=!1),a.extend(this,{getShim:function(){return c.get(this.uid).content.Moxie},shimExec:function(a,b){var c=[].slice.call(arguments,2);return k.getShim().exec(this.uid,a,b,c)},init:function(){var a;a=this.getShimContainer(),a.innerHTML='<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;"><param name="source" value="'+g.xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="uid='+this.uid+",target="+b.global_event_dispatcher+'"/></object>',j=setTimeout(function(){k&&!k.initialized&&k.trigger("Error",new d.RuntimeError(d.RuntimeError.NOT_INIT_ERR))},"Windows"!==b.OS?1e4:5e3)},destroy:function(a){return function(){a.call(k),clearTimeout(j),g=j=a=k=null}}(this.destroy)},i)}var h="silverlight",i={};return e.addConstructor(h,g),i}),d("moxie/runtime/silverlight/file/Blob",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/Blob"],function(a,b,c){return a.Blob=b.extend({},c)}),d("moxie/runtime/silverlight/file/FileInput",["moxie/runtime/silverlight/Runtime"],function(a){var b={init:function(a){function b(a){for(var b="",c=0;c<a.length;c++)b+=(""!==b?"|":"")+a[c].title+" | *."+a[c].extensions.replace(/,/g,";*.");return b}this.getRuntime().shimExec.call(this,"FileInput","init",b(a.accept),a.name,a.multiple),this.trigger("ready")}};return a.FileInput=b}),d("moxie/runtime/silverlight/file/FileDrop",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Dom","moxie/core/utils/Events"],function(a,b,c){var d={init:function(){var a,d=this,e=d.getRuntime();return a=e.getShimContainer(),c.addEvent(a,"dragover",function(a){a.preventDefault(),a.stopPropagation(),a.dataTransfer.dropEffect="copy"},d.uid),c.addEvent(a,"dragenter",function(a){a.preventDefault();var c=b.get(e.uid).dragEnter(a);c&&a.stopPropagation()},d.uid),c.addEvent(a,"drop",function(a){a.preventDefault();var c=b.get(e.uid).dragDrop(a);c&&a.stopPropagation()},d.uid),e.shimExec.call(this,"FileDrop","init")}};return a.FileDrop=d}),d("moxie/runtime/silverlight/file/FileReader",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReader"],function(a,b,c){return a.FileReader=b.extend({},c)}),d("moxie/runtime/silverlight/file/FileReaderSync",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReaderSync"],function(a,b,c){return a.FileReaderSync=b.extend({},c)}),d("moxie/runtime/silverlight/xhr/XMLHttpRequest",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/xhr/XMLHttpRequest"],function(a,b,c){return a.XMLHttpRequest=b.extend({},c)}),d("moxie/runtime/silverlight/runtime/Transporter",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/runtime/Transporter"],function(a,b,c){return a.Transporter=b.extend({},c)}),d("moxie/runtime/silverlight/image/Image",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/image/Image"],function(a,b,c){return a.Image=b.extend({},c,{getInfo:function(){var a=this.getRuntime(),c=["tiff","exif","gps"],d={meta:{}},e=a.shimExec.call(this,"Image","getInfo");return e.meta&&b.each(c,function(a){var b,c,f,g,h=e.meta[a];if(h&&h.keys)for(d.meta[a]={},c=0,f=h.keys.length;f>c;c++)b=h.keys[c],g=h[b],g&&(/^(\d|[1-9]\d+)$/.test(g)?g=parseInt(g,10):/^\d*\.\d+$/.test(g)&&(g=parseFloat(g)),d.meta[a][b]=g)}),d.width=parseInt(e.width,10),d.height=parseInt(e.height,10),d.size=parseInt(e.size,10),d.type=e.type,d.name=e.name,d}})}),d("moxie/runtime/html4/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(a,b,c,d){function e(b){var e=this,h=c.capTest,i=c.capTrue;c.call(this,b,f,{access_binary:h(window.FileReader||window.File&&File.getAsDataURL),access_image_binary:!1,display_media:h(g.Image&&(d.can("create_canvas")||d.can("use_data_uri_over32kb"))),do_cors:!1,drag_and_drop:!1,filter_by_extension:h(function(){return"Chrome"===d.browser&&d.version>=28||"IE"===d.browser&&d.version>=10}()),resize_image:function(){return g.Image&&e.can("access_binary")&&d.can("create_canvas")},report_upload_progress:!1,return_response_headers:!1,return_response_type:function(b){return"json"===b&&window.JSON?!0:!!~a.inArray(b,["text","document",""])},return_status_code:function(b){return!a.arrayDiff(b,[200,404])},select_file:function(){return d.can("use_fileinput")},select_multiple:!1,send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:function(){return e.can("select_file")},summon_file_dialog:h(function(){return"Firefox"===d.browser&&d.version>=4||"Opera"===d.browser&&d.version>=12||!!~a.inArray(d.browser,["Chrome","Safari"])}()),upload_filesize:i,use_http_method:function(b){return!a.arrayDiff(b,["GET","POST"])}}),a.extend(this,{init:function(){this.trigger("Init")},destroy:function(a){return function(){a.call(e),a=e=null}}(this.destroy)}),a.extend(this.getShim(),g)}var f="html4",g={};return c.addConstructor(f,e),g}),d("moxie/runtime/html4/file/FileInput",["moxie/runtime/html4/Runtime","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime","moxie/core/utils/Env"],function(a,b,c,d,e,f){function g(){function a(){var e,k,l,m,n,o,p=this,q=p.getRuntime();o=b.guid("uid_"),e=q.getShimContainer(),g&&(l=c.get(g+"_form"),l&&b.extend(l.style,{top:"100%"})),m=document.createElement("form"),m.setAttribute("id",o+"_form"),m.setAttribute("method","post"),m.setAttribute("enctype","multipart/form-data"),m.setAttribute("encoding","multipart/form-data"),b.extend(m.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"}),n=document.createElement("input"),n.setAttribute("id",o),n.setAttribute("type","file"),n.setAttribute("name",h.name||"Filedata"),n.setAttribute("accept",j.join(",")),b.extend(n.style,{fontSize:"999px",opacity:0}),m.appendChild(n),e.appendChild(m),b.extend(n.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),"IE"===f.browser&&f.version<10&&b.extend(n.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"}),n.onchange=function(){var b;this.value&&(b=this.files?this.files[0]:{name:this.value},i=[b],this.onchange=function(){},a.call(p),p.bind("change",function d(){var a,b=c.get(o),e=c.get(o+"_form");p.unbind("change",d),p.files.length&&b&&e&&(a=p.files[0],b.setAttribute("id",a.uid),e.setAttribute("id",a.uid+"_form"),e.setAttribute("target",a.uid+"_iframe")),b=e=null},998),n=m=null,p.trigger("change"))},q.can("summon_file_dialog")&&(k=c.get(h.browse_button),d.removeEvent(k,"click",p.uid),d.addEvent(k,"click",function(a){n&&!n.disabled&&n.click(),a.preventDefault()},p.uid)),g=o,e=l=k=null}var g,h,i=[],j=[];b.extend(this,{init:function(b){var f,g=this,i=g.getRuntime();h=b,j=b.accept.mimes||e.extList2mimes(b.accept,i.can("filter_by_extension")),f=i.getShimContainer(),function(){var a,e,h;a=c.get(b.browse_button),i.can("summon_file_dialog")&&("static"===c.getStyle(a,"position")&&(a.style.position="relative"),e=parseInt(c.getStyle(a,"z-index"),10)||1,a.style.zIndex=e,f.style.zIndex=e-1),h=i.can("summon_file_dialog")?a:f,d.addEvent(h,"mouseover",function(){g.trigger("mouseenter")},g.uid),d.addEvent(h,"mouseout",function(){g.trigger("mouseleave")},g.uid),d.addEvent(h,"mousedown",function(){g.trigger("mousedown")},g.uid),d.addEvent(c.get(b.container),"mouseup",function(){g.trigger("mouseup")},g.uid),a=null}(),a.call(this),f=null,g.trigger({type:"ready",async:!0})},getFiles:function(){return i},disable:function(a){var b;(b=c.get(g))&&(b.disabled=!!a)},destroy:function(){var a=this.getRuntime(),b=a.getShim(),e=a.getShimContainer();d.removeAllEvents(e,this.uid),d.removeAllEvents(h&&c.get(h.container),this.uid),d.removeAllEvents(h&&c.get(h.browse_button),this.uid),e&&(e.innerHTML=""),b.removeInstance(this.uid),g=i=j=h=e=b=null}})}return a.FileInput=g}),d("moxie/runtime/html4/file/FileReader",["moxie/runtime/html4/Runtime","moxie/runtime/html5/file/FileReader"],function(a,b){return a.FileReader=b}),d("moxie/runtime/html4/xhr/XMLHttpRequest",["moxie/runtime/html4/Runtime","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Url","moxie/core/Exceptions","moxie/core/utils/Events","moxie/file/Blob","moxie/xhr/FormData"],function(a,b,c,d,e,f,g,h){function i(){function a(a){var b,d,e,g,h=this,i=!1;if(k){if(b=k.id.replace(/_iframe$/,""),d=c.get(b+"_form")){for(e=d.getElementsByTagName("input"),g=e.length;g--;)switch(e[g].getAttribute("type")){case"hidden":e[g].parentNode.removeChild(e[g]);break;case"file":i=!0}e=[],i||d.parentNode.removeChild(d),d=null}setTimeout(function(){f.removeEvent(k,"load",h.uid),k.parentNode&&k.parentNode.removeChild(k);var b=h.getRuntime().getShimContainer();b.children.length||b.parentNode.removeChild(b),b=k=null,a()},1)}}var i,j,k;b.extend(this,{send:function(l,m){function n(){var c=t.getShimContainer()||document.body,e=document.createElement("div");e.innerHTML='<iframe id="'+o+'_iframe" name="'+o+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>',k=e.firstChild,c.appendChild(k),f.addEvent(k,"load",function(){var c;try{c=k.contentWindow.document||k.contentDocument||window.frames[k.id].document,/^4(0[0-9]|1[0-7]|2[2346])\s/.test(c.title)?i=c.title.replace(/^(\d+).*$/,"$1"):(i=200,j=b.trim(c.body.innerHTML),s.trigger({type:"progress",loaded:j.length,total:j.length}),r&&s.trigger({type:"uploadprogress",loaded:r.size||1025,total:r.size||1025}))}catch(e){if(!d.hasSameOrigin(l.url))return void a.call(s,function(){s.trigger("error")});i=404}a.call(s,function(){s.trigger("load")})},s.uid)}var o,p,q,r,s=this,t=s.getRuntime();if(i=j=null,m instanceof h&&m.hasBlob()){if(r=m.getBlob(),o=r.uid,q=c.get(o),p=c.get(o+"_form"),!p)throw new e.DOMException(e.DOMException.NOT_FOUND_ERR)}else o=b.guid("uid_"),p=document.createElement("form"),p.setAttribute("id",o+"_form"),p.setAttribute("method",l.method),p.setAttribute("enctype","multipart/form-data"),p.setAttribute("encoding","multipart/form-data"),p.setAttribute("target",o+"_iframe"),t.getShimContainer().appendChild(p);m instanceof h&&m.each(function(a,c){if(a instanceof g)q&&q.setAttribute("name",c);else{var d=document.createElement("input");b.extend(d,{type:"hidden",name:c,value:a}),q?p.insertBefore(d,q):p.appendChild(d)}}),p.setAttribute("action",l.url),n(),p.submit(),s.trigger("loadstart")},getStatus:function(){return i},getResponse:function(a){if("json"===a&&"string"===b.typeOf(j)&&window.JSON)try{return JSON.parse(j.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch(c){return null}return j},abort:function(){var b=this;k&&k.contentWindow&&(k.contentWindow.stop?k.contentWindow.stop():k.contentWindow.document.execCommand?k.contentWindow.document.execCommand("Stop"):k.src="about:blank"),a.call(this,function(){b.dispatchEvent("abort")})}})}return a.XMLHttpRequest=i}),d("moxie/runtime/html4/image/Image",["moxie/runtime/html4/Runtime","moxie/runtime/html5/image/Image"],function(a,b){return a.Image=b}),f(["moxie/core/utils/Basic","moxie/core/I18n","moxie/core/utils/Mime","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/EventTarget","moxie/core/utils/Encode","moxie/runtime/Runtime","moxie/runtime/RuntimeClient","moxie/file/Blob","moxie/file/File","moxie/file/FileInput","moxie/file/FileDrop","moxie/runtime/RuntimeTarget","moxie/file/FileReader","moxie/core/utils/Url","moxie/file/FileReaderSync","moxie/xhr/FormData","moxie/xhr/XMLHttpRequest","moxie/runtime/Transporter","moxie/image/Image","moxie/core/utils/Events"])}(this),function(a){"use strict";var b={},c=a.moxie.core.utils.Basic.inArray;return function d(a){var e,f;for(e in a)f=typeof a[e],"object"!==f||~c(e,["Exceptions","Env","Mime"])?"function"===f&&(b[e]=a[e]):d(a[e])}(a.moxie),b.Env=a.moxie.core.utils.Env,b.Mime=a.moxie.core.utils.Mime,b.Exceptions=a.moxie.core.Exceptions,a.mOxie=b,a.o||(a.o=b),b}(this),function(a,b,c){function d(a){function b(a,b,c){var e={chunks:"slice_blob",jpgresize:"send_binary_string",pngresize:"send_binary_string",progress:"report_upload_progress",multi_selection:"select_multiple",dragdrop:"drag_and_drop",drop_element:"drag_and_drop",headers:"send_custom_headers",urlstream_upload:"send_binary_string",canSendBinary:"send_binary",triggerDialog:"summon_file_dialog"};e[a]?d[e[a]]=b:c||(d[a]=b)}var c=a.required_features,d={};return"string"==typeof c?g.each(c.split(/\s*,\s*/),function(a){b(a,!0)}):"object"==typeof c?g.each(c,function(a,c){b(c,a)}):c===!0&&(a.chunk_size>0&&(d.slice_blob=!0),(a.resize.enabled||!a.multipart)&&(d.send_binary_string=!0),g.each(a,function(a,c){b(c,!!a,!0)})),d}var e=a.setTimeout,f={},g={VERSION:"2.1.2",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,FILE_DUPLICATE_ERROR:-602,IMAGE_FORMAT_ERROR:-700,MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:b.mimes,ua:b.ua,typeOf:b.typeOf,extend:b.extend,guid:b.guid,get:function(a){var c,d=[];"array"!==b.typeOf(a)&&(a=[a]);for(var e=a.length;e--;)c=b.get(a[e]),c&&d.push(c);return d.length?d:null},each:b.each,getPos:b.getPos,getSize:b.getSize,xmlEncode:function(a){var b={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},c=/[<>&\"\']/g;return a?(""+a).replace(c,function(a){return b[a]?"&"+b[a]+";":a}):a},toArray:b.toArray,inArray:b.inArray,addI18n:b.addI18n,translate:b.translate,isEmptyObj:b.isEmptyObj,hasClass:b.hasClass,addClass:b.addClass,removeClass:b.removeClass,getStyle:b.getStyle,addEvent:b.addEvent,removeEvent:b.removeEvent,removeAllEvents:b.removeAllEvents,cleanName:function(a){var b,c;for(c=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"],b=0;b<c.length;b+=2)a=a.replace(c[b],c[b+1]);return a=a.replace(/\s+/g,"_"),a=a.replace(/[^a-z0-9_\-\.]+/gi,"")},buildUrl:function(a,b){var c="";return g.each(b,function(a,b){c+=(c?"&":"")+encodeURIComponent(b)+"="+encodeURIComponent(a)}),c&&(a+=(a.indexOf("?")>0?"&":"?")+c),a},formatSize:function(a){function b(a,b){return Math.round(a*Math.pow(10,b))/Math.pow(10,b)}if(a===c||/\D/.test(a))return g.translate("N/A");var d=Math.pow(1024,4);return a>d?b(a/d,1)+" "+g.translate("tb"):a>(d/=1024)?b(a/d,1)+" "+g.translate("gb"):a>(d/=1024)?b(a/d,1)+" "+g.translate("mb"):a>1024?Math.round(a/1024)+" "+g.translate("kb"):a+" "+g.translate("b")},parseSize:b.parseSizeStr,predictRuntime:function(a,c){var d,e;return d=new g.Uploader(a),e=b.Runtime.thatCan(d.getOption().required_features,c||a.runtimes),d.destroy(),e},addFileFilter:function(a,b){f[a]=b}};g.addFileFilter("mime_types",function(a,b,c){a.length&&!a.regexp.test(b.name)?(this.trigger("Error",{code:g.FILE_EXTENSION_ERROR,message:g.translate("File extension error."),file:b}),c(!1)):c(!0)}),g.addFileFilter("max_file_size",function(a,b,c){var d;a=g.parseSize(a),b.size!==d&&a&&b.size>a?(this.trigger("Error",{code:g.FILE_SIZE_ERROR,message:g.translate("File size error."),file:b}),c(!1)):c(!0)}),g.addFileFilter("prevent_duplicates",function(a,b,c){if(a)for(var d=this.files.length;d--;)if(b.name===this.files[d].name&&b.size===this.files[d].size)return this.trigger("Error",{code:g.FILE_DUPLICATE_ERROR,message:g.translate("Duplicate file error."),file:b}),void c(!1);c(!0)}),g.Uploader=function(a){function h(){var a,b,c=0;if(this.state==g.STARTED){for(b=0;b<D.length;b++)a||D[b].status!=g.QUEUED?c++:(a=D[b],this.trigger("BeforeUpload",a)&&(a.status=g.UPLOADING,this.trigger("UploadFile",a)));c==D.length&&(this.state!==g.STOPPED&&(this.state=g.STOPPED,this.trigger("StateChanged")),this.trigger("UploadComplete",D))}}function i(a){a.percent=a.size>0?Math.ceil(a.loaded/a.size*100):100,j()}function j(){var a,b;for(A.reset(),a=0;a<D.length;a++)b=D[a],b.size!==c?(A.size+=b.origSize,A.loaded+=b.loaded*b.origSize/b.size):A.size=c,b.status==g.DONE?A.uploaded++:b.status==g.FAILED?A.failed++:A.queued++;A.size===c?A.percent=D.length>0?Math.ceil(A.uploaded/D.length*100):0:(A.bytesPerSec=Math.ceil(A.loaded/((+new Date-z||1)/1e3)),A.percent=A.size>0?Math.ceil(A.loaded/A.size*100):0)}function k(){var a=F[0]||G[0];return a?a.getRuntime().uid:!1}function l(a,c){if(a.ruid){var d=b.Runtime.getInfo(a.ruid);if(d)return d.can(c)}return!1}function m(){this.bind("FilesAdded FilesRemoved",function(a){a.trigger("QueueChanged"),a.refresh()}),this.bind("CancelUpload",u),this.bind("BeforeUpload",q),this.bind("UploadFile",r),this.bind("UploadProgress",s),this.bind("StateChanged",t),this.bind("QueueChanged",j),this.bind("Error",w),this.bind("FileUploaded",v),this.bind("Destroy",x)}function n(a,c){var d=this,e=0,f=[],h={runtime_order:a.runtimes,required_caps:a.required_features,preferred_caps:E,swf_url:a.flash_swf_url,xap_url:a.silverlight_xap_url};g.each(a.runtimes.split(/\s*,\s*/),function(b){a[b]&&(h[b]=a[b])}),a.browse_button&&g.each(a.browse_button,function(c){f.push(function(f){var i=new b.FileInput(g.extend({},h,{accept:a.filters.mime_types,name:a.file_data_name,multiple:a.multi_selection,container:a.container,browse_button:c}));i.onready=function(){var a=b.Runtime.getInfo(this.ruid);b.extend(d.features,{chunks:a.can("slice_blob"),multipart:a.can("send_multipart"),multi_selection:a.can("select_multiple")}),e++,F.push(this),f()},i.onchange=function(){d.addFile(this.files)},i.bind("mouseenter mouseleave mousedown mouseup",function(d){H||(a.browse_button_hover&&("mouseenter"===d.type?b.addClass(c,a.browse_button_hover):"mouseleave"===d.type&&b.removeClass(c,a.browse_button_hover)),a.browse_button_active&&("mousedown"===d.type?b.addClass(c,a.browse_button_active):"mouseup"===d.type&&b.removeClass(c,a.browse_button_active)))}),i.bind("mousedown",function(){d.trigger("Browse")}),i.bind("error runtimeerror",function(){i=null,f()}),i.init()})}),a.drop_element&&g.each(a.drop_element,function(a){f.push(function(c){var f=new b.FileDrop(g.extend({},h,{drop_zone:a}));f.onready=function(){var a=b.Runtime.getInfo(this.ruid);d.features.dragdrop=a.can("drag_and_drop"),e++,G.push(this),c()},f.ondrop=function(){d.addFile(this.files)},f.bind("error runtimeerror",function(){f=null,c()}),f.init()})}),b.inSeries(f,function(){"function"==typeof c&&c(e)})}function o(a,d,e){var f=new b.Image;try{f.onload=function(){return d.width>this.width&&d.height>this.height&&d.quality===c&&d.preserve_headers&&!d.crop?(this.destroy(),e(a)):void f.downsize(d.width,d.height,d.crop,d.preserve_headers)},f.onresize=function(){e(this.getAsBlob(a.type,d.quality)),this.destroy()},f.onerror=function(){e(a)},f.load(a)}catch(g){e(a)}}function p(a,c,e){function f(a,b,c){var d=y[a];switch(a){case"max_file_size":"max_file_size"===a&&(y.max_file_size=y.filters.max_file_size=b);break;case"chunk_size":(b=g.parseSize(b))&&(y[a]=b,y.send_file_name=!0);break;case"multipart":y[a]=b,b||(y.send_file_name=!0);break;case"unique_names":y[a]=b,b&&(y.send_file_name=!0);break;case"filters":"array"===g.typeOf(b)&&(b={mime_types:b}),c?g.extend(y.filters,b):y.filters=b,b.mime_types&&(y.filters.mime_types.regexp=function(a){var b=[];return g.each(a,function(a){g.each(a.extensions.split(/,/),function(a){b.push(/^\s*\*\s*$/.test(a)?"\\.*":"\\."+a.replace(new RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})}),new RegExp("("+b.join("|")+")$","i")}(y.filters.mime_types));break;case"resize":c?g.extend(y.resize,b,{enabled:!0}):y.resize=b;break;case"prevent_duplicates":y.prevent_duplicates=y.filters.prevent_duplicates=!!b;break;case"browse_button":case"drop_element":b=g.get(b);case"container":case"runtimes":case"multi_selection":case"flash_swf_url":case"silverlight_xap_url":y[a]=b,c||(i=!0);break;default:y[a]=b}c||h.trigger("OptionChanged",a,b,d)}var h=this,i=!1;"object"==typeof a?g.each(a,function(a,b){f(b,a,e)}):f(a,c,e),e?(y.required_features=d(g.extend({},y)),E=d(g.extend({},y,{required_features:!0}))):i&&(h.trigger("Destroy"),n.call(h,y,function(a){a?(h.runtime=b.Runtime.getInfo(k()).type,h.trigger("Init",{runtime:h.runtime}),h.trigger("PostInit")):h.trigger("Error",{code:g.INIT_ERROR,message:g.translate("Init error.")})}))}function q(a,b){if(a.settings.unique_names){var c=b.name.match(/\.([^.]+)$/),d="part";c&&(d=c[1]),b.target_name=b.id+"."+d}}function r(a,c){function d(){k-->0?e(f,1e3):(c.loaded=n,a.trigger("Error",{code:g.HTTP_ERROR,message:g.translate("HTTP Error."),file:c,response:B.responseText,status:B.status,responseHeaders:B.getAllResponseHeaders()}))}function f(){var l,o,p,q={};c.status===g.UPLOADING&&a.state!==g.STOPPED&&(a.settings.send_file_name&&(q.name=c.target_name||c.name),j&&m.chunks&&h.size>j?(p=Math.min(j,h.size-n),l=h.slice(n,n+p)):(p=h.size,l=h),j&&m.chunks&&(a.settings.send_chunk_number?(q.chunk=Math.ceil(n/j),q.chunks=Math.ceil(h.size/j)):(q.offset=n,q.total=h.size)),B=new b.XMLHttpRequest,B.upload&&(B.upload.onprogress=function(b){c.loaded=Math.min(c.size,n+b.loaded),a.trigger("UploadProgress",c)}),B.onload=function(){return B.status>=400?void d():(k=a.settings.max_retries,p<h.size?(l.destroy(),n+=p,c.loaded=Math.min(n,h.size),a.trigger("ChunkUploaded",c,{offset:c.loaded,total:h.size,response:B.responseText,status:B.status,responseHeaders:B.getAllResponseHeaders()}),"Android Browser"===b.Env.browser&&a.trigger("UploadProgress",c)):c.loaded=c.size,l=o=null,void(!n||n>=h.size?(c.size!=c.origSize&&(h.destroy(),h=null),a.trigger("UploadProgress",c),c.status=g.DONE,a.trigger("FileUploaded",c,{response:B.responseText,status:B.status,responseHeaders:B.getAllResponseHeaders()})):e(f,1)))
},B.onerror=function(){d()},B.onloadend=function(){this.destroy(),B=null},a.settings.multipart&&m.multipart?(B.open("post",i,!0),g.each(a.settings.headers,function(a,b){B.setRequestHeader(b,a)}),o=new b.FormData,g.each(g.extend(q,a.settings.multipart_params),function(a,b){o.append(b,a)}),o.append(a.settings.file_data_name,l),B.send(o,{runtime_order:a.settings.runtimes,required_caps:a.settings.required_features,preferred_caps:E,swf_url:a.settings.flash_swf_url,xap_url:a.settings.silverlight_xap_url})):(i=g.buildUrl(a.settings.url,g.extend(q,a.settings.multipart_params)),B.open("post",i,!0),B.setRequestHeader("Content-Type","application/octet-stream"),g.each(a.settings.headers,function(a,b){B.setRequestHeader(b,a)}),B.send(l,{runtime_order:a.settings.runtimes,required_caps:a.settings.required_features,preferred_caps:E,swf_url:a.settings.flash_swf_url,xap_url:a.settings.silverlight_xap_url})))}var h,i=a.settings.url,j=a.settings.chunk_size,k=a.settings.max_retries,m=a.features,n=0;c.loaded&&(n=c.loaded=j?j*Math.floor(c.loaded/j):0),h=c.getSource(),a.settings.resize.enabled&&l(h,"send_binary_string")&&~b.inArray(h.type,["image/jpeg","image/png"])?o.call(this,h,a.settings.resize,function(a){h=a,c.size=a.size,f()}):f()}function s(a,b){i(b)}function t(a){if(a.state==g.STARTED)z=+new Date;else if(a.state==g.STOPPED)for(var b=a.files.length-1;b>=0;b--)a.files[b].status==g.UPLOADING&&(a.files[b].status=g.QUEUED,j())}function u(){B&&B.abort()}function v(a){j(),e(function(){h.call(a)},1)}function w(a,b){b.code===g.INIT_ERROR?a.destroy():b.file&&(b.file.status=g.FAILED,i(b.file),a.state==g.STARTED&&(a.trigger("CancelUpload"),e(function(){h.call(a)},1)))}function x(a){a.stop(),g.each(D,function(a){a.destroy()}),D=[],F.length&&(g.each(F,function(a){a.destroy()}),F=[]),G.length&&(g.each(G,function(a){a.destroy()}),G=[]),E={},H=!1,z=B=null,A.reset()}var y,z,A,B,C=g.guid(),D=[],E={},F=[],G=[],H=!1;y={runtimes:b.Runtime.order,max_retries:0,chunk_size:0,multipart:!0,multi_selection:!0,file_data_name:"file",flash_swf_url:"js/Moxie.swf",silverlight_xap_url:"js/Moxie.xap",filters:{mime_types:[],prevent_duplicates:!1,max_file_size:0},resize:{enabled:!1,preserve_headers:!0,crop:!1},send_file_name:!0,send_chunk_number:!0},p.call(this,a,null,!0),A=new g.QueueProgress,g.extend(this,{id:C,uid:C,state:g.STOPPED,features:{},runtime:null,files:D,settings:y,total:A,init:function(){var a=this;return"function"==typeof y.preinit?y.preinit(a):g.each(y.preinit,function(b,c){a.bind(c,b)}),m.call(this),y.browse_button&&y.url?void n.call(this,y,function(c){"function"==typeof y.init?y.init(a):g.each(y.init,function(b,c){a.bind(c,b)}),c?(a.runtime=b.Runtime.getInfo(k()).type,a.trigger("Init",{runtime:a.runtime}),a.trigger("PostInit")):a.trigger("Error",{code:g.INIT_ERROR,message:g.translate("Init error.")})}):void this.trigger("Error",{code:g.INIT_ERROR,message:g.translate("Init error.")})},setOption:function(a,b){p.call(this,a,b,!this.runtime)},getOption:function(a){return a?y[a]:y},refresh:function(){F.length&&g.each(F,function(a){a.trigger("Refresh")}),this.trigger("Refresh")},start:function(){this.state!=g.STARTED&&(this.state=g.STARTED,this.trigger("StateChanged"),h.call(this))},stop:function(){this.state!=g.STOPPED&&(this.state=g.STOPPED,this.trigger("StateChanged"),this.trigger("CancelUpload"))},disableBrowse:function(){H=arguments[0]!==c?arguments[0]:!0,F.length&&g.each(F,function(a){a.disable(H)}),this.trigger("DisableBrowse",H)},getFile:function(a){var b;for(b=D.length-1;b>=0;b--)if(D[b].id===a)return D[b]},addFile:function(a,c){function d(a,c){var d=[];b.each(j.settings.filters,function(b,c){f[c]&&d.push(function(d){f[c].call(j,b,a,function(a){d(!a)})})}),b.inSeries(d,c)}function h(a){var f=b.typeOf(a);if(a instanceof b.File){if(!a.ruid&&!a.isDetached()){if(!i)return!1;a.ruid=i,a.connectRuntime(i)}h(new g.File(a))}else a instanceof b.Blob?(h(a.getSource()),a.destroy()):a instanceof g.File?(c&&(a.name=c),l.push(function(b){d(a,function(c){c||(D.push(a),m.push(a),j.trigger("FileFiltered",a)),e(b,1)})})):-1!==b.inArray(f,["file","blob"])?h(new b.File(null,a)):"node"===f&&"filelist"===b.typeOf(a.files)?b.each(a.files,h):"array"===f&&(c=null,b.each(a,h))}var i,j=this,l=[],m=[];i=k(),h(a),l.length&&b.inSeries(l,function(){m.length&&j.trigger("FilesAdded",m)})},removeFile:function(a){for(var b="string"==typeof a?a:a.id,c=D.length-1;c>=0;c--)if(D[c].id===b)return this.splice(c,1)[0]},splice:function(a,b){var d=D.splice(a===c?0:a,b===c?D.length:b),e=!1;return this.state==g.STARTED&&(g.each(d,function(a){return a.status===g.UPLOADING?(e=!0,!1):void 0}),e&&this.stop()),this.trigger("FilesRemoved",d),g.each(d,function(a){a.destroy()}),e&&this.start(),d},bind:function(a,b,c){var d=this;g.Uploader.prototype.bind.call(this,a,function(){var a=[].slice.call(arguments);return a.splice(0,1,d),b.apply(this,a)},0,c)},destroy:function(){this.trigger("Destroy"),y=A=null,this.unbindAll()}})},g.Uploader.prototype=b.EventTarget.instance,g.File=function(){function a(a){g.extend(this,{id:g.guid(),name:a.name||a.fileName,type:a.type||"",size:a.size||a.fileSize,origSize:a.size||a.fileSize,loaded:0,percent:0,status:g.QUEUED,lastModifiedDate:a.lastModifiedDate||(new Date).toLocaleString(),getNative:function(){var a=this.getSource().getSource();return-1!==b.inArray(b.typeOf(a),["blob","file"])?a:null},getSource:function(){return c[this.id]?c[this.id]:null},destroy:function(){var a=this.getSource();a&&(a.destroy(),delete c[this.id])}}),c[this.id]=a}var c={};return a}(),g.QueueProgress=function(){var a=this;a.size=0,a.loaded=0,a.uploaded=0,a.failed=0,a.queued=0,a.percent=0,a.bytesPerSec=0,a.reset=function(){a.size=a.loaded=a.uploaded=a.failed=a.queued=a.percent=a.bytesPerSec=0}},a.plupload=g}(window,mOxie),function(a,b,c,d,e){function f(a){return c.translate(a)||a}function g(a){a.id=a.attr("id"),a.html('<div class="plupload_wrapper"><div class="plupload_container"><div class="plupload_header"><div class="plupload_header_content"></div></div><div class="plupload_content"><!--<div class="plupload_droptext">'+f("Drag files here.")+'</div>--><ul class="plupload_filelist_content"> </ul><div class="plupload_clearer">&nbsp;</div></div><div class="plupload_buttons"><!-- Visible --><a class="plupload_button plupload_add">'+f("Add Files")+'</a>&nbsp;<a class="plupload_button plupload_start">'+f("Start Upload")+'</a>&nbsp;<!--<a class="plupload_button plupload_stop plupload_hidden">'+f("Stop Upload")+'</a>&nbsp;--><span class="plupload_total_status">0%</span><span class="plupload_total_file_size">0 kb</span><div class="plupload_started plupload_hidden"><!-- Hidden --><div class="plupload_progress plupload_right"><div class="plupload_progress_container"></div></div><div class="plupload_cell plupload_upload_status"></div><div class="plupload_clearer">&nbsp;</div></div></div></div><input class="plupload_count" value="0" type="hidden"></div>')}var h={};e.widget("ui.plupload",{widgetEventPrefix:"",contents_bak:"",options:{browse_button_hover:"ui-state-hover",browse_button_active:"ui-state-active",filters:{},buttons:{browse:!0,start:!0,stop:!0},views:{list:!0,thumbs:!1,active:"list",remember:!0},thumb_width:100,thumb_height:60,multiple_queues:!0,dragdrop:!0,autostart:!1,sortable:!1,rename:!1},FILE_COUNT_ERROR:-9001,_create:function(){var a=this.element.attr("id");a||(a=c.guid(),this.element.attr("id",a)),this.id=a,this.contents_bak=this.element.html(),g(this.element),this.container=e(".plupload_container",this.element).attr("id",a+"_container"),this.content=e(".plupload_content",this.element),e.fn.resizable&&this.container.resizable({handles:"s",minHeight:300}),this.filelist=e(".plupload_filelist_content",this.container).attr({id:a+"_filelist",unselectable:"on"}),this.browse_button=e(".plupload_add",this.container).attr("id",a+"_browse"),this.start_button=e(".plupload_start",this.container).attr("id",a+"_start"),this.stop_button=e(".plupload_stop",this.container).attr("id",a+"_stop"),this.thumbs_switcher=e("#"+a+"_view_thumbs"),this.list_switcher=e("#"+a+"_view_list"),e.ui.button&&(this.browse_button.button({icons:{primary:"ui-icon-circle-plus"},disabled:!0}),this.start_button.button({icons:{primary:"ui-icon-circle-arrow-e"},disabled:!0}),this.stop_button.button({icons:{primary:"ui-icon-circle-close"}}),this.list_switcher.button({text:!1,icons:{secondary:"ui-icon-grip-dotted-horizontal"}}),this.thumbs_switcher.button({text:!1,icons:{secondary:"ui-icon-image"}})),this.progressbar=e(".plupload_progress_container",this.container),e.ui.progressbar&&this.progressbar.progressbar(),this.counter=e(".plupload_count",this.element).attr({id:a+"_count",name:a+"_count"}),this._initUploader()},_initUploader:function(){var a,b=this,g=this.id,i={container:g+"_buttons",browse_button:g+"_browse"};e(".plupload_buttons",this.element).attr("id",g+"_buttons"),b.options.dragdrop&&(this.filelist.parent().attr("id",this.id+"_dropbox"),i.drop_element=this.id+"_dropbox"),this.filelist.on("click",function(a){e(a.target).hasClass("plupload_action_icon")&&(b.removeFile(e(a.target).closest(".plupload_file").attr("id")),a.preventDefault())}),a=this.uploader=h[g]=new c.Uploader(e.extend(this.options,i)),b.options.views.thumbs&&(a.settings.required_features.display_media=!0),b.options.max_file_count&&c.extend(a.getOption("filters"),{max_file_count:b.options.max_file_count}),c.addFileFilter("max_file_count",function(a,c,d){a<=this.files.length-(this.total.uploaded+this.total.failed)?(b.browse_button.button("disable"),this.disableBrowse(),this.trigger("Error",{code:b.FILE_COUNT_ERROR,message:f("File count error."),file:c}),d(!1)):d(!0)}),a.bind("Error",function(a,e){var g,h="";switch(g="<strong>"+e.message+"</strong>",e.code){case c.FILE_EXTENSION_ERROR:h=d.sprintf(f("File: %s"),e.file.name);break;case c.FILE_SIZE_ERROR:h=d.sprintf(f("File: %s, size: %d, max file size: %d"),e.file.name,c.formatSize(e.file.size),c.formatSize(c.parseSize(a.getOption("filters").max_file_size)));break;case c.FILE_DUPLICATE_ERROR:h=d.sprintf(f("%s already present in the queue."),e.file.name);break;case b.FILE_COUNT_ERROR:h=d.sprintf(f("Upload element accepts only %d file(s) at a time. Extra files were stripped."),a.getOption("filters").max_file_count||0);break;case c.IMAGE_FORMAT_ERROR:h=f("Image format either wrong or not supported.");break;case c.IMAGE_MEMORY_ERROR:h=f("Runtime ran out of available memory.");break;case c.HTTP_ERROR:h=f("Upload URL might be wrong or doesn't exist.")}g+=" <br /><i>"+h+"</i>",b._trigger("error",null,{up:a,error:e}),e.code===c.INIT_ERROR?setTimeout(function(){b.destroy()},1):b.notify("error",g)}),a.bind("PostInit",function(a){b.options.buttons.browse?b.browse_button.button("enable"):(b.browse_button.button("disable").hide(),a.disableBrowse(!0)),b.options.buttons.start||b.start_button.button("disable").hide(),b.options.buttons.stop||b.stop_button.button("disable").hide(),!b.options.unique_names&&b.options.rename&&b._enableRenaming(),b.options.dragdrop&&a.features.dragdrop&&b.filelist.parent().addClass("plupload_dropbox"),b._enableViewSwitcher(),b.start_button.click(function(a){e(this).button("option","disabled")||b.start(),a.preventDefault()}),b.stop_button.click(function(a){b.stop(),a.preventDefault()}),b._trigger("ready",null,{up:a})}),a.init(),a.bind("FileFiltered",function(a,c){b._addFiles(c)}),a.bind("FilesAdded",function(a,c){b._trigger("selected",null,{up:a,files:c}),b.options.sortable&&e.ui.sortable&&b._enableSortingList(),b._trigger("updatelist",null,{filelist:b.filelist}),b.options.autostart&&setTimeout(function(){b.start()},10)}),a.bind("FilesRemoved",function(a,c){e.ui.sortable&&b.options.sortable&&e("tbody",b.filelist).sortable("destroy"),e.each(c,function(a,b){e("#"+b.id).toggle("highlight",function(){e(this).remove()})}),a.files.length&&b.options.sortable&&e.ui.sortable&&b._enableSortingList(),b._trigger("updatelist",null,{filelist:b.filelist}),b._trigger("removed",null,{up:a,files:c})}),a.bind("QueueChanged StateChanged",function(){b._handleState()}),a.bind("UploadFile",function(a,c){b._handleFileStatus(c)}),a.bind("FileUploaded",function(a,c){b._handleFileStatus(c),b._trigger("uploaded",null,{up:a,file:c})}),a.bind("UploadProgress",function(a,c){b._handleFileStatus(c),b._updateTotalProgress(),b._trigger("progress",null,{up:a,file:c})}),a.bind("UploadComplete",function(a,c){b._addFormFields(),b._trigger("complete",null,{up:a,files:c})})},_setOption:function(a,b){var c=this;"buttons"==a&&"object"==typeof b&&(b=e.extend(c.options.buttons,b),b.browse?(c.browse_button.button("enable").show(),c.uploader.disableBrowse(!1)):(c.browse_button.button("disable").hide(),c.uploader.disableBrowse(!0)),b.start?c.start_button.button("enable").show():c.start_button.button("disable").hide(),b.stop?c.start_button.button("enable").show():c.stop_button.button("disable").hide()),c.uploader.settings[a]=b},start:function(){this.uploader.start(),this._trigger("start",null,{up:this.uploader})},stop:function(){this.uploader.stop(),this._trigger("stop",null,{up:this.uploader})},enable:function(){this.browse_button.button("enable"),this.uploader.disableBrowse(!1)},disable:function(){this.browse_button.button("disable"),this.uploader.disableBrowse(!0)},getFile:function(a){var b;return b="number"==typeof a?this.uploader.files[a]:this.uploader.getFile(a)},getFiles:function(){return this.uploader.files},removeFile:function(a){"string"===c.typeOf(a)&&(a=this.getFile(a)),this.uploader.removeFile(a)},clearQueue:function(){this.uploader.splice()},getUploader:function(){return this.uploader},refresh:function(){this.uploader.refresh()},notify:function(a,b){var c=e('<div class="plupload_message"><span class="plupload_message_close ui-icon ui-icon-circle-close" title="'+f("Close")+'"></span><p><span class="ui-icon"></span>'+b+"</p></div>");c.addClass("ui-state-"+("error"===a?"error":"highlight")).find("p .ui-icon").addClass("ui-icon-"+("error"===a?"alert":"info")).end().find(".plupload_message_close").click(function(){c.remove()}).end(),e(".plupload_header",this.container).append(c)},destroy:function(){this.uploader.destroy(),e(".plupload_button",this.element).unbind(),e.ui.button&&e(".plupload_add, .plupload_start, .plupload_stop",this.container).button("destroy"),e.ui.progressbar&&this.progressbar.progressbar("destroy"),e.ui.sortable&&this.options.sortable&&e("tbody",this.filelist).sortable("destroy"),this.element.empty().html(this.contents_bak),this.contents_bak="",e.Widget.prototype.destroy.apply(this)},_handleState:function(){var a=this.uploader,b=a.files.length-(a.total.uploaded+a.total.failed),g=a.getOption("filters").max_file_count||0;c.STARTED===a.state?(e([]).add(this.stop_button).add(".plupload_started").removeClass("plupload_hidden"),this.start_button.button("disable"),this.options.multiple_queues||(this.browse_button.button("disable"),a.disableBrowse()),e(".plupload_upload_status",this.element).html(d.sprintf(f("Uploaded %d/%d files"),a.total.uploaded,a.files.length)),e(".plupload_header_content",this.element).addClass("plupload_header_content_bw")):c.STOPPED===a.state&&(e([]).add(this.stop_button).add(".plupload_started").addClass("plupload_hidden"),this.start_button.button(b?"enable":"disable"),this.options.multiple_queues&&e(".plupload_header_content",this.element).removeClass("plupload_header_content_bw"),this.options.multiple_queues&&g&&g>b&&(this.browse_button.button("enable"),a.disableBrowse(!1)),this._updateTotalProgress()),e(".ui-button-text",this.browse_button).html(0===a.total.queued?f("Add Files"):d.sprintf(f("%d files queued"),a.total.queued)),a.refresh()},_handleFileStatus:function(a){var b,d,f=e("#"+a.id);if(f.length){switch(a.status){case c.DONE:b="plupload_done",d="plupload_action_icon ui-icon ui-icon-circle-check";break;case c.FAILED:b="ui-state-error plupload_failed",d="plupload_action_icon ui-icon ui-icon-alert";break;case c.QUEUED:b="plupload_delete",d="plupload_action_icon ui-icon ui-icon-circle-minus";break;case c.UPLOADING:b="ui-state-highlight plupload_uploading",d="plupload_action_icon ui-icon ui-icon-circle-arrow-w";var g=e(".plupload_scroll",this.container),h=g.scrollTop(),i=g.height(),j=f.position().top+f.height();j>i&&g.scrollTop(h+j-i),f.find(".plupload_file_percent").html(a.percent+"%").end().find(".plupload_file_progress").css("width",a.percent+"%").end().find(".plupload_file_size").html(c.formatSize(a.size))}b+=" ui-state-default plupload_file",f.attr("class",b).find(".plupload_action_icon").attr("class",d)}},_updateTotalProgress:function(){var a=this.uploader;this.filelist[0].scrollTop=this.filelist[0].scrollHeight,this.progressbar.progressbar("value",a.total.percent),this.element.find(".plupload_total_status").html(a.total.percent+"%").end().find(".plupload_total_file_size").html(c.formatSize(a.total.size)).end().find(".plupload_upload_status").html(d.sprintf(f("Uploaded %d/%d files"),a.total.uploaded,a.files.length))},_displayThumbs:function(){function a(a,b,c){var d;a.on(b,function(){clearTimeout(d),d=setTimeout(function(){clearTimeout(d),c()},300)})}function b(){if(!i||!j){var a=e(".plupload_file:eq(0)",l.filelist);i=a.outerWidth(!0),j=a.outerHeight(!0)}var b=l.content.width(),c=l.content.height();k=Math.floor(b/i),m=k*(Math.ceil(c/j)+1)}function c(){var a=Math.floor(l.content.scrollTop()/j)*k;n=e(".plupload_file",l.filelist).slice(a,a+m).filter(".plupload_file_loading").get()}function f(){function d(){"thumbs"===l.view_mode&&(b(),c(),h())}e.fn.resizable&&a(l.container,"resize",d),a(l.window,"resize",d),a(l.content,"scroll",d),l.element.on("viewchanged selected",d),d()}function g(a,b){var c=new d.Image;c.onload=function(){var b=e("#"+a.id+" .plupload_file_thumb",l.filelist).html("");this.embed(b[0],{width:l.options.thumb_width,height:l.options.thumb_height,crop:!0,swf_url:d.resolveUrl(l.options.flash_swf_url),xap_url:d.resolveUrl(l.options.silverlight_xap_url)})},c.bind("embedded error",function(){e("#"+a.id,l.filelist).removeClass("plupload_file_loading"),this.destroy(),setTimeout(b,1)}),c.load(a.getSource())}function h(){"thumbs"!==l.view_mode||o||(c(),n.length&&(o=!0,g(l.getFile(e(n.shift()).attr("id")),function(){o=!1,h()})))}var i,j,k,l=this,m=0,n=[],o=!1;this.options.views.thumbs&&this.element.on("selected",function p(){l.element.off("selected",p),f()})},_addFiles:function(a){var b,f=this,g="";b='<li class="plupload_file ui-state-default plupload_file_loading plupload_delete" id="%id%" style="width:%thumb_width%px;"><div class="plupload_file_thumb" style="width:%thumb_width%px;height:%thumb_height%px;"><div class="plupload_file_dummy" style="line-height:%thumb_height%px;"><span class="ui-state-disabled">%ext% </span></div></div><div class="plupload_file_status"><div class="plupload_file_progress" style="width: 0%"> </div><span class="plupload_file_percent">%percent% </span></div><div class="plupload_file_name" title="%name%"><span class="plupload_file_name_wrapper">%name% </span></div><div class="plupload_file_action"><div class="plupload_action_icon ui-icon ui-icon-circle-minus"> </div></div><div class="plupload_file_size">%size% </div><div class="plupload_file_fields"> </div></li>',"array"!==c.typeOf(a)&&(a=[a]),e.each(a,function(a,e){var h=d.Mime.getFileExtension(e.name)||"none";g+=b.replace(/%(\w+)%/g,function(a,b){switch(b){case"thumb_width":case"thumb_height":return f.options[b];case"size":return c.formatSize(e.size);case"ext":return h;default:return e[b]||""}})}),f.filelist.append(g)},_addFormFields:function(){var a=this;e(".plupload_file_fields",this.filelist).html(""),c.each(this.uploader.files,function(b,d){var f="",g=a.id+"_"+d;b.target_name&&(f+='<input type="hidden" name="'+g+'_tmpname" value="'+c.xmlEncode(b.target_name)+'" />'),f+='<input type="hidden" name="'+g+'_name" value="'+c.xmlEncode(b.name)+'" />',f+='<input type="hidden" name="'+g+'_status" value="'+(b.status===c.DONE?"done":"failed")+'" />',e("#"+b.id).find(".plupload_file_fields").html(f)}),this.counter.val(this.uploader.files.length)},_viewChanged:function(a){this.options.views.remember&&e.cookie&&e.cookie("plupload_ui_view",a,{expires:7,path:"/"}),"IE"===d.Env.browser&&d.Env.version<7&&this.content.attr("style",'height:expression(document.getElementById("'+this.id+'_container").clientHeight - '+("list"===a?132:102)+")"),this.container.removeClass("plupload_view_list plupload_view_thumbs").addClass("plupload_view_"+a),this.view_mode=a,this._trigger("viewchanged",null,{view:a})},_enableViewSwitcher:function(){var a,b,d,f=this,g=e(".plupload_view_switch",this.container);c.each(["list","thumbs"],function(a){f.options.views[a]||g.find('[for="'+f.id+"_view_"+a+'"], #'+f.id+"_view_"+a).remove()}),b=g.find(".plupload_button"),1===b.length?(g.hide(),a=b.eq(0).data("view"),this._viewChanged(a)):e.ui.button&&b.length>1?(this.options.views.remember&&e.cookie&&(a=e.cookie("plupload_ui_view")),~c.inArray(a,["list","thumbs"])||(a=this.options.views.active),g.show().buttonset().find(".ui-button").click(function(b){a=e(this).data("view"),f._viewChanged(a),b.preventDefault()}),d=g.find('[for="'+f.id+"_view_"+a+'"]'),d.length&&d.trigger("click")):(g.show(),this._viewChanged(this.options.views.active)),this.options.views.thumbs&&this._displayThumbs()},_enableRenaming:function(){var a=this;this.filelist.dblclick(function(b){var c,d,f,g,h=e(b.target),i="";h.hasClass("plupload_file_name_wrapper")&&(d=a.uploader.getFile(h.closest(".plupload_file")[0].id),g=d.name,f=/^(.+)(\.[^.]+)$/.exec(g),f&&(g=f[1],i=f[2]),c=e('<input class="plupload_file_rename" type="text" />').width(h.width()).insertAfter(h.hide()),c.val(g).blur(function(){h.show().parent().scrollLeft(0).end().next().remove()}).keydown(function(a){var b=e(this);-1!==e.inArray(a.keyCode,[13,27])&&(a.preventDefault(),13===a.keyCode&&(d.name=b.val()+i,h.html(d.name)),b.blur())})[0].focus())})},_enableSortingList:function(){var a=this;e(".plupload_file",this.filelist).length<2||(e("tbody",this.filelist).sortable("destroy"),this.filelist.sortable({items:".plupload_delete",cancel:"object, .plupload_clearer",stop:function(){var b=[];e.each(e(this).sortable("toArray"),function(c,d){b[b.length]=a.uploader.getFile(d)}),b.unshift(b.length),b.unshift(0),Array.prototype.splice.apply(a.uploader.files,b)}}))}})}(window,document,plupload,mOxie,jQuery),$j(function(){function a(){var a="";plupload.each(arguments,function(b){var c="";"string"!=typeof b?(plupload.each(b,function(a,d){if(b instanceof plupload.File)switch(a){case plupload.QUEUED:a="QUEUED";break;case plupload.UPLOADING:a="UPLOADING";break;case plupload.FAILED:a="FAILED";break;case plupload.DONE:a="DONE"}"function"!=typeof a&&(c+=(c?", ":"")+d+"="+a)}),a+=c+" "):a+=b+" "})}var b;$j("#uploadImgBtn").mouseup(function(){var a=$j("#uploader").plupload("getUploader");a.settings.multipart_params.customer_id=customer_id,a.settings.multipart_params.isFront=isFront;var b="1"==tempData.configurefeature[7]?"jpg,jpeg,png,ai,eps,psd,pdf,cdr,ps":"jpg,jpeg,png";return a.setOption("filters",[{title:"Image files",extensions:b}]),a.settings.filters.max_img_resolution=1e4,a.settings.filters.max_file_size="150mb",a.settings.filters.prevent_duplicates=!1,a.refresh(),!1}),initHDUploaders=function(a){var b=new plupload.Uploader({runtimes:"html5",browse_button:"uploader_"+a,max_file_size:"150mb",url:basepath+"designnbuy/pcstudio_media/upload",unique_names:!0,multi_selection:!1,filters:{mime_types:[{title:"HD files",extensions:"ai,eps,psd,pdf,cdr,ps,tiff"},{title:"Zip files",extensions:"zip"}]},multipart_params:{isFront:1,isHD:1,imageId:a,isUpload:1,customer_id:customer_id}});b.bind("FilesAdded",function(){b.start()}),b.bind("UploadComplete",function(){$j.alert("HD file uploaded successfully. It will be attached with order.")}),b.bind("FileUploaded",function(a,b,c){var d=jQuery.parseJSON(c.response);d.id&&($imageHD=$j("div").find("[data-hd-id='"+d.id+"']"),$imageHD.addClass("uploadCheckTrue"))}),b.bind("QueueChanged",function(a){b.start(),a.refresh()}),b.bind("Error",function(a,b){$j.alert(b.message)}),b.init()},b=$j("#uploader").plupload({container:"windows",runtimes:"html5",url:basepath+"designnbuy/pcstudio_media/upload",unique_names:!0,max_file_count:20,chunk_size:"1mb",resize:!1,multipart_params:{isFront:isFront,isUpload:1,customer_id:customer_id},filters:{max_img_resolution:1e4,max_file_size:"150mb",mime_types:[{title:"Image files",extensions:"jpg,jpeg,png,ai,eps,psd,pdf,cdr,ps"}],prevent_duplicates:!1},rename:!0,sortable:!1,dragdrop:!0,views:{list:!0,thumbs:!0,active:"thumbs"},preinit:{Init:function(b,c){a("[Init]","Info:",c,"Features:",b.features)},UploadFile:function(b,c){a("[UploadFile]",c)}},init:{PostInit:function(){console.log("PostInit")},Browse:function(){alert("Browse")},Refresh:function(){},StateChanged:function(){},QueueChanged:function(a){a.refresh()},OptionChanged:function(){},BeforeUpload:function(){},UploadProgress:function(){showLoader()},FileFiltered:function(){},FilesAdded:function(a){showUploadPopup||a.start()},FilesRemoved:function(a,b){plupload.each(b,function(){})},FileUploaded:function(a,b,c){var d,e=mediapath+"uploadedImage/",f="",g=jQuery.parseJSON(c.response);1==isFront,g.status&&$j.each(g.images,function(a,b){d=b.image_name;var c=e+d;if(1==isFront){var g="uploadCheck";"true"==b.vectorname&&(g="uploadCheck uploadCheckTrue"),f=""!=customer_id?'<button title="'+svgEditor.uiStrings.elementLabel.uploadHDCaption+'" class="uploadHdButton" id="uploader_'+b.id+'" ><span class="uploadhd"><div class="'+g+'" data-hd-id="'+b.id+'"></div><span class="caption">'+svgEditor.uiStrings.elementLabel.uploadHDCaption+"</span></span></button>":'<button title="'+svgEditor.uiStrings.elementLabel.uploadHDCaption+'" class="uploadHdButton" onclick="showLoginForHD()" ><span class="uploadhd"><div class="'+g+'" data-hd-id=""></div><span class="caption">'+svgEditor.uiStrings.elementLabel.uploadHDCaption+"</span></span></button>"}$j("#flickerresult").append("<li class='imgloader'><div class='imageholder'><img onload='lazyLoaderImg(this)' class ='lazy' data='"+mediapath+"uploadedImage/"+d+"' src='"+mediapath+"uploadedImage/"+d+"' border='0'></div><div class='remove-image-sec'><button onclick='removeUserImages("+b.id+",this)' class='remove-image'><i class='fa fa-trash-o'></i></button></div><div class='place-image'><a onclick='loadImageONCanvas(this.rel,"+b.id+"); return false;' class ='place-stage-image' href='javascript:void(0); return false; ' target='_blank' rel='"+c+"' ><i class='fa fa-share'></i></a></div>"+f+"</li>"),1==isFront&&""!=customer_id&&initHDUploaders(b.id)}),$j("#galleryBtn").trigger("click");var h=svgCanvas.getSelectedElems();if(1==h.length&&"photobox"==h[0].getAttribute("type")&&"true"==h[0].childNodes[0].childNodes[0].getAttribute("isAdminUploaded")&&(console.log("photoboxData"),console.log("obj"),console.log(g),g.status&&g.images.length)){var i=e+g.images[0].image_name;if(svgCanvas.getPrivateMethods().extensions.imageEffect){var j=new Image;j.onload=function(a){svgCanvas.getPrivateMethods().extensions.imageEffect.loadImageinPhotobox(h[0],i,a.target.naturalWidth,a.target.naturalHeight),svgCanvas.clearSelection()},j.src=i}$j("#images-upload").hide()}hideLoader()},ChunkUploaded:function(){},UploadComplete:function(a){var b=a.files.length;for(i=0;i<b;i++)a.files[0]&&void 0!==a.files[0]&&a.removeFile(a.files[0]);$j("#svg_image_upload",window.document).hide(),$j("#tool_image_upload_cancel").trigger("click"),hideLoader()},Destroy:function(){},Error:function(a,b){$j.alert(b.message),$j(".ui-state-default.ui-widget-header.plupload_header div:gt(1)").remove(),a.refresh(),hideLoader()}}}),b.init()}),function(a,b,c){a.fn.jScrollPane=function(d){function e(d,e){function f(b){var e,h,i,k,m,n,o=!1,r=!1;if(P=b,Q===c)m=d.scrollTop(),n=d.scrollLeft(),d.css({overflow:"hidden",padding:0}),R=d.innerWidth()+tb,S=d.innerHeight(),d.width(R),Q=a('<div class="jspPane" />').css("padding",sb).append(d.children()),T=a('<div class="jspContainer" />').css({width:R+"px",height:S+"px"}).append(Q).appendTo(d);else{if(d.css("width",""),o=P.stickToBottom&&D(),r=P.stickToRight&&E(),k=d.innerWidth()+tb!=R||d.outerHeight()!=S,k&&(R=d.innerWidth()+tb,S=d.innerHeight(),T.css({width:R+"px",height:S+"px"})),!k&&ub==U&&Q.outerHeight()==V)return void d.width(R);ub=U,Q.css("width",""),d.width(R),T.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}Q.css("overflow","auto"),U=b.contentWidth?b.contentWidth:Q[0].scrollWidth,V=Q[0].scrollHeight,Q.css("overflow",""),W=U/R,X=V/S,Y=X>1,Z=W>1,Z||Y?(d.addClass("jspScrollable"),e=P.maintainPosition&&(ab||db),e&&(h=B(),i=C()),g(),j(),l(),e&&(z(r?U-R:h,!1),y(o?V-S:i,!1)),I(),F(),P.enableKeyboardNavigation&&K(),P.clickOnTrack&&p(),M(),P.hijackInternalLinks&&N()):(d.removeClass("jspScrollable"),Q.css({top:0,left:0,width:T.width()-tb}),G(),J(),L(),q()),P.autoReinitialise&&!rb?rb=setInterval(function(){f(P)},P.autoReinitialiseDelay):!P.autoReinitialise&&rb&&clearInterval(rb),m&&d.scrollTop(0)&&y(m,!1),n&&d.scrollLeft(0)&&z(n,!1),d.trigger("jsp-initialised",[Z||Y])}function g(){Y&&(T.append(a('<div class="jspVerticalBar" />').append(a('<div class="jspCap jspCapTop" />'),a('<div class="jspTrack" />').append(a('<div class="jspDrag" />').append(a('<div class="jspDragTop" />'),a('<div class="jspDragBottom" />'))),a('<div class="jspCap jspCapBottom" />'))),eb=T.find(">.jspVerticalBar"),fb=eb.find(">.jspTrack"),$=fb.find(">.jspDrag"),P.showArrows&&(jb=a('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",n(0,-1)).bind("click.jsp",H),kb=a('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",n(0,1)).bind("click.jsp",H),P.arrowScrollOnHover&&(jb.bind("mouseover.jsp",n(0,-1,jb)),kb.bind("mouseover.jsp",n(0,1,kb))),m(fb,P.verticalArrowPositions,jb,kb)),hb=S,T.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){hb-=a(this).outerHeight()}),$.hover(function(){$.addClass("jspHover")},function(){$.removeClass("jspHover")}).bind("mousedown.jsp",function(b){a("body").bind("touchmove",h),a("html").bind("dragstart.jsp selectstart.jsp",H),$.addClass("jspActive");var c=b.pageY-$.position().top;return a("html").bind("mousemove.jsp",function(a){s(a.pageY-c,!1)}).bind("mouseup.jsp mouseleave.jsp",r),!1}),i())}function h(a){a.preventDefault()}function i(){fb.height(hb+"px"),ab=0,gb=P.verticalGutter+fb.outerWidth(),Q.width(R-gb-tb);try{0===eb.position().left&&Q.css("margin-left",gb+"px")}catch(a){}}function j(){Z&&(T.append(a('<div class="jspHorizontalBar" />').append(a('<div class="jspCap jspCapLeft" />'),a('<div class="jspTrack" />').append(a('<div class="jspDrag" />').append(a('<div class="jspDragLeft" />'),a('<div class="jspDragRight" />'))),a('<div class="jspCap jspCapRight" />'))),lb=T.find(">.jspHorizontalBar"),mb=lb.find(">.jspTrack"),bb=mb.find(">.jspDrag"),P.showArrows&&(pb=a('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",n(-1,0)).bind("click.jsp",H),qb=a('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",n(1,0)).bind("click.jsp",H),P.arrowScrollOnHover&&(pb.bind("mouseover.jsp",n(-1,0,pb)),qb.bind("mouseover.jsp",n(1,0,qb))),m(mb,P.horizontalArrowPositions,pb,qb)),bb.hover(function(){bb.addClass("jspHover")},function(){bb.removeClass("jspHover")}).bind("mousedown.jsp",function(b){a("body").bind("touchmove",h),a("html").bind("dragstart.jsp selectstart.jsp",H),bb.addClass("jspActive");var c=b.pageX-bb.position().left;return a("html").bind("mousemove.jsp",function(a){u(a.pageX-c,!1)}).bind("mouseup.jsp mouseleave.jsp",r),!1}),nb=T.innerWidth(),k())}function k(){T.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){nb-=a(this).outerWidth()}),mb.width(nb+"px"),db=0}function l(){if(Z&&Y){var b=mb.outerHeight(),c=fb.outerWidth();hb-=b,a(lb).find(">.jspCap:visible,>.jspArrow").each(function(){nb+=a(this).outerWidth()}),nb-=c,S-=c,R-=b,mb.parent().append(a('<div class="jspCorner" />').css("width",b+"px")),i(),k()}Z&&Q.width(T.outerWidth()-tb+"px"),V=Q.outerHeight(),X=V/S,Z&&(ob=Math.ceil(1/W*nb),ob>P.horizontalDragMaxWidth?ob=P.horizontalDragMaxWidth:ob<P.horizontalDragMinWidth&&(ob=P.horizontalDragMinWidth),bb.width(ob+"px"),cb=nb-ob,v(db)),Y&&(ib=Math.ceil(1/X*hb),ib>P.verticalDragMaxHeight?ib=P.verticalDragMaxHeight:ib<P.verticalDragMinHeight&&(ib=P.verticalDragMinHeight),$.height(ib+"px"),_=hb-ib,t(ab))
}function m(a,b,c,d){var e,f="before",g="after";"os"==b&&(b=/Mac/.test(navigator.platform)?"after":"split"),b==f?g=b:b==g&&(f=b,e=c,c=d,d=e),a[f](c)[g](d)}function n(a,b,c){return function(){return o(a,b,this,c),this.blur(),!1}}function o(b,c,d,e){d=a(d).addClass("jspActive");var f,g,h=!0,i=function(){0!==b&&vb.scrollByX(b*P.arrowButtonSpeed),0!==c&&vb.scrollByY(c*P.arrowButtonSpeed),g=setTimeout(i,h?P.initialDelay:P.arrowRepeatFreq),h=!1};i(),f=e?"mouseout.jsp":"mouseup.jsp",e=e||a("html"),e.bind(f,function(){d.removeClass("jspActive"),g&&clearTimeout(g),g=null,e.unbind(f)})}function p(){q(),Y&&fb.bind("mousedown.jsp",function(b){if(b.originalTarget===c||b.originalTarget==b.currentTarget){var d,e=a(this),f=e.offset(),g=b.pageY-f.top-ab,h=!0,i=function(){var a=e.offset(),c=b.pageY-a.top-ib/2,f=S*P.scrollPagePercent,k=_*f/(V-S);if(0>g)ab-k>c?vb.scrollByY(-f):s(c);else{if(!(g>0))return void j();c>ab+k?vb.scrollByY(f):s(c)}d=setTimeout(i,h?P.initialDelay:P.trackClickRepeatFreq),h=!1},j=function(){d&&clearTimeout(d),d=null,a(document).unbind("mouseup.jsp",j)};return i(),a(document).bind("mouseup.jsp",j),!1}}),Z&&mb.bind("mousedown.jsp",function(b){if(b.originalTarget===c||b.originalTarget==b.currentTarget){var d,e=a(this),f=e.offset(),g=b.pageX-f.left-db,h=!0,i=function(){var a=e.offset(),c=b.pageX-a.left-ob/2,f=R*P.scrollPagePercent,k=cb*f/(U-R);if(0>g)db-k>c?vb.scrollByX(-f):u(c);else{if(!(g>0))return void j();c>db+k?vb.scrollByX(f):u(c)}d=setTimeout(i,h?P.initialDelay:P.trackClickRepeatFreq),h=!1},j=function(){d&&clearTimeout(d),d=null,a(document).unbind("mouseup.jsp",j)};return i(),a(document).bind("mouseup.jsp",j),!1}})}function q(){mb&&mb.unbind("mousedown.jsp"),fb&&fb.unbind("mousedown.jsp")}function r(){a("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp"),a("body").unbind("touchmove",h),$&&$.removeClass("jspActive"),bb&&bb.removeClass("jspActive")}function s(a,b){Y&&(0>a?a=0:a>_&&(a=_),b===c&&(b=P.animateScroll),b?vb.animate($,"top",a,t):($.css("top",a),t(a)))}function t(a){a===c&&(a=$.position().top),T.scrollTop(0),ab=a;var b=0===ab,e=ab==_,f=a/_,g=-f*(V-S);(wb!=b||yb!=e)&&(wb=b,yb=e,d.trigger("jsp-arrow-change",[wb,yb,xb,zb])),w(b,e),Q.css("top",g),d.trigger("jsp-scroll-y",[-g,b,e]).trigger("scroll")}function u(a,b){Z&&(0>a?a=0:a>cb&&(a=cb),b===c&&(b=P.animateScroll),b?vb.animate(bb,"left",a,v):(bb.css("left",a),v(a)))}function v(a){a===c&&(a=bb.position().left),T.scrollTop(0),db=a;var b=0===db,e=db==cb,f=a/cb,g=-f*(U-R);(xb!=b||zb!=e)&&(xb=b,zb=e,d.trigger("jsp-arrow-change",[wb,yb,xb,zb])),x(b,e),Q.css("left",g),d.trigger("jsp-scroll-x",[-g,b,e]).trigger("scroll")}function w(a,b){P.showArrows&&(jb[a?"addClass":"removeClass"]("jspDisabled"),kb[b?"addClass":"removeClass"]("jspDisabled"))}function x(a,b){P.showArrows&&(pb[a?"addClass":"removeClass"]("jspDisabled"),qb[b?"addClass":"removeClass"]("jspDisabled"))}function y(a,b){var c=a/(V-S);s(c*_,b)}function z(a,b){var c=a/(U-R);u(c*cb,b)}function A(b,c,d){var e,f,g,h,i,j,k,l,m,n=0,o=0;try{e=a(b)}catch(p){return}for(f=e.outerHeight(),g=e.outerWidth(),T.scrollTop(0),T.scrollLeft(0);!e.is(".jspPane");)if(n+=e.position().top,o+=e.position().left,e=e.offsetParent(),/^body|html$/i.test(e[0].nodeName))return;h=C(),j=h+S,h>n||c?l=n-P.horizontalGutter:n+f>j&&(l=n-S+f+P.horizontalGutter),isNaN(l)||y(l,d),i=B(),k=i+R,i>o||c?m=o-P.horizontalGutter:o+g>k&&(m=o-R+g+P.horizontalGutter),isNaN(m)||z(m,d)}function B(){return-Q.position().left}function C(){return-Q.position().top}function D(){var a=V-S;return a>20&&a-C()<10}function E(){var a=U-R;return a>20&&a-B()<10}function F(){T.unbind(Bb).bind(Bb,function(a,b,c,d){var e=db,f=ab,g=a.deltaFactor||P.mouseWheelSpeed;return vb.scrollBy(c*g,-d*g,!1),e==db&&f==ab})}function G(){T.unbind(Bb)}function H(){return!1}function I(){Q.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(a){A(a.target,!1)})}function J(){Q.find(":input,a").unbind("focus.jsp")}function K(){function b(){var a=db,b=ab;switch(c){case 40:vb.scrollByY(P.keyboardSpeed,!1);break;case 38:vb.scrollByY(-P.keyboardSpeed,!1);break;case 34:case 32:vb.scrollByY(S*P.scrollPagePercent,!1);break;case 33:vb.scrollByY(-S*P.scrollPagePercent,!1);break;case 39:vb.scrollByX(P.keyboardSpeed,!1);break;case 37:vb.scrollByX(-P.keyboardSpeed,!1)}return e=a!=db||b!=ab}var c,e,f=[];Z&&f.push(lb[0]),Y&&f.push(eb[0]),Q.focus(function(){d.focus()}),d.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(d){if(d.target===this||f.length&&a(d.target).closest(f).length){var g=db,h=ab;switch(d.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:c=d.keyCode,b();break;case 35:y(V-S),c=null;break;case 36:y(0),c=null}return e=d.keyCode==c&&g!=db||h!=ab,!e}}).bind("keypress.jsp",function(a){return a.keyCode==c&&b(),!e}),P.hideFocus?(d.css("outline","none"),"hideFocus"in T[0]&&d.attr("hideFocus",!0)):(d.css("outline",""),"hideFocus"in T[0]&&d.attr("hideFocus",!1))}function L(){d.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp")}function M(){if(location.hash&&location.hash.length>1){var b,c,d=escape(location.hash.substr(1));try{b=a("#"+d+', a[name="'+d+'"]')}catch(e){return}b.length&&Q.find(d)&&(0===T.scrollTop()?c=setInterval(function(){T.scrollTop()>0&&(A(b,!0),a(document).scrollTop(T.position().top),clearInterval(c))},50):(A(b,!0),a(document).scrollTop(T.position().top)))}}function N(){a(document.body).data("jspHijack")||(a(document.body).data("jspHijack",!0),a(document.body).delegate("a[href*=#]","click",function(c){var d,e,f,g,h,i,j=this.href.substr(0,this.href.indexOf("#")),k=location.href;if(-1!==location.href.indexOf("#")&&(k=location.href.substr(0,location.href.indexOf("#"))),j===k){d=escape(this.href.substr(this.href.indexOf("#")+1));try{e=a("#"+d+', a[name="'+d+'"]')}catch(l){return}e.length&&(f=e.closest(".jspScrollable"),g=f.data("jsp"),g.scrollToElement(e,!0),f[0].scrollIntoView&&(h=a(b).scrollTop(),i=e.offset().top,(h>i||i>h+a(b).height())&&f[0].scrollIntoView()),c.preventDefault())}}))}function O(){var a=C(),b=B();d.removeClass("jspScrollable").unbind(".jsp"),d.replaceWith(Ab.append(Q.children())),Ab.scrollTop(a),Ab.scrollLeft(b),rb&&clearInterval(rb)}var P,Q,R,S,T,U,V,W,X,Y,Z,$,_,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb=this,wb=!0,xb=!0,yb=!1,zb=!1,Ab=d.clone(!1,!1).empty(),Bb=a.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";"border-box"===d.css("box-sizing")?(sb=0,tb=0):(sb=d.css("paddingTop")+" "+d.css("paddingRight")+" "+d.css("paddingBottom")+" "+d.css("paddingLeft"),tb=(parseInt(d.css("paddingLeft"),10)||0)+(parseInt(d.css("paddingRight"),10)||0)),a.extend(vb,{reinitialise:function(b){b=a.extend({},P,b),f(b)},scrollToElement:function(a,b,c){A(a,b,c)},scrollTo:function(a,b,c){z(a,c),y(b,c)},scrollToX:function(a,b){z(a,b)},scrollToY:function(a,b){y(a,b)},scrollToPercentX:function(a,b){z(a*(U-R),b)},scrollToPercentY:function(a,b){y(a*(V-S),b)},scrollBy:function(a,b,c){vb.scrollByX(a,c),vb.scrollByY(b,c)},scrollByX:function(a,b){var c=B()+Math[0>a?"floor":"ceil"](a),d=c/(U-R);u(d*cb,b)},scrollByY:function(a,b){var c=C()+Math[0>a?"floor":"ceil"](a),d=c/(V-S);s(d*_,b)},positionDragX:function(a,b){u(a,b)},positionDragY:function(a,b){s(a,b)},animate:function(a,b,c,d){var e={};e[b]=c,a.animate(e,{duration:P.animateDuration,easing:P.animateEase,queue:!1,step:d})},getContentPositionX:function(){return B()},getContentPositionY:function(){return C()},getContentWidth:function(){return U},getContentHeight:function(){return V},getPercentScrolledX:function(){return B()/(U-R)},getPercentScrolledY:function(){return C()/(V-S)},getIsScrollableH:function(){return Z},getIsScrollableV:function(){return Y},getContentPane:function(){return Q},scrollToBottom:function(a){s(_,a)},hijackInternalLinks:a.noop,destroy:function(){O()}}),f(e)}return d=a.extend({},a.fn.jScrollPane.defaults,d),a.each(["arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){d[this]=d[this]||d.speed}),this.each(function(){var b=a(this),c=b.data("jsp");c?c.reinitialise(d):(a("script",b).filter('[type="text/javascript"],:not([type])').remove(),c=new e(b,d),b.data("jsp",c))})},a.fn.jScrollPane.defaults={showArrows:!1,maintainPosition:!0,stickToBottom:!1,stickToRight:!1,clickOnTrack:!0,autoReinitialise:!1,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:c,animateScroll:!1,animateDuration:300,animateEase:"linear",hijackInternalLinks:!1,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:3,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:!1,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:!0,hideFocus:!1,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8}}(jQuery,this);var ImportTemplate=function(){function a(a){a=$j.trim(a);var b="</"+a.substring(1)+">";switch(a){case"<path":case"<rect":case"<feGaussianBlur":case"<image":b="/>";break;case"<g":case"<mask":case"<filter":case"<title":case"<foreignObject":case"<i:pgf":case"<text":case"<metadata":case"<marker":case"<rdf:RDF":case"<desc":break;case"<!DOCTYPE":b="]>";break;case"<switch>":case"</switch>":b=">"}return b}var b,c,d=["<i:pgf ","<switch>","</switch>","<foreignObject ","<desc"],e=["<linearGradient ","<radialGradient "],f=["<text ","<image "],g=loadedFonts=0,h=function(a){var b=/(>)\s*(<)(\/*)/g,c=/ *(.*) +\n/g,d=/(<.+>)(.+\n)/g;a=a.replace(b,"$1\n$2$3").replace(c,"$1\n").replace(d,"$1\n$2");for(var e="",f=a.split("\n"),g=0,h="other",i={"single->single":0,"single->closing":-1,"single->opening":0,"single->other":0,"closing->single":0,"closing->closing":-1,"closing->opening":0,"closing->other":0,"opening->single":1,"opening->closing":0,"opening->opening":1,"opening->other":1,"other->single":0,"other->closing":-1,"other->opening":0,"other->other":0},j=0;j<f.length;j++){var k=f[j],l=Boolean(k.match(/<.+\/>/)),m=Boolean(k.match(/<\/.+>/)),n=Boolean(k.match(/<[^!].*>/)),o=l?"single":m?"closing":n?"opening":"other",p=h+"->"+o;h=o;var q="";g+=i[p];for(var r=0;g>r;r++)q+="	";"opening->closing"==p?e=e.substr(0,e.length-1)+k+"\n":e+=q+k+"\n"}return e};return{loadSVGTemplate:function(){if(showLoader(),this.files&&this.files[0]){var c=this.files[0].name,i=c.split(".");if("svg"!=i[i.length-1])return $j.alert("File type not supported."),void hideLoader();var j=new FileReader;j.onload=function(c){b.setText("");for(var i=$j.trim(h(c.target.result)),j=0;j<d.length;j++)for(var k=0,l=d[j];i.indexOf(l,k)>-1;){k=i.indexOf(l,k);var m=a(l),n=i.slice(0,k),o=i.slice(i.indexOf(m,k)+m.length);i=n+o,k++}for(var p=[],j=0;j<e.length;j++){var l=e[j];i.indexOf(l)>-1&&p.push(l.substring(1))}if(p.length)return $j.alert("we do not support "+p.toString()),void hideLoader();p=[];for(var q=[],r=[],j=0;j<f.length;j++)for(var k=0,l=f[j];i.indexOf(l,k)>-1;){k=i.indexOf(l,k);var m=a(l),n=i.slice(k,i.indexOf(m,k)+m.length),s=$j(n);if(p.push(s),"text"==s[0].localName){var t=s.attr("font-family"),u=fontData[t];u?r.push(t):q.push(t)}k++}if(q.length)return $j.alert("we do not have "+q.toString()+" fonts installed. please install this font(s) or remove related text(s) from the svg and try import again."),void hideLoader();if("web2print"==toolType){var v=svgedit.utilities.text2xml(i),w=findNodeWithTitleName(v.firstChild.childNodes,"background"),x=findNodeWithTitleName(v.firstChild.childNodes,"Layer 1"),y=findNodeWithTitleName(v.firstChild.childNodes,"Border");if(w&&x&&y){var z=findNodeWithTitleName(svgCanvas.getContentElem().childNodes,"background");z&&(svgCanvas.getContentElem().insertBefore(w.cloneNode(!0),z),svgCanvas.getContentElem().removeChild(z));var A=findNodeWithTitleName(svgCanvas.getContentElem().childNodes,"Layer 1");A&&(svgCanvas.getContentElem().insertBefore(x.cloneNode(!0),A),svgCanvas.getContentElem().removeChild(A));var B=findNodeWithTitleName(svgCanvas.getContentElem().childNodes,"Border");return B&&(svgCanvas.getContentElem().insertBefore(y.cloneNode(!0),B),svgCanvas.getContentElem().removeChild(B)),void hideLoader()}}if(g=loadedFonts=0,r.length){r=$j.unique(r),g=r.length;for(var j=0;j<r.length;j++){var u=Raphael.fonts[r[j]];u?loadedFonts++:$j.getScript(Smm.fontDirectory+fontData[r[j]].jsFile).done(function(){loadedFonts++}).fail(function(){loadedFonts++})}}var v=svgedit.utilities.text2xml(i);svgedit.sanitize.cleanNotAllowedElems();var C=svgedit.sanitize.sanitizeSvgForImport(v.documentElement);b.setText(i);for(var j=0;j<C.length;j++)for(var l="<"+C[j].nodeName,k=0;i.indexOf(l,k)>-1;){k=i.indexOf(l,k);var m=a(l);b.formatText(k,i.indexOf(m,k)+m.length,"color","#ff0000"),k++}$j("#btnAddUpdateSvg")[0].innerHTML=svgEditor.uiStrings.optionalParam.ImportSVG,$j("#importSvgInstruction")[0].innerHTML=svgEditor.uiStrings.optionalParam.ImportSVGInstruction,$j("#importTemplate_window").show(),hideLoader()},j.readAsText(this.files[0])}else hideLoader();$j("#import_svg").val("")},convertText:function(){if(g==loadedFonts){clearInterval(c);var a=findNodeWithTitleName(svgCanvas.getContentElem().childNodes,"Layer 1");for($j.each(a.childNodes,function(a,b){"text"==b.tagName&&$j(b).text()&&svgCanvas.getPrivateMethods().extensions.textShape.addText($j(b))}),a=findNodeWithTitleName(svgCanvas.getContentElem().childNodes,"Layer 1");a.getElementsByTagName("text").length;){var b=a.getElementsByTagName("text")[0];b.parentNode.removeChild(b)}svgCanvas.getPrivateMethods().extensions.LayerPanel&&svgCanvas.getPrivateMethods().extensions.LayerPanel.update()}},AddUpdateTemplate:function(a,d){d&&"undefined"!=typeof d||(d=$j.trim(b.getText())),$j("#btnAddUpdateSvg")[0].innerHTML==svgEditor.uiStrings.optionalParam.ImportSVG&&(svgCanvas.setDesignIdea(d),svgEditor.updateCanvas(),svgCanvas.ungroupSelectedElement(),svgCanvas.ungroupSelectedElement(),svgCanvas.ungroupSelectedElement(),svgEditor.updateCanvas()),$j("#importTemplate_window").hide(),c=setInterval(this.convertText,200)},initiateEditor:function(){"admin"==user&&($j("#btnAddUpdateSvg").click(ImportTemplate.AddUpdateTemplate),$j("#import_svg").change(ImportTemplate.loadSVGTemplate),b=new Quill("#editor-container",{modules:{"link-tooltip":!0,"image-tooltip":!0}}))}}}();!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.Quill=a()}}(function(){var a;return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c?c:b)},k,k.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(b,c,d){(function(b){(function(){function e(a,b,c){if(b!==b)return h(a,c);for(var d=c-1,e=a.length;++d<e;)if(a[d]===b)return d;return-1}function f(a){return"function"==typeof a||!1}function g(a){return"string"==typeof a?a:null==a?"":a+""}function h(a,b,c){for(var d=a.length,e=b+(c?0:-1);c?e--:++e<d;){var f=a[e];if(f!==f)return e}return-1}function i(a){return a&&"object"==typeof a||!1}function j(a,b){for(var c=-1,d=a.length,e=-1,f=[];++c<d;)a[c]===b&&(a[c]=qc,f[++e]=c);return f}function k(){}function l(a){var b=a?a.length:0;for(this.data={hash:sd(null),set:new nd};b--;)this.push(a[b])}function m(a,b){var c=a.data,d="string"==typeof b||Ob(b)?c.set.has(b):c.hash[b];return d?0:-1}function n(a){var b=this.data;"string"==typeof a||Ob(a)?b.set.add(a):b.hash[a]=!0}function o(a,b){var c=-1,d=a.length;for(b||(b=Array(d));++c<d;)b[c]=a[c];return b}function p(a,b){for(var c=-1,d=a.length;++c<d&&b(a[c],c,a)!==!1;);return a}function q(a,b){for(var c=-1,d=a.length;++c<d;)if(!b(a[c],c,a))return!1;return!0}function r(a,b){for(var c=-1,d=a.length,e=Array(d);++c<d;)e[c]=b(a[c],c,a);return e}function s(a,b,c,d){var e=-1,f=a.length;for(d&&f&&(c=a[++e]);++e<f;)c=b(c,a[e],e,a);return c}function t(a,b){return"undefined"==typeof a?b:a}function u(a,b,c){var d=Od(b);if(!c)return v(b,a,d);for(var e=-1,f=d.length;++e<f;){var g=d[e],h=a[g],i=c(h,b[g],g,a,b);(i===i?i===h:h!==h)&&("undefined"!=typeof h||g in a)||(a[g]=i)}return a}function v(a,b,c){c||(c=b,b={});for(var d=-1,e=c.length;++d<e;){var f=c[d];b[f]=a[f]}return b}function w(a,b,c){var d=typeof a;return"function"==d?"undefined"!=typeof b&&kb(a)?U(a,b,c):a:null==a?$b:"object"==d?M(a):"undefined"==typeof b?O(a+""):N(a+"",b)}function x(a,b,c,d,e,f,g){var h;if(c&&(h=e?c(a,d,e):c(a)),"undefined"!=typeof h)return h;if(!Ob(a))return a;var i=Kd(a);if(i){if(h=hb(a),!b)return o(a,h)}else{var j=gd.call(a),k=j==wc;if(j!=zc&&j!=rc&&(!k||e))return Vc[j]?jb(a,j,b):e?a:{};if(h=ib(k?{}:a),!b)return v(a,h,Od(a))}f||(f=[]),g||(g=[]);for(var l=f.length;l--;)if(f[l]==a)return g[l];return f.push(a),g.push(h),(i?p:G)(a,function(d,e){h[e]=x(d,b,c,e,a,f,g)}),h}function y(a,b,c,d){if("function"!=typeof a)throw new TypeError(pc);return setTimeout(function(){a.apply(cc,Q(c,d))},b)}function z(a,b){var c=a?a.length:0,d=[];if(!c)return d;var f=-1,g=gb(),h=g==e,i=h&&b.length>=200?Gd(b):null,j=b.length;i&&(g=m,h=!1,b=i);a:for(;++f<c;){var k=a[f];if(h&&k===k){for(var l=j;l--;)if(b[l]===k)continue a;d.push(k)}else g(b,k,0)<0&&d.push(k)}return d}function A(a,b){var c=a?a.length:0;if(!nb(c))return G(a,b);for(var d=-1,e=vb(a);++d<c&&b(e[d],d,e)!==!1;);return a}function B(a,b){var c=!0;return A(a,function(a,d,e){return c=!!b(a,d,e)}),c}function C(a,b,c,d){var e;return c(a,function(a,c,f){return b(a,c,f)?(e=d?c:a,!1):void 0}),e}function D(a,b,c,d){for(var e=d-1,f=a.length,g=-1,h=[];++e<f;){var j=a[e];if(i(j)&&nb(j.length)&&(Kd(j)||Lb(j))){b&&(j=D(j,b,c,0));var k=-1,l=j.length;for(h.length+=l;++k<l;)h[++g]=j[k]}else c||(h[++g]=j)}return h}function E(a,b,c){for(var d=-1,e=vb(a),f=c(a),g=f.length;++d<g;){var h=f[d];if(b(e[h],h,e)===!1)break}return a}function F(a,b){return E(a,b,Ub)}function G(a,b){return E(a,b,Od)}function H(a,b,c){var d=-1,e="function"==typeof b,f=a?a.length:0,g=nb(f)?Array(f):[];return A(a,function(a){var f=e?b:null!=a&&a[b];g[++d]=f?f.apply(a,c):cc}),g}function I(a,b,c,d,e,f){if(a===b)return 0!==a||1/a==1/b;var g=typeof a,h=typeof b;return"function"!=g&&"object"!=g&&"function"!=h&&"object"!=h||null==a||null==b?a!==a&&b!==b:J(a,b,I,c,d,e,f)}function J(a,b,c,d,e,f,g){var h=Kd(a),i=Kd(b),j=sc,k=sc;h||(j=gd.call(a),j==rc?j=zc:j!=zc&&(h=Sb(a))),i||(k=gd.call(b),k==rc?k=zc:k!=zc&&(i=Sb(b)));var l=j==zc,m=k==zc,n=j==k;if(n&&!h&&!l)return db(a,b,j);var o=l&&ed.call(a,"__wrapped__"),p=m&&ed.call(b,"__wrapped__");if(o||p)return c(o?a.value():a,p?b.value():b,d,e,f,g);if(!n)return!1;f||(f=[]),g||(g=[]);for(var q=f.length;q--;)if(f[q]==a)return g[q]==b;f.push(a),g.push(b);var r=(h?cb:eb)(a,b,c,d,e,f,g);return f.pop(),g.pop(),r}function K(a,b,c,d,e){var f=b.length;if(null==a)return!f;for(var g=-1,h=!e;++g<f;)if(h&&d[g]?c[g]!==a[b[g]]:!ed.call(a,b[g]))return!1;for(g=-1;++g<f;){var i=b[g];if(h&&d[g])var j=ed.call(a,i);else{var k=a[i],l=c[g];j=e?e(k,l,i):cc,"undefined"==typeof j&&(j=I(l,k,e,!0))}if(!j)return!1}return!0}function L(a,b){var c=[];return A(a,function(a,d,e){c.push(b(a,d,e))}),c}function M(a){var b=Od(a),c=b.length;if(1==c){var d=b[0],e=a[d];if(ob(e))return function(a){return null!=a&&a[d]===e&&ed.call(a,d)}}for(var f=Array(c),g=Array(c);c--;)e=a[b[c]],f[c]=e,g[c]=ob(e);return function(a){return K(a,b,f,g)}}function N(a,b){return ob(b)?function(c){return null!=c&&c[a]===b}:function(c){return null!=c&&I(b,c[a],null,!0)}}function O(a){return function(b){return null==b?cc:b[a]}}function P(a,b,c,d,e){return e(a,function(a,e,f){c=d?(d=!1,a):b(c,a,e,f)}),c}function Q(a,b,c){var d=-1,e=a.length;b=null==b?0:+b||0,0>b&&(b=-b>e?0:e+b),c="undefined"==typeof c||c>e?e:+c||0,0>c&&(c+=e),e=b>c?0:c-b>>>0,b>>>=0;for(var f=Array(e);++d<e;)f[d]=a[d+b];return f}function R(a,b){for(var c=-1,d=b.length,e=Array(d);++c<d;)e[c]=a[b[c]];return e}function S(a,b,c){var d=0,e=a?a.length:d;if("number"==typeof b&&b===b&&zd>=e){for(;e>d;){var f=d+e>>>1,g=a[f];(c?b>=g:b>g)?d=f+1:e=f}return e}return T(a,b,$b,c)}function T(a,b,c,d){b=c(b);for(var e=0,f=a?a.length:0,g=b!==b,h="undefined"==typeof b;f>e;){var i=kd((e+f)/2),j=c(a[i]),k=j===j;if(g)var l=k||d;else l=h?k&&(d||"undefined"!=typeof j):d?b>=j:b>j;l?e=i+1:f=i}return vd(f,yd)}function U(a,b,c){if("function"!=typeof a)return $b;if("undefined"==typeof b)return a;switch(c){case 1:return function(c){return a.call(b,c)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,d,e,f){return a.call(b,c,d,e,f)};case 5:return function(c,d,e,f,g){return a.call(b,c,d,e,f,g)}}return function(){return a.apply(b,arguments)}}function V(a){return jd.call(a,0)}function W(a,b,c){for(var d=c.length,e=-1,f=ud(a.length-d,0),g=-1,h=b.length,i=Array(f+h);++g<h;)i[g]=b[g];for(;++e<d;)i[c[e]]=a[e];for(;f--;)i[g++]=a[e++];return i}function X(a,b,c){for(var d=-1,e=c.length,f=-1,g=ud(a.length-e,0),h=-1,i=b.length,j=Array(g+i);++f<g;)j[f]=a[f];for(var k=f;++h<i;)j[k+h]=b[h];for(;++d<e;)j[k+c[d]]=a[f++];return j}function Y(a){return function(){var b=arguments,c=b.length,d=b[0];if(2>c||null==d)return d;var e=b[c-2],f=b[c-1],g=b[3];c>3&&"function"==typeof e?(e=U(e,f,5),c-=2):(e=c>2&&"function"==typeof f?f:null,c-=e?1:0),g&&mb(b[1],b[2],g)&&(e=3==c?null:e,c=2);for(var h=0;++h<c;){var i=b[h];i&&a(d,i,e)}return d}}function Z(a,b){function c(){var e=this&&this!==ad&&this instanceof c?d:a;return e.apply(b,arguments)}var d=$(a);return c}function $(a){return function(){var b=Ed(a.prototype),c=a.apply(b,arguments);return Ob(c)?c:b}}function _(a,b,c,d,e,f,g,h,i,k){function l(){for(var v=arguments.length,w=v,x=Array(v);w--;)x[w]=arguments[w];if(d&&(x=W(x,d,e)),f&&(x=X(x,f,g)),q||s){var y=l.placeholder,z=j(x,y);if(v-=z.length,k>v){var A=h?o(h):null,B=ud(k-v,0),C=q?z:null,D=q?null:z,E=q?x:null,F=q?null:x;b|=q?jc:kc,b&=~(q?kc:jc),r||(b&=~(ec|fc));var G=_(a,b,c,E,C,F,D,A,i,B);return G.placeholder=y,G}}var H=n?c:this;p&&(a=H[u]),h&&(x=sb(x,h)),m&&i<x.length&&(x.length=i);var I=this&&this!==ad&&this instanceof l?t||$(a):a;return I.apply(H,x)}var m=b&mc,n=b&ec,p=b&fc,q=b&hc,r=b&gc,s=b&ic,t=!p&&$(a),u=a;return l}function ab(a,b,c,d){function e(){for(var b=-1,h=arguments.length,i=-1,j=d.length,k=Array(h+j);++i<j;)k[i]=d[i];for(;h--;)k[i++]=arguments[++b];var l=this&&this!==ad&&this instanceof e?g:a;return l.apply(f?c:this,k)}var f=b&ec,g=$(a);return e}function bb(a,b,c,d,e,f,g,h){var i=b&fc;if(!i&&"function"!=typeof a)throw new TypeError(pc);var j=d?d.length:0;if(j||(b&=~(jc|kc),d=e=null),j-=e?e.length:0,b&kc){var k=d,l=e;d=e=null}var m=!i&&Hd(a),n=[a,b,c,d,e,k,l,f,g,h];if(m&&m!==!0&&(pb(n,m),b=n[1],h=n[9]),n[9]=null==h?i?0:a.length:ud(h-j,0)||0,b==ec)var o=Z(n[0],n[2]);else o=b!=jc&&b!=(ec|jc)||n[4].length?_.apply(cc,n):ab.apply(cc,n);var p=m?Fd:Id;return p(o,n)}function cb(a,b,c,d,e,f,g){var h=-1,i=a.length,j=b.length,k=!0;if(i!=j&&!(e&&j>i))return!1;for(;k&&++h<i;){var l=a[h],m=b[h];if(k=cc,d&&(k=e?d(m,l,h):d(l,m,h)),"undefined"==typeof k)if(e)for(var n=j;n--&&(m=b[n],!(k=l&&l===m||c(l,m,d,e,f,g))););else k=l&&l===m||c(l,m,d,e,f,g)}return!!k}function db(a,b,c){switch(c){case tc:case uc:return+a==+b;case vc:return a.name==b.name&&a.message==b.message;case yc:return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case Ac:case Cc:return a==b+""}return!1}function eb(a,b,c,d,e,f,g){var h=Od(a),i=h.length,j=Od(b),k=j.length;if(i!=k&&!e)return!1;for(var l,m=-1;++m<i;){var n=h[m],o=ed.call(b,n);if(o){var p=a[n],q=b[n];o=cc,d&&(o=e?d(q,p,n):d(p,q,n)),"undefined"==typeof o&&(o=p&&p===q||c(p,q,d,e,f,g))}if(!o)return!1;l||(l="constructor"==n)}if(!l){var r=a.constructor,s=b.constructor;if(r!=s&&"constructor"in a&&"constructor"in b&&!("function"==typeof r&&r instanceof r&&"function"==typeof s&&s instanceof s))return!1}return!0}function fb(a,b,c){var d=k.callback||Yb;return d=d===Yb?w:d,c?d(a,b,c):d}function gb(a,b,c){var d=k.indexOf||yb;return d=d===yb?e:d,a?d(a,b,c):d}function hb(a){var b=a.length,c=new a.constructor(b);return b&&"string"==typeof a[0]&&ed.call(a,"index")&&(c.index=a.index,c.input=a.input),c}function ib(a){var b=a.constructor;return"function"==typeof b&&b instanceof b||(b=Object),new b}function jb(a,b,c){var d=a.constructor;switch(b){case Ec:return V(a);case tc:case uc:return new d(+a);case Fc:case Gc:case Hc:case Ic:case Jc:case Kc:case Lc:case Mc:case Nc:var e=a.buffer;return new d(c?V(e):e,a.byteOffset,a.length);case yc:case Cc:return new d(a);case Ac:var f=new d(a.source,Oc.exec(a));f.lastIndex=a.lastIndex}return f}function kb(a){var b=k.support,c=!(b.funcNames?a.name:b.funcDecomp);if(!c){var d=dd.call(a);b.funcNames||(c=!Pc.test(d)),c||(c=Tc.test(d)||Pb(a),Fd(a,c))}return c}function lb(a,b){return a=+a,b=null==b?Bd:b,a>-1&&a%1==0&&b>a}function mb(a,b,c){if(!Ob(c))return!1;var d=typeof b;if("number"==d)var e=c.length,f=nb(e)&&lb(b,e);else f="string"==d&&b in c;if(f){var g=c[b];return a===a?a===g:g!==g}return!1}function nb(a){return"number"==typeof a&&a>-1&&a%1==0&&Bd>=a}function ob(a){return a===a&&(0===a?1/a>0:!Ob(a))}function pb(a,b){var c=a[1],d=b[1],e=c|d,f=mc|lc,g=ec|fc,h=f|g|gc|ic,i=c&mc&&!(d&mc),k=c&lc&&!(d&lc),l=(k?a:b)[7],m=(i?a:b)[8],n=!(c>=lc&&d>g||c>g&&d>=lc),p=e>=f&&h>=e&&(lc>c||(k||i)&&l.length<=m);if(!n&&!p)return a;d&ec&&(a[2]=b[2],e|=c&ec?0:gc);var q=b[3];if(q){var r=a[3];a[3]=r?W(r,q,b[4]):o(q),a[4]=r?j(a[3],qc):o(b[4])}return q=b[5],q&&(r=a[5],a[5]=r?X(r,q,b[6]):o(q),a[6]=r?j(a[5],qc):o(b[6])),q=b[7],q&&(a[7]=o(q)),d&mc&&(a[8]=null==a[8]?b[8]:vd(a[8],b[8])),null==a[9]&&(a[9]=b[9]),a[0]=b[0],a[1]=e,a}function qb(a,b){a=vb(a);for(var c=-1,d=b.length,e={};++c<d;){var f=b[c];f in a&&(e[f]=a[f])}return e}function rb(a,b){var c={};return F(a,function(a,d,e){b(a,d,e)&&(c[d]=a)}),c}function sb(a,b){for(var c=a.length,d=vd(b.length,c),e=o(a);d--;){var f=b[d];a[d]=lb(f,c)?e[f]:cc}return a}function tb(a){{var b;k.support}if(!i(a)||gd.call(a)!=zc||!ed.call(a,"constructor")&&(b=a.constructor,"function"==typeof b&&!(b instanceof b)))return!1;var c;return F(a,function(a,b){c=b}),"undefined"==typeof c||ed.call(a,c)}function ub(a){for(var b=Ub(a),c=b.length,d=c&&a.length,e=k.support,f=d&&nb(d)&&(Kd(a)||e.nonEnumArgs&&Lb(a)),g=-1,h=[];++g<c;){var i=b[g];(f&&lb(i,d)||ed.call(a,i))&&h.push(i)}return h}function vb(a){return Ob(a)?a:Object(a)}function wb(){for(var a=arguments,b=-1,c=a.length;++b<c;){var d=a[b];if(Kd(d)||Lb(d))break}return z(d,D(a,!1,!0,++b))}function xb(a,b,c){var d=-1,e=a?a.length:0;for(b=fb(b,c,3);++d<e;)if(b(a[d],d,a))return d;return-1}function yb(a,b,c){var d=a?a.length:0;if(!d)return-1;if("number"==typeof c)c=0>c?ud(d+c,0):c;else if(c){var f=S(a,b),g=a[f];return(b===b?b===g:g!==g)?f:-1}return e(a,b,c||0)}function zb(){for(var a=[],b=-1,c=arguments.length,d=[],f=gb(),g=f==e;++b<c;){var h=arguments[b];(Kd(h)||Lb(h))&&(a.push(h),d.push(g&&h.length>=120?Gd(b&&h):null))}c=a.length;var i=a[0],j=-1,k=i?i.length:0,l=[],n=d[0];a:for(;++j<k;)if(h=i[j],(n?m(n,h):f(l,h,0))<0){for(b=c;--b;){var o=d[b];if((o?m(o,h):f(a[b],h,0))<0)continue a}n&&n.push(h),l.push(h)}return l}function Ab(a){var b=a?a.length:0;return b?a[b-1]:cc}function Bb(a,b,c){var d=Kd(a)?q:B;return("function"!=typeof b||"undefined"!=typeof c)&&(b=fb(b,c,3)),d(a,b)}function Cb(a,b,c){if(Kd(a)){var d=xb(a,b,c);return d>-1?a[d]:cc}return b=fb(b,c,3),C(a,b,A)}function Db(a,b,c){return"function"==typeof b&&"undefined"==typeof c&&Kd(a)?p(a,b):A(a,U(b,c,3))}function Eb(a,b){return H(a,b,Q(arguments,2))}function Fb(a,b,c){var d=Kd(a)?r:L;return b=fb(b,c,3),d(a,b)}function Gb(a,b,c,d){var e=Kd(a)?s:P;return e(a,fb(b,d,4),c,arguments.length<3,A)}function Hb(a,b){var c=ec;if(arguments.length>2){var d=Q(arguments,2),e=j(d,Hb.placeholder);c|=jc}return bb(a,c,b,d,e)}function Ib(a){return y(a,1,arguments,1)}function Jb(a){var b=Q(arguments,1),c=j(b,Jb.placeholder);return bb(a,jc,null,b,c)}function Kb(a,b,c,d){return b&&"boolean"!=typeof b&&mb(a,b,c)?b=!1:"function"==typeof b&&(d=c,c=b,b=!1),c="function"==typeof c&&U(c,d,1),x(a,b,c)}function Lb(a){var b=i(a)?a.length:cc;return nb(b)&&gd.call(a)==rc||!1}function Mb(a){return a&&1===a.nodeType&&i(a)&&gd.call(a).indexOf("Element")>-1||!1}function Nb(a,b,c,d){if(c="function"==typeof c&&U(c,d,3),!c&&ob(a)&&ob(b))return a===b;var e=c?c(a,b):cc;return"undefined"==typeof e?I(a,b,c):!!e}function Ob(a){var b=typeof a;return"function"==b||a&&"object"==b||!1}function Pb(a){return null==a?!1:gd.call(a)==wc?hd.test(dd.call(a)):i(a)&&Qc.test(a)||!1}function Qb(a){return"number"==typeof a||i(a)&&gd.call(a)==yc||!1}function Rb(a){return"string"==typeof a||i(a)&&gd.call(a)==Cc||!1}function Sb(a){return i(a)&&nb(a.length)&&Uc[gd.call(a)]||!1}function Tb(a){if(null==a)return a;var b=o(arguments);return b.push(t),Nd.apply(cc,b)}function Ub(a){if(null==a)return[];Ob(a)||(a=Object(a));var b=a.length;b=b&&nb(b)&&(Kd(a)||Dd.nonEnumArgs&&Lb(a))&&b||0;for(var c=a.constructor,d=-1,e="function"==typeof c&&c.prototype===a,f=Array(b),g=b>0;++d<b;)f[d]=d+"";for(var h in a)g&&lb(h,b)||"constructor"==h&&(e||!ed.call(a,h))||f.push(h);return f}function Vb(a,b,c){if(null==a)return{};if("function"!=typeof b){var d=r(D(arguments,!1,!1,1),String);return qb(a,z(Ub(a),d))}return b=U(b,c,3),rb(a,function(a,c,d){return!b(a,c,d)})}function Wb(a){return R(a,Od(a))}function Xb(a){return a=g(a),a&&Sc.test(a)?a.replace(Rc,"\\$&"):a}function Yb(a,b,c){return c&&mb(a,b,c)&&(b=null),i(a)?_b(a):w(a,b)}function Zb(a){return function(){return a}}function $b(a){return a}function _b(a){return M(x(a,!0))}function ac(){}function bc(a){var b=++fd;return g(a)+b}var cc,dc="3.5.0",ec=1,fc=2,gc=4,hc=8,ic=16,jc=32,kc=64,lc=128,mc=256,nc=150,oc=16,pc="Expected a function",qc="__lodash_placeholder__",rc="[object Arguments]",sc="[object Array]",tc="[object Boolean]",uc="[object Date]",vc="[object Error]",wc="[object Function]",xc="[object Map]",yc="[object Number]",zc="[object Object]",Ac="[object RegExp]",Bc="[object Set]",Cc="[object String]",Dc="[object WeakMap]",Ec="[object ArrayBuffer]",Fc="[object Float32Array]",Gc="[object Float64Array]",Hc="[object Int8Array]",Ic="[object Int16Array]",Jc="[object Int32Array]",Kc="[object Uint8Array]",Lc="[object Uint8ClampedArray]",Mc="[object Uint16Array]",Nc="[object Uint32Array]",Oc=/\w*$/,Pc=/^\s*function[ \n\r\t]+\w/,Qc=/^\[object .+?Constructor\]$/,Rc=/[.*+?^${}()|[\]\/\\]/g,Sc=RegExp(Rc.source),Tc=/\bthis\b/,Uc={};Uc[Fc]=Uc[Gc]=Uc[Hc]=Uc[Ic]=Uc[Jc]=Uc[Kc]=Uc[Lc]=Uc[Mc]=Uc[Nc]=!0,Uc[rc]=Uc[sc]=Uc[Ec]=Uc[tc]=Uc[uc]=Uc[vc]=Uc[wc]=Uc[xc]=Uc[yc]=Uc[zc]=Uc[Ac]=Uc[Bc]=Uc[Cc]=Uc[Dc]=!1;var Vc={};Vc[rc]=Vc[sc]=Vc[Ec]=Vc[tc]=Vc[uc]=Vc[Fc]=Vc[Gc]=Vc[Hc]=Vc[Ic]=Vc[Jc]=Vc[yc]=Vc[zc]=Vc[Ac]=Vc[Cc]=Vc[Kc]=Vc[Lc]=Vc[Mc]=Vc[Nc]=!0,Vc[vc]=Vc[wc]=Vc[xc]=Vc[Bc]=Vc[Dc]=!1;var Wc={"function":!0,object:!0},Xc=Wc[typeof d]&&d&&!d.nodeType&&d,Yc=Wc[typeof c]&&c&&!c.nodeType&&c,Zc=Xc&&Yc&&"object"==typeof b&&b,$c=Wc[typeof window]&&window,_c=Yc&&Yc.exports===Xc&&Xc,ad=Zc||$c!==(this&&this.window)&&$c||this,bd=Object.prototype,cd=(cd=ad.window)&&cd.document,dd=Function.prototype.toString,ed=bd.hasOwnProperty,fd=0,gd=bd.toString,hd=RegExp("^"+Xb(gd).replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),id=Pb(id=ad.ArrayBuffer)&&id,jd=Pb(jd=id&&new id(0).slice)&&jd,kd=Math.floor,ld=Pb(ld=Object.getPrototypeOf)&&ld,md=bd.propertyIsEnumerable,nd=Pb(nd=ad.Set)&&nd,od=Pb(od=ad.Uint8Array)&&od,pd=Pb(pd=ad.WeakMap)&&pd,qd=function(){try{var a=Pb(a=ad.Float64Array)&&a,b=new a(new id(10),0,1)&&a}catch(c){}return b}(),rd=Pb(rd=Array.isArray)&&rd,sd=Pb(sd=Object.create)&&sd,td=Pb(td=Object.keys)&&td,ud=Math.max,vd=Math.min,wd=Pb(wd=Date.now)&&wd,xd=Math.pow(2,32)-1,yd=xd-1,zd=xd>>>1,Ad=qd?qd.BYTES_PER_ELEMENT:0,Bd=Math.pow(2,53)-1,Cd=pd&&new pd,Dd=k.support={};!function(){Dd.funcDecomp=!Pb(ad.WinRTError)&&Tc.test(function(){return this}),Dd.funcNames="string"==typeof Function.name;try{Dd.dom=11===cd.createDocumentFragment().nodeType}catch(a){Dd.dom=!1}try{Dd.nonEnumArgs=!md.call(arguments,1)
}catch(a){Dd.nonEnumArgs=!0}}(0,0);var Ed=function(){function a(){}return function(b){if(Ob(b)){a.prototype=b;var c=new a;a.prototype=null}return c||ad.Object()}}(),Fd=Cd?function(a,b){return Cd.set(a,b),a}:$b;jd||(V=id&&od?function(a){var b=a.byteLength,c=qd?kd(b/Ad):0,d=c*Ad,e=new id(b);if(c){var f=new qd(e,0,c);f.set(new qd(a,0,c))}return b!=d&&(f=new od(e,d),f.set(new od(a,d))),e}:Zb(null));var Gd=sd&&nd?function(a){return new l(a)}:Zb(null),Hd=Cd?function(a){return Cd.get(a)}:ac,Id=function(){var a=0,b=0;return function(c,d){var e=Jd(),f=oc-(e-b);if(b=e,f>0){if(++a>=nc)return c}else a=0;return Fd(c,d)}}(),Jd=wd||function(){return(new Date).getTime()},Kd=rd||function(a){return i(a)&&nb(a.length)&&gd.call(a)==sc||!1};Dd.dom||(Mb=function(a){return a&&1===a.nodeType&&i(a)&&!Md(a)||!1});var Ld=f(/x/)||od&&!f(od)?function(a){return gd.call(a)==wc}:f,Md=ld?function(a){if(!a||gd.call(a)!=zc)return!1;var b=a.valueOf,c=Pb(b)&&(c=ld(b))&&ld(c);return c?a==c||ld(a)==c:tb(a)}:tb,Nd=Y(u),Od=td?function(a){if(a)var b=a.constructor,c=a.length;return"function"==typeof b&&b.prototype===a||"function"!=typeof a&&c&&nb(c)?ub(a):Ob(a)?td(a):[]}:ub;l.prototype.push=n,k.assign=Nd,k.bind=Hb,k.callback=Yb,k.constant=Zb,k.defaults=Tb,k.defer=Ib,k.difference=wb,k.forEach=Db,k.intersection=zb,k.invoke=Eb,k.keys=Od,k.keysIn=Ub,k.map=Fb,k.matches=_b,k.omit=Vb,k.partial=Jb,k.values=Wb,k.collect=Fb,k.each=Db,k.extend=Nd,k.iteratee=Yb,k.clone=Kb,k.escapeRegExp=Xb,k.every=Bb,k.find=Cb,k.findIndex=xb,k.identity=$b,k.indexOf=yb,k.isArguments=Lb,k.isArray=Kd,k.isElement=Mb,k.isEqual=Nb,k.isFunction=Ld,k.isNative=Pb,k.isNumber=Qb,k.isObject=Ob,k.isPlainObject=Md,k.isString=Rb,k.isTypedArray=Sb,k.last=Ab,k.noop=ac,k.now=Jd,k.reduce=Gb,k.uniqueId=bc,k.all=Bb,k.detect=Cb,k.foldl=Gb,k.inject=Gb,k.VERSION=dc,p(["bind","partial"],function(a){k[a].placeholder=k}),"function"==typeof a&&"object"==typeof a.amd&&a.amd?(ad._=k,a(function(){return k})):Xc&&Yc?_c?(Yc.exports=k)._=k:Xc._=k:ad._=k}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(b,c,d){!function(){function b(){this._events={},this._conf&&c.call(this,this._conf)}function c(a){a&&(this._conf=a,a.delimiter&&(this.delimiter=a.delimiter),a.maxListeners&&(this._events.maxListeners=a.maxListeners),a.wildcard&&(this.wildcard=a.wildcard),a.newListener&&(this.newListener=a.newListener),this.wildcard&&(this.listenerTree={}))}function e(a){this._events={},this.newListener=!1,c.call(this,a)}function f(a,b,c,d){if(!c)return[];var e,g,h,i,j,k,l,m=[],n=b.length,o=b[d],p=b[d+1];if(d===n&&c._listeners){if("function"==typeof c._listeners)return a&&a.push(c._listeners),[c];for(e=0,g=c._listeners.length;g>e;e++)a&&a.push(c._listeners[e]);return[c]}if("*"===o||"**"===o||c[o]){if("*"===o){for(h in c)"_listeners"!==h&&c.hasOwnProperty(h)&&(m=m.concat(f(a,b,c[h],d+1)));return m}if("**"===o){l=d+1===n||d+2===n&&"*"===p,l&&c._listeners&&(m=m.concat(f(a,b,c,n)));for(h in c)"_listeners"!==h&&c.hasOwnProperty(h)&&("*"===h||"**"===h?(c[h]._listeners&&!l&&(m=m.concat(f(a,b,c[h],n))),m=m.concat(f(a,b,c[h],d))):m=m.concat(h===p?f(a,b,c[h],d+2):f(a,b,c[h],d)));return m}m=m.concat(f(a,b,c[o],d+1))}if(i=c["*"],i&&f(a,b,i,d+1),j=c["**"])if(n>d){j._listeners&&f(a,b,j,n);for(h in j)"_listeners"!==h&&j.hasOwnProperty(h)&&(h===p?f(a,b,j[h],d+2):h===o?f(a,b,j[h],d+1):(k={},k[h]=j[h],f(a,b,{"**":k},d+1)))}else j._listeners?f(a,b,j,n):j["*"]&&j["*"]._listeners&&f(a,b,j["*"],n);return m}function g(a,b){a="string"==typeof a?a.split(this.delimiter):a.slice();for(var c=0,d=a.length;d>c+1;c++)if("**"===a[c]&&"**"===a[c+1])return;for(var e=this.listenerTree,f=a.shift();f;){if(e[f]||(e[f]={}),e=e[f],0===a.length){if(e._listeners){if("function"==typeof e._listeners)e._listeners=[e._listeners,b];else if(h(e._listeners)&&(e._listeners.push(b),!e._listeners.warned)){var g=i;"undefined"!=typeof this._events.maxListeners&&(g=this._events.maxListeners),g>0&&e._listeners.length>g&&(e._listeners.warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",e._listeners.length),console.trace())}}else e._listeners=b;return!0}f=a.shift()}return!0}var h=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},i=10;e.prototype.delimiter=".",e.prototype.setMaxListeners=function(a){this._events||b.call(this),this._events.maxListeners=a,this._conf||(this._conf={}),this._conf.maxListeners=a},e.prototype.event="",e.prototype.once=function(a,b){return this.many(a,1,b),this},e.prototype.many=function(a,b,c){function d(){0===--b&&e.off(a,d),c.apply(this,arguments)}var e=this;if("function"!=typeof c)throw new Error("many only accepts instances of Function");return d._origin=c,this.on(a,d),e},e.prototype.emit=function(){this._events||b.call(this);var a=arguments[0];if("newListener"===a&&!this.newListener&&!this._events.newListener)return!1;if(this._all){for(var c=arguments.length,d=new Array(c-1),e=1;c>e;e++)d[e-1]=arguments[e];for(e=0,c=this._all.length;c>e;e++)this.event=a,this._all[e].apply(this,d)}if("error"===a&&!(this._all||this._events.error||this.wildcard&&this.listenerTree.error))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");var g;if(this.wildcard){g=[];var h="string"==typeof a?a.split(this.delimiter):a.slice();f.call(this,g,h,this.listenerTree,0)}else g=this._events[a];if("function"==typeof g){if(this.event=a,1===arguments.length)g.call(this);else if(arguments.length>1)switch(arguments.length){case 2:g.call(this,arguments[1]);break;case 3:g.call(this,arguments[1],arguments[2]);break;default:for(var c=arguments.length,d=new Array(c-1),e=1;c>e;e++)d[e-1]=arguments[e];g.apply(this,d)}return!0}if(g){for(var c=arguments.length,d=new Array(c-1),e=1;c>e;e++)d[e-1]=arguments[e];for(var i=g.slice(),e=0,c=i.length;c>e;e++)this.event=a,i[e].apply(this,d);return i.length>0||!!this._all}return!!this._all},e.prototype.on=function(a,c){if("function"==typeof a)return this.onAny(a),this;if("function"!=typeof c)throw new Error("on only accepts instances of Function");if(this._events||b.call(this),this.emit("newListener",a,c),this.wildcard)return g.call(this,a,c),this;if(this._events[a]){if("function"==typeof this._events[a])this._events[a]=[this._events[a],c];else if(h(this._events[a])&&(this._events[a].push(c),!this._events[a].warned)){var d=i;"undefined"!=typeof this._events.maxListeners&&(d=this._events.maxListeners),d>0&&this._events[a].length>d&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),console.trace())}}else this._events[a]=c;return this},e.prototype.onAny=function(a){if("function"!=typeof a)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),this._all.push(a),this},e.prototype.addListener=e.prototype.on,e.prototype.off=function(a,b){if("function"!=typeof b)throw new Error("removeListener only takes instances of Function");var c,d=[];if(this.wildcard){var e="string"==typeof a?a.split(this.delimiter):a.slice();d=f.call(this,null,e,this.listenerTree,0)}else{if(!this._events[a])return this;c=this._events[a],d.push({_listeners:c})}for(var g=0;g<d.length;g++){var i=d[g];if(c=i._listeners,h(c)){for(var j=-1,k=0,l=c.length;l>k;k++)if(c[k]===b||c[k].listener&&c[k].listener===b||c[k]._origin&&c[k]._origin===b){j=k;break}if(0>j)continue;return this.wildcard?i._listeners.splice(j,1):this._events[a].splice(j,1),0===c.length&&(this.wildcard?delete i._listeners:delete this._events[a]),this}(c===b||c.listener&&c.listener===b||c._origin&&c._origin===b)&&(this.wildcard?delete i._listeners:delete this._events[a])}return this},e.prototype.offAny=function(a){var b,c=0,d=0;if(a&&this._all&&this._all.length>0){for(b=this._all,c=0,d=b.length;d>c;c++)if(a===b[c])return b.splice(c,1),this}else this._all=[];return this},e.prototype.removeListener=e.prototype.off,e.prototype.removeAllListeners=function(a){if(0===arguments.length)return!this._events||b.call(this),this;if(this.wildcard)for(var c="string"==typeof a?a.split(this.delimiter):a.slice(),d=f.call(this,null,c,this.listenerTree,0),e=0;e<d.length;e++){var g=d[e];g._listeners=null}else{if(!this._events[a])return this;this._events[a]=null}return this},e.prototype.listeners=function(a){if(this.wildcard){var c=[],d="string"==typeof a?a.split(this.delimiter):a.slice();return f.call(this,c,d,this.listenerTree,0),c}return this._events||b.call(this),this._events[a]||(this._events[a]=[]),h(this._events[a])||(this._events[a]=[this._events[a]]),this._events[a]},e.prototype.listenersAny=function(){return this._all?this._all:[]},"function"==typeof a&&a.amd?a(function(){return e}):"object"==typeof d?d.EventEmitter2=e:window.EventEmitter2=e}()},{}],3:[function(a,b){var c=a("fast-diff"),d=a("./is"),e=a("./op"),f=String.fromCharCode(0),g=function(a){this.ops=d.array(a)?a:d.object(a)&&d.array(a.ops)?a.ops:[]};g.prototype.insert=function(a,b){var c={};if(d.string(a)){if(0===a.length)return this;c.insert=a}else d.number(a)&&(c.insert=a);return d.object(b)&&Object.keys(b).length>0&&(c.attributes=b),this.push(c)},g.prototype["delete"]=function(a){return 0>=a?this:this.push({"delete":a})},g.prototype.retain=function(a,b){if(0>=a)return this;var c={retain:a};return d.object(b)&&Object.keys(b).length>0&&(c.attributes=b),this.push(c)},g.prototype.push=function(a){var b=this.ops.length,c=this.ops[b-1];if(a=e.clone(a),d.object(c)){if(d.number(a["delete"])&&d.number(c["delete"]))return this.ops[b-1]={"delete":c["delete"]+a["delete"]},this;if(d.number(c["delete"])&&(d.string(a.insert)||d.number(a.insert))&&(b-=1,c=this.ops[b-1],!d.object(c)))return this.ops.unshift(a),this;if(d.equal(a.attributes,c.attributes)){if(d.string(a.insert)&&d.string(c.insert))return this.ops[b-1]={insert:c.insert+a.insert},d.object(a.attributes)&&(this.ops[b-1].attributes=a.attributes),this;if(d.number(a.retain)&&d.number(c.retain))return this.ops[b-1]={retain:c.retain+a.retain},d.object(a.attributes)&&(this.ops[b-1].attributes=a.attributes),this}}return this.ops.splice(b,0,a),this},g.prototype.chop=function(){var a=this.ops[this.ops.length-1];return a&&a.retain&&!a.attributes&&this.ops.pop(),this},g.prototype.length=function(){return this.ops.reduce(function(a,b){return a+e.length(b)},0)},g.prototype.slice=function(a,b){a=a||0,d.number(b)||(b=1/0);for(var c=new g,f=e.iterator(this.ops),h=0;b>h&&f.hasNext();){var i;a>h?i=f.next(a-h):(i=f.next(b-h),c.push(i)),h+=e.length(i)}return c},g.prototype.compose=function(a){var b=e.iterator(this.ops),c=e.iterator(a.ops);for(this.ops=[];b.hasNext()||c.hasNext();)if("insert"===c.peekType())this.push(c.next());else if("delete"===b.peekType())this.push(b.next());else{var f=Math.min(b.peekLength(),c.peekLength()),g=b.next(f),h=c.next(f);if(d.number(h.retain)){var i={};d.number(g.retain)?i.retain=f:i.insert=g.insert;var j=e.attributes.compose(g.attributes,h.attributes,d.number(g.retain));j&&(i.attributes=j),this.push(i)}else d.number(h["delete"])&&d.number(g.retain)&&this.push(h)}return this.chop()},g.prototype.diff=function(a){var b=[this.ops,a.ops].map(function(b){return b.map(function(c){if(d.string(c.insert))return c.insert;if(d.number(c.insert))return f;var e=b===a.ops?"on":"with";throw new Error("diff() called "+e+" non-document")}).join("")}),h=c(b[0],b[1]),i=e.iterator(this.ops),j=e.iterator(a.ops),k=new g;return h.forEach(function(a){for(var b=a[1].length;b>0;){var d=0;switch(a[0]){case c.INSERT:d=Math.min(j.peekLength(),b),k.push(j.next(d));break;case c.DELETE:d=Math.min(b,i.peekLength()),i.next(d),k["delete"](d);break;case c.EQUAL:d=Math.min(i.peekLength(),j.peekLength(),b);var f=i.next(d),g=j.next(d);f.insert===g.insert?k.retain(d,e.attributes.diff(f.attributes,g.attributes)):k.push(g)["delete"](d)}b-=d}}),k.chop()},g.prototype.transform=function(a,b){if(b=!!b,d.number(a))return this.transformPosition(a,b);for(var c=e.iterator(this.ops),f=e.iterator(a.ops),h=new g;c.hasNext()||f.hasNext();)if("insert"!==c.peekType()||!b&&"insert"===f.peekType())if("insert"===f.peekType())h.push(f.next());else{var i=Math.min(c.peekLength(),f.peekLength()),j=c.next(i),k=f.next(i);if(j["delete"])continue;k["delete"]?h.push(k):h.retain(i,e.attributes.transform(j.attributes,k.attributes,b))}else h.retain(e.length(c.next()));return h.chop()},g.prototype.transformPosition=function(a,b){b=!!b;for(var c=e.iterator(this.ops),d=0;c.hasNext()&&a>=d;){var f=c.peekLength(),g=c.peekType();c.next(),"delete"!==g?("insert"===g&&(a>d||!b)&&(a+=f),d+=f):a-=Math.min(f,a-d)}return a},b.exports=g},{"./is":4,"./op":5,"fast-diff":6}],4:[function(a,b){b.exports={equal:function(a,b){if(a===b)return!0;if(null==a&&null==b)return!0;if(null==a||null==b)return!1;if(Object.keys(a).length!=Object.keys(b).length)return!1;for(var c in a)if(a[c]!==b[c])return!1;return!0},array:function(a){return Array.isArray(a)},number:function(a){return"number"==typeof a?!0:"object"==typeof a&&"[object Number]"===Object.prototype.toString.call(a)?!0:!1},object:function(a){return a?"function"==typeof a||"object"==typeof a:!1},string:function(a){return"string"==typeof a?!0:"object"==typeof a&&"[object String]"===Object.prototype.toString.call(a)?!0:!1}}},{}],5:[function(a,b){function c(a){this.ops=a,this.index=0,this.offset=0}var d=a("./is"),e={attributes:{clone:function(a,b){return d.object(a)?Object.keys(a).reduce(function(c,d){return void 0===a[d]||null===a[d]&&!b||(c[d]=a[d]),c},{}):{}},compose:function(a,b,c){d.object(a)||(a={}),d.object(b)||(b={});var e=this.clone(b,c);for(var f in a)void 0!==a[f]&&void 0===b[f]&&(e[f]=a[f]);return Object.keys(e).length>0?e:void 0},diff:function(a,b){d.object(a)||(a={}),d.object(b)||(b={});var c=Object.keys(a).concat(Object.keys(b)).reduce(function(c,d){return a[d]!==b[d]&&(c[d]=void 0===b[d]?null:b[d]),c},{});return Object.keys(c).length>0?c:void 0},transform:function(a,b,c){if(!d.object(a))return b;if(!d.object(b))return void 0;if(!c)return b;var e=Object.keys(b).reduce(function(c,d){return void 0===a[d]&&(c[d]=b[d]),c},{});return Object.keys(e).length>0?e:void 0}},clone:function(a){var b=this.attributes.clone(a);return d.object(b.attributes)&&(b.attributes=this.attributes.clone(b.attributes,!0)),b},iterator:function(a){return new c(a)},length:function(a){return d.number(a["delete"])?a["delete"]:d.number(a.retain)?a.retain:d.string(a.insert)?a.insert.length:1}};c.prototype.hasNext=function(){return this.peekLength()<1/0},c.prototype.next=function(a){a||(a=1/0);var b=this.ops[this.index];if(b){var c=this.offset,f=e.length(b);if(a>=f-c?(a=f-c,this.index+=1,this.offset=0):this.offset+=a,d.number(b["delete"]))return{"delete":a};var g={};return b.attributes&&(g.attributes=b.attributes),d.number(b.retain)?g.retain=a:g.insert=d.string(b.insert)?b.insert.substr(c,a):b.insert,g}return{retain:1/0}},c.prototype.peekLength=function(){return this.ops[this.index]?e.length(this.ops[this.index])-this.offset:1/0},c.prototype.peekType=function(){return this.ops[this.index]?d.number(this.ops[this.index]["delete"])?"delete":d.number(this.ops[this.index].retain)?"retain":"insert":"retain"},b.exports=e},{"./is":4}],6:[function(a,b){function c(a,b){if(a==b)return a?[[m,a]]:[];var c=g(a,b),e=a.substring(0,c);a=a.substring(c),b=b.substring(c),c=h(a,b);var f=a.substring(a.length-c);a=a.substring(0,a.length-c),b=b.substring(0,b.length-c);var i=d(a,b);return e&&i.unshift([m,e]),f&&i.push([m,f]),j(i),i}function d(a,b){var d;if(!a)return[[l,b]];if(!b)return[[k,a]];var f=a.length>b.length?a:b,g=a.length>b.length?b:a,h=f.indexOf(g);if(-1!=h)return d=[[l,f.substring(0,h)],[m,g],[l,f.substring(h+g.length)]],a.length>b.length&&(d[0][0]=d[2][0]=k),d;if(1==g.length)return[[k,a],[l,b]];var j=i(a,b);if(j){var n=j[0],o=j[1],p=j[2],q=j[3],r=j[4],s=c(n,p),t=c(o,q);return s.concat([[m,r]],t)}return e(a,b)}function e(a,b){for(var c=a.length,d=b.length,e=Math.ceil((c+d)/2),g=e,h=2*e,i=new Array(h),j=new Array(h),m=0;h>m;m++)i[m]=-1,j[m]=-1;i[g+1]=0,j[g+1]=0;for(var n=c-d,o=n%2!=0,p=0,q=0,r=0,s=0,t=0;e>t;t++){for(var u=-t+p;t-q>=u;u+=2){var v,w=g+u;v=u==-t||u!=t&&i[w-1]<i[w+1]?i[w+1]:i[w-1]+1;for(var x=v-u;c>v&&d>x&&a.charAt(v)==b.charAt(x);)v++,x++;if(i[w]=v,v>c)q+=2;else if(x>d)p+=2;else if(o){var y=g+n-u;if(y>=0&&h>y&&-1!=j[y]){var z=c-j[y];if(v>=z)return f(a,b,v,x)}}}for(var A=-t+r;t-s>=A;A+=2){var z,y=g+A;z=A==-t||A!=t&&j[y-1]<j[y+1]?j[y+1]:j[y-1]+1;for(var B=z-A;c>z&&d>B&&a.charAt(c-z-1)==b.charAt(d-B-1);)z++,B++;if(j[y]=z,z>c)s+=2;else if(B>d)r+=2;else if(!o){var w=g+n-A;if(w>=0&&h>w&&-1!=i[w]){var v=i[w],x=g+v-w;if(z=c-z,v>=z)return f(a,b,v,x)}}}}return[[k,a],[l,b]]}function f(a,b,d,e){var f=a.substring(0,d),g=b.substring(0,e),h=a.substring(d),i=b.substring(e),j=c(f,g),k=c(h,i);return j.concat(k)}function g(a,b){if(!a||!b||a.charAt(0)!=b.charAt(0))return 0;for(var c=0,d=Math.min(a.length,b.length),e=d,f=0;e>c;)a.substring(f,e)==b.substring(f,e)?(c=e,f=c):d=e,e=Math.floor((d-c)/2+c);return e}function h(a,b){if(!a||!b||a.charAt(a.length-1)!=b.charAt(b.length-1))return 0;for(var c=0,d=Math.min(a.length,b.length),e=d,f=0;e>c;)a.substring(a.length-e,a.length-f)==b.substring(b.length-e,b.length-f)?(c=e,f=c):d=e,e=Math.floor((d-c)/2+c);return e}function i(a,b){function c(a,b,c){for(var d,e,f,i,j=a.substring(c,c+Math.floor(a.length/4)),k=-1,l="";-1!=(k=b.indexOf(j,k+1));){var m=g(a.substring(c),b.substring(k)),n=h(a.substring(0,c),b.substring(0,k));l.length<n+m&&(l=b.substring(k-n,k)+b.substring(k,k+m),d=a.substring(0,c-n),e=a.substring(c+m),f=b.substring(0,k-n),i=b.substring(k+m))}return 2*l.length>=a.length?[d,e,f,i,l]:null}var d=a.length>b.length?a:b,e=a.length>b.length?b:a;if(d.length<4||2*e.length<d.length)return null;var f,i=c(d,e,Math.ceil(d.length/4)),j=c(d,e,Math.ceil(d.length/2));if(!i&&!j)return null;f=j?i&&i[4].length>j[4].length?i:j:i;var k,l,m,n;a.length>b.length?(k=f[0],l=f[1],m=f[2],n=f[3]):(m=f[0],n=f[1],k=f[2],l=f[3]);var o=f[4];return[k,l,m,n,o]}function j(a){a.push([m,""]);for(var b,c=0,d=0,e=0,f="",i="";c<a.length;)switch(a[c][0]){case l:e++,i+=a[c][1],c++;break;case k:d++,f+=a[c][1],c++;break;case m:d+e>1?(0!==d&&0!==e&&(b=g(i,f),0!==b&&(c-d-e>0&&a[c-d-e-1][0]==m?a[c-d-e-1][1]+=i.substring(0,b):(a.splice(0,0,[m,i.substring(0,b)]),c++),i=i.substring(b),f=f.substring(b)),b=h(i,f),0!==b&&(a[c][1]=i.substring(i.length-b)+a[c][1],i=i.substring(0,i.length-b),f=f.substring(0,f.length-b))),0===d?a.splice(c-e,d+e,[l,i]):0===e?a.splice(c-d,d+e,[k,f]):a.splice(c-d-e,d+e,[k,f],[l,i]),c=c-d-e+(d?1:0)+(e?1:0)+1):0!==c&&a[c-1][0]==m?(a[c-1][1]+=a[c][1],a.splice(c,1)):c++,e=0,d=0,f="",i=""}""===a[a.length-1][1]&&a.pop();var n=!1;for(c=1;c<a.length-1;)a[c-1][0]==m&&a[c+1][0]==m&&(a[c][1].substring(a[c][1].length-a[c-1][1].length)==a[c-1][1]?(a[c][1]=a[c-1][1]+a[c][1].substring(0,a[c][1].length-a[c-1][1].length),a[c+1][1]=a[c-1][1]+a[c+1][1],a.splice(c-1,1),n=!0):a[c][1].substring(0,a[c+1][1].length)==a[c+1][1]&&(a[c-1][1]+=a[c+1][1],a[c][1]=a[c][1].substring(a[c+1][1].length)+a[c+1][1],a.splice(c+1,1),n=!0)),c++;n&&j(a)}var k=-1,l=1,m=0,n=c;n.INSERT=l,n.DELETE=k,n.EQUAL=m,b.exports=n},{}],7:[function(a,b){b.exports={version:"0.19.12"}},{}],8:[function(a,b){var c,d,e,f,g,h,i,j;i=a("lodash"),c=a("rich-text/lib/delta"),j=a("../lib/dom"),e=a("./format"),f=a("./line"),g=a("../lib/linked-list"),h=a("./normalizer"),d=function(){function a(a,b){this.root=a,null==b&&(b={}),this.normalizer=new h,this.formats={},i.each(b.formats,i.bind(this.addFormat,this)),this.setHTML(this.root.innerHTML)}return a.prototype.addFormat=function(a,b){return i.isObject(b)||(b=e.FORMATS[a]),null!=this.formats[a]&&console.warn("Overwriting format",a,this.formats[a]),this.formats[a]=new e(b),this.normalizer.addFormat(b)},a.prototype.appendLine=function(a){return this.insertLineBefore(a,null)},a.prototype.findLeafAt=function(a,b){var c,d,e;return e=this.findLineAt(a),c=e[0],d=e[1],null!=c?c.findLeafAt(d,b):[void 0,d]},a.prototype.findLine=function(a){for(var b;null!=a&&null==j.BLOCK_TAGS[a.tagName];)a=a.parentNode;return b=null!=a?j(a).data(f.DATA_KEY):void 0,(null!=b?b.node:void 0)===a?b:void 0},a.prototype.findLineAt=function(a){var b,c;if(!(this.lines.length>0))return[void 0,a];if(c=this.toDelta().length(),a===c)return[this.lines.last,this.lines.last.length];if(a>c)return[void 0,a-c];for(b=this.lines.first;null!=b;){if(a<b.length)return[b,a];a-=b.length,b=b.next}return[void 0,a]},a.prototype.getHTML=function(){return this.root.innerHTML.replace(/\>\s+\</g,">&nbsp;<")},a.prototype.insertLineBefore=function(a,b){var c;return c=new f(this,a),null!=b?(j(a.parentNode).isElement()||this.root.insertBefore(a,b.node),this.lines.insertAfter(b.prev,c)):(j(a.parentNode).isElement()||this.root.appendChild(a),this.lines.append(c)),c},a.prototype.mergeLines=function(a,b){return b.length>1&&(1===a.length&&j(a.leaves.last.node).remove(),i.each(j(b.node).childNodes(),function(b){return b.tagName!==j.DEFAULT_BREAK_TAG?a.node.appendChild(b):void 0})),this.removeLine(b),a.rebuild()},a.prototype.optimizeLines=function(){return i.each(this.lines.toArray(),function(a){return a.optimize(),!0})},a.prototype.rebuild=function(){var a,b,c;for(b=this.lines.toArray(),a=this.root.firstChild,null!=a&&null!=j.LIST_TAGS[a.tagName]&&(a=a.firstChild),i.each(b,function(b){return function(c){for(var d,e;c.node!==a;){if(c.node.parentNode!==b.root&&(null!=(e=c.node.parentNode)?e.parentNode:void 0)!==b.root)return b.removeLine(c);a=b.normalizer.normalizeLine(a),d=b.insertLineBefore(a,c),a=j(a).nextLineNode(b.root)}return c.outerHTML!==a.outerHTML&&(c.node=b.normalizer.normalizeLine(c.node),c.rebuild()),a=j(a).nextLineNode(b.root)}}(this)),c=[];null!=a;)a=this.normalizer.normalizeLine(a),this.appendLine(a),c.push(a=j(a).nextLineNode(this.root));return c},a.prototype.removeLine=function(a){return null!=a.node.parentNode&&(j.LIST_TAGS[a.node.parentNode.tagName]&&1===a.node.parentNode.childNodes.length?j(a.node.parentNode).remove():j(a.node).remove()),this.lines.remove(a)},a.prototype.setHTML=function(a){return a=h.stripComments(a),a=h.stripWhitespace(a),this.root.innerHTML=a,this.lines=new g,this.rebuild()},a.prototype.splitLine=function(a,b){var c,d,e,f;return b=Math.min(b,a.length-1),f=j(a.node).split(b,!0),c=f[0],d=f[1],a.node=c,a.rebuild(),e=this.insertLineBefore(d,a.next),e.formats=i.clone(a.formats),e.resetContent(),e},a.prototype.toDelta=function(){var a,b;return b=this.lines.toArray(),a=new c,i.each(b,function(b){return i.each(b.delta.ops,function(b){return a.push(b)})}),a},a}(),b.exports=d},{"../lib/dom":17,"../lib/linked-list":18,"./format":10,"./line":12,"./normalizer":13,lodash:1,"rich-text/lib/delta":3}],9:[function(a,b){var c,d,e,f,g,h;g=a("lodash"),h=a("../lib/dom"),c=a("./document"),e=a("./line"),f=a("./selection"),d=function(){function a(a,b,d){this.root=a,this.quill=b,this.options=null!=d?d:{},this.root.setAttribute("id",this.options.id),this.doc=new c(this.root,this.options),this.delta=this.doc.toDelta(),this.length=this.delta.length(),this.selection=new f(this.doc,this.quill),this.timer=setInterval(g.bind(this.checkUpdate,this),this.options.pollInterval),this.options.readOnly||this.enable()}return a.sources={API:"api",SILENT:"silent",USER:"user"},a.prototype.destroy=function(){return clearInterval(this.timer)},a.prototype.disable=function(){return this.enable(!1)},a.prototype.enable=function(a){return null==a&&(a=!0),this.root.setAttribute("contenteditable",a)},a.prototype.applyDelta=function(b,c){var d;return d=this._update(),d&&(b=d.transform(b,!0),d=b.transform(d,!1)),b.ops.length>0&&(b=this._trackDelta(function(a){return function(){var c;return c=0,g.each(b.ops,function(b){return g.isString(b.insert)?(a._insertAt(c,b.insert,b.attributes),c+=b.insert.length):g.isNumber(b.insert)?(a._insertEmbed(c,b.attributes),c+=1):g.isNumber(b["delete"])?a._deleteAt(c,b["delete"]):g.isNumber(b.retain)?(g.each(b.attributes,function(d,e){return a._formatAt(c,b.retain,e,d)}),c+=b.retain):void 0}),a.selection.shiftAfter(0,0,g.bind(a.doc.optimizeLines,a.doc))}}(this)),this.delta=this.doc.toDelta(),this.length=this.delta.length(),this.innerHTML=this.root.innerHTML,b&&c!==a.sources.SILENT&&this.quill.emit(this.quill.constructor.events.TEXT_CHANGE,b,c)),d&&d.ops.length>0&&c!==a.sources.SILENT?this.quill.emit(this.quill.constructor.events.TEXT_CHANGE,d,a.sources.USER):void 0},a.prototype.checkUpdate=function(b){var c;return null==b&&(b="user"),null==this.root.parentNode?clearInterval(this.timer):(c=this._update(),c&&(this.delta.compose(c),this.length=this.delta.length(),this.quill.emit(this.quill.constructor.events.TEXT_CHANGE,c,b)),c&&(b=a.sources.SILENT),this.selection.update(b))},a.prototype.focus=function(){return null!=this.selection.range?this.selection.setRange(this.selection.range):this.root.focus()},a.prototype.getBounds=function(a){var b,c,d,e,f,g,i;if(this.checkUpdate(),g=this.doc.findLeafAt(a,!0),d=g[0],e=g[1],null==d)throw new Error("Invalid index");return c=this.root.parentNode.getBoundingClientRect(),i="left",0===d.length?b=d.node.parentNode.getBoundingClientRect():h.VOID_TAGS[d.node.tagName]?(b=d.node.getBoundingClientRect(),1===e&&(i="right")):(f=document.createRange(),e<d.length?(f.setStart(d.node,e),f.setEnd(d.node,e+1)):(f.setStart(d.node,e-1),f.setEnd(d.node,e),i="right"),b=f.getBoundingClientRect()),{height:b.height,left:b[i]-c.left,top:b.top-c.top}},a.prototype._deleteAt=function(a,b){return 0>=b?void 0:this.selection.shiftAfter(a,-1*b,function(c){return function(){var d,e,f,g,h,i,j;for(j=c.doc.findLineAt(a),f=j[0],i=j[1],d=f,g=f.length-i<=b&&i>0;null!=d&&b>0;)h=d.next,e=Math.min(d.length-i,b),0===i&&b>=d.length?c.doc.removeLine(d):d.deleteText(i,e),b-=e,d=h,i=0;return g&&f.next?c.doc.mergeLines(f,f.next):void 0}}(this))},a.prototype._formatAt=function(a,b,c,d){return this.selection.shiftAfter(a,0,function(e){return function(){var f,g,h,i,j;for(i=e.doc.findLineAt(a),g=i[0],h=i[1],j=[];null!=g&&b>0;)f=Math.min(b,g.length-h-1),g.formatText(h,f,c,d),b-=f,b>0&&g.format(c,d),b-=1,h=0,j.push(g=g.next);return j}}(this))},a.prototype._insertEmbed=function(a,b){return this.selection.shiftAfter(a,1,function(c){return function(){var d,e,f;return f=c.doc.findLineAt(a),d=f[0],e=f[1],d.insertEmbed(e,b)}}(this))},a.prototype._insertAt=function(a,b,c){return null==c&&(c={}),this.selection.shiftAfter(a,b.length,function(d){return function(){var e,f,i,j;return b=b.replace(/\r\n?/g,"\n"),f=b.split("\n"),j=d.doc.findLineAt(a),e=j[0],i=j[1],g.each(f,function(a,b){var j;return null==e||e.length<=i?(b<f.length-1||a.length>0)&&(e=d.doc.appendLine(document.createElement(h.DEFAULT_BLOCK_TAG)),i=0,e.insertText(i,a,c),e.format(c),j=null):(e.insertText(i,a,c),b<f.length-1&&(j=d.doc.splitLine(e,i+a.length),g.each(g.defaults({},c,e.formats),function(a,b){return e.format(b,c[b])}),i=0)),e=j})}}(this))},a.prototype._trackDelta=function(a){var b,c;return a(),c=this.doc.toDelta(),b=this.delta.diff(c)},a.prototype._update=function(){var a;return this.innerHTML===this.root.innerHTML?!1:(a=this._trackDelta(function(a){return function(){return a.selection.preserve(g.bind(a.doc.rebuild,a.doc)),a.selection.shiftAfter(0,0,g.bind(a.doc.optimizeLines,a.doc))}}(this)),this.innerHTML=this.root.innerHTML,a.ops.length>0?a:!1)},a}(),b.exports=d},{"../lib/dom":17,"./document":8,"./line":12,"./selection":14,lodash:1}],10:[function(a,b){var c,d,e;d=a("lodash"),e=a("../lib/dom"),c=function(){function a(a){this.config=a}return a.types={LINE:"line",EMBED:"embed"},a.FORMATS={bold:{tag:"B",prepare:"bold"},italic:{tag:"I",prepare:"italic"},underline:{tag:"U",prepare:"underline"},strike:{tag:"S",prepare:"strikeThrough"},color:{style:"color","default":"rgb(0, 0, 0)",prepare:"foreColor"},background:{style:"backgroundColor","default":"rgb(255, 255, 255)",prepare:"backColor"},font:{style:"fontFamily","default":"'Helvetica', 'Arial', sans-serif",prepare:"fontName"},size:{style:"fontSize","default":"13px",prepare:function(a){return document.execCommand("fontSize",!1,e.convertFontSize(a))}},link:{tag:"A",add:function(a,b){return a.setAttribute("href",b),a},remove:function(a){return a.removeAttribute("href"),a},value:function(a){return a.getAttribute("href")}},image:{type:a.types.EMBED,tag:"IMG",attribute:"src"},align:{type:a.types.LINE,style:"textAlign","default":"left"},bullet:{type:a.types.LINE,exclude:"list",parentTag:"UL",tag:"LI"},list:{type:a.types.LINE,exclude:"bullet",parentTag:"OL",tag:"LI"}},a.prototype.add=function(b,c){var f,g,h,i,j;return c?this.value(b)===c?b:(d.isString(this.config.parentTag)&&(h=document.createElement(this.config.parentTag),e(b).wrap(h),b.parentNode.tagName===(null!=(i=b.parentNode.previousSibling)?i.tagName:void 0)&&e(b.parentNode.previousSibling).merge(b.parentNode),b.parentNode.tagName===(null!=(j=b.parentNode.nextSibling)?j.tagName:void 0)&&e(b.parentNode).merge(b.parentNode.nextSibling)),d.isString(this.config.tag)&&(f=document.createElement(this.config.tag),null!=e.VOID_TAGS[f.tagName]?(null!=b.parentNode&&e(b).replace(f),b=f):this.isType(a.types.LINE)?b=e(b).switchTag(this.config.tag):(e(b).wrap(f),b=f)),(d.isString(this.config.style)||d.isString(this.config.attribute)||d.isString(this.config["class"]))&&(d.isString(this.config["class"])&&(b=this.remove(b)),e(b).isTextNode()&&(g=document.createElement(e.DEFAULT_INLINE_TAG),e(b).wrap(g),b=g),d.isString(this.config.style)&&c!==this.config["default"]&&(b.style[this.config.style]=c),d.isString(this.config.attribute)&&b.setAttribute(this.config.attribute,c),d.isString(this.config["class"])&&e(b).addClass(this.config["class"]+c)),d.isFunction(this.config.add)&&(b=this.config.add(b,c)),b):this.remove(b)},a.prototype.isType=function(a){return a===this.config.type},a.prototype.match=function(a){var b,c,f,g,h;if(!e(a).isElement())return!1;if(d.isString(this.config.parentTag)&&(null!=(g=a.parentNode)?g.tagName:void 0)!==this.config.parentTag)return!1;if(d.isString(this.config.tag)&&a.tagName!==this.config.tag)return!1;if(d.isString(this.config.style)&&(!a.style[this.config.style]||a.style[this.config.style]===this.config["default"]))return!1;if(d.isString(this.config.attribute)&&!a.hasAttribute(this.config.attribute))return!1;if(d.isString(this.config["class"])){for(h=e(a).classes(),c=0,f=h.length;f>c;c++)if(b=h[c],0===b.indexOf(this.config["class"]))return!0;return!1}return!0},a.prototype.prepare=function(a){return d.isString(this.config.prepare)?document.execCommand(this.config.prepare,!1,a):d.isFunction(this.config.prepare)?this.config.prepare(a):void 0},a.prototype.remove=function(b){var c,f,g,h;if(!this.match(b))return b;if(d.isString(this.config.style)&&(b.style[this.config.style]="",b.getAttribute("style")||b.removeAttribute("style")),d.isString(this.config.attribute)&&b.removeAttribute(this.config.attribute),d.isString(this.config["class"]))for(h=e(b).classes(),f=0,g=h.length;g>f;f++)c=h[f],0===c.indexOf(this.config["class"])&&e(b).removeClass(c);if(d.isString(this.config.tag))if(this.isType(a.types.LINE))d.isString(this.config.parentTag)&&(null!=b.previousSibling&&e(b).splitBefore(b.parentNode.parentNode),null!=b.nextSibling&&e(b.nextSibling).splitBefore(b.parentNode.parentNode)),b=e(b).switchTag(e.DEFAULT_BLOCK_TAG);else{if(this.isType(a.types.EMBED))return void e(b).remove();b=e(b).switchTag(e.DEFAULT_INLINE_TAG)}return d.isString(this.config.parentTag)&&e(b.parentNode).unwrap(),d.isFunction(this.config.remove)&&(b=this.config.remove(b)),b.tagName!==e.DEFAULT_INLINE_TAG||b.hasAttributes()||(b=e(b).unwrap()),b},a.prototype.value=function(a){var b,c,f,g;if(!this.match(a))return void 0;if(this.config.value)return this.config.value(a);if(d.isString(this.config.attribute))return a.getAttribute(this.config.attribute)||void 0;if(d.isString(this.config.style))return a.style[this.config.style]||void 0;if(d.isString(this.config["class"])){for(g=e(a).classes(),c=0,f=g.length;f>c;c++)if(b=g[c],0===b.indexOf(this.config["class"]))return b.slice(this.config["class"].length)
}else if(d.isString(this.config.tag))return!0;return void 0},a}(),b.exports=c},{"../lib/dom":17,lodash:1}],11:[function(a,b){var c,d,e,f,g,h=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},i={}.hasOwnProperty;f=a("lodash"),g=a("../lib/dom"),c=a("./format"),e=a("../lib/linked-list"),d=function(a){function b(a,c){this.node=a,this.formats=f.clone(c),this.text=g(this.node).text(),this.length=this.text.length,g(this.node).data(b.DATA_KEY,this)}return h(b,a),b.DATA_KEY="leaf",b.isLeafNode=function(a){return g(a).isTextNode()||null==a.firstChild},b.prototype.deleteText=function(a,c){var d;if(c>0)return this.text=this.text.slice(0,a)+this.text.slice(a+c),this.length=this.text.length,null!=g.EMBED_TAGS[this.node.tagName]?(d=document.createTextNode(this.text),g(d).data(b.DATA_KEY,this),this.node=g(this.node).replace(d)):g(this.node).text(this.text)},b.prototype.insertText=function(a,c){var d;return this.text=this.text.slice(0,a)+c+this.text.slice(a),g(this.node).isTextNode()?g(this.node).text(this.text):(d=document.createTextNode(c),g(d).data(b.DATA_KEY,this),this.node.tagName===g.DEFAULT_BREAK_TAG?this.node=g(this.node).replace(d):(this.node.appendChild(d),this.node=d)),this.length=this.text.length},b}(e.Node),b.exports=d},{"../lib/dom":17,"../lib/linked-list":18,"./format":10,lodash:1}],12:[function(a,b){var c,d,e,f,g,h,i,j,k=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},l={}.hasOwnProperty;i=a("lodash"),c=a("rich-text/lib/delta"),j=a("../lib/dom"),d=a("./format"),e=a("./leaf"),f=a("./line"),g=a("../lib/linked-list"),h=a("./normalizer"),f=function(a){function b(a,c){this.doc=a,this.node=c,this.formats={},this.rebuild(),b.__super__.constructor.call(this,this.node)}return k(b,a),b.DATA_KEY="line",b.prototype.buildLeaves=function(a,b){return i.each(j(a).childNodes(),function(a){return function(c){var f;return c=a.doc.normalizer.normalizeNode(c),f=i.clone(b),i.each(a.doc.formats,function(a,b){return!a.isType(d.types.LINE)&&a.match(c)?f[b]=a.value(c):void 0}),e.isLeafNode(c)?a.leaves.append(new e(c,f)):a.buildLeaves(c,f)}}(this))},b.prototype.deleteText=function(a,b){var c,d,e;if(b>0){for(e=this.findLeafAt(a),d=e[0],a=e[1];null!=d&&b>0;)c=Math.min(b,d.length-a),d.deleteText(a,c),b-=c,d=d.next,a=0;return this.rebuild()}},b.prototype.findLeaf=function(a){return null!=a?j(a).data(e.DATA_KEY):void 0},b.prototype.findLeafAt=function(a,b){var c;if(null==b&&(b=!1),a>=this.length-1)return[this.leaves.last,this.leaves.last.length];for(c=this.leaves.first;null!=c;){if(a<c.length||a===c.length&&b)return[c,a];a-=c.length,c=c.next}return[this.leaves.last,a-this.leaves.last.length]},b.prototype.format=function(a,b){var c;return i.isObject(a)?c=a:(c={},c[a]=b),i.each(c,function(a){return function(b,c){var e,f;return f=a.doc.formats[c],null!=f?(f.isType(d.types.LINE)&&(f.config.exclude&&a.formats[f.config.exclude]&&(e=a.doc.formats[f.config.exclude],null!=e&&(a.node=e.remove(a.node),delete a.formats[f.config.exclude])),a.node=f.add(a.node,b)),b?a.formats[c]=b:delete a.formats[c]):void 0}}(this)),this.resetContent()},b.prototype.formatText=function(a,b,c,e){var f,g,h,i,k,l,m,n,o,p;if(l=this.findLeafAt(a),g=l[0],h=l[1],f=this.doc.formats[c],null!=f&&f.config.type!==d.types.LINE){for(;null!=g&&b>0;){if(k=g.next,e&&g.formats[c]!==e||!e&&null!=g.formats[c]){if(p=g.node,null!=g.formats[c]){for(j(p).splitBefore(this.node);!f.match(p);)p=p.parentNode;j(p).split(g.length)}h>0&&(m=j(p).split(h),i=m[0],p=m[1]),g.length>h+b&&(n=j(p).split(b),p=n[0],o=n[1]),f.add(p,e)}b-=g.length-h,h=0,g=k}return this.rebuild()}},b.prototype._insert=function(a,b,c){var d,e,f,g,h,k;return h=this.findLeafAt(a),d=h[0],e=h[1],b=i.reduce(c,function(a){return function(b,c,d){var e;return e=a.doc.formats[d],null!=e&&(b=e.add(b,c)),b}}(this),b),k=j(d.node).split(e),g=k[0],f=k[1],f&&(f=j(f).splitBefore(this.node).get()),this.node.insertBefore(b,f),this.rebuild()},b.prototype.insertEmbed=function(a,b){var c,e,f,g,h,k,l,m;return l=this.findLeafAt(a),e=l[0],f=l[1],m=j(e.node).split(f),k=m[0],g=m[1],c=i.find(Object.keys(b),function(a){return function(b){return a.doc.formats[b].isType(d.types.EMBED)}}(this)),h=this.doc.formats[c].add({},b[c]),b=i.clone(b),delete b[c],this._insert(a,h,b)},b.prototype.insertText=function(a,b,c){var d,e,f;return null==c&&(c={}),b.length>0?(f=this.findLeafAt(a),d=f[0],e=f[1],i.isEqual(d.formats,c)?(d.insertText(e,b),this.resetContent()):this._insert(a,document.createTextNode(b),c)):void 0},b.prototype.optimize=function(){return h.optimizeLine(this.node),this.rebuild()},b.prototype.rebuild=function(a){return null==a&&(a=!1),!a&&null!=this.outerHTML&&this.outerHTML===this.node.outerHTML&&i.all(this.leaves.toArray(),function(a){return function(b){return j(b.node).isAncestor(a.node)}}(this))?!1:(this.node=this.doc.normalizer.normalizeNode(this.node),0!==j(this.node).length()||this.node.querySelector(j.DEFAULT_BREAK_TAG)||this.node.appendChild(document.createElement(j.DEFAULT_BREAK_TAG)),this.leaves=new g,this.formats=i.reduce(this.doc.formats,function(a){return function(b,c,e){return c.isType(d.types.LINE)&&(c.match(a.node)?b[e]=c.value(a.node):delete b[e]),b}}(this),this.formats),this.buildLeaves(this.node,{}),this.resetContent(),!0)},b.prototype.resetContent=function(){return j(this.node).data(b.DATA_KEY,this),this.outerHTML=this.node.outerHTML,this.length=1,this.delta=new c,i.each(this.leaves.toArray(),function(a){return function(b){return a.length+=b.length,null!=j.EMBED_TAGS[b.node.tagName]?a.delta.insert(1,b.formats):a.delta.insert(b.text,b.formats)}}(this)),this.delta.insert("\n",this.formats)},b}(g.Node),b.exports=f},{"../lib/dom":17,"../lib/linked-list":18,"./format":10,"./leaf":11,"./line":12,"./normalizer":13,lodash:1,"rich-text/lib/delta":3}],13:[function(a,b){var c,d,e,f;d=a("lodash"),f=a("../lib/dom"),e=function(a){return a=a.replace(/(?:^|[-_])(\w)/g,function(a,b){return b?b.toUpperCase():""}),a.charAt(0).toLowerCase()+a.slice(1)},c=function(){function a(){this.whitelist={styles:{},tags:{}},this.whitelist.tags[f.DEFAULT_BREAK_TAG]=!0,this.whitelist.tags[f.DEFAULT_BLOCK_TAG]=!0,this.whitelist.tags[f.DEFAULT_INLINE_TAG]=!0}return a.ALIASES={STRONG:"B",EM:"I",DEL:"S",STRIKE:"S"},a.ATTRIBUTES={color:"color",face:"fontFamily",size:"fontSize"},a.prototype.addFormat=function(a){return null!=a.tag&&(this.whitelist.tags[a.tag]=!0),null!=a.parentTag&&(this.whitelist.tags[a.parentTag]=!0),null!=a.style?this.whitelist.styles[a.style]=!0:void 0},a.prototype.normalizeLine=function(b){return b=a.wrapInline(b),b=a.handleBreaks(b),b=a.pullBlocks(b),b=this.normalizeNode(b),a.unwrapText(b),null!=b&&null!=f.LIST_TAGS[b.tagName]&&(b=b.firstChild),b},a.prototype.normalizeNode=function(b){return f(b).isTextNode()?b:(d.each(a.ATTRIBUTES,function(a,c){var d;return b.hasAttribute(c)?(d=b.getAttribute(c),"size"===c&&(d=f.convertFontSize(d)),b.style[a]=d,b.removeAttribute(c)):void 0}),this.whitelistStyles(b),this.whitelistTags(b))},a.prototype.whitelistStyles=function(a){var b,c;return b=f(a).styles(),c=d.omit(b,function(a){return function(b,c){return null==a.whitelist.styles[e(c)]}}(this)),Object.keys(c).length<Object.keys(b).length?Object.keys(c).length>0?f(a).styles(c,!0):a.removeAttribute("style"):void 0},a.prototype.whitelistTags=function(b){return f(b).isElement()?(null!=a.ALIASES[b.tagName]?b=f(b).switchTag(a.ALIASES[b.tagName]):null==this.whitelist.tags[b.tagName]&&(b=null!=f.BLOCK_TAGS[b.tagName]?f(b).switchTag(f.DEFAULT_BLOCK_TAG):b.hasAttributes()||null==b.firstChild?f(b).switchTag(f.DEFAULT_INLINE_TAG):f(b).unwrap()),b):b},a.handleBreaks=function(a){var b;return b=d.map(a.querySelectorAll(f.DEFAULT_BREAK_TAG)),d.each(b,function(){return function(b){return null==b.nextSibling||f.isIE(10)&&null==b.previousSibling?void 0:f(b.nextSibling).splitBefore(a.parentNode)}}(this)),a},a.optimizeLine=function(a){var b,c,e,g;for(a.normalize(),b=f(a).length(),e=f(a).descendants(),g=[];e.length>0;)c=e.pop(),null!=(null!=c?c.parentNode:void 0)&&null==f.EMBED_TAGS[c.tagName]&&(c.tagName===f.DEFAULT_BREAK_TAG?g.push(0!==b?f(c).remove():void 0):0===f(c).length()?(e.push(c.nextSibling),g.push(f(c).unwrap())):null!=c.previousSibling&&c.tagName===c.previousSibling.tagName&&d.isEqual(f(c).attributes(),f(c.previousSibling).attributes())?(e.push(c.firstChild),g.push(f(c.previousSibling).merge(c))):g.push(void 0));return g},a.pullBlocks=function(b){var c;for(c=b.firstChild;null!=c;){if(null!=f.BLOCK_TAGS[c.tagName]&&"LI"!==c.tagName){f(c).isolate(b.parentNode),null!=f.LIST_TAGS[c.tagName]&&c.firstChild?(f(c.parentNode).unwrap(),null==b.parentNode&&(b=c)):(f(c).unwrap(),a.pullBlocks(b));break}c=c.nextSibling}return b},a.stripComments=function(a){return a.replace(/<!--[\s\S]*?-->/g,"")},a.stripWhitespace=function(a){return a=a.trim(),a=a.replace(/(\r?\n|\r)+/g," "),a=a.replace(/\>\s+\</g,"><")},a.wrapInline=function(a){var b,c;if(null!=f.BLOCK_TAGS[a.tagName])return a;for(b=document.createElement(f.DEFAULT_BLOCK_TAG),a.parentNode.insertBefore(b,a);null!=a&&null==f.BLOCK_TAGS[a.tagName];)c=a.nextSibling,b.appendChild(a),a=c;return b},a.unwrapText=function(a){var b;return b=d.map(a.querySelectorAll(f.DEFAULT_INLINE_TAG)),d.each(b,function(a){return a.hasAttributes()?void 0:f(a).unwrap()})},a}(),b.exports=c},{"../lib/dom":17,lodash:1}],14:[function(a,b){var c,d,e,f,g,h;g=a("lodash"),h=a("../lib/dom"),c=a("./leaf"),d=a("./normalizer"),e=a("../lib/range"),f=function(){function a(a,b){this.doc=a,this.emitter=b,this.focus=!1,this.range=new e(0,0),this.nullDelay=!1,this.update("silent")}return a.prototype.checkFocus=function(){return document.activeElement===this.doc.root},a.prototype.getRange=function(a){var b,c,d;return null==a&&(a=!1),this.checkFocus()?(c=this._getNativeRange(),null==c?null:(d=this._positionToIndex(c.startContainer,c.startOffset),b=c.startContainer===c.endContainer&&c.startOffset===c.endOffset?d:this._positionToIndex(c.endContainer,c.endOffset),new e(Math.min(d,b),Math.max(d,b)))):a?this.range:null},a.prototype.preserve=function(a){var b,c,d,e,f,g,h,i,j;return d=this._getNativeRange(),null!=d&&this.checkFocus()?(e=this._encodePosition(d.startContainer,d.startOffset),i=e[0],j=e[1],f=this._encodePosition(d.endContainer,d.endOffset),b=f[0],c=f[1],a(),g=this._decodePosition(i,j),i=g[0],j=g[1],h=this._decodePosition(b,c),b=h[0],c=h[1],this._setNativeRange(i,j,b,c)):a()},a.prototype.setRange=function(a,b){var c,d,e,f,g,h,i;return null!=a?(e=this._indexToPosition(a.start),h=e[0],i=e[1],a.isCollapsed()?(f=[h,i],c=f[0],d=f[1]):(g=this._indexToPosition(a.end),c=g[0],d=g[1]),this._setNativeRange(h,i,c,d)):this._setNativeRange(null),this.update(b)},a.prototype.shiftAfter=function(a,b,c){var d;return d=this.getRange(),c(),null!=d?(d.shift(a,b),this.setRange(d,"silent")):void 0},a.prototype.update=function(a){var b,c,d,f;return c=this.checkFocus(),d=this.getRange(!0),b="silent"!==a&&(!e.compare(d,this.range)||c!==this.focus),f=c?d:null,null!==f||"user"!==a||this.nullDelay?(this.nullDelay=!1,this.range=d,this.focus=c,b?this.emitter.emit(this.emitter.constructor.events.SELECTION_CHANGE,f,a):void 0):this.nullDelay=!0},a.prototype._decodePosition=function(a,b){var c;return h(a).isElement()&&(c=h(a.parentNode).childNodes().indexOf(a),b+=c,a=a.parentNode),[a,b]},a.prototype._encodePosition=function(a,b){for(var c;;){if(h(a).isTextNode()||a.tagName===h.DEFAULT_BREAK_TAG||null!=h.EMBED_TAGS[a.tagName])return[a,b];if(b<a.childNodes.length)a=a.childNodes[b],b=0;else{if(0===a.childNodes.length)return null==this.doc.normalizer.whitelist.tags[a.tagName]&&(c=document.createTextNode(""),a.appendChild(c),a=c),[a,0];if(a=a.lastChild,!h(a).isElement())return[a,h(a).length()];if(a.tagName===h.DEFAULT_BREAK_TAG||null!=h.EMBED_TAGS[a.tagName])return[a,1];b=a.childNodes.length}}},a.prototype._getNativeRange=function(){var a,b;return b=document.getSelection(),(null!=b?b.rangeCount:void 0)>0&&(a=b.getRangeAt(0),h(a.startContainer).isAncestor(this.doc.root,!0)&&(a.startContainer===a.endContainer||h(a.endContainer).isAncestor(this.doc.root,!0)))?a:null},a.prototype._indexToPosition=function(a){var b,c,d;return 0===this.doc.lines.length?[this.doc.root,0]:(d=this.doc.findLeafAt(a,!0),b=d[0],c=d[1],this._decodePosition(b.node,c))},a.prototype._positionToIndex=function(a,b){var c,d,e,f,g,i;if(h.isIE(10)&&"BR"===a.tagName&&1===b&&(b=0),i=this._encodePosition(a,b),d=i[0],b=i[1],f=this.doc.findLine(d),null==f)return 0;for(c=f.findLeaf(d),g=0;null!=f.prev;)f=f.prev,g+=f.length;if(null==c)return g;for(e=0;null!=c.prev;)c=c.prev,e+=c.length;return g+e+b},a.prototype._setNativeRange=function(a,b,c,d){var e,f;if(f=document.getSelection())if(null!=a){if(this.checkFocus()||this.doc.root.focus(),e=this._getNativeRange(),null==e||a!==e.startContainer||b!==e.startOffset||c!==e.endContainer||d!==e.endOffset)return f.removeAllRanges(),e=document.createRange(),e.setStart(a,b),e.setEnd(c,d),f.addRange(e)}else if(f.removeAllRanges(),this.doc.root.blur(),h.isIE(11)&&!h.isIE(9))return document.body.focus()},a}(),b.exports=f},{"../lib/dom":17,"../lib/range":20,"./leaf":11,"./normalizer":13,lodash:1}],15:[function(a,b){a("./modules/authorship"),a("./modules/image-tooltip"),a("./modules/keyboard"),a("./modules/link-tooltip"),a("./modules/multi-cursor"),a("./modules/paste-manager"),a("./modules/toolbar"),a("./modules/tooltip"),a("./modules/undo-manager"),b.exports=a("./quill")},{"./modules/authorship":21,"./modules/image-tooltip":22,"./modules/keyboard":23,"./modules/link-tooltip":24,"./modules/multi-cursor":25,"./modules/paste-manager":26,"./modules/toolbar":27,"./modules/tooltip":28,"./modules/undo-manager":29,"./quill":30}],16:[function(a,b){var c,d,e,f=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},g={}.hasOwnProperty;e=a("./dom"),d=a("./picker"),c=function(a){function b(){b.__super__.constructor.apply(this,arguments),e(this.container).addClass("ql-color-picker")}return f(b,a),b.prototype.buildItem=function(a,c,d){var e;return e=b.__super__.buildItem.call(this,a,c,d),e.style.backgroundColor=c.value,e},b}(d),b.exports=c},{"./dom":17,"./picker":19}],17:[function(a,b){var c,d,e,f,g,h=function(a,b){return function(){return a.apply(b,arguments)}},i=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},j={}.hasOwnProperty;e=a("lodash"),g=null,d=function(){function a(a){this.node=a,this.trigger=h(this.trigger,this)}return a.prototype.addClass=function(a){return this.hasClass(a)?void 0:(null!=this.node.classList?this.node.classList.add(a):null!=this.node.className&&(this.node.className=(this.node.className+" "+a).trim()),this)},a.prototype.attributes=function(a){var b,c,d,f,g,h;if(a)return e.each(a,function(a){return function(b,c){return a.node.setAttribute(c,b)}}(this)),this;if(null==this.node.attributes)return{};for(a={},g=this.node.attributes,c=d=0,f=g.length;f>d;c=++d)h=g[c],b=this.node.attributes[c],a[b.name]=b.value;return a},a.prototype.child=function(a){var b,c;for(b=this.node.firstChild,c=f(b).length();null!=b&&!(c>a);)a-=c,b=b.nextSibling,c=f(b).length();return null==b&&(b=this.node.lastChild,a=f(b).length()),[b,a]},a.prototype.childNodes=function(){return e.map(this.node.childNodes)},a.prototype.classes=function(){return this.node.className.split(/\s+/)},a.prototype.data=function(a,b){var c;return null!=b?(null==this.node["ql-data"]&&(this.node["ql-data"]={}),this.node["ql-data"][a]=b,this):null!=(c=this.node["ql-data"])?c[a]:void 0},a.prototype.descendants=function(){return e.map(this.node.getElementsByTagName("*"))},a.prototype.get=function(){return this.node},a.prototype.hasClass=function(a){return null!=this.node.classList?this.node.classList.contains(a):null!=this.node.className?this.classes().indexOf(a)>-1:!1},a.prototype.isAncestor=function(a,b){var c;if(null==b&&(b=!1),a===this.node)return b;for(c=this.node;c;){if(c===a)return!0;c=c.parentNode}return!1},a.prototype.isElement=function(){var a;return(null!=(a=this.node)?a.nodeType:void 0)===f.ELEMENT_NODE},a.prototype.isTextNode=function(){var a;return(null!=(a=this.node)?a.nodeType:void 0)===f.TEXT_NODE},a.prototype.isolate=function(a){return null!=this.node.nextSibling&&f(this.node.nextSibling).splitBefore(a),this.splitBefore(a),this},a.prototype.length=function(){var a;return null==this.node?0:(a=this.text().length,this.isElement()&&(a+=this.node.querySelectorAll(Object.keys(f.EMBED_TAGS).join(",")).length),a)},a.prototype.merge=function(a){var b;return b=f(a),this.isElement()?(b.moveChildren(this.node),this.normalize()):this.text(this.text()+b.text()),b.remove(),this},a.prototype.moveChildren=function(a){return e.each(this.childNodes(),function(b){return a.appendChild(b)}),this},a.prototype.nextLineNode=function(a){var b;return b=this.node.nextSibling,null==b&&this.node.parentNode!==a&&(b=this.node.parentNode.nextSibling),null!=b&&null!=f.LIST_TAGS[b.tagName]&&(b=b.firstChild),b},a.prototype.normalize=function(){var a,b,c,d;for(b=this.node.firstChild;null!=b;)d=b.nextSibling,a=f(b),null!=d&&f(d).isTextNode()&&(0===a.text().length?a.remove():a.isTextNode()&&(c=d.nextSibling,a.merge(d),d=c)),b=d;return this},a.prototype.on=function(a,b){return this.node.addEventListener(a,function(c){return function(d){var e,f;return e=!g||"keydown"!==a&&"keyup"!==a?d:g,f=b.call(c.node,e),f||(d.preventDefault(),d.stopPropagation()),f}}(this)),this},a.prototype.remove=function(){var a;return null!=(a=this.node.parentNode)&&a.removeChild(this.node),this.node=null,null},a.prototype.removeClass=function(a){var b;if(this.hasClass(a))return null!=this.node.classList?this.node.classList.remove(a):null!=this.node.className&&(b=this.classes(),b.splice(b.indexOf(a),1),this.node.className=b.join(" ")),this.node.getAttribute("class")||this.node.removeAttribute("class"),this},a.prototype.replace=function(a){return this.node.parentNode.replaceChild(a,this.node),this.node=a,a},a.prototype.splitBefore=function(a,b){var c,d,e,g;if(null==b&&(b=!1),this.node===a||this.node.parentNode===a)return this;if(null!=this.node.previousSibling||b){for(e=this.node.parentNode,d=e.cloneNode(!1),e.parentNode.insertBefore(d,e.nextSibling),g=this.node;null!=g;)c=g.nextSibling,d.appendChild(g),g=c;return f(d).splitBefore(a)}return f(this.node.parentNode).splitBefore(a)},a.prototype.split=function(a,b){var c,d,e,g,h,i,j,k,l,m;if(null==b&&(b=!1),j=this.length(),a=Math.max(0,a),a=Math.min(a,j),!b&&0===a)return[this.node.previousSibling,this.node,!1];if(!b&&a===j)return[this.node,this.node.nextSibling,!1];if(this.node.nodeType===f.TEXT_NODE)return c=this.node.splitText(a),[this.node,c,!0];for(h=this.node,m=this.node.cloneNode(!1),this.node.parentNode.insertBefore(m,h.nextSibling),k=this.child(a),d=k[0],a=k[1],l=f(d).split(a),e=l[0],g=l[1];null!==g;)i=g.nextSibling,m.appendChild(g),g=i;return[h,m,!0]},a.prototype.styles=function(a,b){var c,d;return null==b&&(b=!1),a?(b||(a=e.defaults(a,this.styles())),d=e.map(a,function(a,b){return b+": "+a}).join("; ")+";",this.node.setAttribute("style",d),this):(d=this.node.getAttribute("style")||"",c=e.reduce(d.split(";"),function(a,b){var c,d,e;return d=b.split(":"),c=d[0],e=d[1],c&&e&&(c=c.trim(),e=e.trim(),a[c.toLowerCase()]=e),a},{}))},a.prototype.switchTag=function(a){var b,c;return a=a.toUpperCase(),this.node.tagName===a?this:(c=document.createElement(a),b=this.attributes(),null==f.VOID_TAGS[a]&&this.moveChildren(c),this.replace(c),this.attributes(b).get())},a.prototype.text=function(a){if(null!=a){switch(this.node.nodeType){case f.ELEMENT_NODE:this.node.textContent=a;break;case f.TEXT_NODE:this.node.data=a}return this}switch(this.node.nodeType){case f.ELEMENT_NODE:return this.node.tagName===f.DEFAULT_BREAK_TAG?"":null!=f.EMBED_TAGS[this.node.tagName]?f.EMBED_TEXT:null!=this.node.textContent?this.node.textContent:"";case f.TEXT_NODE:return this.node.data||"";default:return""}},a.prototype.textNodes=function(){var a,b,c;for(c=document.createTreeWalker(this.node,NodeFilter.SHOW_TEXT,null,!1),b=[];a=c.nextNode();)b.push(a);return b},a.prototype.toggleClass=function(a,b){return null==b&&(b=!this.hasClass(a)),b?this.addClass(a):this.removeClass(a),this},a.prototype.trigger=function(a,b){var c,d,h;return null==b&&(b={}),["keypress","keydown","keyup"].indexOf(a)<0?(c=document.createEvent("Event"),c.initEvent(a,b.bubbles,b.cancelable)):(c=document.createEvent("KeyboardEvent"),g=e.clone(b),g.which=e.isNumber(b.key)?b.key:e.isString(b.key)?b.key.toUpperCase().charCodeAt(0):0,f.isIE(10)?(h=[],b.altKey&&h.push("Alt"),b.ctrlKey&&h.push("Control"),b.metaKey&&h.push("Meta"),b.shiftKey&&h.push("Shift"),c.initKeyboardEvent(a,b.bubbles,b.cancelable,window,0,0,h.join(" "),null,null)):(d=e.isFunction(c.initKeyboardEvent)?"initKeyboardEvent":"initKeyEvent",c[d](a,b.bubbles,b.cancelable,window,b.ctrlKey,b.altKey,b.shiftKey,b.metaKey,0,0))),this.node.dispatchEvent(c),g=null,this},a.prototype.unwrap=function(){var a,b;return b=this.node.firstChild,a=this.node.nextSibling,e.each(this.childNodes(),function(b){return function(c){return b.node.parentNode.insertBefore(c,a)}}(this)),this.remove(),b},a.prototype.wrap=function(a){var b;for(null!=this.node.parentNode&&this.node.parentNode.insertBefore(a,this.node),b=a;null!=b.firstChild;)b=a.firstChild;return b.appendChild(this.node),this},a}(),c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return i(b,a),b.prototype["default"]=function(){return this.node.querySelector("option[selected]")},b.prototype.option=function(a,b){var c,d,f,g,h,i;if(null==b&&(b=!0),i=e.isElement(a)?a.value:a){for(i=i.replace(/[^\w]+/g,""),h=this.node.children,d=f=0,g=h.length;g>f;d=++f)if(c=h[d],c.value.replace(/[^\w]+/g,"")===i){this.node.selectedIndex=d;break}}else this.node.selectedIndex=-1;return b&&this.trigger("change"),this},b.prototype.reset=function(a){var b;return null==a&&(a=!0),b=this["default"](),null!=b?b.selected=!0:this.node.selectedIndex=0,a&&this.trigger("change"),this},b.prototype.value=function(){return this.node.selectedIndex>-1?this.node.options[this.node.selectedIndex].value:""},b}(d),f=function(a){return"SELECT"===(null!=a?a.tagName:void 0)?new c(a):new d(a)},f=e.extend(f,{ELEMENT_NODE:1,NOBREAK_SPACE:"&nbsp;",TEXT_NODE:3,ZERO_WIDTH_NOBREAK_SPACE:"﻿",DEFAULT_BLOCK_TAG:"DIV",DEFAULT_BREAK_TAG:"BR",DEFAULT_INLINE_TAG:"SPAN",EMBED_TEXT:"!",FONT_SIZES:{"10px":1,"13px":2,"16px":3,"18px":4,"24px":5,"32px":6,"48px":7},KEYS:{BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},BLOCK_TAGS:{ADDRESS:"ADDRESS",ARTICLE:"ARTICLE",ASIDE:"ASIDE",AUDIO:"AUDIO",BLOCKQUOTE:"BLOCKQUOTE",CANVAS:"CANVAS",DD:"DD",DIV:"DIV",DL:"DL",FIGCAPTION:"FIGCAPTION",FIGURE:"FIGURE",FOOTER:"FOOTER",FORM:"FORM",H1:"H1",H2:"H2",H3:"H3",H4:"H4",H5:"H5",H6:"H6",HEADER:"HEADER",HGROUP:"HGROUP",LI:"LI",OL:"OL",OUTPUT:"OUTPUT",P:"P",PRE:"PRE",SECTION:"SECTION",TABLE:"TABLE",TBODY:"TBODY",TD:"TD",TFOOT:"TFOOT",TH:"TH",THEAD:"THEAD",TR:"TR",UL:"UL",VIDEO:"VIDEO"},EMBED_TAGS:{IMG:"IMG"},LINE_TAGS:{DIV:"DIV",LI:"LI"},LIST_TAGS:{OL:"OL",UL:"UL"},VOID_TAGS:{AREA:"AREA",BASE:"BASE",BR:"BR",COL:"COL",COMMAND:"COMMAND",EMBED:"EMBED",HR:"HR",IMG:"IMG",INPUT:"INPUT",KEYGEN:"KEYGEN",LINK:"LINK",META:"META",PARAM:"PARAM",SOURCE:"SOURCE",TRACK:"TRACK",WBR:"WBR"},convertFontSize:function(a){var b,c,d,g;e.isString(a)&&a.indexOf("px")>-1?(d=Object.keys(f.FONT_SIZES),g=e.values(f.FONT_SIZES)):(g=Object.keys(f.FONT_SIZES),d=e.values(f.FONT_SIZES));for(b in d)if(c=d[b],parseInt(a)<=parseInt(c))return g[b];return e.last(g)},isIE:function(a){var b;return b=document.documentMode,b&&a>=b},isIOS:function(){return/iPhone|iPad/i.test(navigator.userAgent)},isMac:function(){return/Mac/i.test(navigator.platform)}}),b.exports=f},{lodash:1}],18:[function(a,b){var c,d;d=function(){function a(a){this.data=a,this.prev=this.next=null}return a}(),c=function(){function a(){this.length=0,this.first=this.last=null}return a.Node=d,a.prototype.append=function(a){return null!=this.first?(a.next=null,this.last.next=a):this.first=a,a.prev=this.last,this.last=a,this.length+=1},a.prototype.insertAfter=function(a,b){return b.prev=a,null!=a?(b.next=a.next,null!=a.next&&(a.next.prev=b),a.next=b,a===this.last&&(this.last=b)):(b.next=this.first,this.first.prev=b,this.first=b),this.length+=1},a.prototype.remove=function(a){return this.length>1?(null!=a.prev&&(a.prev.next=a.next),null!=a.next&&(a.next.prev=a.prev),a===this.first&&(this.first=a.next),a===this.last&&(this.last=a.prev)):this.first=this.last=null,a.prev=a.next=null,this.length-=1},a.prototype.toArray=function(){var a,b;for(a=[],b=this.first;null!=b;)a.push(b),b=b.next;return a},a}(),b.exports=c},{}],19:[function(a,b){var c,d,e;d=a("lodash"),e=a("./dom"),c=function(){function a(a){this.select=a,this.container=document.createElement("span"),this.buildPicker(),e(this.container).addClass("ql-picker"),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),e(document).on("click",function(a){return function(){return a.close(),!0}}(this)),e(this.label).on("click",function(a){return function(){return d.defer(function(){return e(a.container).toggleClass("ql-expanded")}),!1}}(this)),e(this.select).on("change",function(a){return function(){var b,c;return a.select.selectedIndex>-1&&(b=a.container.querySelectorAll(".ql-picker-item")[a.select.selectedIndex],c=a.select.options[a.select.selectedIndex]),a.selectItem(b,!1),e(a.label).toggleClass("ql-active",c!==e(a.select)["default"]())}}(this))}return a.TEMPLATE='<span class="ql-picker-label"></span><span class="ql-picker-options"></span>',a.prototype.buildItem=function(a,b,c){var d;return d=document.createElement("span"),d.setAttribute("data-value",b.getAttribute("value")),e(d).addClass("ql-picker-item").text(e(b).text()).on("click",function(a){return function(){return a.selectItem(d,!0),a.close()}}(this)),this.select.selectedIndex===c&&this.selectItem(d,!1),d},a.prototype.buildPicker=function(){var b;return d.each(e(this.select).attributes(),function(a){return function(b,c){return a.container.setAttribute(c,b)}}(this)),this.container.innerHTML=a.TEMPLATE,this.label=this.container.querySelector(".ql-picker-label"),b=this.container.querySelector(".ql-picker-options"),d.each(this.select.options,function(a){return function(c,d){var e;return e=a.buildItem(b,c,d),b.appendChild(e)}}(this))},a.prototype.close=function(){return e(this.container).removeClass("ql-expanded")},a.prototype.selectItem=function(a,b){var c,d;return c=this.container.querySelector(".ql-selected"),null!=c&&e(c).removeClass("ql-selected"),null!=a?(d=a.getAttribute("data-value"),e(a).addClass("ql-selected"),e(this.label).text(e(a).text()),e(this.select).option(d,b),this.label.setAttribute("data-value",d)):(this.label.innerHTML="&nbsp;",this.label.removeAttribute("data-value"))},a}(),b.exports=c},{"./dom":17,lodash:1}],20:[function(a,b){var c,d;d=a("lodash"),c=function(){function a(a,b){this.start=a,this.end=b}return a.compare=function(a,b){return a===b?!0:null==a||null==b?!1:a.equals(b)},a.prototype.equals=function(a){return null==a?!1:this.start===a.start&&this.end===a.end},a.prototype.shift=function(a,b){var c;return c=d.map([this.start,this.end],function(c){return a>c?c:b>=0?c+b:Math.max(a,c+b)}),this.start=c[0],this.end=c[1],c},a.prototype.isCollapsed=function(){return this.start===this.end},a}(),b.exports=c},{lodash:1}],21:[function(a,b){var c,d,e,f,g;e=a("../quill"),f=e.require("lodash"),g=e.require("dom"),d=e.require("delta"),c=function(){function a(a,b){this.quill=a,this.options=b,null!=this.options.button&&this.attachButton(this.options.button),this.options.enabled&&this.enable(),this.quill.addFormat("author",{"class":"author-"}),null!=this.options.authorId&&(this.quill.on(this.quill.constructor.events.PRE_EVENT,function(a){return function(b,c,g){var h,i;return b===a.quill.constructor.events.TEXT_CHANGE&&"user"===g?(h=new d,i={author:a.options.authorId},f.each(c.ops,function(b){return null==b["delete"]?null!=b.insert||null!=b.retain&&null!=b.attributes?(b.attributes||(b.attributes={}),b.attributes.author=a.options.authorId,h.retain(b.retain||b.insert.length||1,i)):h.retain(b.retain):void 0}),a.quill.updateContents(h,e.sources.SILENT)):void 0}}(this)),this.addAuthor(this.options.authorId,this.options.color))}return a.DEFAULTS={authorId:null,color:"transparent",enabled:!1},a.prototype.addAuthor=function(a,b){var c;return c={},c[".authorship .author-"+a]={"background-color":""+b},this.quill.theme.addStyles(c)},a.prototype.attachButton=function(a){var b;return b=g(a),b.on("click",function(a){return function(){return b.toggleClass("ql-on"),a.enable($dom.hasClass("ql-on"))}}(this))},a.prototype.enable=function(a){return null==a&&(a=!0),g(this.quill.root).toggleClass("authorship",a)},a.prototype.disable=function(){return this.enable(!1)},a}(),e.registerModule("authorship",c),b.exports=c},{"../quill":30}],22:[function(a,b){var c,d,e,f,g,h,i,j=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},k={}.hasOwnProperty;e=a("../quill"),g=a("./tooltip"),h=e.require("lodash"),i=e.require("dom"),c=e.require("delta"),f=e.require("range"),d=function(a){function b(a,c){this.quill=a,this.options=c,this.options=h.defaults(this.options,g.DEFAULTS),b.__super__.constructor.call(this,this.quill,this.options),this.preview=this.container.querySelector(".preview"),this.textbox=this.container.querySelector(".input"),i(this.container).addClass("ql-image-tooltip"),this.initListeners()}return j(b,a),b.DEFAULTS={template:'<input class="input" type="textbox"> <div class="preview"> <span>Preview</span> </div> <a href="javascript:;" class="cancel">Cancel</a> <a href="javascript:;" class="insert">Insert</a>'},b.prototype.initListeners=function(){return i(this.quill.root).on("focus",h.bind(this.hide,this)),i(this.container.querySelector(".insert")).on("click",h.bind(this.insertImage,this)),i(this.container.querySelector(".cancel")).on("click",h.bind(this.hide,this)),i(this.textbox).on("input",h.bind(this._preview,this)),this.initTextbox(this.textbox,this.insertImage,this.hide),this.quill.onModuleLoad("toolbar",function(a){return function(b){return a.toolbar=b,b.initFormat("image",h.bind(a._onToolbar,a))}}(this))},b.prototype.insertImage=function(){var a,b;return b=this._normalizeURL(this.textbox.value),null==this.range&&(this.range=new f(0,0)),this.range&&(this.preview.innerHTML="<span>Preview</span>",this.textbox.value="",a=this.range.end,this.quill.insertEmbed(a,"image",b,"user"),this.quill.setSelection(a+1,a+1)),this.hide()},b.prototype._onToolbar=function(a,b){return b?(this.textbox.value||(this.textbox.value="http://"),this.show(),this.textbox.focus(),h.defer(function(a){return function(){return a.textbox.setSelectionRange(a.textbox.value.length,a.textbox.value.length)}}(this))):(this.quill.deleteText(a,"user"),this.toolbar.setActive("image",!1))},b.prototype._preview=function(){var a;if(this._matchImageURL(this.textbox.value))return"IMG"===this.preview.firstChild.tagName?this.preview.firstChild.setAttribute("src",this.textbox.value):(a=document.createElement("img"),a.setAttribute("src",this.textbox.value),this.preview.replaceChild(a,this.preview.firstChild))},b.prototype._matchImageURL=function(a){return/^https?:\/\/.+\.(jpe?g|gif|png)$/.test(a)},b.prototype._normalizeURL=function(a){return/^https?:\/\//.test(a)||(a="http://"+a),a},b}(g),e.registerModule("image-tooltip",d),b.exports=d},{"../quill":30,"./tooltip":28}],23:[function(a,b){var c,d,e,f,g;e=a("../quill"),f=e.require("lodash"),g=e.require("dom"),c=e.require("delta"),d=function(){function a(a){this.quill=a,this.hotkeys={},this._initListeners(),this._initHotkeys(),this.quill.onModuleLoad("toolbar",function(a){return function(b){return a.toolbar=b
}}(this))}return a.hotkeys={BOLD:{key:"B",metaKey:!0},INDENT:{key:g.KEYS.TAB},ITALIC:{key:"I",metaKey:!0},OUTDENT:{key:g.KEYS.TAB,shiftKey:!0},UNDERLINE:{key:"U",metaKey:!0}},a.prototype.addHotkey=function(a,b){return Array.isArray(a)||(a=[a]),f.each(a,function(a){return function(c){var d,e;return c=f.isObject(c)?f.clone(c):{key:c},c.callback=b,e=f.isNumber(c.key)?c.key:c.key.toUpperCase().charCodeAt(0),null==(d=a.hotkeys)[e]&&(d[e]=[]),a.hotkeys[e].push(c)}}(this))},a.prototype.toggleFormat=function(a,b){var c,d;return c=a.isCollapsed()?this.quill.getContents(Math.max(0,a.start-1),a.end):this.quill.getContents(a),d=0===c.ops.length||!f.all(c.ops,function(a){var c;return null!=(c=a.attributes)?c[b]:void 0}),a.isCollapsed()?this.quill.prepareFormat(b,d,e.sources.USER):this.quill.formatText(a,b,d,e.sources.USER),null!=this.toolbar?this.toolbar.setActive(b,d):void 0},a.prototype._initEnter=function(){var a;return a=[{key:g.KEYS.ENTER},{key:g.KEYS.ENTER,shiftKey:!0}],this.addHotkey(a,function(a){return function(b){var d,g,h,i,j,k;return null==b?!0:(j=a.quill.editor.doc.findLineAt(b.start),h=j[0],i=j[1],k=h.findLeafAt(i),g=k[0],i=k[1],d=(new c).retain(b.start).insert("\n",h.formats)["delete"](b.end-b.start),a.quill.updateContents(d,e.sources.USER),f.each(g.formats,function(b,c){return a.quill.prepareFormat(c,b),a.toolbar.setActive(c,b)}),!1)}}(this))},a.prototype._initDeletes=function(){return this.addHotkey([g.KEYS.DELETE,g.KEYS.BACKSPACE],function(a){return function(b,c){var d,f,h,i;return null!=b&&a.quill.getLength()>0&&(b.start!==b.end?a.quill.deleteText(b.start,b.end,e.sources.USER):c.key===g.KEYS.BACKSPACE?(i=a.quill.editor.doc.findLineAt(b.start),f=i[0],h=i[1],0===h&&(f.formats.bullet||f.formats.list)?(d=f.formats.bullet?"bullet":"list",a.quill.formatLine(b.start,b.start,d,!1)):b.start>0&&a.quill.deleteText(b.start-1,b.start,e.sources.USER)):b.start<a.quill.getLength()-1&&a.quill.deleteText(b.start,b.start+1,e.sources.USER)),!1}}(this))},a.prototype._initHotkeys=function(){return this.addHotkey(a.hotkeys.INDENT,function(a){return function(b){return a._onTab(b,!1),!1}}(this)),this.addHotkey(a.hotkeys.OUTDENT,function(){return function(){return!1}}(this)),f.each(["bold","italic","underline"],function(b){return function(c){return b.addHotkey(a.hotkeys[c.toUpperCase()],function(a){return b.toggleFormat(a,c),!1})}}(this)),this._initDeletes(),this._initEnter()},a.prototype._initListeners=function(){return g(this.quill.root).on("keydown",function(a){return function(b){var c;return c=!1,f.each(a.hotkeys[b.which],function(d){var e;return e=g.isMac()?b.metaKey:b.metaKey||b.ctrlKey,!!d.metaKey==!!e&&!!d.shiftKey==!!b.shiftKey&&!!d.altKey==!!b.altKey?(c=d.callback(a.quill.getSelection(),d,b)===!1||c,!0):void 0}),!c}}(this))},a.prototype._onTab=function(a,b){var d;return null==b&&(b=!1),d=(new c).retain(a.start).insert("	")["delete"](a.end-a.start).retain(this.quill.getLength()-a.end),this.quill.updateContents(d,e.sources.USER),this.quill.setSelection(a.start+1,a.start+1)},a}(),e.registerModule("keyboard",d),b.exports=d},{"../quill":30}],24:[function(a,b){var c,d,e,f,g,h=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},i={}.hasOwnProperty;d=a("../quill"),e=a("./tooltip"),f=d.require("lodash"),g=d.require("dom"),c=function(a){function b(a,c){this.quill=a,this.options=c,this.options=f.defaults(this.options,e.DEFAULTS),b.__super__.constructor.call(this,this.quill,this.options),g(this.container).addClass("ql-link-tooltip"),this.textbox=this.container.querySelector(".input"),this.link=this.container.querySelector(".url"),this.initListeners()}return h(b,a),b.DEFAULTS={maxLength:50,template:'<span class="title">Visit URL:&nbsp;</span> <a href="#" class="url" target="_blank" href="about:blank"></a> <input class="input" type="text"> <span>&nbsp;&#45;&nbsp;</span> <a href="javascript:;" class="change">Change</a> <a href="javascript:;" class="remove">Remove</a> <a href="javascript:;" class="done">Done</a>'},b.hotkeys={LINK:{key:"K",metaKey:!0}},b.prototype.initListeners=function(){return this.quill.on(this.quill.constructor.events.SELECTION_CHANGE,function(a){return function(b){var c;if(null!=b&&b.isCollapsed())return c=a._findAnchor(b),c?(a.setMode(c.href,!1),a.show(c)):a.container.style.left!==e.HIDE_MARGIN?(a.range=null,a.hide()):void 0}}(this)),g(this.container.querySelector(".done")).on("click",f.bind(this.saveLink,this)),g(this.container.querySelector(".remove")).on("click",function(a){return function(){return a.removeLink(a.range)}}(this)),g(this.container.querySelector(".change")).on("click",function(a){return function(){return a.setMode(a.link.href,!0)}}(this)),this.initTextbox(this.textbox,this.saveLink,this.hide),this.quill.onModuleLoad("toolbar",function(a){return function(b){return a.toolbar=b,b.initFormat("link",f.bind(a._onToolbar,a))}}(this)),this.quill.onModuleLoad("keyboard",function(a){return function(c){return c.addHotkey(b.hotkeys.LINK,f.bind(a._onKeyboard,a))}}(this))},b.prototype.saveLink=function(){var a,b,c;return c=this._normalizeURL(this.textbox.value),null!=this.range&&(b=this.range.end,this.range.isCollapsed()?(a=this._findAnchor(this.range),null!=a&&(a.href=c)):this.quill.formatText(this.range,"link",c,"user"),this.quill.setSelection(b,b)),this.setMode(c,!1)},b.prototype.removeLink=function(a){return a.isCollapsed()&&(a=this._expandRange(a)),this.hide(),this.quill.formatText(a,"link",!1,"user"),null!=this.toolbar?this.toolbar.setActive("link",!1):void 0},b.prototype.setMode=function(a,b){var c;return null==b&&(b=!1),b?(this.textbox.value=a,f.defer(function(b){return function(){return b.textbox.focus(),b.textbox.setSelectionRange(0,a.length)}}(this))):(this.link.href=a,a=this.link.href,c=a.length>this.options.maxLength?a.slice(0,this.options.maxLength)+"...":a,g(this.link).text(c)),g(this.container).toggleClass("editing",b)},b.prototype._findAnchor=function(a){var b,c,d,e;for(e=this.quill.editor.doc.findLeafAt(a.start,!0),b=e[0],d=e[1],null!=b&&(c=b.node);null!=c&&c!==this.quill.root;){if("A"===c.tagName)return c;c=c.parentNode}return null},b.prototype._expandRange=function(a){var b,c,d,e,f;return e=this.quill.editor.doc.findLeafAt(a.start,!0),c=e[0],d=e[1],f=a.start-d,b=f+c.length,{start:f,end:b}},b.prototype._onToolbar=function(a,b){return this._toggle(a,b)},b.prototype._onKeyboard=function(){var a;return a=this.quill.getSelection(),this._toggle(a,!this._findAnchor(a))},b.prototype._toggle=function(a,b){var c;if(a)return b?a.isCollapsed()?void 0:(this.setMode(this._suggestURL(a),!0),c=this.quill.editor.selection._getNativeRange(),this.show(c)):this.removeLink(a)},b.prototype._normalizeURL=function(a){return/^(https?:\/\/|mailto:)/.test(a)||(a="http://"+a),a},b.prototype._suggestURL=function(a){var b;return b=this.quill.getText(a),this._normalizeURL(b)},b}(e),d.registerModule("link-tooltip",c),b.exports=c},{"../quill":30,"./tooltip":28}],25:[function(a,b){var c,d,e,f,g,h=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},i={}.hasOwnProperty;e=a("../quill"),c=a("eventemitter2").EventEmitter2,f=e.require("lodash"),g=e.require("dom"),d=function(a){function b(a,b){this.quill=a,this.options=b,this.cursors={},this.container=this.quill.addContainer("ql-multi-cursor",!0),this.quill.on(this.quill.constructor.events.TEXT_CHANGE,f.bind(this._applyDelta,this))}return h(b,a),b.DEFAULTS={template:'<span class="cursor-flag"> <span class="cursor-name"></span> </span> <span class="cursor-caret"></span>',timeout:2500},b.events={CURSOR_ADDED:"cursor-addded",CURSOR_MOVED:"cursor-moved",CURSOR_REMOVED:"cursor-removed"},b.prototype.clearCursors=function(){return f.each(Object.keys(this.cursors),f.bind(this.removeCursor,this)),this.cursors={}},b.prototype.moveCursor=function(a,b){var c;return c=this.cursors[a],c.index=b,g(c.elem).removeClass("hidden"),clearTimeout(c.timer),c.timer=setTimeout(function(){return function(){return g(c.elem).addClass("hidden"),c.timer=null}}(this),this.options.timeout),this._updateCursor(c),c},b.prototype.removeCursor=function(a){var c;return c=this.cursors[a],this.emit(b.events.CURSOR_REMOVED,c),null!=c&&c.elem.parentNode.removeChild(c.elem),delete this.cursors[a]},b.prototype.setCursor=function(a,c,d,e){var g;return null==this.cursors[a]&&(this.cursors[a]=g={userId:a,index:c,color:e,elem:this._buildCursor(d,e)},this.emit(b.events.CURSOR_ADDED,g)),f.defer(function(b){return function(){return b.moveCursor(a,c)}}(this)),this.cursors[a]},b.prototype.shiftCursors=function(a,b,c){return null==c&&(c=null),f.each(this.cursors,function(){return function(d){return d&&(d.index>a||d.userId===c)?d.index+=Math.max(b,a-d.index):void 0}}(this))},b.prototype.update=function(){return f.each(this.cursors,function(a){return function(b){return null!=b?(a._updateCursor(b),!0):void 0}}(this))},b.prototype._applyDelta=function(a){var b;return b=0,f.each(a.ops,function(a){return function(c){var d,e;return d=0,null!=c.insert?(d=c.insert.length||1,a.shiftCursors(b,d,null!=(e=c.attributes)?e.author:void 0)):null!=c["delete"]?a.shiftCursors(b,-1*c["delete"],null):null!=c.retain&&(a.shiftCursors(b,0,null),d=c.retain),b+=d}}(this)),this.update()},b.prototype._buildCursor=function(a,b){var c,d,e,f;return c=document.createElement("span"),g(c).addClass("cursor"),c.innerHTML=this.options.template,e=c.querySelector(".cursor-flag"),f=c.querySelector(".cursor-name"),g(f).text(a),d=c.querySelector(".cursor-caret"),d.style.backgroundColor=f.style.backgroundColor=b,this.container.appendChild(c),c},b.prototype._updateCursor=function(a){var c,d;return c=this.quill.getBounds(a.index),a.elem.style.top=c.top-this.quill.container.scrollTop+"px",a.elem.style.left=c.left+"px",a.elem.style.height=c.height+"px",d=a.elem.querySelector(".cursor-flag"),g(a.elem).toggleClass("top",parseInt(a.elem.style.top)<=d.offsetHeight).toggleClass("left",parseInt(a.elem.style.left)<=d.offsetWidth).toggleClass("right",this.quill.root.offsetWidth-parseInt(a.elem.style.left)<=d.offsetWidth),this.emit(b.events.CURSOR_MOVED,a)},b}(c),e.registerModule("multi-cursor",d),b.exports=d},{"../quill":30,eventemitter2:2}],26:[function(a,b){var c,d,e,f,g,h;f=a("../quill"),d=a("../core/document"),g=f.require("lodash"),h=f.require("dom"),c=f.require("delta"),e=function(){function a(a,b){this.quill=a,this.options=b,this.container=this.quill.addContainer("ql-paste-manager"),this.container.setAttribute("contenteditable",!0),h(this.quill.root).on("paste",g.bind(this._paste,this))}return a.prototype._paste=function(){var a,b;return a=this.quill.getLength(),b=this.quill.getSelection(),null!=b?(this.container.focus(),g.defer(function(a){return function(){var e,f,g,h,i,j,k,l;return f=new d(a.container,a.quill.options),e=f.toDelta(),g=e.length()-1,e.compose((new c).retain(g)["delete"](1)),b.start>0&&e.ops.unshift({retain:b.start}),e["delete"](b.end-b.start),a.quill.updateContents(e,"user"),a.quill.setSelection(b.start+g,b.start+g),k=a.quill.editor.doc.findLineAt(b.start+g),h=k[0],j=k[1],i=h.node.getBoundingClientRect().bottom,l=document.documentElement.clientHeight,i>l&&h.node.scrollIntoView(!1),a.container.innerHTML=""}}(this))):void 0},a}(),f.registerModule("paste-manager",e),b.exports=e},{"../core/document":8,"../quill":30}],27:[function(a,b){var c,d,e,f;c=a("../quill"),e=c.require("lodash"),f=c.require("dom"),d=function(){function a(b,d){if(this.quill=b,this.options=d,(e.isString(this.options)||e.isElement(this.options))&&(this.options={container:this.options}),null==this.options.container)throw new Error("container required for toolbar",this.options);this.container=e.isString(this.options.container)?document.querySelector(this.options.container):this.options.container,this.inputs={},this.preventUpdate=!1,this.triggering=!1,e.each(this.quill.options.formats,function(b){return function(c){return null==a.formats.TOOLTIP[c]?b.initFormat(c,e.bind(b._applyFormat,b,c)):void 0}}(this)),this.quill.on(c.events.FORMAT_INIT,function(b){return function(c){return null==a.formats.TOOLTIP[c]?b.initFormat(c,e.bind(b._applyFormat,b,c)):void 0}}(this)),this.quill.on(c.events.SELECTION_CHANGE,function(a){return function(b){return null!=b?a.updateActive(b):void 0}}(this)),this.quill.on(c.events.TEXT_CHANGE,function(a){return function(){return a.updateActive()}}(this)),this.quill.onModuleLoad("keyboard",function(a){return function(b){return b.addHotkey([f.KEYS.BACKSPACE,f.KEYS.DELETE],function(){return e.defer(e.bind(a.updateActive,a))})}}(this)),f(this.container).addClass("ql-toolbar"),f.isIOS()&&f(this.container).addClass("ios"),f.isIE(11)&&f(this.container).on("mousedown",function(){return function(){return!1}}(this))}return a.DEFAULTS={container:null},a.formats={LINE:{align:"align",bullet:"bullet",list:"list"},SELECT:{align:"align",background:"background",color:"color",font:"font",size:"size"},TOGGLE:{bold:"bold",bullet:"bullet",image:"image",italic:"italic",link:"link",list:"list",strike:"strike",underline:"underline"},TOOLTIP:{image:"image",link:"link"}},a.prototype.initFormat=function(b,c){var d,e,g;return g=".ql-"+b,null!=a.formats.SELECT[b]?(g="select"+g,d="change"):d="click",e=this.container.querySelector(g),null!=e?(this.inputs[b]=e,f(e).on(d,function(a){return function(){var b,g;return g="change"===d?f(e).value():!f(e).hasClass("ql-active"),a.preventUpdate=!0,a.quill.focus(),b=a.quill.getSelection(),null!=b&&c(b,g),a.preventUpdate=!1,!0}}(this))):void 0},a.prototype.setActive=function(a,b){var c,d,e,g;return"image"===a&&(b=!1),d=this.inputs[a],null!=d?(c=f(d),"SELECT"===d.tagName?(this.triggering=!0,g=c.value(d),null==b&&(b=null!=(e=c["default"]())?e.value:void 0),Array.isArray(b)&&(b=""),b!==g&&(null!=b?c.option(b):c.reset()),this.triggering=!1):c.toggleClass("ql-active",b||!1)):void 0},a.prototype.updateActive=function(a,b){var c;return null==b&&(b=null),a||(a=this.quill.getSelection()),null==a||this.preventUpdate?void 0:(c=this._getActive(a),e.each(this.inputs,function(a){return function(d,e){return(!Array.isArray(b)||b.indexOf(e)>-1)&&a.setActive(e,c[e]),!0}}(this)))},a.prototype._applyFormat=function(b,c,d){return this.triggering?void 0:(c.isCollapsed()?this.quill.prepareFormat(b,d,"user"):null!=a.formats.LINE[b]?this.quill.formatLine(c,b,d,"user"):this.quill.formatText(c,b,d,"user"),e.defer(function(a){return function(){return a.updateActive(c,["bullet","list"]),a.setActive(b,d)}}(this)))},a.prototype._getActive=function(a){var b,c;return b=this._getLeafActive(a),c=this._getLineActive(a),e.defaults({},b,c)},a.prototype._getLeafActive=function(a){var b,c,d,f,g;return a.isCollapsed()?(g=this.quill.editor.doc.findLineAt(a.start),d=g[0],f=g[1],b=0===f?this.quill.getContents(a.start,a.end+1):this.quill.getContents(a.start-1,a.end)):b=this.quill.getContents(a),c=e.map(b.ops,"attributes"),this._intersectFormats(c)},a.prototype._getLineActive=function(a){var b,c,d,f,g,h;for(c=[],g=this.quill.editor.doc.findLineAt(a.start),b=g[0],f=g[1],h=this.quill.editor.doc.findLineAt(a.end),d=h[0],f=h[1],null!=d&&d===b&&(d=d.next);null!=b&&b!==d;)c.push(e.clone(b.formats)),b=b.next;return this._intersectFormats(c)},a.prototype._intersectFormats=function(b){return e.reduce(b.slice(1),function(b,c){var d,f,g,h,i;return null==c&&(c={}),d=Object.keys(b),g=null!=c?Object.keys(c):{},h=e.intersection(d,g),i=e.difference(d,g),f=e.difference(g,d),e.each(h,function(d){if(null!=a.formats.SELECT[d])if(Array.isArray(b[d])){if(b[d].indexOf(c[d])<0)return b[d].push(c[d])}else if(b[d]!==c[d])return b[d]=[b[d],c[d]]}),e.each(i,function(c){return null!=a.formats.TOGGLE[c]?delete b[c]:null==a.formats.SELECT[c]||Array.isArray(b[c])?void 0:b[c]=[b[c]]}),e.each(f,function(d){return null!=a.formats.SELECT[d]?b[d]=[c[d]]:void 0}),b},b[0]||{})},a}(),c.registerModule("toolbar",d),b.exports=d},{"../quill":30}],28:[function(a,b){var c,d,e,f;c=a("../quill"),e=c.require("lodash"),f=c.require("dom"),d=function(){function a(b,c){this.quill=b,this.options=c,this.container=this.quill.addContainer("ql-tooltip"),this.container.innerHTML=this.options.template,this.hide(),this.quill.on(this.quill.constructor.events.TEXT_CHANGE,function(b){return function(){return b.container.style.left!==a.HIDE_MARGIN?(b.range=null,b.hide()):void 0}}(this))}return a.DEFAULTS={offset:10,template:""},a.HIDE_MARGIN="-10000px",a.prototype.initTextbox=function(a,b,c){return f(a).on("keydown",function(a){return function(d){switch(d.which){case f.KEYS.ENTER:return d.preventDefault(),b.call(a);case f.KEYS.ESCAPE:return d.preventDefault(),c.call(a);default:return!0}}}(this))},a.prototype.hide=function(){return this.container.style.left=a.HIDE_MARGIN,this.range&&this.quill.setSelection(this.range),this.range=null},a.prototype.position=function(a){var b,c,d,e,f,g,h;return null!=a?(g=a.getBoundingClientRect(),f=this.quill.container.getBoundingClientRect(),d=g.left-f.left,e=g.top-f.top,c=g.bottom-f.bottom,b=d+g.width/2-this.container.offsetWidth/2,h=e+g.height+this.options.offset,h+this.container.offsetHeight>this.quill.container.offsetHeight&&(h=e-this.container.offsetHeight-this.options.offset),b=Math.max(0,Math.min(b,this.quill.container.offsetWidth-this.container.offsetWidth)),h=Math.max(0,Math.min(h,this.quill.container.offsetHeight-this.container.offsetHeight))):(b=this.quill.container.offsetWidth/2-this.container.offsetWidth/2,h=this.quill.container.offsetHeight/2-this.container.offsetHeight/2),h+=this.quill.container.scrollTop,[b,h]},a.prototype.show=function(a){var b,c,d;return this.range=this.quill.getSelection(),c=this.position(a),b=c[0],d=c[1],this.container.style.left=b+"px",this.container.style.top=d+"px",this.container.focus()},a}(),c.registerModule("tooltip",d),b.exports=d},{"../quill":30}],29:[function(a,b){var c,d,e,f;d=a("../quill"),f=d.require("lodash"),c=d.require("delta"),e=function(){function a(a,b){this.quill=a,this.options=null!=b?b:{},this.lastRecorded=0,this.ignoreChange=!1,this.clear(),this.initListeners()}return a.DEFAULTS={delay:1e3,maxStack:100},a.hotkeys={UNDO:{key:"Z",metaKey:!0},REDO:{key:"Z",metaKey:!0,shiftKey:!0}},a.prototype.initListeners=function(){return this.quill.onModuleLoad("keyboard",function(b){return function(c){return c.addHotkey(a.hotkeys.UNDO,function(){return b.quill.editor.checkUpdate(),b.undo(),!1}),c.addHotkey(a.hotkeys.REDO,function(){return b.quill.editor.checkUpdate(),b.redo(),!1})}}(this)),this.quill.on(this.quill.constructor.events.TEXT_CHANGE,function(a){return function(b){return a.ignoreChange?void 0:(a.record(b,a.oldDelta),a.oldDelta=a.quill.getContents())}}(this))},a.prototype.clear=function(){return this.stack={undo:[],redo:[]},this.oldDelta=this.quill.getContents()},a.prototype.record=function(a){var b,c,d,e;if(a.ops.length>0){this.stack.redo=[];try{if(e=this.quill.getContents().diff(this.oldDelta),d=(new Date).getTime(),this.lastRecorded+this.options.delay>d&&this.stack.undo.length>0?(b=this.stack.undo.pop(),e=e.compose(b.undo),a=b.redo.compose(a)):this.lastRecorded=d,this.stack.undo.push({redo:a,undo:e}),this.stack.undo.length>this.options.maxStack)return this.stack.undo.unshift()}catch(f){return c=f,console.warn("Could not record change... clearing undo stack."),this.clear()}}},a.prototype.redo=function(){return this._change("redo","undo")},a.prototype.undo=function(){return this._change("undo","redo")},a.prototype._getLastChangeIndex=function(a){var b,c;return c=0,b=0,f.each(a.ops,function(a){return null!=a.insert?c=Math.max(b+(a.insert.length||1),c):null!=a["delete"]?c=Math.max(b,c):null!=a.retain?(null!=a.attributes&&(c=Math.max(b+a.retain,c)),b+=a.retain):void 0}),c},a.prototype._change=function(a,b){var c,d;return this.stack[a].length>0?(c=this.stack[a].pop(),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(c[a],"user"),this.ignoreChange=!1,d=this._getLastChangeIndex(c[a]),this.quill.setSelection(d,d),this.oldDelta=this.quill.getContents(),this.stack[b].push(c)):void 0},a}(),d.registerModule("undo-manager",e),b.exports=e},{"../quill":30}],30:[function(a,b){var c,d,e,f,g,h,i,j,k,l,m=function(a,b){function c(){this.constructor=a}for(var d in b)n.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},n={}.hasOwnProperty,o=[].slice;j=a("lodash"),l=a("../package.json"),c=a("rich-text/lib/delta"),e=a("eventemitter2").EventEmitter2,k=a("./lib/dom"),d=a("./core/editor"),f=a("./core/format"),g=a("./core/normalizer"),i=a("./lib/range"),h=function(a){function b(a,c){var e,f,g;if(this.container=a,null==c&&(c={}),j.isString(this.container)&&(this.container=document.querySelector(this.container)),null==this.container)throw new Error("Invalid Quill container");if(f=j.defaults(c.modules||{},b.DEFAULTS.modules),e=this.container.innerHTML,this.container.innerHTML="",this.options=j.defaults(c,b.DEFAULTS),this.options.modules=f,this.options.id=this.id="ql-editor-"+(b.editors.length+1),this.modules={},this.root=this.addContainer("ql-editor"),this.editor=new d(this.root,this,this.options),b.editors.push(this),this.setHTML(e,b.sources.SILENT),g=b.themes[this.options.theme],null==g)throw new Error("Cannot load "+this.options.theme+" theme. Are you sure you registered it?");this.theme=new g(this,this.options),j.each(this.options.modules,function(a){return function(b,c){return a.addModule(c,b)}}(this))}return m(b,a),b.version=l.version,b.editors=[],b.modules=[],b.themes=[],b.DEFAULTS={formats:["align","bold","italic","strike","underline","color","background","font","size","link","image","bullet","list"],modules:{keyboard:!0,"paste-manager":!0,"undo-manager":!0},pollInterval:100,readOnly:!1,styles:{},theme:"base"},b.events={FORMAT_INIT:"format-init",MODULE_INIT:"module-init",POST_EVENT:"post-event",PRE_EVENT:"pre-event",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change"},b.sources=d.sources,b.registerModule=function(a,c){return null!=b.modules[a]&&console.warn("Overwriting "+a+" module"),b.modules[a]=c},b.registerTheme=function(a,c){return null!=b.themes[a]&&console.warn("Overwriting "+a+" theme"),b.themes[a]=c},b.require=function(a){switch(a){case"lodash":return j;case"delta":return c;case"format":return f;case"normalizer":return g;case"dom":return k;case"range":return i;default:return null}},b.prototype.destroy=function(){var a;return a=this.getHTML(),j.each(this.modules,function(a){return j.isFunction(a.destroy)?a.destroy():void 0}),this.editor.destroy(),this.removeAllListeners(),b.editors.splice(j.indexOf(b.editors,this),1),this.container.innerHTML=a},b.prototype.addContainer=function(a,b){var c,d;return null==b&&(b=!1),d=b?this.root:null,c=document.createElement("div"),k(c).addClass(a),this.container.insertBefore(c,d),c},b.prototype.addFormat=function(a,c){return this.editor.doc.addFormat(a,c),this.emit(b.events.FORMAT_INIT,a)},b.prototype.addModule=function(a,c){var d;if(d=b.modules[a],null==d)throw new Error("Cannot load "+a+" module. Are you sure you registered it?");return c===!0&&(c={}),c=j.defaults(c,this.theme.constructor.OPTIONS[a]||{},d.DEFAULTS||{}),this.modules[a]=new d(this,c),this.emit(b.events.MODULE_INIT,a,this.modules[a]),this.modules[a]},b.prototype.deleteText=function(a,d,e){var f,g,h;return null==e&&(e=b.sources.API),h=this._buildParams(a,d,{},e),a=h[0],d=h[1],g=h[2],e=h[3],d>a?(f=(new c).retain(a)["delete"](d-a),this.editor.applyDelta(f,e)):void 0},b.prototype.emit=function(){var a,c;return c=arguments[0],a=2<=arguments.length?o.call(arguments,1):[],b.__super__.emit.apply(this,[b.events.PRE_EVENT,c].concat(o.call(a))),b.__super__.emit.apply(this,[c].concat(o.call(a))),b.__super__.emit.apply(this,[b.events.POST_EVENT,c].concat(o.call(a)))},b.prototype.focus=function(){return this.editor.focus()},b.prototype.formatLine=function(a,b,c,d,e){var f,g,h,i,j;return i=this._buildParams(a,b,c,d,e),a=i[0],b=i[1],f=i[2],e=i[3],j=this.editor.doc.findLineAt(b),g=j[0],h=j[1],null!=g&&(b+=g.length-h),this.formatText(a,b,f,e)},b.prototype.formatText=function(a,b,d,e,f){var g,h,i;return i=this._buildParams(a,b,d,e,f),a=i[0],b=i[1],h=i[2],f=i[3],h=j.reduce(h,function(a){return function(b,c,d){var e;return e=a.editor.doc.formats[d],c&&c!==e.config["default"]||(b[d]=null),b}}(this),h),g=(new c).retain(a).retain(b-a,h),this.editor.applyDelta(g,f)},b.prototype.getBounds=function(a){return this.editor.getBounds(a)},b.prototype.getContents=function(a,b){return null==a&&(a=0),null==b&&(b=null),j.isObject(a)&&(b=a.end,a=a.start),this.editor.delta.slice(a,b)},b.prototype.getHTML=function(){return this.editor.doc.getHTML()},b.prototype.getLength=function(){return this.editor.length},b.prototype.getModule=function(a){return this.modules[a]},b.prototype.getSelection=function(){return this.editor.checkUpdate(),this.editor.selection.getRange()},b.prototype.getText=function(a,b){return null==a&&(a=0),null==b&&(b=null),j.map(this.getContents(a,b).ops,function(a){return j.isString(a.insert)?a.insert:""}).join("")},b.prototype.insertEmbed=function(a,b,d,e){var f,g,h,i;return i=this._buildParams(a,0,b,d,e),a=i[0],g=i[1],h=i[2],e=i[3],f=(new c).retain(a).insert(1,h),this.editor.applyDelta(f,e)},b.prototype.insertText=function(a,b,d,e,f){var g,h,i,j;return j=this._buildParams(a,0,d,e,f),a=j[0],h=j[1],i=j[2],f=j[3],b.length>0?(g=(new c).retain(a).insert(b,i),this.editor.applyDelta(g,f)):void 0},b.prototype.onModuleLoad=function(a,c){return this.modules[a]?c(this.modules[a]):this.on(b.events.MODULE_INIT,function(b,d){return b===a?c(d):void 0})},b.prototype.prepareFormat=function(a,c,d){var e,g;return null==d&&(d=b.sources.API),e=this.editor.doc.formats[a],null!=e&&(g=this.getSelection(),null!=g?g.isCollapsed():void 0)?e.isType(f.types.LINE)?this.formatLine(g,a,c,d):e.prepare(c):void 0},b.prototype.setContents=function(a,d){var e;return null==d&&(d=b.sources.API),a=new c(Array.isArray(a)?a.slice():a.ops.slice()),e=j.last(a.slice(a.length()-1).ops),a["delete"](this.getLength()-1),null!=e&&j.isString(e.insert)&&"\n"===j.last(e.insert)&&a["delete"](1),this.updateContents(a,d)},b.prototype.setHTML=function(a,c){return null==c&&(c=b.sources.API),a.trim()||(a="<"+k.DEFAULT_BLOCK_TAG+"><"+k.DEFAULT_BREAK_TAG+"></"+k.DEFAULT_BLOCK_TAG+">"),this.editor.doc.setHTML(a),this.editor.checkUpdate(c)},b.prototype.setSelection=function(a,c,d){var e;return null==d&&(d=b.sources.API),j.isNumber(a)&&j.isNumber(c)?e=new i(a,c):(e=a,d=c||d),this.editor.selection.setRange(e,d)},b.prototype.setText=function(a,d){var e;return null==d&&(d=b.sources.API),e=(new c).insert(a),this.setContents(e,d)},b.prototype.updateContents=function(a,c){return null==c&&(c=b.sources.API),Array.isArray(a)&&(a={ops:a}),this.editor.applyDelta(a,c)},b.prototype._buildParams=function(){var a,c;return c=1<=arguments.length?o.call(arguments,0):[],j.isObject(c[0])&&c.splice(0,1,c[0].start,c[0].end),j.isString(c[2])&&(a={},a[c[2]]=c[3],c.splice(2,2,a)),null==c[3]&&(c[3]=b.sources.API),c},b}(e),h.registerTheme("base",a("./themes/base")),h.registerTheme("snow",a("./themes/snow")),b.exports=h},{"../package.json":7,"./core/editor":9,"./core/format":10,"./core/normalizer":13,"./lib/dom":17,"./lib/range":20,"./themes/base":32,"./themes/snow":33,eventemitter2:2,lodash:1,"rich-text/lib/delta":3}],31:[function(a,b){b.exports='.ql-image-tooltip{padding:10px;width:300px}.ql-image-tooltip:after{clear:both;content:"";display:table}.ql-image-tooltip a{border:1px solid #000;box-sizing:border-box;display:inline-block;float:left;padding:5px;text-align:center;width:50%}.ql-image-tooltip img{bottom:0;left:0;margin:auto;max-height:100%;max-width:100%;position:absolute;right:0;top:0}.ql-image-tooltip .input{box-sizing:border-box;width:100%}.ql-image-tooltip .preview{margin:10px 0;position:relative;border:1px dashed #000;height:200px}.ql-image-tooltip .preview span{display:inline-block;position:absolute;text-align:center;top:40%;width:100%}.ql-link-tooltip{padding:5px 10px}.ql-link-tooltip input.input{width:170px}.ql-link-tooltip a.done,.ql-link-tooltip input.input{display:none}.ql-link-tooltip a.change{margin-right:4px}.ql-link-tooltip.editing a.done,.ql-link-tooltip.editing input.input{display:inline-block}.ql-link-tooltip.editing a.change,.ql-link-tooltip.editing a.remove,.ql-link-tooltip.editing a.url{display:none}.ql-multi-cursor{position:absolute;left:0;top:0;z-index:1000}.ql-multi-cursor .cursor{margin-left:-1px;position:absolute}.ql-multi-cursor .cursor-flag{bottom:100%;position:absolute;white-space:nowrap}.ql-multi-cursor .cursor-name{display:inline-block;color:#fff;padding:2px 8px}.ql-multi-cursor .cursor-caret{height:100%;position:absolute;width:2px}.ql-multi-cursor .cursor.hidden .cursor-flag{display:none}.ql-multi-cursor .cursor.top .cursor-flag{bottom:auto;top:100%}.ql-multi-cursor .cursor.right .cursor-flag{right:-2px}.ql-paste-manager{left:-100000px;position:absolute;top:50%}.ql-toolbar{box-sizing:border-box}.ql-tooltip{background-color:#fff;border:1px solid #000;box-sizing:border-box;position:absolute;top:0;white-space:nowrap;z-index:2000}.ql-tooltip a{cursor:pointer;text-decoration:none}.ql-container{box-sizing:border-box;cursor:text;font-family:Helvetica,Arial,sans-serif;font-size:13px;height:100%;line-height:1.42;margin:0;overflow-x:hidden;overflow-y:auto;padding:12px 15px;position:relative}.ql-editor{box-sizing:border-box;min-height:100%;outline:0;tab-size:4;white-space:pre-wrap}.ql-editor div{margin:0;padding:0}.ql-editor a{text-decoration:underline}.ql-editor b{font-weight:700}.ql-editor i{font-style:italic}.ql-editor s{text-decoration:line-through}.ql-editor u{text-decoration:underline}.ql-editor a,.ql-editor b,.ql-editor i,.ql-editor s,.ql-editor span,.ql-editor u{background-color:inherit}.ql-editor img{max-width:100%}.ql-editor blockquote,.ql-editor ol,.ql-editor ul{margin:0 0 0 2em;padding:0}.ql-editor ol{list-style-type:decimal}.ql-editor ul{list-style-type:disc}.ql-editor.ql-ie-10 br,.ql-editor.ql-ie-9 br{display:none}'},{}],32:[function(a,b){var c,d,e,f;d=a("lodash"),f=a("../../lib/dom"),e=a("./base.styl"),c=function(){function a(b,c){var d;this.quill=b,this.options=c,f(this.quill.container).addClass("ql-container"),this.options.styles&&this.addStyles(e+a.objToCss(this.options.styles)),f.isIE(10)&&(d=f.isIE(9)?"9":"10",f(this.quill.root).addClass("ql-ie-"+d))}return a.OPTIONS={},a.objToCss=function(a){return d.map(a,function(a,b){var c;return c=d.map(a,function(a,b){return b+": "+a+";"}).join(" "),b+" { "+c+" }"}).join("\n")},a.prototype.addStyles=function(b){var c;return d.isObject(b)&&(b=a.objToCss(b)),c=document.createElement("style"),c.type="text/css",c.appendChild(document.createTextNode(b)),document.head.appendChild(c)},a}(),b.exports=c},{"../../lib/dom":17,"./base.styl":31,lodash:1}],33:[function(a,b){var c,d,e,f,g,h,i=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},j={}.hasOwnProperty;g=a("lodash"),d=a("../../lib/color-picker"),c=a("../base"),h=a("../../lib/dom"),e=a("../../lib/picker"),f=function(a){function b(a,c){this.quill=a,this.options=c,b.__super__.constructor.apply(this,arguments),h(this.quill.container).addClass("ql-snow"),this.pickers=[],this.quill.on(this.quill.constructor.events.SELECTION_CHANGE,function(a){return function(b){return null!=b?g.invoke(a.pickers,"close"):void 0}}(this)),this.quill.onModuleLoad("multi-cursor",g.bind(this.extendMultiCursor,this)),this.quill.onModuleLoad("toolbar",g.bind(this.extendToolbar,this))}return i(b,a),b.COLORS=["#000000","#e60000","#ff9900","#ffff00","#008A00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],b.OPTIONS={"multi-cursor":{template:'<span class="cursor-flag"> <span class="cursor-triangle top"></span> <span class="cursor-name"></span> <span class="cursor-triangle bottom"></span> </span> <span class="cursor-caret"></span>'}},b.prototype.extendMultiCursor=function(a){return a.on(a.constructor.events.CURSOR_ADDED,function(a){var b,c;
return b=a.elem.querySelector(".cursor-triangle.bottom"),c=a.elem.querySelector(".cursor-triangle.top"),b.style.borderTopColor=c.style.borderBottomColor=a.color})},b.prototype.extendToolbar=function(a){return h(a.container).addClass("ql-snow"),g.each(["color","background","font","size","align"],function(b){return function(c){var f,i;if(i=a.container.querySelector(".ql-"+c),null!=i){switch(c){case"font":case"size":case"align":f=new e(i);break;case"color":case"background":f=new d(i),g.each(f.container.querySelectorAll(".ql-picker-item"),function(a,b){return 7>b?h(a).addClass("ql-primary-color"):void 0})}return null!=f?b.pickers.push(f):void 0}}}(this)),g.each(h(a.container).textNodes(),function(a){return 0===h(a).text().trim().length?h(a).remove():void 0})},b}(c),b.exports=f},{"../../lib/color-picker":16,"../../lib/dom":17,"../../lib/picker":19,"../base":32,lodash:1}]},{},[15])(15)}),function(a){a.fn.simpleColor=function(b){var c=this,d=["990033","ff3366","cc0033","ff0033","ff9999","cc3366","ffccff","cc6699","993366","660033","cc3399","ff99cc","ff66cc","ff99ff","ff6699","cc0066","ff0066","ff3399","ff0099","ff33cc","ff00cc","ff66ff","ff33ff","ff00ff","cc0099","990066","cc66cc","cc33cc","cc99ff","cc66ff","cc33ff","993399","cc00cc","cc00ff","9900cc","990099","cc99cc","996699","663366","660099","9933cc","660066","9900ff","9933ff","9966cc","330033","663399","6633cc","6600cc","9966ff","330066","6600ff","6633ff","ccccff","9999ff","9999cc","6666cc","6666ff","666699","333366","333399","330099","3300cc","3300ff","3333ff","3333cc","0066ff","0033ff","3366ff","3366cc","000066","000033","0000ff","000099","0033cc","0000cc","336699","0066cc","99ccff","6699ff","003366","6699cc","006699","3399cc","0099cc","66ccff","3399ff","003399","0099ff","33ccff","00ccff","99ffff","66ffff","33ffff","00ffff","00cccc","009999","669999","99cccc","ccffff","33cccc","66cccc","339999","336666","006666","003333","00ffcc","33ffcc","33cc99","00cc99","66ffcc","99ffcc","00ff99","339966","006633","336633","669966","66cc66","99ff99","66ff66","339933","99cc99","66ff99","33ff99","33cc66","00cc66","66cc99","009966","009933","33ff66","00ff66","ccffcc","ccff99","99ff66","99ff33","00ff33","33ff33","00cc33","33cc33","66ff33","00ff00","66cc33","006600","003300","009900","33ff00","66ff00","99ff00","66cc00","00cc00","33cc00","339900","99cc66","669933","99cc33","336600","669900","99cc00","ccff66","ccff33","ccff00","999900","cccc00","cccc33","333300","666600","999933","cccc66","666633","999966","cccc99","ffffcc","ffff99","ffff66","ffff33","ffff00","ffcc00","ffcc66","ffcc33","cc9933","996600","cc9900","ff9900","cc6600","993300","cc6633","663300","ff9966","ff6633","ff9933","ff6600","cc3300","996633","330000","663333","996666","cc9999","993333","cc6666","ffcccc","ff3333","cc3333","ff6666","660000","990000","cc0000","ff0000","ff3300","cc9966","ffcc99","ffffff","cccccc","999999","666666","333333","000000","000000","000000","000000","000000","000000","000000","000000","000000"];b=a.extend({defaultColor:this.attr("defaultColor")||"#FFF",cellWidth:this.attr("cellWidth")||10,cellHeight:this.attr("cellHeight")||10,cellMargin:this.attr("cellMargin")||1,boxWidth:this.attr("boxWidth")||"115px",boxHeight:this.attr("boxHeight")||"20px",columns:this.attr("columns")||16,insert:this.attr("insert")||"after",colors:this.attr("colors")||d,displayColorCode:this.attr("displayColorCode")||!1,colorCodeAlign:this.attr("colorCodeAlign")||"center",colorCodeColor:this.attr("colorCodeColor")||"#FFF",onSelect:null,onCellEnter:null,onClose:null,livePreview:!1},b||{});var e=$j.map(b.colors,function(a,b){return b}).length;b.columns=Math.min(b.columns,e),b.totalWidth=b.columns*(b.cellWidth+2*b.cellMargin),b.totalHeight=Math.ceil(e/b.columns)*(b.cellHeight+2*b.cellMargin),b.chooserCSS=a.extend({width:"447px",height:"228px",top:"0",left:"0",position:"absolute","background-color":"#fff","box-shadow":"0 0 5px 1px #cccccc","z-index":8},b.chooserCSS||{}),b.displayCSS=a.extend({"background-color":b.defaultColor,border:"1px solid #000",width:b.boxWidth,height:b.boxHeight,"line-height":b.boxHeight+"px",cursor:"pointer"},b.displayCSS||{});-1!=navigator.userAgent.indexOf("MSIE")&&(b.totalWidth+=2),a.simpleColorOptions=b,b=a.simpleColorOptions;var f;f=a(a(".simpleColorContainer").length?".simpleColorContainer":"<div class='simpleColorContainer' />");var g=this.value&&""!=this.value?this.value:b.defaultColor,h=a("<div class='simpleColorDisplay' />");h.css(a.extend(b.displayCSS,{"background-color":g})),h.data("color",g),b.displayColorCode&&(h.data("displayColorCode",!0),h.text(this.value),h.css({color:b.colorCodeColor,textAlign:b.colorCodeAlign})),a(".simpleColorChooser").length&&a(".simpleColorChooser").remove();var i=a("<div class='simpleColorChooser'/>");return i.css(b.chooserCSS),f.chooser=i,f.append(i),$j.each(b.colors,function(d,e){e.colorCode.indexOf("#")>=0&&(e.colorCode=e.colorCode.substr(1));var f=a("<div class='simpleColorCell' title='"+e.name+"' id='"+e.colorCode+"'/>");f.css({"background-color":"#"+e.colorCode}),i.append(f),(b.onCellEnter||b.livePreview)&&f.bind("mouseenter",function(){b.onCellEnter&&b.onCellEnter(this.id,c),b.livePreview&&(h.css("background-color","#"+this.id),b.displayColorCode&&h.text("#"+this.id))}),f.bind("mouseup",{chooser:i,displayBox:h},function(d){var e=(parseFloat($j("#common-panel").css("left")),parseFloat($j("#common-panel").css("top")),"#"+this.id);$j(this).animate({"border-radius":"0%"}),$j(this).animate({"border-radius":"50%"},500),a(d.data.displayBox).data("color",e),d.data.displayBox.css("background-color",e),b.displayColorCode&&d.data.displayBox.text(e),b.onSelect&&b.onSelect(this.id,c)})}),a("#bordercontrolls").after(f),a(this).data("container",f),a(".simpleColorDisplay").each(function(){a(this).click(function(a){a.stopPropagation()})}),this},a.fn.closeChooser=function(){return this.each(function(){a(this).data("container").find(".simpleColorChooser").hide()}),this},a.fn.setColor=function(b){return this.each(function(){var c=a(this).data("container").find(".simpleColorDisplay");c.css("background-color",b).data("color",b),c.data("displayColorCode")===!0&&c.text(b)}),this}}(jQuery),svgEditor.addExtension("product",function(){return{name:"product",elementChanged:function(a){a&&(selectionChange(),1==isLoaded&&"image"==a.elems[0].tagName&&(hideLoader(),productPricingExt.calculatePriceData(!0)))},selectedChanged:function(a){a&&(selectionChange(a),svgCanvas.getSelectedElems().length>1?$j("#tool_align_relative").show():$j("#tool_align_relative").hide(),0==svgCanvas.getSelectedElems().length&&$j("#common_upper_open_panel").hide())},canvasUpdated:function(){trace("canvasUpdated"),set_config_svg(design_area_width[curSide],design_area_height[curSide],pos_x[curSide],pos_y[curSide],curSide)},onNewDocument:function(){updateMaskImage(),productPricingExt.calculatePriceData(!0)},elementRemoved:function(){productPricingExt.calculatePriceData(!0)}}}),svgEditor.addExtension("multiColor",function(){function a(a){for(var b=a.length-1;b>=0;){var c=a[b];"text"==c.parentNode.getAttribute("type")?"rect"==c.tagName?a.splice(b,1):"path"==c.tagName&&c.parentNode.firstChild!=c&&a.splice(b,1):"path"==c.tagName&&"photobox"==c.parentNode.getAttribute("type")&&a.splice(b,1),b--}}function b(b){if(b){for(f=b.elems,d=[],c=[];$j("#tool_fill .multiColorBlock").children().length>0;)$j($j("#tool_fill .multiColorBlock").children()[0]).remove();if(f.length&&void 0!=f[0])if(1==f.length&&void 0!=f[0]){var k=$j(f[0]).find(e);a(k),k.each(function(a){var b='<div class="color_tool"><div class="color_block">';b+='<div><svg xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">		  <line fill="none" stroke="#d40000" id="svg_90" y2="18" x2="18" y1="0" x1="0"/> <line id="svg_92" fill="none" stroke="#d40000" y2="18" x2="0" y1="0" x1="18"/>	</svg></div></div>',b+='<div id="'+g+a+'" class="color_block"></div></div>',$j("#tool_fill .multiColorBlock").append($j(b));var e=$j(this).attr("fill");null==e&&(e="#000000"),c[a]=new h("#"+g+a,e),d[a]=$j(this),$j("#"+g+a).click(function(){$j("#bordercontrolls").hide(),$j(".border_colorpicker").css("left","60px"),$j("#common_upper_open_panel").show(),$j(".simpleColorContainer").hide(),$j(".border_colorpicker").hide(),manageColorPanel(),$j("#tool_fill").hasClass("disabled")||("full"==pickerMode?(i($j("#"+this.id)),$j(".border_colorpicker").show()):"printable"==pickerMode&&(j($j("#"+this.id),printableColorList),$j(".simpleColorContainer").show(),$j(".simpleColorChooser").jScrollPane()))})}),$j("#tool_fill .multiColorBlock").children().length>1?($j("#tool_fill .multiColorBlock").show(),$j("#tool_fill .singleColor").hide()):($j("#tool_fill .multiColorBlock").hide(),$j("#tool_fill .singleColor").show())}else $j("#tool_fill .multiColorBlock").hide(),$j("#tool_fill .singleColor").show()}}var c=[],d=[],e="circle,ellipse,line,path,polygon,polyline,rect,text",f=[],g="fill_color_",h=function(a,b){var c=(new DOMParser).parseFromString('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  width="20" height="20"><rect width="20" height="20" fill="'+b+'" opacity="100"/><defs><linearGradient id="gradbox_"/></defs></svg>',"text/xml"),d=c.documentElement;d=$j(a)[0].appendChild(document.importNode(d,!0)),this.rect=d.firstChild,this.defs=d.getElementsByTagName("defs")[0],this.grad=this.defs.firstChild,this.paint=new $j.jGraduate.Paint({solidColor:b}),this.type="fill",this.setPaint=function(a){this.paint=a;var b="none",c=a.type,d=a.alpha/100;switch(c){case"solidColor":b="none"!=a[c]?"#"+a[c]:a[c];break;case"linearGradient":case"radialGradient":this.defs.removeChild(this.grad),this.grad=this.defs.appendChild(a[c]);var e=this.grad.id="gradbox_"+this.type;b="url(#"+e+")"}this.rect.setAttribute("fill",b),this.rect.setAttribute("opacity",d)}},i=function(a){$j.farbtastic("#colorpicker").linkTo(function(){});{var b=a.attr("id"),e=b.substr(g.length,b.length-g.length),f=c[e].paint;a.offset()}-1==f.solidColor.search("#")?($j.farbtastic("#colorpicker").setColor("#"+f.solidColor),updateColorElements(f.solidColor)):($j.farbtastic("#colorpicker").setColor(f.solidColor),updateColorElements(f.solidColor.substr(1))),updateColorHexCode(),$j("#colorpicker").addClass("displayblock"),$j.farbtastic("#colorpicker").linkTo(function(a){parseFloat($j("#common-panel").css("left")),parseFloat($j("#common-panel").css("top"));a=a.replace("#",""),f=new $j.jGraduate.Paint(c[e].paint),f.solidColor=a,c[e].setPaint(f),d[e].attr("fill","#"+a),svgCanvas.runExtensions("elementChanged",{elems:svgCanvas.getSelectedElems()}),updateColorElements(a),updateColorHexCode()})},j=function(a,b){var e=a.attr("id"),f=e.substr(g.length,e.length-g.length);$j(a).simpleColor({boxHeight:50,cellWidth:40,cellHeight:40,cellMargin:5,columns:10,colors:b,displayCSS:{border:"1px solid red"},displayColorCode:!0,livePreview:!1,onSelect:function(a){var b=new $j.jGraduate.Paint({solidColor:a});c[f].setPaint(b),d[f].attr("fill","#"+b[b.type]),svgCanvas.runExtensions("elementChanged",{elems:svgCanvas.getSelectedElems()})}})};return{name:"multiColor",elementChanged:function(){},selectedChanged:function(a){b(a)}}}),svgEditor.addExtension("curveText",function(a){function b(){var a=svgCanvas.getSelectedElems()[0];-1==a.getAttribute("invert")?$j("#curveInvert").prop("checked",!0):$j("#curveInvert").prop("checked",!1),svgCanvas.selectorManager.requestSelector(a).resize()}function c(b){var c=b.id,e=$j("#"+c)[0].textContent;if(k=$j("#"+c)[0].getBBox().width+2,l=$j("#"+c)[0].getBBox().height+2,j=svgedit.utilities.getBBox(b),$j(b).find("textPath").length){var f=b.cloneNode(!0);svgCanvas.getContentElem().appendChild(f),f.textContent=e;var g=svgedit.utilities.getBBox(f);if(svgCanvas.getContentElem().removeChild(f),k=g.width,0==k)return;n=b.getAttribute("curveVal")?b.getAttribute("curveVal"):p,i=k/(2*Math.PI)*(360/n)}else{n=p,h=document.createElementNS("http://www.w3.org/2000/svg","textPath"),h.setAttribute("id",svgCanvas.getNextId()),h.setAttribute("startOffset","62.5%");var q=svgCanvas.getNextId();h.setAttributeNS(m,"xlink:href","#"+q),h.textContent=e,$j("#"+c).empty(),$j("#"+c).append(h),i=k/(2*Math.PI)*(360/n);var r=d({radius:i,dir:1}),s=Raphael.pathBBox(r),t=b.getAttribute("pathX")?b.getAttribute("pathX"):$j("#"+c).attr("x")-s.width/2,u=b.getAttribute("pathY")?b.getAttribute("pathY"):$j("#"+c).attr("y"),v=a.addSvgElementFromJson({element:"path",curStyles:!0,attr:{d:r,id:q,transform:"translate("+t+" , "+u+")"}});svgCanvas.findDefs().appendChild(v),b.setAttribute("curveVal",n),b.setAttribute("invert",1),b.setAttribute("multiLine","false"),b.setAttribute("pathX",t),b.setAttribute("pathY",u),o&&a.addSvgElementFromJson({element:"path",curStyles:!0,attr:{d:r,id:c+"txtPathDefclone",fill:"none",transform:"translate("+t+" , "+u+")"}}),svgCanvas.selectorManager.requestSelector(b).resize()}b.setAttribute("x",0),b.setAttribute("y",0),svgCanvas.recalculateDimensions(v),o&&svgCanvas.recalculateDimensions(svgCanvas.getElem(c+"txtPathDefclone"))}function d(a){var b=a.radius,c=2*b,d=-1==a.dir?"0":"1",e=a.x?a.x:0,f=a.y?a.y:0,g="M "+e+", "+f+" 					a "+b+","+b+" 0 0,"+d+" "+c+",0 					a "+b+","+b+" 0 0,"+d+" -"+c+",0 					a "+b+","+b+" 0 0,"+d+" "+c+",0 					a "+b+","+b+" 0 0,"+d+" -"+c+",0 					";return g}function e(a,b){a.setAttribute("curveVal",b),b=Math.abs(b);var c=svgCanvas.getHref($j(a).find("textPath")[0]);c=c.substring(1,c.length);if($j("#"+c).length){rad=k/(2*Math.PI)*(360/b);var e=d({radius:rad,dir:a.getAttribute("invert"),x:a.getAttribute("pathX"),y:a.getAttribute("pathY")});$j("#"+c).attr("d",e),o&&$j("#"+a.id+"txtPathDefclone").attr("d",e);var f=svgedit.utilities.getBBox(a),g=parseFloat(j.x-f.x),h=parseFloat(j.y-f.y);$j("#"+c).attr("transform","translate("+g+","+h+")"),svgCanvas.recalculateDimensions(svgCanvas.getElem(c)),o&&($j("#"+a.id+"txtPathDefclone").attr("transform","translate("+g+","+h+")"),svgCanvas.recalculateDimensions(svgCanvas.getElem(a.id+"txtPathDefclone"))),svgCanvas.selectorManager.requestSelector(a).resize(),svgCanvas.runExtensions("elementTransition",{elems:[a]})}}function f(a,b){var c=b?b:a.getAttribute("text-anchor");if("middle"!=c){var d,e=svgedit.utilities.getBBox(a);a.setAttribute("text-anchor","middle"),d="start"==c?$j(a).attr("x")+e.width/2:$j(a).attr("x")-e.width/2,$j(a).attr("x",d)}}function g(a,b){return Math.round(10*a*b)/(10*b)}var h,i,j,k=0,l=0,m="http://www.w3.org/1999/xlink",n=0,o=!1,p=180;$j(document).ready(function(){var a;$j("#curve_slider").slider({range:!1,min:0,max:360,step:5,values:[p],slide:function(a,c){var d=svgCanvas.getSelectedElems()[0];b(),e(d,0==c.values[0]?1:c.values[0]),$j("#curveAngle").val(c.values[0])},start:function(){var b=svgCanvas.getSelectedElems()[0],c=svgCanvas.getHref($j(b).find("textPath")[0]);c=c.substring(1,c.length),a=Raphael.pathBBox(document.getElementById(c).getAttribute("d")),j=svgedit.utilities.getBBox(b)},stop:function(){var b=svgCanvas.getSelectedElems()[0],c=svgCanvas.getHref($j(b).find("textPath")[0]);c=c.substring(1,c.length);var d=Raphael.pathBBox(document.getElementById(c).getAttribute("d")),e=a.x-d.x,f=parseFloat(b.getAttribute("pathX"))-e;b.setAttribute("pathX",f),svgCanvas.runExtensions("elementChanged",{elems:[b]}),i=k/(2*Math.PI)*(360/n)}}),$j("#curveInvert").on("change",function(){var a=svgCanvas.getSelectedElems()[0];$j("#curveInvert").is(":checked")?(a.setAttribute("invert",-1),a.setAttribute("dy","0.8em")):(a.setAttribute("invert",1),a.setAttribute("dy","-0.2em")),e(a,a.getAttribute("curveVal")?a.getAttribute("curveVal"):p),b()})});{var q=curveTextExt.sliderInit=function(a){a=a?a:svgCanvas.getSelectedElems()[0],c(a),$j("#curve_slider").slider({values:[n]}),$j("#curveAngle").val(n),1==n&&$j("#curveAngle").val(0),b()},r=curveTextExt.updatePathOnTextChange=function(a){var b=svgCanvas.getHref($j(a).find("textPath")[0]);b=b.substring(1,b.length);var c=parseFloat(a.getAttribute("pathX"))+parseFloat(a.getAttribute("x")),d=parseFloat(a.getAttribute("pathY"))+parseFloat(a.getAttribute("y"));a.setAttribute("pathX",c),a.setAttribute("pathY",d),$j("#"+b).attr("transform","translate("+g(parseFloat(a.getAttribute("x")),2)+","+g(parseFloat(a.getAttribute("y")),2)+")"),o&&($j("#"+a.id+"txtPathDefclone").attr("transform","translate("+parseFloat(a.getAttribute("x"))+","+parseFloat(a.getAttribute("y"))+")"),svgCanvas.recalculateDimensions(svgCanvas.getElem(a.id+"txtPathDefclone"))),svgCanvas.recalculateDimensions(svgCanvas.getElem(b)),a.setAttribute("x",0),a.setAttribute("y",0)};curveTextExt.resetForMultiLine=function(a){a.setAttribute("multiLine","true"),$j("#tool_curve").hide(),$j("#text_align_left, #text_align_center, #text_align_right").removeClass("disabled");var b=(svgedit.utilities.getBBox(a),svgCanvas.getHref($j(a).find("textPath")[0]));b=b.substring(1,b.length);var c=Raphael.pathBBox(document.getElementById(b).getAttribute("d")),d=c.x+c.width/2,e=c.y;a.setAttribute("x",d),a.setAttribute("y",e)},curveTextExt.resetForSingleLine=function(a){f(a),a.setAttribute("multiLine","false"),$j("#text_align_left, #text_align_center, #text_align_right").addClass("disabled");var b=svgedit.utilities.getBBox(a);a.setAttribute("curveVal","180");var c=b.width/(2*Math.PI)*(360/parseFloat(a.getAttribute("curveVal")));a.setAttribute("pathX",parseFloat(a.getAttribute("x"))-c),a.setAttribute("pathY",parseFloat(a.getAttribute("y"))+c),$j("#tool_curve").show()}}return{name:"curveText",selectedChanged:function(a){if(a)if($j("#text_align_left, #text_align_center, #text_align_right").removeClass("disabled"),$j("#tool_curve").hide(),null!=a.elems[0]&&1==a.elems.length){var b=a.elems[0];if("text"==b.tagName){var c=$j(b).find("tspan");c.length<=1?($j("#tool_curve").show(),q(b),$j("#text_align_left, #text_align_center, #text_align_right").addClass("disabled")):$j(b).attr("multiLine","true")}}else $j("#tool_curve").hide()},elementChanged:function(a){$j("#text_align_left, #text_align_center, #text_align_right").removeClass("disabled");var b=a?a.elems:svgCanvas.getSelectedElems();if(b.length&&void 0!=b[0])for(var c=0;c<b.length;c++)"g"==b[c].tagName&&svgedit.utilities.walkTree(b[c],function(a){"text"==a.tagName&&$j(a).find("textPath").length&&(r(a),$j("#text_align_left, #text_align_center, #text_align_right").addClass("disabled"))}),"text"==b[c].tagName&&svgCanvas.getElem(b[c].id)&&$j(b[c]).find("textPath").length&&(r(b[c]),$j("#text_align_left, #text_align_center, #text_align_right").addClass("disabled"))},elementAdded:function(a){for(var b=a.elems,c=0;c<b.length;c++)if("text"==b[c].tagName&&$j(b[c]).find("textPath").length){var d=$j(b[c]).find("textPath")[0],e=d.href.baseVal.substring(1,d.href.baseVal.length),f=svgCanvas.getElem(e);if(!f)for(var g=svgCanvas.clipBoard,h=g.length;h--;){var i=g[h];if(i){var j=$j(i).parentsUntil("svg")[0].parentNode;j.getElementById(e)&&(f=j.getElementById(e));break}}if(!f)return;var k=svgCanvas.copyElem(f);svgCanvas.findDefs().appendChild(k),svgCanvas.setHref(d,"#"+k.id)}},elementTransition:function(){}}}),svgEditor.addExtension("objectPanel",function(){function a(){for(var a=svgCanvas.getSelectedElems(),b=!1,c=a.length;c--;)if("image"==a[c].tagName&&svgCanvas.getHref(a[c])&&"svg"==getExtension(svgCanvas.getHref(a[c]))){b=!0;break}return b}function b(a){var b;if(0!=svgCanvas.getRotationAngle(a)){var c=a.cloneNode(!0);svgCanvas.getCurrentDrawing().getCurrentLayer().appendChild(c),svgCanvas.setRotationAngle(0,!0,c),b=svgedit.utilities.getObjectBbox(c),svgCanvas.getCurrentDrawing().getCurrentLayer().removeChild(c)}else b=svgedit.utilities.getObjectBbox(a);if("producttool"==toolType){var d=b.width*outputWidth[curSide]/design_area_width[curSide],e=b.height*outputHeight[curSide]/design_area_height[curSide];return{width:d,height:e}}return{width:svgedit.units.convertUnit(b.width),height:svgedit.units.convertUnit(b.height)}}function c(a){var b=Number.MAX_VALUE,c=Number.MAX_VALUE,d=svgCanvas.getStrokedBBox(a);return d?(b=Math.min(b,d.x),c=Math.min(c,d.y)):(b=0,c=0),"producttool"==toolType?{x:b*outputWidth[curSide]/design_area_width[curSide],y:c*outputHeight[curSide]/design_area_height[curSide]}:{x:svgedit.units.convertUnit(b),y:svgedit.units.convertUnit(c)}}function d(a){var b=svgCanvas.getSelectedElems();null!=b[0]&&"text"==b[0].tagName&&"true"==b[0].getAttribute("multiLine")&&(b[0].setAttribute("lineHeight",a),$j("#lineHeight").val(a),svgCanvas.reAlignTextVertically(b[0]),svgCanvas.selectorManager.requestSelector(b[0]).resize())}function e(a){var b=svgCanvas.getSelectedElems();if(null!=b[0]){var c=!0;svgCanvas.setRotationAngle(a,c),$j("#rotateAngle").val(Math.floor(a))}}function f(){var a=svgCanvas.getSelectedElems();if(null!=a[0]){var b=a[0];svgCanvas.recalculateDimensions(b),svgCanvas.runExtensions("elementChanged",{elems:[b]})}}svgEditor.curConfig.dimensions[0],svgEditor.curConfig.dimensions[1];return $j(document).ready(function(){var a='<div class="caption-section">';if(a+='<div class="hwxyrow"> <div id="objectXCaption" class="caption">X:</div><input type="number" id="xStepper" name="xStepper" step="0.01" class="numStepper" value="5" />',a+='<div id="objectYCaption" class="caption">Y:</div><input type="number" id="yStepper" name="yStepper" step="0.01" class="numStepper" value="5" /></div>',a+='<div class="hwxyrow"> <div id="objectWCaption" class="caption">W:</div><input type="number" id="wStepper" name="wStepper" step="0.01" class="numStepper" value="5" min="0.1" />',a+='<div id="objectHCaption" class="caption">H:</div><input type="number" id="hStepper" name="hStepper" step="0.01" class="numStepper" value="5" min="0.1" /></div>',a+='<div class="interlock"><input type="checkbox" id="propCheckbox" name="propCheckbox" class="checkboxStepper" checked="checked" /></div>',a+="</div>",$j("#sizeSlider").append(a),svgedit.browser.isTouch()){var b=!1;$j("#propCheckbox").on("click",function(a){b&&a.preventDefault(),b=!b})}$j("#rotationSlider").slider({range:!1,min:-180,max:180,step:5,value:0,slide:function(a,b){e(b.value)},start:function(){},stop:function(){f()}}),$j("#lineSpaceSlider").slider({range:!1,min:.1,max:10,step:.1,value:1,slide:function(a,b){d(b.value),svgCanvas.runExtensions("elementChanged",{elems:svgCanvas.getSelectedElems()})},start:function(){}})}),{name:"objectPanel",elementTransition:function(a){var d=svgCanvas.getMode(),e=a.elems[0];switch(multiselected=a.elems.length>=2&&null!=a.elems[1],d){case"rotate":if(!multiselected){var f=svgCanvas.getRotationAngle(e);$j("#rotationSlider").slider("value",f),$j("#rotateAngle").val(Math.floor(f))}break;case"resize":if(!multiselected){var g=b(e);$j("#wStepper").val(Number(g.width).toFixed(2)),$j("#hStepper").val(Number(g.height).toFixed(2))}break;case"select":var h=c(a.elems);$j("#xStepper").val(Number(h.x).toFixed(2)),$j("#yStepper").val(Number(h.y).toFixed(2))}$j("#common-panel").removeClass("cbp-spmenu-open")},textChanged:function(a){if(a&&a.elems[0]&&0==a.multiselected){var b=a.elems[0];if("text"==b.tagName)if("true"==b.getAttribute("multiLine")){$j("#lineSpaceDiv").show();var c=b.getAttribute("lineHeight")?b.getAttribute("lineHeight"):1;$j("#lineSpaceSlider").slider("value",c),$j("#lineHeight").val(c)}else $j("#lineSpaceDiv").hide()}},elementChanged:function(a){if(a&&a.elems[0]&&""!=a.elems[0].id&&svgCanvas.getElem(a.elems[0].id)&&1==a.elems.length){{var d=a.elems[0];$j(d)[0].getBBox()}if("text"==d.tagName){var e=1;if(svgedit.browser.isIE())for(var f,g=/matrix\((.*?)\)/gim,h=d.getAttribute("transform");null!=(f=g.exec(h));)f.index===g.lastIndex&&g.lastIndex++,trace(f),e*=parseFloat(f[1].split(" ")[0]);else for(var i=svgCanvas.getTransformList(d),j=i.numberOfItems,k=0;j>k;k++)i[k]&&(e*=i[k].matrix.a)}else"line"==d.tagName?($j("#tool_fill").hide(),$j("#propCheckbox").attr("disabled","disabled")):"circle"==d.tagName?$j("#propCheckbox").attr("disabled","disabled"):"image"==d.tagName?svgCanvas.getHref(d)&&"svg"==getExtension(svgCanvas.getHref(d))&&$j("#propCheckbox").attr("disabled","disabled"):"g"==d.tagName&&(svgCanvas.getPrivateMethods().extensions.textShape.isTextSelected()&&!svgCanvas.getPrivateMethods().extensions.textShape.isImproportionate()?$j("#propCheckbox").attr("disabled","disabled"):"photobox"==d.getAttribute("type")&&($j("#propCheckbox")[0].checked=!0,$j("#propCheckbox").attr("disabled","disabled")));var l=b(d);$j("#wStepper").val(Number(l.width).toFixed(2)),$j("#hStepper").val(Number(l.height).toFixed(2));var m=c(a.elems);$j("#xStepper").val(Number(m.x).toFixed(2)),$j("#yStepper").val(Number(m.y).toFixed(2))}},selectedChanged:function(a){if($j("#lineSpaceDiv").hide(),$j("#rotationDiv").hide(),$j("#wStepper").removeAttr("disabled"),$j("#hStepper").removeAttr("disabled"),a.elems[0]&&svgCanvas.getElem(a.elems[0].id)&&0==a.multiselected){var d=a.elems[0],e=svgCanvas.getRotationAngle(d);if($j("#rotationSlider").slider("value",e),$j("#rotateAngle").val(Math.floor(e)),bbox=$j(d)[0].getBBox(),"text"==d.tagName){var f=1;if(svgedit.browser.isIE())for(var g,h=/matrix\((.*?)\)/gim,i=d.getAttribute("transform");null!=(g=h.exec(i));)g.index===h.lastIndex&&h.lastIndex++,trace(g),f*=parseFloat(g[1].split(" ")[0]);else for(var j=svgCanvas.getTransformList(d),k=j.numberOfItems,l=0;k>l;l++)j[l]&&(f*=j[l].matrix.a)}else"line"==d.tagName?($j("#tool_fill").hide(),$j("#propCheckbox").attr("disabled","disabled")):"circle"==d.tagName?$j("#propCheckbox").attr("disabled","disabled"):"image"==d.tagName?svgCanvas.getHref(d)&&"svg"==getExtension(svgCanvas.getHref(d))&&$j("#propCheckbox").attr("disabled","disabled"):"g"==d.tagName&&(svgCanvas.getPrivateMethods().extensions.textShape.isTextSelected()&&!svgCanvas.getPrivateMethods().extensions.textShape.isImproportionate()?$j("#propCheckbox").attr("disabled","disabled"):"photobox"==d.getAttribute("type")&&($j("#propCheckbox")[0].checked=!0,$j("#propCheckbox").attr("disabled","disabled")));if($j("#rotationDiv").show(),"true"==d.getAttribute("multiLine")){var m=d.getAttribute("lineHeight")?d.getAttribute("lineHeight"):1;$j("#lineSpaceSlider").slider("value",m),$j("#lineHeight").val(m),$j("#lineSpaceDiv").show()}var n=b(d);$j("#wStepper").val(Number(n.width).toFixed(2)),$j("#hStepper").val(Number(n.height).toFixed(2))}else $j("#wStepper").attr("disabled","disabled"),$j("#hStepper").attr("disabled","disabled");var o=c(a.elems);$j("#xStepper").val(Number(o.x).toFixed(2)),$j("#yStepper").val(Number(o.y).toFixed(2))},resizeProportion:function(){return $j("#propCheckbox")[0].checked||$j("#propCheckbox")[0].disabled||svgCanvas.getPrivateMethods().extensions.textShape.isTextSelected()&&!svgCanvas.getPrivateMethods().extensions.textShape.isImproportionate()||a()},isQRCodeSelected:function(){return a()}}}),svgEditor.addExtension("objectLock",function(){function a(){if($j("#objectLock").hide(),"admin"==user||!objectLockExt.useLock)return void("admin"==user&&void 0!=b[0]&&("1"==tempData.settings.preTemplate&&$j("#objectLock").show(),"true"==b[0].getAttribute("lockTransform")?$j("#lockTransform").removeClass("tool_button").addClass("push_button_pressed"):$j("#lockTransform").removeClass("push_button_pressed").addClass("tool_button"),"true"==b[0].getAttribute("lockEdit")?$j("#lockEdit").removeClass("tool_button").addClass("push_button_pressed"):$j("#lockEdit").removeClass("push_button_pressed").addClass("tool_button")));var a=[];if(b=svgCanvas.getSelectedElems(),b&&b.length){for(var j=!1,k=!1,l=0;l<b.length;l++)if(null!=b[l])if("true"==b[l].getAttribute("lockTransform")&&"true"==b[l].getAttribute("lockEdit"))a.push(b[l]),j=!0,k=!0;else{if("true"==b[l].getAttribute("lockTransform")){var m=svgCanvas.selectorManager.requestSelector(b[l]);m.showGrips(!1),j=!0}"true"==b[l].getAttribute("lockEdit")&&(k=!0)}j&&k&&i(a),j?($j(c).attr("disabled","disabled"),$j(d).slider({disabled:!0}),$j(d).css("opacity","0.5"),$j(e).addClass("disabled")):($j(c).removeAttr("disabled"),$j(d).slider({disabled:!1}),$j(d).css("opacity","1"),$j(e).removeClass("disabled"),1==b.length&&void 0!=b[0]&&($j("#tool_group").addClass("disabled"),"text"==b[0].tagName?$j(b[0]).find("tspan").length<=1&&$j("#text_align_left, #text_align_center, #text_align_right").addClass("disabled"):"g"==b[0].tagName?svgCanvas.getPrivateMethods().extensions.textShape.isTextSelected()&&!svgCanvas.getPrivateMethods().extensions.textShape.isImproportionate()?$j("#propCheckbox").attr("disabled","disabled"):"photobox"==b[0].getAttribute("type")&&($j("#propCheckbox")[0].checked=!0,$j("#propCheckbox").attr("disabled","disabled")):"line"==b[0].tagName?($j("#tool_fill").hide(),$j("#propCheckbox").attr("disabled","disabled")):"circle"==b[0].tagName?$j("#propCheckbox").attr("disabled","disabled"):"image"==b[0].tagName&&svgCanvas.getHref(b[0])&&"svg"==getExtension(svgCanvas.getHref(b[0]))&&$j("#propCheckbox").attr("disabled","disabled"),0==b[0].childNodes.length&&$j("#tool_ungroup").addClass("disabled"))),k?($j(f).attr("disabled","disabled"),$j(g).slider({disabled:!0}),$j(g).css("opacity","0.5"),$j(h).addClass("disabled")):($j(f).removeAttr("disabled"),$j(g).slider({disabled:!1}),$j(g).css("opacity","1"),$j(h).removeClass("disabled"))}}var b,c=(objectLockExt.useLock=!0,"#xStepper,#yStepper,#wStepper,#hStepper"),d="#rotationSlider",e="#tool_delete,#tool_clone,#tool_cut,#tool_copy,#tool_group,#tool_ungroup,#alignPanel,#upMove,#leftMove,#downMove,#rightMove",f="#stroke_style",g="#stroke_slider",h="#tool_fill,#fill_color,#stroke_color,#stroke_style,#dd,#text_align_left,#text_align_center,#text_align_right,#tool_bold,#tool_italic";$j().ready(function(){$j("#objectLock").css("right","-1px"),$j("#objectLock").css("top","204px"),$j("#objectLock").draggable({containment:".main_dt",scroll:!1,cancel:"div.ranges-content, #knobCanvas",handle:"div.mop-heading"})});{var i=objectLockExt.removeSelection=function(a){svgCanvas.removeFromSelection(a);var b,c=svgCanvas.getSelectedElems();for(b=0;b<c.length;b++)(void 0==c[b]||null==c[b])&&(c.splice(b,1),b--);if(0==c.length)"producttool"==toolType?(disableOther("layerPanel"),$j("#layer-panel").addClass("cbp-spmenu-open")):(disableOther("layerPanel"),$j("#layer-panel").addClass("cbp-spmenu-open")),$j("#tool_delete").addClass("disabled"),$j("#alignPanel").addClass("disabled"),$j(".align_icons").hide(),$j("#tool_clone").addClass("disabled"),$j("#tool_cut").addClass("disabled"),$j("#tool_copy").addClass("disabled"),$j("#tool_group").addClass("disabled"),$j("#tool_ungroup").addClass("disabled");else if(1==c.length){var d=svgCanvas.selectorManager.requestSelector(c[0]);d.resize(),d.showGrips(!0)}};objectLockExt.removeMouseEvent=function(a){if("admin"!=user){a=a?a:b;for(var c,c=0;c<a.length;c++)"true"==a[c].getAttribute("lockTransform")&&"true"==a[c].getAttribute("lockEdit")&&svgedit.utilities.walkTree(a[c],function(a){"g"!=a.nodeName&&a.setAttribute("style","pointer-events: none; cursor: default;")})}}}return{name:"objectLock",iconSize:[40,35],buttons:[{id:"lockTransform",icon:jspath+"images/lock-transform.png",type:"context",panel:"objectLock .lock-unlock-range",title:"Lock Transform",events:{click:function(){if(b)for(var a=0;a<b.length;a++)"true"==b[a].getAttribute("lockTransform")?(b[a].setAttribute("lockTransform","false"),$j("#lockTransform").removeClass("push_button_pressed").addClass("tool_button")):(b[a].setAttribute("lockTransform","true"),$j("#lockTransform").removeClass("tool_button").addClass("push_button_pressed"))}}},{id:"lockEdit",icon:jspath+"images/lock-edit.png",type:"context",panel:"objectLock .lock-unlock-range",title:"Lock Edit",events:{click:function(){if(b)for(var a=0;a<b.length;a++)"true"==b[a].getAttribute("lockEdit")?(b[a].setAttribute("lockEdit","false"),$j("#lockEdit").removeClass("push_button_pressed").addClass("tool_button")):(b[a].setAttribute("lockEdit","true"),$j("#lockEdit").removeClass("tool_button").addClass("push_button_pressed"))}}}],selectedChanged:function(c){b=c?c.elems:null,a()},elementChanged:function(){},mouseDown:function(){},mouseUp:function(){}}}),svgEditor.addExtension("LayerPanel",function(){function a(a){var b=a.closest(".layer_row").attr("elemId"),c=a.closest(".layer_row"),d=c.closest(".for-check input");"checked"==$j(d.context).attr("checked")?svgCanvas.addToSelection([$j("#"+b)[0]],!0):svgCanvas.removeFromSelection([$j("#"+b)[0]]),svgCanvas.removeFromSelection([$j("#nameText")[0]]),svgCanvas.removeFromSelection([$j("#numberText")[0]]);
var e=!1;if(svgCanvas.getSelectedElems().length>1){var f=svgCanvas.selectorManager.requestSelector(svgCanvas.getSelectedElems()[0]);f.showGrips(!1),e=!0}else if(0==svgCanvas.getSelectedElems().length)svgCanvas.clearSelection();else{var f=svgCanvas.selectorManager.requestSelector(svgCanvas.getSelectedElems()[0]);f.showGrips(!0)}svgCanvas.runExtensions("selectedChanged",{elems:svgCanvas.getSelectedElems(),selectedElement:svgCanvas.getSelectedElems(),multiselected:e})}function b(a){var b=a.closest(".layer_row").attr("elemId");if("none"==$j("#"+b).attr("display"))$j("#"+b).attr("display","inline");else{$j("#"+b).attr("display","none");var c=a.closest(".layer_row"),d=c.find(".selectObject")[0];d.checked=!1}"producttool"==toolType&&productPricingExt.calculatePriceData(!0),i.extensions.undoRedo.addToStack()}function c(a){var b=a.closest(".layer_row").attr("elemId");if(trace("lock = "+$j("#"+b).attr("lock")),"true"==$j("#"+b).attr("lock"))$j("#"+b).attr("lock","false"),e(svgCanvas.getElem(b));else{$j("#"+b).attr("lock","true"),d(svgCanvas.getElem(b));var c=a.closest(".layer_row"),f=c.find(".selectObject")[0];f.checked=!1}i.extensions.undoRedo.addToStack()}function d(a){svgedit.utilities.walkTree(a,function(a){"g"!=a.nodeName&&$j(a).css("pointer-events: none; cursor: default;")})}function e(a){svgedit.utilities.walkTree(a,function(a){"g"!=a.nodeName&&$j(a).css("pointer-events: inherit; cursor: auto;")})}function f(a){for(var b=[],c=0;c<a.length;c++)null!=a[c]&&("true"==a[c].getAttribute("lock")||"none"==$j(a[c]).attr("display"))&&b.push(a[c]);if(b.length){svgCanvas.removeFromSelection(b);var c,d=svgCanvas.getSelectedElems();for(c=0;c<d.length;c++)(void 0==d[c]||null==d[c])&&(d.splice(c,1),c--);if(0==d.length)"producttool"==toolType?(disableOther("layerPanel"),$j("#layer-panel").addClass("cbp-spmenu-open")):(disableOther("layerPanel"),$j("#layer-panel").addClass("cbp-spmenu-open")),$j("#tool_delete").addClass("disabled"),$j("#alignPanel").addClass("disabled"),$j(".align_icons").hide(),$j("#tool_clone").addClass("disabled"),$j("#tool_cut").addClass("disabled"),$j("#tool_copy").addClass("disabled"),$j("#tool_group").addClass("disabled"),$j("#tool_ungroup").addClass("disabled");else if(1==d.length){var e=svgCanvas.selectorManager.requestSelector(d[0]);e.resize(),e.showGrips(!0)}}}function g(){var a=findNodeWithTitleName(svgCanvas.getContentElem().childNodes,"Layer 1"),b=[];return $j.each(a.childNodes,function(a,c){-1==n.indexOf(c.tagName)&&b.push(c)}),b.reverse()}function h(){if(l){var a=$j("#sortableLayerPanel").parent().scrollTop();$j("#sortableLayerPanel").empty();var b=g(),c=svgCanvas.getContentElem().getAttribute("width")/svgCanvas.getZoom(),d=svgCanvas.getContentElem().getAttribute("height")/svgCanvas.getZoom(),e=30,f=30,h=0,j=0;c>=d?(f=d*e/c,h=(e-f)/2):(e=c*f/d,j=(f-e)/2),$j.each(b,function(a,b){var c=!1;i.extensions.nameNumber&&i.extensions.nameNumber.isNameNumSelected([b])&&(c=!0);var d=!1;if("admin"!=user&&"true"==b.getAttribute("lockEdit")&&"true"==b.getAttribute("lockTransform")&&(d=!0),"use"!=b.tagName&&3!=b.nodeType&&!c&&!d){var g=$j("#"+b.id).attr("display");$j("#"+b.id).attr("display","inline");var h="";"none"==g&&(h="checked=checked");var j="";"true"==$j("#"+b.id).attr("lock")&&(j="checked=checked");var k="",l=svgCanvas.getElem(b.id);svgCanvas.getSelectedElems().indexOf(l)>-1&&""==j&&(k="checked=checked");var m="",n="",p=b.cloneNode(!0);p.removeAttribute("id");var q=svgCanvas.getContentElem().getAttribute("width")/svgCanvas.getZoom(),r=svgCanvas.getContentElem().getAttribute("height")/svgCanvas.getZoom();n='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xlinkns="http://www.w3.org/1999/xlink" width="'+e+'" height="'+f+'" viewBox="0 0 '+q+" "+r+'">'+(new XMLSerializer).serializeToString(p)+"</svg>","text"==b.tagName||"g"==b.tagName&&"text"==b.getAttribute("type")?(m="g"==b.tagName&&"text"==b.getAttribute("type")?addSpecialChar(b.getAttribute("text")):svgCanvas.getMultiTextContent(b),n='<svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="31px" height="31px" viewBox="0 0 42.121 22.473" enable-background="new 0 0 42.121 22.473" xml:space="preserve"><g><g><line fill="none" x1="0" y1="0.404" x2="42.121" y2="0.404"/><rect fill="#2D2D2D" width="42.121" height="0.807"/></g><g><line fill="none" x1="0" y1="22.072" x2="42.121" y2="22.072"/><rect y="21.666" fill="#2D2D2D" width="42.121" height="0.807"/></g><g><path fill="#2D2D2D" d="M14.21,14.957l-1.585,5.219H9.158l5.898-18.41h4.289l5.981,18.41h-3.633l-1.667-5.219H14.21z			 M19.481,12.417l-1.446-4.534c-0.356-1.117-0.657-2.373-0.929-3.439H17.05c-0.272,1.066-0.573,2.35-0.874,3.439l-1.42,4.534			H19.481z"/>		<path fill="#2D2D2D" d="M35.169,16.979c0,1.201,0.054,2.377,0.218,3.197h-3.031l-0.246-1.475h-0.082			c-0.791,1.037-2.186,1.771-3.934,1.771c-2.676,0-4.178-1.939-4.178-3.959c0-3.332,2.977-5.053,7.895-5.023v-0.219			c0-0.875-0.355-2.324-2.705-2.324c-1.311,0-2.676,0.412-3.578,0.988l-0.655-2.188c0.983-0.602,2.704-1.176,4.808-1.176			c4.26,0,5.49,2.705,5.49,5.628L35.169,16.979L35.169,16.979z M31.891,13.027c-2.377-0.025-5.289,1.109-5.289,3.133			c0,1.311,1.492,1.912,2.559,1.912c1.365,0,2.32-0.229,2.648-1.184c0.082-0.246,0.082-0.492,0.082-0.738V13.027z"/>	</g></g></svg>'):m="g"==b.tagName?b.getAttribute("type")==o.photoBox?svgEditor.uiStrings.elementLabel.PhotoBox:svgEditor.uiStrings.elementLabel.ClipArt:"image"==b.tagName?svgEditor.uiStrings.elementLabel.Image:svgEditor.uiStrings.elementLabel[b.tagName];var s=$j('<div class="layer_row"></div>').attr("elemId",b.id).append('<div class="for-check"><input id="elemSelected'+a+'" type="checkbox"'+k+' name="elemSelected'+a+'" value="elemSelected'+a+'" class="selectObject" ></div><div class="leftObj">'+n+"</div>"),t=$j("<div class='rightObj'></div>").append("<div class='titleName'>"+m+"</div>").append("<div class='visibility'><input id='visible"+a+"' type='checkbox'"+h+" class='hideObject' name='visible"+a+"' value='visible"+a+"' ><label for='visible"+a+"' >&nbsp;</label></div>").append("<div class='security'><input id='check"+a+"'  type='checkbox'"+j+" class='lockObject' name='check"+a+"' value='check"+a+"' > <label for='check"+a+"' >&nbsp;</label></div>").append("<div class='up-down'><div class='moveUp'><i class='fa fa-arrows'></i></div> <div class='delete_layer' ><i class='fa fa-trash-o'></i></div></div>");if(s.append(t),$j("#sortableLayerPanel").append(s),s.find("use").length){for(var u;$j(s.find(".leftObj")[0]).offset().left>$j(s.find("use")[0]).offset().left;)u=$j(s.find(".leftObj")[0]).offset().left-$j(s.find("use")[0]).offset().left,$j(s.find("use")[0]).attr("x",$j(s.find("use")[0]).attr("x")+u);for(;$j(s.find(".leftObj")[0]).offset().top>$j(s.find("use")[0]).offset().top;)u=$j(s.find(".leftObj")[0]).offset().top-$j(s.find("use")[0]).offset().top,$j(s.find("use")[0]).attr("y",$j(s.find("use")[0]).attr("y")+u)}$j("#"+b.id).attr("display",g)}});var k=$j(".mangalyaan").jScrollPane();layerScrollerApi=k.data("jsp"),$j(".layer_row .leftObj").css("margin",h+"px "+j+"px"),$j("#sortableLayerPanel").parent().scrollTop(a)}}var i,j,k,l=!0,m=!1,n="title",o=new $j.DNBBaseObject;return $j(document).ready(function(){$j(".delete_layer").live("click",function(){var a=$j(this).closest(".layer_row"),b=svgCanvas.getElem(a.attr("elemId"));svgCanvas.getSelectedElems().length&&svgCanvas.clearSelection(),b&&b.parentNode.removeChild(b),svgCanvas.runExtensions("elementRemoved"),layerScrollerApi.getContentHeight()<=$j("#sortableLayerPanel").parents(".jspContainer").height()&&$j("#sortableLayerPanel").parent().css("top",0),i.extensions.undoRedo.addToStack()}),$j(".moveUp").live("click",function(){var a=$j(this).closest(".layer_row"),b=svgCanvas.getElem(a.attr("elemId")),c=svgCanvas.getElem(a.siblings(":first").attr("elemId"));$j(c).after(b),h()}),$j(".moveDown").live("click",function(){var a=$j(this).closest(".layer_row"),b=svgCanvas.getElem(a.attr("elemId")),c=svgCanvas.getElem(a.siblings(":last").attr("elemId"));$j(c).before(b),h()}),$j(".hideObject").live("click",function(a){b($j(this)),svgCanvas.getSelectedElems().length&&svgCanvas.clearSelection(),a.stopPropagation(),a.stopImmediatePropagation()}),$j(".lockObject").live("change",function(){c($j(this)),svgCanvas.getSelectedElems().length&&svgCanvas.clearSelection()}),$j(".selectObject").live("click",function(){a($j(this))}),i=svgCanvas.getPrivateMethods(),$j("#sortableLayerPanel").sortable({revert:!0,axis:"y",handle:"div.rightObj div div",start:function(a,b){m=!0,j=b.item.index()},change:function(a,b){k=b.placeholder.index();var c,d=svgCanvas.getElem(b.item.attr("elemId")),e=j-k;c=svgCanvas.getElem(0>e?b.placeholder.prev().attr("elemId"):b.placeholder.next().attr("elemId")),c&&c!=d&&$j(c)[0>e?"before":"after"](d)},sort:function(){},stop:function(){m=!1}})}),{name:"LayerPanel",selectedChanged:function(a){h(),a&&f(a.elems)},elementChanged:function(){h()},elementRemoved:function(){h()},onNewDocument:function(){h()},pageChanged:function(){},getAllObjects:function(){return g()},toolButtonStateUpdate:function(){},update:function(){h()}}}),svgEditor.addExtension("transformPanel",function(){return $j().ready(function(){$j("#upMove").on("click",function(a){return a.preventDefault(),svgCanvas.moveSelectedElements(0,-5,!1),!1}),$j("#downMove").on("click",function(a){return a.preventDefault(),svgCanvas.moveSelectedElements(0,5,!1),!1}),$j("#leftMove").on("click",function(a){return a.preventDefault(),svgCanvas.moveSelectedElements(-5,0,!1),!1}),$j("#rightMove").on("click",function(a){return a.preventDefault(),svgCanvas.moveSelectedElements(5,0,!1),!1})}),{name:"transformPanel",selectedChanged:function(a){if(a){var b=a.elems;if(b.length){$j("#transformPanel").show();for(var c=0;c<b.length;c++)if("true"==b[c].getAttribute("lock")||"true"==b[c].getAttribute("lockTransform")){$j("#transformPanel").hide();break}}else $j("#transformPanel").hide()}},elementChanged:function(a){}}}),svgEditor.addExtension("productPricing",function(){function a(a){for(var b={},c=a.length-1;c>=0;c--){var d=JSON.stringify(a[c]);b[d]?a.splice(c,1):b[d]=!0}return a}function b(a){for(var b=[],c=0,d=a.length;d>c;c++)-1==b.indexOf(a[c])&&b.push(a[c]);return b}var c,d,e,f,g,h,i=new $j.DNBBaseObject,j="circle,ellipse,line,path,polygon,polyline,rect,text,image",k=!0,l=!1,m={1:"full",2:"printable"},n={1:"Fixed",2:"No. of Colors",3:"Artwork Size"},o={},p={},q={},r={},s={},t={},u={},v={},w={},x={},y="",z=!0;svgEditor.ready(function(){}),$j(document).ready(function(){h=svgCanvas.getPrivateMethods()});var A=(productPricingExt.createPrintingMethod=function(){$j(".printingMethod-area").hide(),$j("#printingMethod").length?(f=$j("#printingMethod"),f.empty()):(f=$j("<select></select>").attr("id","printingMethod").attr("name","printingMethod"),$j(".printingMethod-area").append(f)),$j.each(printingMethods,function(a,b){f.append("<option id="+b.printingMethodId+" labelData="+b.name+" value="+b.printingMethodId+">"+b.name+"</option>"),y=$j("#printingMethod").val(),k&&($j(".printingMethod-area").show(),k=!1,o=b,c=b.printingMethodId,pickerMode=m[b.printableColorType],d=n[b.pricingLogic],e=b.pricingLogic,$j("#printingMethod").selectedIndex=c)}),$j(".printingMethod-area").find("label").length&&$j(".printingMethod-area").find("label").remove(),printingMethods.length<1?$j(".printingMethod-area").hide():1==printingMethods.length?($j("#printingMethod").hide(),$j("<label class='label-printmethod'>"+$j("#printingMethod option:selected").text()+"</label>").appendTo($j(".printingMethod-area"))):printingMethods.length>1&&($j(".printingMethod-area").show(),$j("#printingMethod").show()),printingMethods.length?C():pickerMode="full",productPricingExt.getProductPrice(),$j("#printingMethod").focus(function(){y=this.value}).change(function(){o=B(this.value),A(this)})},function(){1==o.isAlert?$j.confirm_custom(o.alertMessage,function(a){a?C(!0):$j("#printingMethod").val(y)}):(C(!0),y=$j("#printingMethod").val())}),B=function(a){var b={};return $j.each(printingMethods,function(c,d){d.printingMethodId==a&&(b=d)}),b},C=productPricingExt.applyPrintingMethod=function(a){a=a?a:!0,savedPrintingMethod&&0==l&&$j("#printingMethod").length&&(a=!1,l=!0,trace("savedPrintingMethod.printingMethodId = "+savedPrintingMethod.printingMethodId),$j.each(printingMethods,function(a,b){savedPrintingMethod.printingMethodId==b.printingMethodId&&(o=b,$j("#printingMethod")[0].selectedIndex=parseInt(a))})),pickerMode=m[o.printableColorType],"printable"==pickerMode&&(printableColorList=o.printableColors),c=o.printingMethodId,pickerMode=m[o.printableColorType],d=n[o.pricingLogic],e=o.pricingLogic,x.printableColorType=o.printableColorType,x.printingMethodId=c,x.pricingLogic=d,x.pricingLogicId=e,D(a),h.extensions.nameNumber&&h.extensions.nameNumber.updatePrice()},D=productPricingExt.calculatePriceData=function(a){z&&(getsvg_str(),0==o.isImageUpload?($j("#addimgbtn").addClass("disabled"),F()):"0"!=tempData.configurefeature[2]&&$j("#addimgbtn").removeClass("disabled"),"printable"==pickerMode&&1==a&&I(),"Fixed"==d?N(a):"No. of Colors"==d?N(a):"Artwork Size"==d&&(N(a),H()),E(),M(),L(),P())},E=function(){s.Side1=0,s.Side2=0,s.Side3=0,s.Side4=0,s.Side5=0,s.Side6=0,s.Side7=0,s.Side8=0,t.Side1=[],t.Side2=[],t.Side3=[],t.Side4=[],t.Side5=[],t.Side6=[],t.Side7=[],t.Side8=[],p={Side1:!1,Side2:!1,Side3:!1,Side4:!1,Side5:!1,Side6:!1,Side7:!1,Side8:!1};for(var a=1;no_of_side>=a;a++){var b="#textsvg_"+a,c=$j(b).val();"undefined"!=typeof c&&""!=c&&(svg=svgedit.utilities.text2xml(c),$j(svg).find(j).each(function(b,c){$j(c).closest("defs").length||"canvasMaskImage"!=c.getAttribute("id")&&K(c)&&(1==a?("image"==c.tagName&&"g"==c.parentNode.parentNode.tagName&&c.parentNode.parentNode.getAttribute("type")==i.photoBox?"true"!=c.getAttribute("isAdminUploaded")&&(p.Side1=!0):"path"==c.tagName&&"g"==c.parentNode.tagName&&c.parentNode.getAttribute("type")==i.photoBox?"true"!=c.parentNode.firstChild.firstChild.getAttribute("isAdminUploaded")&&(p.Side1=!0):p.Side1=!0,c.hasAttribute("origHeight")&&(s.Side1++,-1==t.Side1.indexOf(c.getAttribute("image_id"))&&t.Side1.push(c.getAttribute("image_id")))):2==a?("image"==c.tagName&&"g"==c.parentNode.parentNode.tagName&&c.parentNode.parentNode.getAttribute("type")==i.photoBox?"true"!=c.getAttribute("isAdminUploaded")&&(p.Side2=!0):"path"==c.tagName&&"g"==c.parentNode.tagName&&c.parentNode.getAttribute("type")==i.photoBox?"true"!=c.parentNode.firstChild.firstChild.getAttribute("isAdminUploaded")&&(p.Side2=!0):p.Side2=!0,c.hasAttribute("origHeight")&&(s.Side2++,-1==t.Side2.indexOf(c.getAttribute("image_id"))&&t.Side2.push(c.getAttribute("image_id")))):3==a?("image"==c.tagName&&"g"==c.parentNode.parentNode.tagName&&c.parentNode.parentNode.getAttribute("type")==i.photoBox?"true"!=c.getAttribute("isAdminUploaded")&&(p.Side3=!0):"path"==c.tagName&&"g"==c.parentNode.tagName&&c.parentNode.getAttribute("type")==i.photoBox?"true"!=c.parentNode.firstChild.firstChild.getAttribute("isAdminUploaded")&&(p.Side3=!0):p.Side3=!0,c.hasAttribute("origHeight")&&(s.Side3++,-1==t.Side3.indexOf(c.getAttribute("image_id"))&&t.Side3.push(c.getAttribute("image_id")))):4==a?("image"==c.tagName&&"g"==c.parentNode.parentNode.tagName&&c.parentNode.parentNode.getAttribute("type")==i.photoBox?"true"!=c.getAttribute("isAdminUploaded")&&(p.Side4=!0):"path"==c.tagName&&"g"==c.parentNode.tagName&&c.parentNode.getAttribute("type")==i.photoBox?"true"!=c.parentNode.firstChild.firstChild.getAttribute("isAdminUploaded")&&(p.Side4=!0):p.Side4=!0,c.hasAttribute("origHeight")&&(s.Side4++,-1==t.Side4.indexOf(c.getAttribute("image_id"))&&t.Side4.push(c.getAttribute("image_id")))):5==a?("image"==c.tagName&&"g"==c.parentNode.parentNode.tagName&&c.parentNode.parentNode.getAttribute("type")==i.photoBox?"true"!=c.getAttribute("isAdminUploaded")&&(p.Side5=!0):"path"==c.tagName&&"g"==c.parentNode.tagName&&c.parentNode.getAttribute("type")==i.photoBox?"true"!=c.parentNode.firstChild.firstChild.getAttribute("isAdminUploaded")&&(p.Side5=!0):p.Side5=!0,c.hasAttribute("origHeight")&&(s.Side5++,-1==t.Side5.indexOf(c.getAttribute("image_id"))&&t.Side5.push(c.getAttribute("image_id")))):6==a?("image"==c.tagName&&"g"==c.parentNode.parentNode.tagName&&c.parentNode.parentNode.getAttribute("type")==i.photoBox?"true"!=c.getAttribute("isAdminUploaded")&&(p.Side6=!0):"path"==c.tagName&&"g"==c.parentNode.tagName&&c.parentNode.getAttribute("type")==i.photoBox?"true"!=c.parentNode.firstChild.firstChild.getAttribute("isAdminUploaded")&&(p.Side6=!0):p.Side6=!0,c.hasAttribute("origHeight")&&(s.Side6++,-1==t.Side6.indexOf(c.getAttribute("image_id"))&&t.Side6.push(c.getAttribute("image_id")))):7==a?("image"==c.tagName&&"g"==c.parentNode.parentNode.tagName&&c.parentNode.parentNode.getAttribute("type")==i.photoBox?"true"!=c.getAttribute("isAdminUploaded")&&(p.Side7=!0):"path"==c.tagName&&"g"==c.parentNode.tagName&&c.parentNode.getAttribute("type")==i.photoBox?"true"!=c.parentNode.firstChild.firstChild.getAttribute("isAdminUploaded")&&(p.Side7=!0):p.Side7=!0,c.hasAttribute("origHeight")&&(s.Side7++,-1==t.Side7.indexOf(c.getAttribute("image_id"))&&t.Side7.push(c.getAttribute("image_id")))):8==a&&("image"==c.tagName&&"g"==c.parentNode.parentNode.tagName&&c.parentNode.parentNode.getAttribute("type")==i.photoBox?"true"!=c.getAttribute("isAdminUploaded")&&(p.Side8=!0):"path"==c.tagName&&"g"==c.parentNode.tagName&&c.parentNode.getAttribute("type")==i.photoBox?"true"!=c.parentNode.firstChild.firstChild.getAttribute("isAdminUploaded")&&(p.Side8=!0):p.Side8=!0,c.hasAttribute("origHeight")&&(s.Side8++,-1==t.Side8.indexOf(c.getAttribute("image_id"))&&t.Side8.push(c.getAttribute("image_id")))))})),x.isCustomized=p}x.totalImagesUsed=s,x.sideWiseImgIDs=t},F=function(){for(var a=1;no_of_side>=a;a++){var b=$j("#textsvg_"+a).val();if("undefined"!=typeof b&&""!=b){var c=svgedit.utilities.text2xml(b);G(c),$j("#textsvg_"+a).val((new XMLSerializer).serializeToString(c))}}G(svgCanvas.getContentElem()),svgCanvas.getPrivateMethods().extensions.LayerPanel&&svgCanvas.getPrivateMethods().extensions.LayerPanel.update()},G=function(a){$j(a).find(j).each(function(b,c){if(c.hasAttribute("origHeight")||"image"==c.tagName&&c.parentNode.getAttribute("type")==i.photoBox)if(c.hasAttribute("origHeight"))if("image"==c.tagName&&c.parentNode.getAttribute("type")==i.photoBox){var d=c.parentNode.getAttribute("clip-path");if(d&&""!=d){d=d.replace(/"/g,"");var e=d.substring(5,d.indexOf(")"));a.getElementById(e).parentNode.removeChild(a.getElementById(e))}c.parentNode.parentNode.removeChild(c.parentNode)}else c.parentNode.removeChild(c);else{var d=c.parentNode.getAttribute("clip-path");if(d&&""!=d){d=d.replace(/"/g,"");var e=d.substring(5,d.indexOf(")"));$j("#"+e).remove()}c.parentNode.parentNode.removeChild(c.parentNode)}})},H=function(){for(var a=1;no_of_side>=a;a++){var b=$j("#textsvg_"+a).val();if("undefined"!=typeof b&&""!=b){var c=svgedit.utilities.text2xml(b),d=c.getElementById("canvasMaskImageDef");d&&d.parentNode.removeChild(d),b=(new XMLSerializer).serializeToString(c),$j("#calAreaDiv").html(b),$j("#calAreaDiv").show();var e=$j("#calAreaDiv").children("svg")[0].getBBox(),f=e.width,g=e.height,h=e.x,i=e.y;h+f>design_area_width[a]&&(f=design_area_width[a]-h),0>h&&(f+=h),i+g>design_area_height[a]&&(g=design_area_height[a]-i),0>i&&(g+=i),0>f&&(f=0),0>g&&(g=0),$j("#calAreaDiv").empty(),$j("#calAreaDiv").hide(),f*=outputWidth[a]/design_area_width[a],g*=outputHeight[a]/design_area_height[a],1==a?q.Side1=(g*f).toFixed(2):2==a?q.Side2=(g*f).toFixed(2):3==a?q.Side3=(g*f).toFixed(2):4==a?q.Side4=(g*f).toFixed(2):5==a?q.Side5=(g*f).toFixed(2):6==a?q.Side6=(g*f).toFixed(2):7==a?q.Side7=(g*f).toFixed(2):8==a&&(q.Side8=(g*f).toFixed(2))}}x.squareArea=q},I=function(){for(var a=1;no_of_side>=a;a++){var b=$j("#textsvg_"+a).val();if("undefined"!=typeof b&&""!=b){var c=svgedit.utilities.text2xml(b);J(c),$j("#textsvg_"+a).val((new XMLSerializer).serializeToString(c))}}J(svgCanvas.getContentElem())},J=function(a){var b=($j.makeArray(printableColorList),0),c=[];$j(a).find(j).each(function(){if($j(this).attr("id").indexOf("txtPathDef")<=-1){if(b>=printableColorList.length&&(b=0),$j(this).attr("fill")){if("none"!=$j(this).attr("fill")&&!alreadyInPrintable($j(this).attr("fill"))){var a=printableColorList[b].colorCode.toString();-1==a.indexOf("#")&&(a="#"+a),$j(this).attr("fill",a),c.push(this)}}else if(("path"==this.tagName.toLowerCase()||"rect"==this.tagName.toLowerCase()||"ellipse"==this.tagName.toLowerCase()||"circle"==this.tagName.toLowerCase()||"polyline"==this.tagName.toLowerCase()||"polygon"==this.tagName.toLowerCase())&&!alreadyInPrintable("#000000")){var a=printableColorList[b].colorCode.toString();$j(this).attr("fill","#000000"),c.push(this)}if($j(this).attr("stroke")&&"none"!=$j(this).attr("stroke")&&"null"!=$j(this).attr("stroke")&&!alreadyInPrintable($j(this).attr("stroke"))){var a=printableColorList[b].colorCode.toString();-1==a.indexOf("#")&&(a="#"+a),$j(this).attr("stroke",a),c.push(this)}}b++}),console.log("changedElems"),console.log(c);for(var d=0;d<c.length;d++)"nameText"==c[d].parentNode.id?$j("#fill_nameText svg rect").attr("fill",getFill(c[d])):"numberText"==c[d].parentNode.id&&$j("#fill_numberText svg rect").attr("fill",getFill(c[d]))},K=function(a){return"none"==a.getAttribute("display")?!1:$j(a).parents("g").length>=2?"none"!=$j(a).parents("g")[$j(a).parents("g").length-2].getAttribute("display"):!0},L=function(){v.Side1=[],v.Side2=[],v.Side3=[],v.Side4=[],v.Side5=[],v.Side6=[],v.Side7=[],v.Side8=[];for(var a=1;no_of_side>=a;a++){var b="#textsvg_"+a,c=$j(b).val();if("undefined"!=typeof c&&""!=c){doc=svgedit.utilities.text2xml(c);var d="g,circle,ellipse,line,path,polygon,polyline,rect,image";$j(doc).find(d).each(function(b,c){null!=c.getAttribute("clip-id")&&K(c)&&(1==a?v.Side1.push(c.getAttribute("clip-id")):2==a?v.Side2.push(c.getAttribute("clip-id")):3==a?v.Side3.push(c.getAttribute("clip-id")):4==a?v.Side4.push(c.getAttribute("clip-id")):5==a?v.Side5.push(c.getAttribute("clip-id")):6==a?v.Side6.push(c.getAttribute("clip-id")):7==a?v.Side7.push(c.getAttribute("clip-id")):8==a&&v.Side8.push(c.getAttribute("clip-id")))})}}x.sideWiseClipIDs=v},M=function(){u.Side1=[],u.Side2=[],u.Side3=[],u.Side4=[],u.Side5=[],u.Side6=[],u.Side7=[],u.Side8=[];for(var a=1;no_of_side>=a;a++){var b="#textsvg_"+a,c=$j(b).val();if("undefined"!=typeof c&&""!=c){doc=svgedit.utilities.text2xml(c);var d="g";$j(doc).find(d).each(function(b,c){"text"==c.getAttribute("type")&&K(c)&&(1==a?-1==u.Side1.indexOf(c.getAttribute("font-id"))&&u.Side1.push(c.getAttribute("font-id")):2==a?-1==u.Side2.indexOf(c.getAttribute("font-id"))&&u.Side2.push(c.getAttribute("font-id")):3==a?-1==u.Side3.indexOf(c.getAttribute("font-id"))&&u.Side3.push(c.getAttribute("font-id")):4==a?-1==u.Side4.indexOf(c.getAttribute("font-id"))&&u.Side4.push(c.getAttribute("font-id")):5==a?-1==u.Side5.indexOf(c.getAttribute("font-id"))&&u.Side5.push(c.getAttribute("font-id")):6==a?-1==u.Side6.indexOf(c.getAttribute("font-id"))&&u.Side6.push(c.getAttribute("font-id")):7==a?-1==u.Side7.indexOf(c.getAttribute("font-id"))&&u.Side7.push(c.getAttribute("font-id")):8==a&&-1==u.Side8.indexOf(c.getAttribute("font-id"))&&u.Side8.push(c.getAttribute("font-id")))})}}x.sideWiseFontIDs=u},N=function(c){c=c?c:!0;var d=[];r.Side1=0,r.Side2=0,r.Side3=0,r.Side4=0,r.Side5=0,r.Side6=0,r.Side7=0,r.Side8=0,w.Side1=[],w.Side2=[],w.Side3=[],w.Side4=[],w.Side5=[],w.Side6=[],w.Side7=[],w.Side8=[];for(var e=1;no_of_side>=e;e++){var f=[];d=[];var g="#textsvg_"+e,h=$j(g).val();if("undefined"!=typeof h&&""!=h){doc=svgedit.utilities.text2xml(h);var i="circle,ellipse,line,path,polygon,polyline,rect,text";$j(doc).find(i).each(function(a,c){if(!($j(c).closest("defs").length||"rect"==c.tagName&&"text"==c.parentNode.getAttribute("type")||"path"==c.tagName&&"photobox"==c.parentNode.getAttribute("type"))&&c.getAttribute("id").indexOf("txtPathDef")<=-1&&K(c)){if(c.hasAttribute("fill")){if("none"!=c.getAttribute("fill")&&"null"!=c.getAttribute("fill")){var e={},g=c.getAttribute("fill").toLowerCase();d.push(g),e.colorCode=g,f.push(e)}}else if("path"==c.tagName.toLowerCase()||"rect"==c.tagName.toLowerCase()||"ellipse"==c.tagName.toLowerCase()||"circle"==c.tagName.toLowerCase()||"polyline"==c.tagName.toLowerCase()||"polygon"==c.tagName.toLowerCase()){var e={};d.push("#000000"),e.colorCode="#000000",f.push(e)}if(c.hasAttribute("stroke")&&"none"!=c.getAttribute("stroke")&&"null"!=c.getAttribute("stroke")){var h=c.hasAttribute("stroke-width");if(0==h){var e={},i=c.getAttribute("stroke").toLowerCase();d.push(i),e.colorCode=i,f.push(e)}else if(c.getAttribute("stroke-width")>0){var e={},i=c.getAttribute("stroke").toLowerCase();d.push(i),e.colorCode=i,f.push(e)}}d=b(d)}})}1==e?(r.Side1=d.length,w.Side1=a(f)):2==e?(r.Side2=d.length,w.Side2=a(f)):3==e?(r.Side3=d.length,w.Side3=a(f)):4==e?(r.Side4=d.length,w.Side4=a(f)):5==e?(r.Side5=d.length,w.Side5=a(f)):6==e?(r.Side6=d.length,w.Side6=a(f)):7==e?(r.Side7=d.length,w.Side7=a(f)):8==e&&(r.Side8=d.length,w.Side8=a(f))}x.totalColors=r,x.sideWiseColorInfo=w},O=(productPricingExt.getPrintingMethodData=function(){return x},productPricingExt.applyMinQuantity=function(){var a=productPricingExt.getTotalQuantity(),b=parseInt(svgCanvas.getPrivateMethods().extensions.productPricing.getCurrentPrintingMethod().minQty);if(b>a)if("configurable"==productData.type){var c=$j("#current_product_colorid").val(),d=$j("#colorid_"+c).find("input"),e=d.length;if(e){for(var f=0;e>f;f++)if(parseInt(d[f].value)){d[f].value=b;break}f==e&&(d[0].value=b)}}else if("onlysize"==productData.type){var d=$j("#onlySize_").find("input"),e=d.length;if(e){for(var f=0;e>f;f++)if(parseInt(d[f].value)){d[f].value=b;break}f==e&&(d[0].value=b)}}else $j("#quantity").val(b)},productPricingExt.getTotalQuantity=function(a){var b=0,c=$j("#current_product_colorid").val();if("configurable"==productData.type?$j.each(productData.allColors.color[c].sizes,function(d,e){var f=parseInt($j("#size"+e.optionID+"_"+c).val());f>0?(a&&a.push({id:e.optionID,quantity:f,addtocartparam:e.addtocartparam}),b+=f):$j("#size"+e.optionID+"_"+c).val(0)}):"onlysize"==productData.type?$j.each(productData.allColors.size,function(c,d){var e=parseInt($j("#size"+d.optionID).val());e>0?(a&&a.push({id:d.optionID,quantity:e,addtocartparam:d.addtocartparam}),b+=e):$j("#size"+d.optionID).val(0)}):b=pricingData.qty=$j("#quantity").val(),"onlycolor"==productData.type&&"wordpress"==postData.plateform){var d=Array();$j.each(productData.allColors.color,function(a,b){if(b.optionID==c){var e=b.addtocartparam;d.push(e)}}),pricingData.colorsData=d}return b}),P=productPricingExt.getProductPrice=function(){if("admin"!=user&&z){g&&(g.abort(),g=null),$j("#price_break").html(""),$j("#price").html("");var a=Array(),b=$j("#current_product_colorid").val();pricingData.productId=productid,pricingData.qty=0,pricingData.colorId=b;var c=O(a);if($j("#errornotinstock").hide(),$j("#designInfo").hide(),$j("#addcart").show(),c<parseInt(svgCanvas.getPrivateMethods().extensions.productPricing.getCurrentPrintingMethod().minQty))return $j("#errornotinstock").show(),$j("#designInfo").show(),errormessage=svgEditor.uiStrings.notification.printingMethod_LessQty_1+" "+svgCanvas.getPrivateMethods().extensions.productPricing.getCurrentPrintingMethod().minQty+" "+svgEditor.uiStrings.notification.printingMethod_LessQty_2,errorhtml='<div class="error-msg">'+errormessage+"</div>",$j("#errornotinstock").html(errorhtml),void $j("#addcart").hide();if(c>parseInt(svgCanvas.getPrivateMethods().extensions.productPricing.getCurrentPrintingMethod().maxQty))return $j("#errornotinstock").show(),$j("#designInfo").show(),errormessage=svgEditor.uiStrings.notification.printingMethod_MoreQty_1+" "+svgCanvas.getPrivateMethods().extensions.productPricing.getCurrentPrintingMethod().maxQty+" "+svgEditor.uiStrings.notification.printingMethod_MoreQty_2,errorhtml='<div class="error-msg">'+errormessage+"</div>",$j("#errornotinstock").html(errorhtml),void $j("#addcart").hide();pricingData.sizesData=a,pricingData.printingMethod=x,$j.isEmptyObject(nameNumberObject)||(pricingData.totalname=nameNumberObject.getNameCount(),pricingData.totalnumber=nameNumberObject.getNumberCount()),$j("#priceAjaxLoader").show(),$j("#addcart").addClass("disabled"),g=$j.ajax({type:"POST",url:productPriceUrl,cache:!1,data:{pricingData:JSON.stringify(pricingData),plateform:postData.plateform,siteBaseUrl:postData.siteBaseUrl,language_id:postData.language_id},success:function(a){var b;if(""==a)b='<span class="itemnotfound">'+svgEditor.uiStrings.notification.noDataFound+"</span>";else if(productPriceData=JSON.parse(a),""==productPriceData.message){$j("#price").html(productPriceData.good),$j("#errornotinstock").hide(),$j("#designInfo").hide(),$j("#addcart").show();var c="";if("configurable"==productData.type)for(var d=productPriceData.colorSizeTotalPrice,e=Object.keys(d),f=0;f<e.length;f++)for(var g=Object.keys(d[e[f]]),h=0;h<g.length;h++)c+=e[f]+" - "+g[h]+" - "+d[e[f]][g[h]]+"<br>";else if("onlysize"==productData.type||"onlycolor"==productData.type)for(var d=productPriceData.colorSizeTotalPrice,g=Object.keys(d),h=0;h<g.length;h++)c+=g[h]+" - "+d[g[h]]+"<br>";var i=c+svgEditor.uiStrings.elementLabel.avgPrintPriceCaption+" "+productPriceData.printingPrice+"<br>"+svgEditor.uiStrings.elementLabel.artWorkSetupPriceCaption+" "+productPriceData.artWorkSetupPrice+"<br>"+svgEditor.uiStrings.elementLabel.clipartPriceCaption+" "+productPriceData.clipartPrice;$j.isEmptyObject(nameNumberObject)||(i+="<br>"+svgEditor.uiStrings.elementLabel.namePriceCaption+" "+productPriceData.namePrice+"<br>"+svgEditor.uiStrings.elementLabel.numberPriceCaption+" "+productPriceData.numberPrice)}else{var j=productPriceData.message;errorhtml='<div class="error-msg">'+j+"</div>",$j("#errornotinstock").show(),$j("#designInfo").show(),$j("#errornotinstock").html(errorhtml),$j("#addcart").hide(),$j("#price").html("")}$j("#priceAjaxLoader").hide(),$j("#addcart").removeClass("disabled")}})}};return{name:"productPricing",elementChanged:function(a){a&&printingMethods.length>0&&"svgcontent"!==a.elems[0].id&&D(!0)},selectedChanged:function(a){a&&void 0!=a.elems[0]&&printingMethods.length>0&&"svgcontent"!==a.elems[0].id},elementAdded:function(){printingMethods&&D()},onNewDocument:function(){printingMethods&&D()},getCurrentPrintingMethod:function(){return o},forNameNumber:function(){printingMethods&&D()},createMethodFirstTime:function(a){k=a},isCalculate:function(a){z=a},stopPriceAjax:function(){g.abort()},getPricingLogicType:function(a){return n[a]}}}),svgEditor.addExtension("ProductMaskOverlayImage",function(a){{var b=document.getElementById("svgcanvas").ownerDocument,c="http://www.w3.org/2000/svg",d="http://svg-edit.googlecode.com",e="http://www.w3.org/1999/xlink";svgEditor.curConfig.dimensions,svgEditor.curConfig.position,a.svgroot}svgEditor.ready(function(){});var f=productOverlayImageExt.updateOverlayImage=function(a){if(a="undefined"!=typeof a?a:curSide,overlayImageUrls.length){var f=svgCanvas.getElem("overlayHolder");f||(f=b.createElementNS(c,"svg"));var g=parseInt($j("#img_"+a).attr("width")),h=parseInt($j("#img_"+a).attr("height"));if("NaN"==String(g))return;{$j("#canvasBackground").attr("x"),$j("#canvasBackground").attr("y")}if($j(f).attr({id:"overlayHolder",width:g*svgCanvas.getZoom(),height:h*svgCanvas.getZoom(),overflow:svgEditor.curConfig.show_outside_canvas?"visible":"hidden",xmlns:c,"xmlns:se":d,"xmlns:xlink":e}),$j(f).insertAfter("#svgcontent"),""==a||void 0==a){selIndex=0}else{selIndex=parseInt(a)-1}var i=overlayImageUrls[selIndex];""!=i&&void 0!=i&&null!=i?($j("#overlayImage").length?newImage=svgCanvas.getElem("overlayImage"):(newImage=document.createElementNS("http://www.w3.org/2000/svg","image"),f.appendChild(newImage)),svgedit.utilities.assignAttributes(newImage,{width:g*svgCanvas.getZoom(),height:h*svgCanvas.getZoom(),x:0,y:0,id:"overlayImage",preserveAspectRatio:"none",style:"pointer-events:none"}),svgCanvas.setHref(newImage,i)):$j("#overlayImage").length&&$j("#overlayImage").remove()
}};return{name:"ProductMaskOverlayImage",pageChanged:function(){f()},onNewDocument:function(){f(),zoomChange("100%")},zoomChanged:function(){f()}}}),svgEditor.addExtension("ShowObjectSize",function(){function a(a,j){if(a&&1==a.length&&void 0!=a[0]){b=svgCanvas.selectorManager.selectorGripsGroup;var k=svgCanvas.selectorManager.selectorGrips.s,l=svgCanvas.selectorManager.selectorGrips.w,m=svgedit.utilities.getBBox(k),n=svgedit.utilities.getBBox(l);if(!m)return;c?($j(c).show(),$j(f).show()):(c=svgCanvas.addSvgElementFromJson({element:"g",attr:{id:"widthGroup"}}),d=svgCanvas.addSvgElementFromJson({element:"rect",attr:{x:m.x-45,y:m.y+10,width:"100",height:"30",id:"widthBg",opacity:1,style:"pointer-events:none",stroke:"#000000"}}),e=svgCanvas.addSvgElementFromJson({element:"text",attr:{x:0,y:0,id:"widthText",fill:"#FFFFFF","stroke-width":"0","font-size":i,"text-anchor":"start",style:"pointer-events:none","xml:space":"preserve",opacity:"1"}}),f=svgCanvas.addSvgElementFromJson({element:"g",attr:{id:"heightGroup"}}),g=svgCanvas.addSvgElementFromJson({element:"rect",attr:{x:n.x-45,y:n.y+10,width:"100",height:"30",id:"heightBg",opacity:1,style:"pointer-events:none",stroke:"#000000"}}),h=svgCanvas.addSvgElementFromJson({element:"text",attr:{x:0,y:0,id:"heightText",fill:"#FFFFFF","stroke-width":"0","font-size":i,"text-anchor":"start",style:"pointer-events:none","xml:space":"preserve",opacity:"1"}}),c.appendChild(d),c.appendChild(e),b.appendChild(c),f.appendChild(g),f.appendChild(h),b.appendChild(f));var o;if(0!=svgCanvas.getRotationAngle(a[0])){var p=a[0].cloneNode(!0);svgCanvas.getContentElem().appendChild(p),svgCanvas.setRotationAngle(0,!0,p),o=svgedit.utilities.getObjectBbox(p),svgCanvas.getContentElem().removeChild(p)}else o=svgedit.utilities.getObjectBbox(a[0]);if("producttool"==toolType){var q=o.width*outputWidth[curSide]/design_area_width[curSide],r=o.height*outputHeight[curSide]/design_area_height[curSide];e.textContent=q.toFixed(2)+" "+productData.baseUnit,h.textContent=r.toFixed(2)+" "+productData.baseUnit}else e.textContent=svgedit.units.convertUnit(o.width).toFixed(2)+" "+svgEditor.curConfig.baseUnit,h.textContent=svgedit.units.convertUnit(o.height).toFixed(2)+" "+svgEditor.curConfig.baseUnit;var s=svgedit.utilities.getBBox(e),t=svgedit.utilities.getBBox(h);e.setAttribute("x",m.x-s.width/2+3),e.setAttribute("y",m.y+s.height+15),h.setAttribute("x",n.x-t.width-10),h.setAttribute("y",n.y+t.height/2),s=svgedit.utilities.getBBox(e),t=svgedit.utilities.getBBox(h),d.setAttribute("width",s.width+10),d.setAttribute("height",s.height+10),d.setAttribute("x",s.x-5),d.setAttribute("y",s.y-5),g.setAttribute("width",t.width+10),g.setAttribute("height",t.height+10),g.setAttribute("x",t.x-5),g.setAttribute("y",t.y-5),svgCanvas.setRotationAngle(-90,!0,f),j&&($j(c).hide(),$j(f).hide())}}var b,c,d,e,f,g,h,i=12;return{name:"ShowObjectSize",elementTransition:function(b){var c=b?b.elems:svgCanvas.getSelectedElems();a(c)},elementAdded:function(b){for(var c=b?b.elems:svgCanvas.getSelectedElems(),d=!0,e=0;e<c.length&&("g"!=c[e].tagName||("photobox"==c[e].getAttribute("type")&&(d=!1),$j.each($j(c[e]).find("g"),function(a,b){"photobox"==b.getAttribute("type")&&(d=!1)}),d));e++);d&&a(c)},selectedChanged:function(b){var c=b?b.elems:svgCanvas.getSelectedElems();a(c)},textChanged:function(b){var c=b?b.elems:svgCanvas.getSelectedElems();a(c)},elementChanged:function(b){var c=b?b.elems:svgCanvas.getSelectedElems();a(c)},zoomChanged:function(){var b=svgCanvas.getSelectedElems();a(b)},onNewDocument:function(){c=null},toolButtonStateUpdate:function(){},displaySize:function(b){b=b||svgCanvas.getSelectedElems(),a(b)},mouseDown:function(){}}}),svgEditor.addExtension("textShape",function(){function a(){handleTextPanel(),$j(".textFontSizePanel .shape_con").show()}function b(a){var b=t(),c=$j(".textFontSizePanel .shape_con").find("button");if(c.removeClass("selected"),b&&1==b.length){var d=b[0];d.setAttribute("font-size",a.target.value),$j(a.target).addClass("selected"),n(),$j(".currentFontSize").html(svgEditor.uiStrings.elementLabel.currentFontSize+": "+Math.round(100*d.getAttribute("font-size"))/100)}$j(".textFontSizePanel .shape_con").hide()}function c(a){""!=a.target.id&&(handleTextPanel("fontBox"),$j("#font-selector-con").toggle(),$j("#font-box").hasClass("active")?$j("#font-box").removeClass("active"):$j("#font-box").addClass("active"))}function d(a){var b=t();if(b&&1==b.length){var c=b[0];c.setAttribute("lineHeight",a),n()}}function e(){handleTextPanel("textShape"),$j("#textShapeDD").toggleClass("active"),$j("#textShapeDD .shape_con").toggle()}function g(a){var b;b="IMG"==a.target.tagName?a.target.parentNode:a.target;var c=parseInt(b.value),d=t();if(d&&1==d.length){var e=d[0];if(parseInt(e.getAttribute("shapeId"))==c)return;switch(H=0,0==parseInt(e.getAttribute("shapeId"))?9==c?H=45:c>0&&(H=5):9==parseInt(e.getAttribute("shapeId"))?c>0&&(H=5):parseInt(e.getAttribute("shapeId"))>0&&9==c&&(H=45),e.setAttribute("shapeId",c),H&&(e.setAttribute("shapeVal",H),$j("#textShapeSlider").slider("value",H),$j("#shapeValue").val(H)),$j("#textShapeSlider").slider({disabled:!1}),$j("#textShapeSlider").css("opacity","1"),c){case 0:$j("#textShapeSlider").slider({disabled:!0}),$j("#textShapeSlider").css("opacity","0.5");break;case 9:$j("#textShapeSlider").slider({min:-360}),$j("#textShapeSlider").slider({max:360}),$j("#textShapeSlider").slider({step:5});break;default:$j("#textShapeSlider").slider({min:-10}),$j("#textShapeSlider").slider({max:10}),$j("#textShapeSlider").slider({step:.5})}}n(a),setPropertiesInpanel(e)}function h(a){var b=t();b&&1==b.length&&b[0].setAttribute("shapeVal",a),n()}function i(){K=!1}function j(){var a=t();a&&!K&&(K=!0,E=svgCanvas.getStrokedBBox([a]),G="")}function k(){var a=t();if(a&&1==a.length){var b=svgCanvas.getStrokedBBox(a),c=parseFloat(a[0].getAttribute("elemBBoxWidth")),d=parseFloat(a[0].getAttribute("elemBBoxHeight"));if(Q){var e=a[0].getAttribute("xscale")?parseFloat(a[0].getAttribute("xscale")):1,f=a[0].getAttribute("yscale")?parseFloat(a[0].getAttribute("yscale")):1;a[0].setAttribute("xscale",e*(b.width/c)),a[0].setAttribute("yscale",f*(b.height/d)),a[0].getAttribute("xscale")==a[0].getAttribute("yscale")&&(a[0].setAttribute("xscale",1),a[0].setAttribute("yscale",1),a[0].setAttribute("font-size",a[0].getAttribute("font-size")*(b.width/c)))}else a[0].setAttribute("font-size",a[0].getAttribute("font-size")*(b.width/c));var g=svgCanvas.getRotationAngle(a[0]);g?(a[0].setAttribute("elemBBoxWidth",C(a[0]).width),a[0].setAttribute("elemBBoxHeight",C(a[0]).height)):(a[0].setAttribute("elemBBoxWidth",svgCanvas.getStrokedBBox([a[0]]).width),a[0].setAttribute("elemBBoxHeight",svgCanvas.getStrokedBBox([a[0]]).height)),G=""}}function l(a){clearTimeout(I),I=setTimeout(n,500,a)}function m(){return $j("#add_text").val().toString().trim()?($j("#text").val($j("#add_text").val()),void n()):($j.alert(svgEditor.uiStrings.notification.ADDTEXT_ALERT),void $j("#add_text").val(""))}function n(a,b,c){if(!a||"text"!=a.target.id||(f=svgCanvas.getSelectedElems()[0])){if(!$j("#text").val().toString().trim()&&!b)return $j.alert(svgEditor.uiStrings.notification.ADDTEXT_ALERT),void $j("#text").val("");showLoader();var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;if(b||svgCanvas.getSelectedElems().length){f=b||svgCanvas.getSelectedElems()[0],t=B(f),s=svgCanvas.getRotationAngle(f),s&&svgCanvas.setRotationAngle(0,!0,f),i=svgCanvas.getStrokedBBox([f]),d=i.x,e=i.y,o=f.getAttribute("text");var v=c||$j("#text").val();f.setAttribute("text",removeSpecialChar(v)),q=A(f),f.setAttribute("stroke-width",q),k=f.childNodes[0].getAttribute("stroke"),k&&(k=k.substring(1)),f.setAttribute("stroke",k),r=y(f),f.setAttribute("stroke-dasharray",r)}else{if("producttool"==toolType)d=design_area_width[curSide]/2,e=design_area_height[curSide]/2;else{var C=getSize();d=parseFloat(C[0])*svgedit.units.getTypeMap()[svgEditor.curConfig.baseUnit]*.5,e=parseFloat(C[1])*svgedit.units.getTypeMap()[svgEditor.curConfig.baseUnit]*.5}q=1,f=svgCanvas.addSvgElementFromJson({element:"g",attr:{id:svgCanvas.getNextId(),type:"text",text:removeSpecialChar($j("#text").val()),"font-size":J,"font-family":first_font,"font-id":jsonfontList[first_font].font_id,fill:"000000",stroke:"none","stroke-width":1,"stroke-dasharray":"none","text-anchor":"start","font-weight":"normal","font-style":"normal",lineHeight:1,shapeId:0,shapeVal:0,style:"pointer-events:inherit"}}),r="none",o=$j("#text").val()}g=f.getAttribute("font-family"),h=f.getAttribute("font-size"),j=z(f),k=f.getAttribute("stroke"),align=f.getAttribute("text-anchor");var E="normal";L&&"bold"==f.getAttribute("font-weight")?E="bold":$j("#tool_bold").removeClass("push_button_pressed"),f.setAttribute("font-weight",E);var F="normal";for(M&&"italic"==f.getAttribute("font-style")?F="italic":$j("#tool_italic").removeClass("push_button_pressed"),f.setAttribute("font-style",F),m=f.getAttribute("shapeId"),n=f.getAttribute("shapeVal"),p=parseFloat(f.getAttribute("lineHeight")),k&&"null"!=k?"none"!=k&&(k="#"+k):k="none";f.childNodes.length;)f.removeChild(f.childNodes[0]);D.clear();var G=D.printArray(d,e,c||$j("#text").val(),g,j,h,align,E,F,null,p,f.getAttribute("fixedWidth"),f.getAttribute("xscale"),f.getAttribute("yscale"));-1==j.indexOf("#")&&(j="#"+j);for(var H=0;H<G.length;H++)l=svgCanvas.addSvgElementFromJson({element:"path",attr:{id:svgCanvas.getNextId(),fill:j,stroke:k,"stroke-width":q,"stroke-dasharray":r,d:G[H].node.getAttribute("d"),transform:G[H].node.getAttribute("transform"),style:"pointer-events:inherit"}}),f.appendChild(l);if(1==G.length)if(m>0&&9>m){var I=G[0].attrs.path,K=G[0].getBBox(),N=w(G[0].attrs.path);l.setAttribute("d",u(I,K,N,1e5,parseInt(m),parseFloat(n)).toString())}else if(9==m){var K=G[0].getBBox();0!=n&&l.setAttribute("d",x(n,K,$j("#text").val(),o,!0,K,g,h,0,j,j,0))}if(i){var O=parseFloat(f.getAttribute("xscale")),P=parseFloat(f.getAttribute("yscale"));if(Q&&(O||P)){var R=svgedit.utilities.getObjectBbox(f),S=svgCanvas.getZoom();W=O+","+P;var d=R.x*S,e=R.y*S;f.setAttribute("transform","translate("+-1*d+","+-1*e+") scale("+W+") translate("+d+","+e+")"),svgCanvas.recalculateDimensions(f)}if(s&&svgCanvas.setRotationAngle(s,!0,f),!b){svgCanvas.selectorManager.requestSelector(f).resize();var T=B(f),U=t.x-T.x,V=t.y-T.y;(0!=U||0!=V)&&(svgCanvas.moveSelectedElements(U,V,!1,[f]),svgCanvas.selectorManager.requestSelector(f).resize())}}else{svgCanvas.getPrivateMethods().extensions.undoRedo&&svgCanvas.getPrivateMethods().extensions.undoRedo.isAddToStack(!1),svgCanvas.selectOnly([f],!0);var W=setSizePosition(f);f.setAttribute("font-size",J*W),f.setAttribute("xscale",1),f.setAttribute("yscale",1),svgCanvas.getPrivateMethods().extensions.undoRedo&&svgCanvas.getPrivateMethods().extensions.undoRedo.isAddToStack(!0)}for(var X=f.childNodes.length,Y=0;X>Y;Y++){var Z=svgCanvas.getStrokedBBox([f.childNodes[Y]]),$=svgCanvas.addSvgElementFromJson({element:"rect",attr:{id:svgCanvas.getNextId(),x:Z.x,y:Z.y,width:Z.width,height:Z.height,fill:"#000000",opacity:"0",style:"pointer-events:inherit"}});f.appendChild($)}svgCanvas.runExtensions("textChanged",{elems:[f]}),hideLoader()}}function o(a){if(Raphael.fonts){var b=Raphael.fonts[a];if(!b)return setTimeout(showLoader,500),void $j.getScript(Smm.fontDirectory+fontData[a].jsFile).done(function(){setTimeout(hideLoader,500),o(a)}).fail(function(){setTimeout(hideLoader,500),$j.alert("Sorry!! this font is not available.")});N=L=M=!1;for(var c=0;c<b.length;c++)"700"==b[c].face["font-weight"]?"italic"==b[c].face["font-style"]?N=!0:L=!0:"italic"==b[c].face["font-style"]&&(M=!0);$j("#tool_bold").addClass("disabled"),$j("#tool_italic").addClass("disabled"),N?($j("#tool_bold").removeClass("disabled"),$j("#tool_italic").removeClass("disabled")):L?$j("#tool_bold").removeClass("disabled"):M&&$j("#tool_italic").removeClass("disabled")}}function p(a){var b=t();if(b&&1==b.length){var c=b[0],d=Raphael.fonts[a.target.getAttribute("font-name")];d?(c.setAttribute("font-family",a.target.getAttribute("font-name")),o(a.target.getAttribute("font-name")),n(a),setPropertiesInpanel(c)):(showLoader(),$j.getScript(Smm.fontDirectory+fontData[a.target.getAttribute("font-name")].jsFile).done(function(){hideLoader(),c.setAttribute("font-family",a.target.getAttribute("font-name")),o(a.target.getAttribute("font-name")),n(a),setPropertiesInpanel(c)}).fail(function(){hideLoader(),$j.alert("Sorry!! this font is not available.")}))}}function q(a){if(!$j("#tool_bold").hasClass("disabled")){var b=t();if(b&&1==b.length){var c=b[0];N||"italic"!=c.getAttribute("font-style")||r(a),"normal"==c.getAttribute("font-weight")?(c.setAttribute("font-weight","bold"),$j("#tool_bold").addClass("push_button_pressed")):(c.setAttribute("font-weight","normal"),$j("#tool_bold").removeClass("push_button_pressed")),n(a)}}}function r(a){if(!$j("#tool_italic").hasClass("disabled")){var b=t();if(b&&1==b.length){var c=b[0];N||"italic"!=c.getAttribute("font-style")||q(a),"normal"==c.getAttribute("font-style")?(c.setAttribute("font-style","italic"),$j("#tool_italic").addClass("push_button_pressed")):(c.setAttribute("font-style","normal"),$j("#tool_italic").removeClass("push_button_pressed")),n(a)}}}function s(a){var b;switch(a.currentTarget.id){case"text_align_left":b="start";break;case"text_align_center":b="middle";break;case"text_align_right":b="end"}var c=t();if(c&&1==c.length){var d=c[0];d.getAttribute("text-anchor")!=b&&(d.setAttribute("text-anchor",b),n(a),setAlignButton(d.getAttribute("text-anchor")))}}function t(a){if(a=a||svgCanvas.getSelectedElems(),a.length){for(var b=[],c=0;c<a.length;c++)"g"==a[c].tagName&&("text"==a[c].getAttribute("type")?b.push(a[c]):b=b.concat($j.makeArray($j(a[c]).find('g[type="text"]'))));if(b.length)return b}return null}function u(a,b,c,d,e,f){for(var g=0;g<a.length;g++)for(var h=1;h<a[g].length-1;h+=2){var i=h+1,j=Math.floor(parseFloat(a[g][h]-c.x)/b.width*d),k=Math.ceil(parseFloat(a[g][i]-c.y)/b.height*d),j=v(j,k,e,f,b.height,b.width,d);a[g][h]=j.x+0,a[g][i]=j.y+0}return a}function v(a,b,c,d,e,f,g){var h={x:0,y:0};switch(h.x=f/(g-1)*a,c){case 1:h.x=f/(g-1)*a,h.y=d>=0?e/g*b*(g-d/10*a)/g+a/g*(e/2)*(d/10):e/g*b*(g-(g-a)*(Math.abs(d)/10))/g+(g-a)/g*(e/2)*(Math.abs(d)/10);break;case 2:h.x=f/(g-1)*a,h.y=-(e/2)+e/g*b,d>=0?(h.y+=e/5*Math.pow((-1+g-2*a)/g,2)*d*(b/g),h.y-=b/g*(e/40)*d):(h.y-=e/5*Math.pow((-1+g-2*a)/g,2)*Math.abs(d)*((g-b)/g),h.y-=(g-b)/g*(e/40)*d),h.y+=e/2;break;case 3:h.x=f/(g-1)*a,h.y=e/(g-1)*b,h.y=d>=0?h.y+e/5*Math.pow((-1+g-2*a)/g,2)*d:h.y-e/5*Math.pow((-1+g-2*a)/g,2)*Math.abs(d);break;case 4:h.x=f/(g-1)*a,h.y=-(e/2)+e/g*b,h.y=d>=0?g/2>a?h.y*Math.sqrt(1-(g/2-4*a)/(g/2)*(d/10)):h.y*Math.sqrt(Math.max(0,1-(g/2-4*(g-1-a))/(g/2)*(d/10))):g/2>a?h.y*Math.pow(-1+(g/2-2*a)/(g/2)*(d/10),2):h.y*Math.pow(-1+(g/2-2*(g-1-a))/(g/2)*(d/10),2);break;case 5:h.y=e/g*b,d>=0?(h.x=-(f/2)+f/g*a,h.x*=(1+(g-2*b)/g*(d/10))/2):(h.x=-(f/2)+f/g*a,h.x*=(1+(2*b-g)/g*(Math.abs(d)/10))/2),h.x+=f/2;break;case 6:h.x=f/(g-1)*a,h.y=d>=0?e/g*b*((g-d/10*a)/g)+a/g*(d/10)*e:e/g*b*(g-(g-a)*(Math.abs(d)/10))/g+(g-a)/g*e*(Math.abs(d)/10);break;case 7:h.x=f/(g-1)*a,h.y=d>=0?e/g*b*(g-d/10*a)/g:e/g*b*(g-(g-a)*(Math.abs(d)/10))/g;break;case 8:h.x=f/(g-1)*a,h.y=e/(g-1)*b,h.y=d>=0?h.y+e/15*Math.pow((-1+g-2*a)/g,3)*d:h.y-e/15*Math.pow((-1+g-2*a)/g,3)*Math.abs(d)}return h}function w(a){for(var b=1e4,c=1e4,d={x:0,y:0},e=0;e<a.length;e++)for(var f=1;f<a[e].length-1;f+=2){var g=f+1,h=parseInt(parseFloat(a[e][f])),g=parseInt(parseFloat(a[e][g]));b>h&&(b=h),c>g&&(c=g)}return d.x=b,d.y=c,d}function x(a,b,c,d,e,g,h,i,j,k,l,m){if(0!=a){n={sx:1,sy:1,w:b.width,h:b.height,x:b.x,bBox:r,yo:0};var n,o=a,p=b,q=1,r=!1,s={};0>a&&(r=!0,q=-1),a=Math.abs(a),f="";var t=c,u=c;c.length<d.length&&0==e&&(p=g,u=d);var u=D.print(0,0,u,h,i,"middle",j),v=u.getBBox(!0),w=D.print(0,0,t,h,i,"middle",j),x=w.getBBox(!0),p=getRadious(p.width,p.height,a),o=D.path(arc([v.width/2,v.y2+p],p,-90-a/2,a-90-a/2)).attr({stroke:"#0000ff"}),y=o.getTotalLength();for(s[t+h+"SP"+j]?p=s[t+h+"SP"+j]:(p=new TextMetrics(D,t,h,i,j).getMetrics(),s[t+h+"SP"+j]=p),u.remove(),w.remove(),u=Math.abs(v.width-x.width)/2,v=y/(v.width-v.x),w=0;w<t.length;w++)if(" "!=c[w]){var z=p[w].y,A=p[w].width,y=p[w].height,B=(u+p[w].x+A/2)/v,x=D.print(0,0,t[w],h,i,"middle",j).attr({fill:k,stroke:l,"stroke-width":m,"stroke-linecap":"round","stroke-linejoin":"round"}),y=D.rect(0,0,A,y),C=o.getPointAtLength(B).x,E=o.getPointAtLength(B).y*q;y.transform("T"+(C-A/2)+","+(z+E)),A=y.getBBox(!1),C=x.getBBox(!0),z=A.x-C.x,A=A.y-C.y,C=o.getPointAtLength(B),B=o.getPointAtLength(B+1),B=180*Math.atan2(B.y-C.y,B.x-C.x)/Math.PI,r&&(B=360-B),x.transform("t"+z+","+A+"r"+B+"..."),B=Raphael.transformPath(x.attr("path"),x.transform()),f+=B,x.remove(),y.remove()}return o.remove(),q=f}}function y(a){return a.childNodes.length&&a.childNodes[0].hasAttribute("stroke-dasharray")?a.childNodes[0].getAttribute("stroke-dasharray"):a.getAttribute("stroke-dasharray")?a.getAttribute("stroke-dasharray"):"none"}function z(a){return a.childNodes.length&&a.childNodes[0].getAttribute("fill")?a.childNodes[0].getAttribute("fill"):a.getAttribute("fill")?a.getAttribute("fill"):"#000000"}function A(a){if(a.childNodes.length){if(a.childNodes[0].hasAttribute("stroke-width"))return parseInt(a.childNodes[0].getAttribute("stroke-width"));if(a.childNodes[0].hasAttribute("stroke")){var b=a.childNodes[0].getAttribute("stroke");return"none"!=b&&"null"!=b?"1":"0"}return"0"}return"0"}function B(a,b){if(a){var c;switch(b=b||a.getAttribute("text-anchor")){case"start":c=$j("#selectorGrip_resize_nw");break;case"middle":c=$j("#selectorGrip_resize_n");break;case"end":c=$j("#selectorGrip_resize_ne")}var d=!1;"none"==c.parent().attr("display")&&(c.parent().attr("display","inline"),d=!0);var e=c.position();return d&&c.parent().attr("display","none"),{x:e.left,y:e.top}}}function C(a){var b=a.cloneNode(!0);svgCanvas.getContentElem().appendChild(b),svgCanvas.setRotationAngle(0,!0,b);var c=svgCanvas.getStrokedBBox([b]);return svgCanvas.getContentElem().removeChild(b),c}var D,E,F,G,H,I,J=24,K=!1,L=!1,M=!1,N=!1,O="ltr",P=[],Q=!0,R=[];return $j(document).ready(function(){P=[{name:"none",id:0,image:"images/shape-none.jpg"},{name:"curve",id:9,image:"images/shape-curve.jpg"},{name:"arch",id:3,image:"images/shape-arch.jpg"},{name:"Bridge",id:2,image:"images/shape-bridge.jpg"},{name:"bulge",id:4,image:"images/shape-bulge.jpg"},{name:"bird's eye",id:5,image:"images/shape-bridseye.jpg"},{name:"pinch",id:1,image:"images/shape-pinch.jpg"},{name:"Cascade Down",id:6,image:"images/shape-cascadedown.jpg"},{name:"Cascade Up",id:7,image:"images/shape-cascadeup.jpg"},{name:"Wave",id:8,image:"images/shape-wave.jpg"}];$j("<div id='tempCanvas' style='display:none' ></div>").appendTo($j("body"));D=Raphael("tempCanvas",500,500),$j("#wStepper, #hStepper").on("change",k),$j("#wStepper, #hStepper").on("focus",j),$j("#wStepper, #hStepper").on("blur",i),R=[{name:"5",val:5},{name:"6",val:6},{name:"7",val:7},{name:"8",val:8},{name:"9",val:9},{name:"10",val:10},{name:"12",val:12},{name:"14",val:14},{name:"16",val:16},{name:"18",val:18},{name:"20",val:20},{name:"22",val:22},{name:"24",val:24},{name:"26",val:26},{name:"28",val:28},{name:"30",val:30},{name:"32",val:32},{name:"34",val:34},{name:"36",val:36},{name:"38",val:38},{name:"40",val:40},{name:"42",val:42},{name:"44",val:44},{name:"46",val:46},{name:"48",val:48},{name:"50",val:50},{name:"52",val:52},{name:"54",val:54},{name:"56",val:56},{name:"58",val:58},{name:"60",val:60},{name:"62",val:62},{name:"66",val:66},{name:"68",val:68},{name:"70",val:70},{name:"72",val:72},{name:"74",val:74},{name:"76",val:76},{name:"78",val:78},{name:"80",val:80},{name:"82",val:82},{name:"84",val:84},{name:"86",val:86},{name:"88",val:88},{name:"90",val:90},{name:"92",val:92},{name:"94",val:94},{name:"96",val:96},{name:"98",val:98}];for(var f=$j(".textFontSizePanel .shape_con"),l=0;l<R.length;l++)svgedit.browser.isTouch()&&0==svgedit.browser.isIOS()?$j('<button class="tool_button" value="'+R[l].val+'" name="'+R[l].name+'" >'+R[l].name+"</button>").appendTo(f).on("touchstart",b):$j('<button class="tool_button" value="'+R[l].val+'" name="'+R[l].name+'" >'+R[l].name+"</button>").appendTo(f).on("click",b);svgedit.browser.isTouch()&&0==svgedit.browser.isIOS()?$j("#textFontSize").on("touchstart",a):$j("#textFontSize").on("click",a);for(var m=($j("#textShapeDiv .curve-property"),$j("#textShapeDD")),n=$j("#textShapeDD .shape_con"),o=$j("<ul class='dropdown'>").appendTo(n),l=0;l<P.length;l++)svgedit.browser.isTouch()&&0==svgedit.browser.isIOS()?$j('<li value="'+P[l].id+" name="+P[l].name+'" ><img style="pointer-events:none" src="'+jspath+P[l].image+'"/></li>').appendTo(o).on("touchstart",g):$j('<li value="'+P[l].id+" name="+P[l].name+'" ><img style="pointer-events:none" src="'+jspath+P[l].image+'"/></li>').appendTo(o).on("click",g);svgedit.browser.isTouch()&&0==svgedit.browser.isIOS()?(m.on("touchstart",e),$j("#font-box").on("touchstart",c)):(m.on("click",e),$j("#font-box").on("click",c)),$j("#textalignment").click(function(){handleTextPanel(),$j("#textalignment").addClass("active"),$j(".text-align").show()}),$j("#textLineSpace").click(function(){handleTextPanel(),$j("#textLineSpace").addClass("active"),$j(".text-lineSpace").show()}),$j("#borderalignment").on("mousedown",function(){handleTextPanel(),$j("#bordercontrolls").show(),$j(".border_colorpicker").css("left","0px"),$j("#common_upper_open_panel").show(),$j("#stroke_color, #tool_stroke .icon_label").trigger("mousedown"),svgCanvas.getSelectedElems().length&&$j.farbtastic("#colorpicker").setColor(getStroke())}),$j("#textShapeSlider").slider({orientation:"vertical",range:!1,min:-10,max:10,step:.5,value:0,slide:function(a,b){$j("#shapeValue").val(b.value)},start:function(){},stop:function(a,b){h(b.value)}}),$j("#lineSpaceSlider").slider({range:!1,min:.1,max:10,step:.1,value:1,slide:function(a,b){$j("#lineHeight").val(b.value)},start:function(){},stop:function(a,b){d(b.value)}})}),Raphael.fn.printArray=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=[],p=[],q=0;l=l||1/0,m=parseFloat(m)||1,n=parseFloat(n)||1,n=1,e=e||"#000000",g=g||"start",h="bold"==h?700:400,i="italic"==i?i:"normal",j=j||0,k=k||1,d=this.getFont(d,h,i);for(var r=d.face.bbox.split(" "),s=(f||16)/d.face["units-per-em"],t=(r[3]-r[1])*s,u=c.split("\n"),v=0;v<u.length;v++){if(u[v]){var w=this.print(0,0,u[v],d,f,null,j,null,O).attr({opacity:0}).attr({fill:e});w.attr({transform:"T"+a+","+b,opacity:1}),o.push(w);var x=w.getBBox();q=Math.max(x.width,q),p.push(x.width)}b+=t*k*n}if(o.length>1)for(var v=0;v<o.length;v++){var y=0;switch(g){case"start":continue;case"middle":y=(q-p[v])/2;break;case"end":y=q-p[v]}var z=o[v].matrix.e+y;o[v].attr({transform:"T"+z+","+o[v].matrix.f,opacity:1})}return o},TextMetrics=function(a,b,c,d,e){var f=[];this.init=function(){for(var g=0;g<b.length;g++){var h=a.print(0,0,b.slice(0,g+1),c,d,"middle",e),i=h.getBBox(!0);h.remove();var h=a.print(0,0,b.slice(g,g+1),c,d,"middle",e),j=h.getBBox(!0);h.remove(),i.x=i.x+i.width-j.width,i.width=j.width,i.y=j.y,i.height=j.height,f.push(i)}for(h=f[0].x,g=0;g<f.length;g++)f[g].x-=h},this.getMetrics=function(){return f},this.init()},getRadious=function(a,b,c){var d=a=a/2-b/2,e=a*(2*Math.abs(c)*Math.PI/360);return 2*(d+b/2)>e&&(a=2*(d+b/2)/(2*Math.abs(c)*Math.PI/360),e=2*c*Math.PI/360*a),e>2*(d+b/2)&&(a=2*(d+b/2)/(2*Math.abs(c)*Math.PI/360)),a},arc=function(a,b,c,d){for(a[0]=parseFloat(a[0]),a[1]=parseFloat(a[1]),angle=c,coords=toCoords(a,b,angle),path="M "+coords[0]+" "+coords[1];angle<=d;)coords=toCoords(a,b,angle),path+=" L "+coords[0]+" "+coords[1],angle+=1;return path},toCoords=function(a,b,c){var d=c/180*Math.PI;return c=a[0]+Math.cos(d)*b,a=a[1]+Math.sin(d)*b,[c,a]},{name:"textShape",elementTransition:function(a){t(a.elems)&&(G=svgCanvas.getMode())},selectedChanged:function(a){$j(".textFontSizePanel").hide();var b=a.elems,c=t(b);if($j("#textShapeDiv").hide(),$j("#font_shape_caption").hide(),c){E=svgCanvas.getStrokedBBox(c);for(var d=0;d<c.length;d++){var e,f=svgCanvas.getRotationAngle(c[d]);e=f?C(c[d]):svgCanvas.getStrokedBBox([c[d]]),c[d].setAttribute("elemBBoxWidth",e.width),c[d].setAttribute("elemBBoxHeight",e.height)}if(1==b.length&&"text"==b[0].getAttribute("type")&&"true"!=b[0].getAttribute("lock")){{c[0]}this.showTextPanel()}}},textChanged:function(){var a=svgCanvas.getSelectedElems(),b=t(a);if(b&&1==a.length&&"text"==a[0].getAttribute("type")){$j("#textShapeDiv").hide(),$j("#font_shape_caption").hide(),$j("#lineSpaceDiv").hide(),$j("#text_size_box .textalignmentpanel").hide(),$j("#text_size_box .textlinespacepanel").hide();var c=b[0];1==c.getElementsByTagName("path").length?($j("#textShapeDiv").show(),$j("#font_shape_caption").show()):($j("#lineSpaceDiv").show(),$j("#text_size_box .textalignmentpanel").show(),$j("#text_size_box .textlinespacepanel").show())}},elementChanged:function(){var a=svgCanvas.getSelectedElems(),b=t(a);if(b){if("resize"==G){for(var c=0;c<b.length;c++){var d=svgCanvas.getRotationAngle(b[c]);if(bbox=d?C(b[c]):svgCanvas.getStrokedBBox([b[c]]),E=parseFloat(b[c].getAttribute("elemBBoxWidth")),F=parseFloat(b[c].getAttribute("elemBBoxHeight")),Q){var e=b[c].getAttribute("xscale")?parseFloat(b[c].getAttribute("xscale")):1,f=b[c].getAttribute("yscale")?parseFloat(b[c].getAttribute("yscale")):1;b[c].setAttribute("xscale",e*(bbox.width/E)),b[c].setAttribute("yscale",f*(bbox.height/F)),b[c].getAttribute("xscale")==b[c].getAttribute("yscale")&&(b[c].setAttribute("xscale",1),b[c].setAttribute("yscale",1),b[c].setAttribute("font-size",b[c].getAttribute("font-size")*(bbox.width/E)))}else b[c].setAttribute("font-size",b[c].getAttribute("font-size")*(bbox.width/E));b[c].setAttribute("elemBBoxWidth",bbox.width),b[c].setAttribute("elemBBoxHeight",bbox.height)}E=bbox,G=""}if(1==a.length&&"text"==a[0].getAttribute("type")&&"true"!=a[0].getAttribute("lock")){var g=b[0];svgEditor.paintBox.fill.paint&&g.setAttribute("fill",svgEditor.paintBox.fill.paint.solidColor),$j("#stroke_slider").slider("value",A(g)),$j("#stroke_width").val(A(g)),$j(".currentFontSize").html(svgEditor.uiStrings.elementLabel.currentFontSize+": "+Math.round(100*g.getAttribute("font-size"))/100);var h=$j(".textFontSizePanel .shape_con").find("button");h.removeClass("selected");for(var c=0;c<h.length;c++)if(h[c].value==g.getAttribute("font-size")){$j(h[c]).addClass("selected");break}}}},zoomChanged:function(){},toolReady:function(){$j("#btnAddText").off("click"),$j("#text").off("keyup"),$j("#text_align_left").off("click"),$j("#text_align_center").off("click"),$j("#text_align_right").off("click"),$j("#btnAddText").on("click",m),$j("#text").on("input",l),$j("#text_align_left").on("click",s),$j("#text_align_center").on("click",s),$j("#text_align_right").on("click",s),$j("#tool_bold").on("click",q),$j("#tool_italic").on("click",r)},fontInitiated:function(){svgedit.browser.isTouch()&&0==svgedit.browser.isIOS()?$j(".font-item").on("touchstart",p):$j(".font-item").on("click",p)},toolButtonStateUpdate:function(){},mouseDown:function(){},setDirection:function(a){O=a,$j("#text")[0].style.direction=a},getTextStrokeWidth:function(a){return A(a)},updateBoldItalic:function(a){o(a)},isTextSelected:function(a){return a=a||svgCanvas.getSelectedElems(),t(a)?!0:!1},hasBold:function(){return L},hasItalic:function(){return M},getShapeObject:function(a,b){for(var c=0;c<P.length&&P[c][a]!=b;c++);return P[c]},isImproportionate:function(){return Q},changeText:function(a,b){var c=Raphael.fonts[a.getAttribute("font-family")];c?(o(a.getAttribute("font-family")),n(null,a,b)):(showLoader(),$j.getScript(Smm.fontDirectory+fontData[a.getAttribute("font-family")].jsFile).done(function(){hideLoader(),o(a.getAttribute("font-family")),n(null,a,b)}).fail(function(){hideLoader(),$j.alert("Sorry!! this font is not available.")}))},showTextPanel:function(){$j("#objectColorCaption").hide(),disableOther("addtext"),handleTextPanel(),$j("#addtext-panel").addClass("cbp-spmenu-open"),"producttool"==toolType||$j("#common-panel").css("margin-top","120px"),$j("#tool_group,#tool_ungroup").hide(),$j("#common-panel").addClass("cbp-spmenu-open"),manageCommonPanel(),$j("#text_panel").css("display","inline"),$j("#text_popup").css("display","none"),$j("#btnAddText").hide(),$j("#tool_font_family").show(),$j(".textFontSizePanel").show(),$j("#text_size_box").show(),$j(".multiColorBlock").hide(),$j(".singleColor").show(),$j(".font-size").show();var a=t();if(a&&1==a.length){var b=a[0];$j("#lineSpaceDiv").hide(),1==b.getElementsByTagName("path").length?($j("#textShapeDiv").show(),$j("#font_shape_caption").show(),disableFeatures(textShapeDiv),$j("#text_size_box .textalignmentpanel").hide(),$j("#text_size_box .textlinespacepanel").hide()):($j("#lineSpaceDiv").show(),$j("#text_size_box .textalignmentpanel").show(),$j("#text_size_box .textlinespacepanel").show())}},addText:function(a){var b,c;if("producttool"==toolType)b=design_area_width[curSide]/2,c=design_area_height[curSide]/2;else{var d=getSize();b=parseFloat(d[0])*svgedit.units.getTypeMap()[svgEditor.curConfig.baseUnit]*.5,c=parseFloat(d[1])*svgedit.units.getTypeMap()[svgEditor.curConfig.baseUnit]*.5}var e=svgCanvas.getStrokedBBox([a[0]]);e&&(b=e.x,c=e.y);var f=a.attr("font-family"),g=parseFloat(a.attr("font-size")),h=a.attr("fill")||"000000",i=a.attr("stroke")||"1",j=a.attr("stroke-width")||"0",k=a.attr("stroke-dasharray")||"none",l=a.attr("text-anchor")||"start",m=a.attr("font-weight")||"normal",o=a.attr("font-style")||"normal",p=(a.attr("shapeId")||"0",a.attr("shapeVal")||"0"),q=a.attr("lineHeight")||"1",r=svgCanvas.addSvgElementFromJson({element:"g",attr:{id:svgCanvas.getNextId(),type:"text",text:a.text(),"font-size":g,"font-family":f,fill:h,stroke:i,"stroke-width":parseFloat(j),"stroke-dasharray":k,"text-anchor":l,"font-weight":m,"font-style":o,lineHeight:parseInt(q),shapeId:parseInt(p),shapeVal:parseFloat(p),style:"pointer-events:inherit"}});D.clear();for(var s=D.printArray(b,c,a.text(),f,h,g,l,m,o,null,q,r.getAttribute("fixedWidth"),r.getAttribute("xscale"),r.getAttribute("yscale")),t=0;t<s.length;t++){var u=svgCanvas.addSvgElementFromJson({element:"path",attr:{id:svgCanvas.getNextId(),fill:"#"+h,stroke:i,"stroke-width":parseFloat(j),"stroke-dasharray":k,d:s[t].node.getAttribute("d"),transform:s[t].node.getAttribute("transform"),style:"pointer-events:inherit"}});r.appendChild(u)}var v=svgCanvas.getStrokedBBox([r]);r.setAttribute("font-size",parseFloat(r.getAttribute("font-size"))*(e.width/v.width)),n(null,r,a.text()),v=svgCanvas.getStrokedBBox([r]);var w=e.x-v.x,x=e.y-v.y;svgCanvas.moveSelectedElements(w*svgCanvas.getZoom(),x*svgCanvas.getZoom(),!1,[r])}}}),svgEditor.addExtension("pickDesignColor",function(){function a(){$j(".border_colorpicker").append('<div><input type="button" class="DesignColor" value="'+svgEditor.uiStrings.elementLabel.PickColorButtonCaption+'"/></div>'),$j(".DesignColor").on("click",b)}function b(){var a,b=convertSvgDimentionToPx(svgCanvas.getSvgString());a="producttool"==toolType?curSide-1:Navigation.getCurPage();var c=(new Date).getTime();showLoader(),$j.ajax({type:"POST",url:generatePreviewPngUrl,cache:!1,data:"svg="+encodeURIComponent(b)+"&side="+a+"&current_time="+c+"&form_key="+formkey+"&action=pickcolor",success:function(a){$j("#pickDesignColor_window").show();var b=new Image;b.onload=function(){var a=b.width/b.height;b.width>b.height?b.width>500&&(b.width=500,b.height=b.width/a,b.height>400&&(b.height=400,b.width=a*b.height)):b.height>400&&(b.height=400,b.width=a*b.height,b.width>500&&(b.width=500,b.height=b.width/a)),d.width=b.width,d.height=b.height,d.getContext("2d").drawImage(b,0,0,b.width,b.height),hideLoader()},b.src="producttool"==toolType?basepath+a:mediapath+"cartimages/"+a},error:function(){$j.alert("error in saving"),hideLoader()}})}function c(a){var b=0,c=0;if(a.offsetParent){do b+=a.offsetLeft,c+=a.offsetTop;while(a=a.offsetParent);return{x:b,y:c}}return void 0}var d,e;return $j(document).ready(function(){d=$j("#pickDesignColorCanvas")[0],d.onmouseup=function(a){var b=c(this),f=a.pageX-b.x,g=a.pageY-b.y;e=d.getContext("2d").getImageData(f,g,1,1).data,$j("#pickDesignColor_window .colorSwatch").css("background-color","rgb("+e[0]+","+e[1]+","+e[2]+")")
},d.onmousemove=function(a){var b=c(this),e=a.pageX-b.x,f=a.pageY-b.y,g=d.getContext("2d").getImageData(e,f,1,1).data;$j("#pickDesignColor_window .colorSwatchMouseMove").css("background-color","rgb("+g[0]+","+g[1]+","+g[2]+")")},$j("#pickDesignColorButton")[0].onclick=function(){if(e){$j("#pickDesignColor_window").hide();var a=strPad(e[0].toString(16),2,"0",!0),b=strPad(e[1].toString(16),2,"0",!0),c=strPad(e[2].toString(16),2,"0",!0),d=a+""+b+c;console.log(d),$j.farbtastic("#colorpicker").setColor("#"+d)}},a()}),{name:"pickDesignColor",pickerOpen:function(){setTimeout(a,100)}}}),svgEditor.addExtension("Flip tools",function(){function a(a){for(var d,e=c.length;e--;){var f=c[e];if(f){var g=0;g=svgCanvas.getRotationAngle(f),g&&svgCanvas.setRotationAngle(0,!0,f);var h,i=f.getAttribute("transform"),j=svgCanvas.getStrokedBBox([f]),k=(f.getBoundingClientRect(),j.x),l=j.y;if("-"==a){if(i&&"image"==f.nodeName){d=b(i),h="scale("+-1*d[0]+","+d[3]+")";var k=-1*parseFloat(f.getAttribute("x"))-parseFloat(f.getAttribute("width"));return f.setAttribute("x",k),d[0]=-1*d[0],f.setAttribute("transform","matrix("+d.join(" ")+")"),svgCanvas.recalculateDimensions(f),g&&svgCanvas.setRotationAngle(g,!0,f),void svgCanvas.runExtensions("elementChanged")}h="scale(-1,1)",k+=j.width/2}else{if(i&&"image"==f.nodeName){d=b(i),h="scale("+d[0]+","+-1*d[3]+")";var l=-1*parseFloat(f.getAttribute("y"))-parseFloat(f.getAttribute("height"));return f.setAttribute("y",l),d[3]=-1*d[3],f.setAttribute("transform","matrix("+d.join(" ")+")"),svgCanvas.recalculateDimensions(f),g&&svgCanvas.setRotationAngle(g,!0,f),void svgCanvas.runExtensions("elementChanged")}h="scale(1,-1)",l+=j.height/2}if(f.setAttribute("transform","translate("+k+","+l+") "+h+" translate("+-k+","+-l+")"),svgCanvas.recalculateDimensions(f),i){var m=(svgedit.utilities.getBBox(f),/rotate\(([-+]?\d*(?:\.\d+)?)\,\s*([-+]?\d*(?:\.\d+)?)\,\s*([-+]?\d*(?:\.\d+)?)\)/i),n=i.match(m);if(console.log("m"),console.log(n),console.log(i),n){var o="rotate("+(0-parseFloat(n[1]))+", "+n[2]+", "+n[3]+")";f.setAttribute("transform",i.replace(m,o))}else if(i.indexOf("rotate(")>-1){var p=i.indexOf("rotate("),o=i.substr(p,i.indexOf(")",p)+1);f.getAttribute("transform")?f.setAttribute("transform",f.getAttribute("transform")+" "+o):f.setAttribute("transform",o)}else f.setAttribute("transform",i);svgCanvas.recalculateDimensions(f)}}}g&&svgCanvas.setRotationAngle(g,!1,f),svgCanvas.selectorManager.requestSelector(f).resize(),svgCanvas.runExtensions("elementChanged")}function b(a){var b="1 0 0 1 0 0",c=b.split(" "),d=0;if(a.indexOf("matrix(")>-1)for(;a.indexOf("matrix(",d)>=0;){d=a.indexOf("matrix(",d),d+=7;var e=a.substring(d,a.indexOf(")",d)),f=e.split(" ");c[0]*=parseFloat(f[0]),c[3]*=parseFloat(f[3]),c[4]=parseFloat(f[4]),c[5]=parseFloat(f[5])}return c}$j(document).ready(function(){svgedit.browser.isTouch()&&0==svgedit.browser.isIOS()?($j("#tool_flipHoriz").on("touchstart",function(){a("-")}),$j("#tool_flipVert").on("touchstart",function(){a("|")})):($j("#tool_flipHoriz").on("click",function(){a("-")}),$j("#tool_flipVert").on("click",function(){a("|")}))});var c,d=function(a){a?$j("#tool_flipHoriz,#tool_flipVert").show():$j("#tool_flipHoriz,#tool_flipVert").hide()};return{name:"Flip tools",selectedChanged:function(a){var b=svgCanvas.getMode();if(c=a.elems,c.length&&"pathedit"!=b){var e=!0;if(c.length>1)e=!1;else for(var f=0;f<c.length;f++){if("true"==c[f].getAttribute("lock")||"true"==c[f].getAttribute("lockTransform")){e=!1;break}if("photobox"==c[f].getAttribute("type")){e=!1;break}}svgCanvas.getPrivateMethods().extensions.textShape&&svgCanvas.getPrivateMethods().extensions.textShape.isTextSelected()&&(e=!1),d(e)}else d(!1)},setSelElems:function(a){c=a},getSelElems:function(){return c}}}),svgEditor.addExtension("imageEffect",function(){function a(a){a.preventDefault();var b=svgCanvas.getSelectedElems()[0];c(b)}function b(a,b,c,d){imageObj=a.childNodes[0].childNodes[0];var e=svgCanvas.getPrivateMethods().extensions.imageEffect.getProportionalWidthHeight(c,d,imageObj.getAttribute("width"),imageObj.getAttribute("height"));svgCanvas.setHref(imageObj,b),imageObj.setAttribute("width",e[0]),imageObj.setAttribute("height",e[1]),imageObj.setAttribute("origWidth",c),imageObj.setAttribute("origHeight",d),imageObj.getAttribute("templateSrc")==b?imageObj.setAttribute("isAdminUploaded","true"):imageObj.setAttribute("isAdminUploaded","false"),ub(),svgCanvas.runExtensions("elementChanged",{elems:[a]})}function c(a){if("true"==a.getAttribute("lockTransform")&&"admin"!=user){if(a.childNodes[0].getAttribute("templateSrc")){var c=a.childNodes[0].childNodes[0].getAttribute("templateSrc"),d=new Image;d.onload=function(d){b(a,c,d.target.naturalWidth,d.target.naturalHeight),svgCanvas.getPrivateMethods().extensions.undoRedo&&svgCanvas.getPrivateMethods().extensions.undoRedo.addToStack()},d.src=c}}else $j.confirm(svgEditor.uiStrings.notification.QwantToDelete,function(a){a&&(svgCanvas.deleteSelectedElements(),svgCanvas.runExtensions("elementRemoved"))})}function d(a){a.preventDefault(),handleSocialMediaGallery(),$j("#images_loaded").show(),$j("#images-upload").show(),$j("#flickerresult").show(),$j(".qrcode-section").hide(),$j("#uploader").hide(),$j("#gallery_warn_msg_con").hide(),$j("#galleryBtn").trigger("click"),$j("#flickerresult").children().length>0||$j("#gallery_warn_msg_con").show()}function e(a){var b,c,d,e;if("g"==a.tagName&&a.getAttribute("type")==gb.photoBox){var f=a.childNodes[1],g=f.getAttribute("shapeType");b=ib[g],c=a.childNodes[0].childNodes[0].getAttribute("filter"),console.log("type="+c),d=svgCanvas.getHref(a.childNodes[0].childNodes[0])}else"image"==a.tagName&&(c=a.getAttribute("filter"),console.log("elem="+c),d=svgCanvas.getHref(a));c?(c=c.replace(/"/g,""),console.log("Somin_filter = "+c),c=c.substring(5,c.indexOf(")")),console.log("filter_somin "+c),console.log("type="+svgCanvas.getElem(c).getAttribute("type")),c=svgCanvas.getElem(c)?svgEditor.uiStrings.elementLabel[svgCanvas.getElem(c).getAttribute("type")]:"none",console.log("1 filter")):c="none",console.log("filter+"+c),b=b?'<div class="mask-shape"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"><svg viewBox="-25 -15 168 168"><path fill="none" stroke="#000000" stroke-width="5" d="'+b+'"/></svg></svg></div>':"<div class='mask-shape'>none</div>",R.html('<div class="mask-caption-label">'+svgEditor.uiStrings.elementLabel.MaskCaption+" </div>"+b),S.html('<div class="mask-caption-label">'+svgEditor.uiStrings.elementLabel.EffectCaption+" </div>"+c),d&&(e=getExtension(d)),"svg"==e||"true"==a.getAttribute("lockEdit")?(T.hide(),Q.hide()):T.show()}function f(a,b){var c=V.getAttribute("colors").split(",");c[b]=a.substring(1),V.setAttribute("colors",c.join(","));var d=parseInt(a.substr(1,2),16),e=findDefs(U[0]),f=$j(e).find("feFuncR[type='table']")[0],g=f.getAttribute("tableValues").split(" ");g[b]=d/255,1==g.length&&g.push(d/255),f.setAttribute("tableValues",g.join(" "));var h=parseInt(a.substr(3,2),16),i=$j(e).find("feFuncG[type='table']")[0],g=i.getAttribute("tableValues").split(" ");g[b]=h/255,1==g.length&&g.push(h/255),i.setAttribute("tableValues",g.join(" "));var j=parseInt(a.substr(5,2),16),k=$j(e).find("feFuncB[type='table']")[0],g=k.getAttribute("tableValues").split(" ");g[b]=j/255,1==g.length&&g.push(j/255),k.setAttribute("tableValues",g.join(" "))}function g(a){var b=$j("<div class='ie_colorChanger_picker'>");$j("#ie_colorChanger .colorCon").append(b);for(var c=0;a>c;c++){var d='<div class="color_block_parent" style="display:none;">';d+='<div><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" width="22" height="25" xmlns:xlink="http://www.w3.org/1999/xlink" class="svg_icon"><svg xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">		  <line fill="none" stroke="#d40000" id="svg_90" y2="24" x2="24" y1="0" x1="0"/>		  <line id="svg_92" fill="none" stroke="#d40000" y2="24" x2="0" y1="0" x1="24"/>	</svg></svg></div>',d+='<div id="'+ob+nb.length+'" class="color_block"></div></div>',b.append($j(d));var e=$j(this).attr("fill");null==e&&(e=getDefaultColor());var f=$j("#"+ob+nb.length);nb[nb.length]=new sb("#"+f[0].id,e),f.click(function(){"full"==pickerMode?qb($j(this)):"printable"==pickerMode&&rb($j(this),printableColorList)})}}function h(a){var b=V.parentNode.parentNode;if(2==b.childNodes.length){var c=b.childNodes[1];c.setAttribute("stroke",a)}}function i(a){var b=a.target.options[a.target.selectedIndex].value,c=V.parentNode.parentNode;if(2==c.childNodes.length){var d=c.childNodes[1];d.setAttribute("stroke-dasharray",b)}}function j(a){var b=V.parentNode.parentNode;if(2==b.childNodes.length){var c=b.childNodes[1];c.setAttribute("stroke-width",a)}$j("#ie_strokeSlider_label").val(a)}function k(a){l(a.target,a.target.id.substring(6))}function l(a,b){var c=a.value;U.find("filter").length&&U.find("filter").remove();var d;d=$j(a).parent().find("filter"),d.length?(findDefs(U[0]).appendChild(d[0].cloneNode(!0)),V.setAttribute("filter","url(#"+b+")")):V.removeAttribute("filter");for(var e=0;e<nb.length;){if(c>e){nb[e].container.parent().show();var g=nb[e].paint,h=g[g.type];"none"!=h&&-1==h.indexOf("#")&&(h="#"+h),f(h,e)}else nb[e].container.parent().hide();e++}}function m(a){$j("#ie_colorpicker").hide(),$j("#ie_shapes").hide(),$j("#ie_filters").hide(),$j("#ie_colorChanger").hide(),$j("#tabShapes").removeClass("active"),$j("#tabFilters").removeClass("active"),$j("#tabColors").removeClass("active"),"tabShapes"==a.currentTarget.id?($j("#ie_shapes").show(),$j("#tabShapes").addClass("active")):"tabFilters"==a.currentTarget.id?($j("#ie_filters").show(),$j("#tabFilters").addClass("active")):"tabColors"==a.currentTarget.id&&($j("#ie_colorChanger").show(),$j("#tabColors").addClass("active"))}function n(){var a=V.parentNode;a.removeAttribute("clip-path"),Y.hide(),2==a.parentNode.childNodes.length&&a.parentNode.removeChild(a.parentNode.childNodes[1])}function o(){V.removeAttribute("filter")}function p(){var a=svgCanvas.getRotationAngle(cb);a&&svgCanvas.setRotationAngle(0,!0,cb);var b,c=svgedit.utilities.getBBox(cb),d=cb.id,e=V.parentNode.parentNode;if(V.parentNode.getAttribute("clip-path")&&""!=V.parentNode.getAttribute("clip-path")){b=e.cloneNode(!0);var f=U.find("clipPath")[0].cloneNode(!0);f.id=svgCanvas.getNextId(),svgCanvas.findDefs().appendChild(f),b.childNodes[0].setAttribute("clip-path","url(#"+f.id+")"),b.childNodes[1].id=svgCanvas.getNextId(),b.childNodes[0].childNodes[0].id=svgCanvas.getNextId(),b.setAttribute("pathStr",b.childNodes[1].getAttribute("d"))}else if(b=V.cloneNode(!0),"g"==cb.tagName){var g=cb.childNodes[0].getAttribute("clip-path");if(g&&""!=g){var h=g.substring(5,g.indexOf(")")),i=svgCanvas.getElem(h),j=svgCanvas.findDefs();i&&i.parentNode==j&&j.removeChild(i)}}var k=svgCanvas.getZoom(),l=V.getAttribute("filter");if(l){l=l.replace(/"/g,""),l=l.substring(5,l.indexOf(")"));var m=U.find("filter")[0],n=m.getAttribute("type");console.log("Somin filter"),console.log(m),console.log("type"),console.log(n),console.log("filterId"),console.log(l);var o;if(kb[l]){var p;if(console.log("selectedElem.tagName"),console.log(cb.tagName),p="g"==cb.tagName?cb.childNodes[0].childNodes[0].getAttribute("filter"):cb.getAttribute("filter")){p=p.replace(/"/g,""),p=p.substring(5,p.indexOf(")"));var r=p.split("_")[1];if(kb[r]){var s=svgCanvas.getElem(p);s&&s.parentNode.removeChild(s)}}o=m.cloneNode(!0),o.id=svgCanvas.getNextId(),svgCanvas.findDefs().appendChild(o)}else q(n)?o=q(n):(o=m.cloneNode(!0),console.log("oldFilterId"),console.log(o),o.id=svgCanvas.getNextId(),svgCanvas.findDefs().appendChild(o));"g"==b.tagName?b.childNodes[0].childNodes[0].setAttribute("filter","url(#"+o.id+")"):b.setAttribute("filter","url(#"+o.id+")")}b.setAttribute("lockTransform",cb.getAttribute("lockTransform")),b.setAttribute("lockEdit",cb.getAttribute("lockEdit")),cb.parentNode.replaceChild(b,cb),b.setAttribute("id",d),svgCanvas.selectOnly([b]);var t=svgedit.utilities.getBBox(b),u=c.width/t.width,v=t.x*k,w=t.y*k;b.setAttribute("transform","translate("+v+","+w+") scale("+u+") translate("+-1*v+","+-1*w+")"),svgCanvas.recalculateDimensions(b),V.parentNode.getAttribute("clip-path")&&""!=V.parentNode.getAttribute("clip-path")&&H(b.childNodes[0]),t=svgedit.utilities.getBBox(b),svgCanvas.moveSelectedElements((c.x-t.x)*k,(c.y-t.y)*k,!1),a&&svgCanvas.setRotationAngle(a,!0,b),svgCanvas.selectorManager.requestSelector(b).resize(),"true"==b.getAttribute("lockTransform")&&"admin"!=user&&svgCanvas.selectorManager.requestSelector(b).showGrips(!1),svgCanvas.getPrivateMethods().extensions.ShowObjectSize&&svgCanvas.getPrivateMethods().extensions.ShowObjectSize.displaySize(),$j("#imageEffect_window").hide(),svgCanvas.getPrivateMethods().extensions.undoRedo&&(svgCanvas.getPrivateMethods().extensions.undoRedo.isAddToStack(!0),svgCanvas.getPrivateMethods().extensions.undoRedo.addToStack())}function q(a){for(var b=null,c=svgCanvas.findDefs(),d=c.getElementsByTagName("filter"),e=0;e<d.length;e++)if(d[e].getAttribute("type")==a){b=d[e];break}return b}function r(){$j("#imageEffect_window").hide(),svgCanvas.getPrivateMethods().extensions.undoRedo&&svgCanvas.getPrivateMethods().extensions.undoRedo.isAddToStack(!0)}function s(a){return mb=!0,W=a.pageX,X=a.pageY,$j(document).bind("mouseup",u),$j(document).bind("mousemove",{objToMove:Y},t),svgedit.browser.isTouch()&&$j(document).bind("touchmove",D),!1}function t(a){if(mb){var b=a.pageX-W,c=a.pageY-X;W=a.pageX,X=a.pageY;var d,e=V.parentNode.parentNode,f=$j(e).find("path")[0],g=f.getAttribute("d");g&&""!=g&&(d=Raphael.pathBBox(g));var h=(d.width+b)/d.width,i=(d.height+c)/d.height;if(fb[0].checked&&(h=i=Math.min(h,i)),d.width*h>10&&d.height*i>10){Y.css("top",parseFloat(Y.css("top"))+c+"px"),Y.css("left",parseFloat(Y.css("left"))+b+"px");var j="translate("+d.x+","+d.y+") ";j+="scale("+h+","+i+") ",j+="translate("+-1*d.x+","+-1*d.y+")",f.setAttribute("transform",j),svgCanvas.recalculateDimensions(f),H(V.parentNode)}return fb[0].checked&&G(),!1}}function u(){mb=!1,$j(document).unbind("mouseup",u),$j(document).unbind("mousemove",t),svgedit.browser.isTouch()&&$j(document).unbind("touchmove",D),L(0)}function v(a){B(a.data.shapeType)}function w(a){console.log(a),A(a.currentTarget,a.data.filterType)}function x(){svgCanvas.getPrivateMethods().extensions.undoRedo&&svgCanvas.getPrivateMethods().extensions.undoRedo.isAddToStack(!1),cb=svgCanvas.getSelectedElems()[0],"image"==cb.tagName&&cb.parentNode.parentNode&&"photobox"==cb.parentNode.parentNode.getAttribute("type")&&(svgCanvas.selectorManager.releaseSelector(cb),svgCanvas.setSelectedElems([cb.parentNode.parentNode]),cb=svgCanvas.getSelectedElems()[0],svgCanvas.selectorManager.requestSelector(cb).resize()),$j("#imageEffect_window").show(),eb.slider("value",0),$j("#ie_strokeSlider_label").val(0),$j("#ie_stroke_style")[0].selectedIndex=0;var a=new $j.jGraduate.Paint({solidColor:"000000"});db.setPaint(a);var b,c,d;if("g"==cb.tagName){var e=cb.childNodes[0].childNodes[0],f=(svgedit.utilities.getBBox(e),svgCanvas.getZoom(),cb.childNodes[1].cloneNode(!0));d=z(e),f.setAttribute("d",cb.getAttribute("pathStr")),V.setAttribute("width",d[0]),V.setAttribute("height",d[1]),b=svgCanvas.getHref(e);var g=U.find("clipPath")[0],h=V.parentNode;if(!g){{J()}g=U.find("clipPath")[0]}h.setAttribute("clip-path","url(#"+g.id+")"),$j(g).empty(),f.id="ie_path",g.appendChild(f);var i=f.cloneNode(!0);2==h.parentNode.childNodes.length&&h.parentNode.removeChild(h.parentNode.childNodes[1]),h.parentNode.appendChild(i),$j(i).on("mousedown",C);var j=i.getAttribute("stroke-width")?parseInt(i.getAttribute("stroke-width")):1;eb.slider("value",j),$j("#ie_strokeSlider_label").val(j);var a=new $j.jGraduate.Paint({solidColor:i.getAttribute("stroke").substr(1)});db.setPaint(a);var k=i.getAttribute("stroke-dasharray");k?$j("#ie_stroke_style").val(k):$j("#ie_stroke_style")[0].selectedIndex=0,V.setAttribute("origWidth",e.getAttribute("origWidth")),V.setAttribute("origHeight",e.getAttribute("origHeight")),V.setAttribute("image_id",e.getAttribute("image_id")),e.getAttribute("templateSrc")&&(V.setAttribute("templateSrc",e.getAttribute("templateSrc")),V.setAttribute("isAdminUploaded",e.getAttribute("isAdminUploaded"))),c=e.getAttribute("filter"),Y.show()}else{var h=V.parentNode;h.removeAttribute("clip-path"),Y.hide(),2==h.parentNode.childNodes.length&&h.parentNode.removeChild(h.parentNode.childNodes[1]),b=svgCanvas.getHref(cb),V.setAttribute("origWidth",cb.getAttribute("origWidth")),V.setAttribute("origHeight",cb.getAttribute("origHeight")),V.setAttribute("image_id",cb.getAttribute("image_id")),cb.getAttribute("templateSrc")&&(V.setAttribute("templateSrc",cb.getAttribute("templateSrc")),V.setAttribute("isAdminUploaded",cb.getAttribute("isAdminUploaded"))),d=z(cb),V.setAttribute("width",d[0]),V.setAttribute("height",d[1]),c=cb.getAttribute("filter"),$j("#ie_strokeSlider_label").val("0")}svgCanvas.setHref(V,b);var l=(350-d[1])/2,m=(500-d[0])/2;$j(".imageeffectpreviw svg").css("top",l+"px"),$j(".imageeffectpreviw svg").css("left",m+"px");var n=U.offset(),o=$j("#imageEffect_window .window_container").offset();Z=n.left-o.left,_=n.top-o.top,G();var p=$j("#ie_filters svg");if(p.find("image").each(function(a,c){svgCanvas.setHref(c,b)}),c){c=c.replace(/"/g,""),c=c.substring(5,c.indexOf(")"));var q=svgCanvas.getElem(c);if(q){U.find("filter").length&&U.find("filter").remove();var r=q.cloneNode(!0);r.id=svgCanvas.getNextId();var s=findDefs(U[0]);s.appendChild(r);var t=r.getAttribute("type");if(t.indexOf("twoColor")>-1||t.indexOf("oneColor")>-1){var u=$j(s).find("feFuncR[type='table']")[0],v=u.getAttribute("tableValues").split(" "),w=$j(s).find("feFuncG[type='table']")[0],x=w.getAttribute("tableValues").split(" "),A=$j(s).find("feFuncB[type='table']")[0],B=A.getAttribute("tableValues").split(" ");if(t.indexOf("twoColor")>-1){r.id="twoColor",$j("#radio_twoColor")[0].checked=!0;var D=y(v[0])+""+y(x[0])+y(B[0]),E=y(v[1])+""+y(x[1])+y(B[1]),a=new $j.jGraduate.Paint({solidColor:D});nb[0].setPaint(a),nb[0].container.parent().show(),a=new $j.jGraduate.Paint({solidColor:E}),nb[1].setPaint(a),nb[1].container.parent().show(),V.setAttribute("colors",D+","+E)}else if(t.indexOf("oneColor")>-1){r.id="oneColor",$j("#radio_oneColor")[0].checked=!0;var D=y(v[0])+""+y(x[0])+y(B[0]),a=new $j.jGraduate.Paint({solidColor:D});nb[0].setPaint(a),nb[0].container.parent().show(),nb[1].container.parent().hide(),V.setAttribute("colors",D)}}else $j("#radio_original")[0].checked=!0,nb[0].container.parent().hide(),nb[1].container.parent().hide();V.setAttribute("filter","url(#"+r.id+")")}}else V.removeAttribute("filter"),V.setAttribute("colors",""),$j("#radio_original")[0].checked=!0,nb[0].container.parent().hide(),nb[1].container.parent().hide()}function y(a){var b=Math.floor(255*a).toString(16);return 1==b.length?"0"+b:b}function z(a,b,c){b=b||parseFloat(a.getAttribute("width")),c=c||parseFloat(a.getAttribute("height"));var d=parseFloat(U.attr("width")),e=parseFloat(U.attr("height")),f=b/c;return b>c?(b=d,c=b/f,c>e&&(c=e,b=c*f)):(c=e,b=c*f,b>d&&(b=d,c=b/f)),[b,c]}function A(a){U.find("filter").length&&U.find("filter").remove();var b=$j(a).find("filter"),c=b[0].cloneNode(!0);c.id=svgCanvas.getNextId(),findDefs(U[0]).appendChild(c),V.setAttribute("filter","url(#"+c.id+")")}function B(a){var b=ib[a],c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("d",b),c.setAttribute("id","ie_path"),c.setAttribute("opacity",1),c.setAttribute("stroke","#000000"),c.setAttribute("shapeType",a),tb(c)}function C(a){mb=!0,W=a.pageX,X=a.pageY;var b=V.parentNode.parentNode;return $j(document).bind("mouseup",F),$j(document).bind("mousemove",{objToMove:$j(b).find("path")[0]},E),svgedit.browser.isTouch()&&$j(document).bind("touchmove",D),!1}function D(a){a.preventDefault()}function E(a){if(mb){var b=a.pageX-W,c=a.pageY-X,d=a.data.objToMove;return svgCanvas.moveSelectedElements(b/5,c/5,!1,[d]),W=a.pageX,X=a.pageY,H(V.parentNode),G(),!1}}function F(){mb=!1,$j(document).unbind("mouseup",F),$j(document).unbind("mousemove",E),svgedit.browser.isTouch()&&$j(document).unbind("touchmove",D),L(0)}function G(){var a=V.parentNode.parentNode,b=$j(a).find("path")[0];if(b){var c,d=b.getAttribute("d");d&&""!=d&&(c=Raphael.pathBBox(d)),c&&(Y.css("left",Z+c.x+c.width+"px"),Y.css("top",_+c.y+c.height+"px"))}}function H(a){var b=I(a);if(b){var c=b.childNodes[0];b.replaceChild(a.parentNode.childNodes[1].cloneNode(!0),c),b.childNodes[0].setAttribute("id","")}}function I(a){var b=a.getAttribute("clip-path");if(b&&""!=b){b=b.replace(/"/g,"");var c=b.substring(5,b.indexOf(")"));return $j("#"+c)[0]}return null}function J(a){var b;return U.find("clipPath").length?(b=U.find("clipPath")[0],$j(b).empty()):(b=document.createElementNS("http://www.w3.org/2000/svg","clipPath"),b.setAttribute("class","clippath"),b.setAttribute("id","ie_"+svgCanvas.getNextId()),findDefs(U[0]).appendChild(b)),a&&b.appendChild(a),b.id}function K(){$j("#common-panel").addClass("cbp-spmenu-open"),$j("#tool_fill,#border_box").hide()}function L(a){if(svgedit.browser.isIE()){var b=I(V.parentNode);V.parentNode.removeAttribute("clip-path"),setTimeout(M,a,b)}}function M(a,b){b=b||V.parentNode,b.setAttribute("clip-path",'url("#'+a.id+'")')}function N(){$j("#imageEffectCaptoin")[0].innerHTML=svgEditor.uiStrings.elementLabel.imageEffectCaption,$j("#ie_filters span")[0].innerHTML=svgEditor.uiStrings.elementLabel.original,$j("#ie_filters svg title")[0].innerHTML=svgEditor.uiStrings.elementLabel.original;var a=1;for(var b in jb)$j("#ie_filters span")[a].innerHTML=svgEditor.uiStrings.elementLabel[b],$j("#ie_filters svg title")[a].innerHTML=svgEditor.uiStrings.elementLabel[b],a++;$j("#ie_colorChanger span")[0].innerHTML=svgEditor.uiStrings.elementLabel.original,a=1;for(var b in kb)$j("#ie_colorChanger span")[a].innerHTML=svgEditor.uiStrings.elementLabel[b],a++}function O(a){if("photobox"==a.getAttribute("type")&&"g"!=a.childNodes[0].tagName){var b=svgCanvas.addSvgElementFromJson({element:"g",attr:{id:svgCanvas.getNextId(),style:"pointer-events:inherit"}}),c=a.childNodes[0];a.insertBefore(b,c),b.appendChild(c);var d=c.getAttribute("clip-path");c.removeAttribute("clip-path"),b.setAttribute("clip-path",d)}}function P(){var a=findNodeWithTitleName(svgCanvas.getElem("svgcontent").childNodes,"Layer 1");if(null!=a)for(var b=a.childNodes.length;b--;){var c=a.childNodes[b];"g"==c.tagName&&O(c)}}var Q,R,S,T,U,V,W,X,Y,Z,_,ab,bb,cb,db,eb,fb,gb=new $j.DNBBaseObject,hb=!1,ib={circle:"M140,70c0,38.659-31.34,70-70,70C31.34,140,0,108.66,0,70C0,31.34,31.34,0,70,0C108.66,0,140,31.34,140,70z",rect:"M0,0L140,0L140,140L0,140z",heart:"M70.33952,35.80746C99.34181,-52.10137 212.96642,35.80746 70.33952,148.8372C-72.28889,35.80746 41.33672,-52.10086 70.33952,35.80746z",roundedSquare:"M0.00105,14.08789C3.67214,51.49151 3.67214,89.19104 0.00105,126.59348C0.00105,134.33238 6.25158,140.68195 14.08894,140.68195C51.49193,137.01144 89.19145,137.01144 126.59508,140.68195C134.33279,140.68195 140.68236,134.43201 140.68236,126.59348C137.01068,89.19104 137.01068,51.4915 140.68236,14.08789C140.68236,6.34899 134.43242,0.00001 126.59508,0.00001L126.59508,0.09904C89.19145,3.76955 51.49193,3.76955 14.08894,0.09904C6.35062,0.09904 0.00105,6.34958 0.00105,14.18692",cloudMirror:"M43.4833984375,12.406707763671875 C42.192718505859375,13.896171569824219 40.207183837890625,14.591041564941406 38.32012939453125,14.29315185546875 C28.0938720703125,12.704597473144531 18.16552734375,18.959739685058594 14.988372802734375,28.888107299804688 C13.99560546875,31.96612548828125 13.79681396484375,35.242340087890625 14.29290771484375,38.41947937011719 C14.590789794921875,40.40562438964844 13.895904541015625,42.29205322265625 12.406463623046875,43.582733154296875 C-1.3939208984375,55.29844665527344 -4.0743408203125,75.65123748779297 6.35009765625,90.54352569580078 L6.2515869140625,90.54352569580078 C7.93927001953125,93.02521514892578 10.024505615234375,95.30921173095703 12.307952880859375,97.19623565673828 L12.40704345703125,97.19623565673828 C13.896514892578125,98.48632049560547 14.591400146484375,100.47249603271484 14.29351806640625,102.35950469970703 C12.704925537109375,112.68433380126953 18.86041259765625,122.6132583618164 28.78875732421875,125.69068145751953 C31.866790771484375,126.6834487915039 35.143585205078125,126.88162994384766 38.32073974609375,126.38617706298828 L38.32073974609375,126.48639678955078 C40.3062744140625,126.18790435791016 42.193328857421875,126.8833999633789 43.48394775390625,128.37348175048828 C55.19972229003906,142.1731948852539 75.55313110351562,144.85370635986328 90.44537353515625,134.42920684814453 C92.9263916015625,132.7415542602539 95.21112060546875,130.6557388305664 97.0975341796875,128.37348175048828 L97.0975341796875,128.2737808227539 C98.38824462890625,126.78491973876953 100.3743896484375,126.0882339477539 102.26080322265625,126.38617706298828 C112.58621215820312,127.97525787353516 122.51519775390625,121.81983184814453 125.59323120117188,111.89090728759766 C126.58535766601562,108.81224822998047 126.78408813476562,105.53667449951172 126.28924560546875,102.35948944091797 L126.3876953125,102.35948944091797 C126.08984375,100.37340545654297 126.78594970703125,98.48690032958984 128.27474975585938,97.19623565673828 C142.07510375976562,85.4804916381836 144.756103515625,65.1270980834961 134.33053588867188,50.23486328125 C132.64349365234375,47.75323486328125 130.55767822265625,45.46916198730469 128.27474975585938,43.582733154296875 C126.78594970703125,42.29205322265625 126.08984375,40.305908203125 126.3876953125,38.41947937011719 C127.97628784179688,28.094696044921875 121.82144165039062,18.16516876220703 111.89254760742188,15.087142944335938 L111.79275512695312,15.087142944335938 C108.71536254882812,14.094955444335938 105.43853759765625,13.896171569824219 102.26080322265625,14.392257690429688 L102.26080322265625,14.29315185546875 C100.274658203125,14.591041564941406 98.38824462890625,13.896171569824219 97.0975341796875,12.406707763671875 C85.3812255859375,-1.3936691284179688 65.02839660644531,-4.074699401855469 50.135528564453125,6.350349426269531 C47.653289794921875,8.038009643554688 45.369842529296875,10.122665405273438 43.4833984375,12.406707763671875 z",heartCurve:"M7.44131,21.7771C2.97615,28.02938 0.39599,35.47269 -0.00082,43.11353L0.09823,43.11353C-0.29858,51.45011 1.48795,59.7861 5.15949,67.2294L5.15949,67.32905C8.03741,73.18452 11.70895,78.64318 15.87753,83.6048C19.64871,88.17019 23.8167,92.43666 28.1834,96.30748C31.55777,99.38351 35.13025,102.16295 38.80179,104.94122C40.68738,106.23072 42.47391,107.61927 44.35833,108.90993L44.25928,108.90993C47.7327,111.68879 50.80873,115.06258 53.38948,118.7347C58.05393,125.18627 61.0309,132.72746 61.92416,140.66664C71.25306,137.49097 80.18456,133.0258 88.32185,127.4675C107.2774,115.06258 122.36096,97.69603 131.88798,77.25229L131.98762,77.25229C137.04888,67.0313 139.92679,55.91586 140.62078,44.50326L140.62078,44.60173C141.01818,36.3648 139.43034,28.12845 135.95691,20.58609C133.17747,14.63097 128.911,9.57088 123.55199,5.60041C119.38458,2.42474 114.4212,0.53915 109.16183,0.04328C99.23683,-0.45317 89.51288,3.31801 82.56603,10.66168C78.59673,14.82967 75.22236,19.69165 72.54139,24.85255L72.64044,24.85255C71.44942,27.23401 70.35745,29.61606 69.46477,32.09657L69.36572,32.09657C67.57918,29.3183 65.59453,26.6385 63.51024,24.05893C59.14414,18.69932 53.98323,14.23357 48.0287,10.76073C41.47925,6.79144 33.54007,5.79853 26.19582,8.18057L26.29488,8.18057C18.7531,10.66168 12.20306,15.42518 7.53861,21.87558",star_points_5:"M-0.00082,51.04887L53.73506,51.04887L70.33986,0.00001L86.94467,51.04887L140.68054,51.04887L97.20738,82.59845L113.81304,133.64731L70.33986,102.09688L26.86669,133.64731L43.47235,82.59845L-0.00082,51.04887z",cloud:"M85.61639,0.00677C85.31163,0.01664 85.01769,0.04251 84.71152,0.07308C79.81985,0.55985 75.50195,3.66482 73.30891,8.29077L72.14537,11.79221C72.39604,10.57882 72.78216,9.40211 73.30891,8.29077C69.39689,4.23813 63.90651,2.36771 58.48151,3.24484C53.05651,4.1229 48.34497,7.64316 45.77003,12.74458C38.50142,8.26819 29.44047,8.53956 22.43101,13.45193S11.68542,27.06123 12.82074,35.83717L13.56383,39.40304C13.22803,38.2348 12.97735,37.04586 12.82074,35.83717L12.70787,36.16591C6.61456,36.83046 1.61707,41.55705 0.31949,47.88411S1.72054,60.70329 7.00633,63.97522L15.25976,65.98014C12.37771,66.21765 9.50037,65.51924 7.00633,63.97522C2.92923,68.54238 1.99096,75.30353 4.68065,80.88749C7.37034,86.47146 13.11374,89.68648 19.03962,88.9575L22.64171,88.00419C21.48287,88.48908 20.27935,88.80512 19.03962,88.9575C22.40326,95.15005 27.98158,99.66688 34.52921,101.46487C41.07684,103.26286 48.03175,102.20043 53.83017,98.52309C58.561,105.98312 66.95694,109.90172 75.37686,108.58157C83.79631,107.26188 90.74181,100.93201 93.20811,92.34325L94.06407,87.54423C93.93662,89.17478 93.65772,90.77806 93.20811,92.34325C98.99901,96.14098 106.28408,96.35497 112.26686,92.90197C118.25059,89.44897 121.98389,82.86513 122.03892,75.69388L119.89337,64.97933L111.44288,57.72953C117.97687,61.82262 122.0963,68.0589 122.03845,75.69388C129.80793,75.77524 136.40776,69.11756 139.36882,61.47694C142.32988,53.83585 141.21007,45.12481 136.4294,38.58189C138.41221,33.70997 138.29464,28.16786 136.10629,23.39518C133.91748,18.62155 129.8813,15.07402 125.02584,13.68144C123.93943,7.35533 119.46069,2.2666 113.54187,0.59936C107.62304,-1.06882 101.32092,0.98783 97.3581,5.89126L94.95154,9.95143C95.56623,8.48266 96.36999,7.115 97.3581,5.89126C94.56494,2.03756 90.18356,-0.13762 85.61639,0.00677L85.61639,0.00677z"},jb={css_brightness:'<filter id="sample_css_brightness"  type="css_brightness" color-interpolation-filters="sRGB"><feComponentTransfer> <feFuncR type="linear" slope="0.5"/> <feFuncG type="linear" slope="0.5"/> <feFuncB type="linear" slope="0.5"/></feComponentTransfer></filter>',brightness_threshold:'<filter id="sample_brightness_threshold" type="brightness_threshold" color-interpolation-filters="sRGB"><feComponentTransfer> <feFuncR type="linear" slope="1.5" intercept="-0.3"/> <feFuncG type="linear" slope="1.5" intercept="-0.3"/> <feFuncB type="linear" slope="1.5" intercept="-0.3"/></feComponentTransfer> </filter>',css_invert:'<filter id="sample_css_invert" type="css_invert" color-interpolation-filters="sRGB"><feComponentTransfer>  <feFuncR type="table" tableValues="1 0"/>  <feFuncG type="table" tableValues="1 0"/>  <feFuncB type="table" tableValues="1 0"/></feComponentTransfer></filter>',gamma_correct:'<filter id="sample_gamma_correct" type="gamma_correct" color-interpolation-filters="sRGB"><feComponentTransfer> <feFuncG type="gamma" amplitude="1" exponent="0.5"/> </feComponentTransfer> </filter>',gamma_correct2:'<filter id="sample_gamma_correct2" type="gamma_correct2" color-interpolation-filters="sRGB"><feComponentTransfer> <feFuncG type="gamma" amplitude="1" exponent="0.5" offset="-0.1"/> </feComponentTransfer> </filter>',css_grayscale:'<filter id="sample_css_grayscale" type="css_grayscale" color-interpolation-filters="sRGB"><feColorMatrix type="saturate" values="0"/></filter>',css_sharpen:'<filter id="sample_css_sharpen" type="css_sharpen" color-interpolation-filters="sRGB"><feConvolveMatrix order="3" kernelMatrix="1 0 0 0 1 0 0 0 -1"/></filter>',css_hue_rotate:'<filter id="sample_css_hue_rotate" type="css_hue_rotate" color-interpolation-filters="sRGB"><feColorMatrix type="hueRotate" values="180"/></filter>',luminance_mask:'<filter id="sample_luminance_mask" type="luminance_mask" color-interpolation-filters="sRGB"><feColorMatrix type="luminanceToAlpha"/></filter>',css_sepia:'<filter id="sample_css_sepia" type="css_sepia" color-interpolation-filters="sRGB"><feColorMatrix type="matrix" values=".343 .669 .119 0 0             .249 .626 .130 0 0            .172 .334 .111 0 0            .000 .000 .000 1 0 "/></filter>',dusk:'<filter id="sample_dusk" type="dusk" color-interpolation-filters="sRGB"><feColorMatrix type="matrix" values="1.0 0   0   0   0            0   0.2 0   0   0             0   0   0.2 0   0             0   0   0   1.0 0 "/></filter>'},kb={oneColor:'<filter id="oneColor" type="oneColor" color-interpolation-filters="sRGB" ><feComponentTransfer><feFuncR slope="0" type="linear"/><feFuncG slope="0" type="linear"/><feFuncB slope="0" type="linear"/></feComponentTransfer><feComponentTransfer><feFuncR type="table" tableValues=""/><feFuncG type="table" tableValues=""/><feFuncB type="table" tableValues=""/></feComponentTransfer></filter>',twoColor:'<filter id="twoColor" type="twoColor" color-interpolation-filters="sRGB" ><feColorMatrix in = "SourceGraphic" type = "saturate" values = "0"/><feComponentTransfer ><feFuncR slope="1" type="linear"/><feFuncG slope="1" type="linear"/><feFuncB slope="1" type="linear"/></feComponentTransfer><feComponentTransfer><feFuncR intercept="-1" slope="10" type="linear"/><feFuncG intercept="-1" slope="10" type="linear"/><feFuncB intercept="-1" slope="10" type="linear"/></feComponentTransfer><feComponentTransfer><feFuncR type="table" tableValues=""/><feFuncG type="table" tableValues=""/><feFuncB type="table" tableValues=""/></feComponentTransfer></filter>'},lb='<div class="imageeffectpreviw"><svg width="500" height="350" x="0" y="63" viewBox="0 0 500 350" overflow="hidden"><g mask="" style="pointer-events:all"><g type="photobox" style="pointer-events:inherit"><g><image xmlns:xlink="http://www.w3.org/1999/xlink" x="0" y="0" width="500" height="350" preserveAspectRatio="none" id="svg_5" xlink:href="http://192.168.0.139/work/print_commerce/pc-newtool-oc2/source/designnbuy/assets/images/dragImage.svg" style="pointer-events:inherit"/></g></g></g></svg><div>',mb=!1,nb=[],ob="effect_color_",pb=[];
$j(document).ready(function(){$j("#imageEffect_window .close-window-positoin").bind("click",r),$j("#ie_preview").html(lb),T=$j('<div class="imageEffectPanel caption-section"></div>'),$j(".image_quality").append(T);var b=$j("<div class='div-table'><div class='div-table-cell'><div id='imageEffectCaptoin' class='caption-tabs'>Image Effect</div></div><div class='div-table-cell'></div></div>");T.append(b);var c=b.find(".div-table-cell");R=$j('<div class="caption-mask">Mask None</div>'),$j(c[1]).append(R),S=$j('<div class="caption-mask">Effect:None</div>'),$j(c[1]).append(S),Q=$j('<button type="button" id="imageeffectburow" class="button"><i class="fa fa-leaf"></i></button>'),$j(".photo-boxbtn").prepend(Q),svgedit.browser.isTouch()&&0==svgedit.browser.isIOS()?Q.on("touchstart",x):Q.on("click",x),ab=$j('<button type="button" class="imageftbtn"><span id="imgUpdateBtn">Update</span></button>'),bb=$j('<button type="button" class="imageftbtn"><span id="imgCancleBtn">Cancel</span></button>'),$j("#imageEffect_window .buttonHolder").append(ab),$j("#imageEffect_window .buttonHolder").append(bb),ab.bind("click",p),bb.bind("click",r),U=$j("#ie_preview svg"),V=U.find("image")[0];var e=$j("#ie_shapes"),f=$j('<i class="fa fa-ban fa-3"></i>');e.append(f),f.bind("click",n);for(var h in ib){var l=$j('<div class="tool_button" >');l.append('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"><svg viewBox="-25 -15 168 168"><path fill="none" stroke="#000000" stroke-width="5" d="'+ib[h]+'"/></svg></svg>'),l.bind("click",{shapeType:h},v),e.append(l)}var q=$j('<div class="propo_label">');fb=$j('<input type="checkbox" checked="checked" class="checkboxStepper" name="propCheckbox">'),q.append(fb),q.append('<label id="proportionCaption">Proportion</label>'),e.append(q);var t='<div class="ie_stroke_panel range-blocks"><div class="caption-section"><div class="caption" id="imgBorderCaption">Border</div><input autocomplete="off" id="ie_strokeSlider_label" class="slider_itag" size="2" value="0" data-attr="Stroke Width" disabled="disabled" type="text"><div class="psright"><div class="left"><label class="stroke_tool no-padding"><select autocomplete="off" id="ie_stroke_style" ><option selected="selected" value="none">—</option><option value="2,2">...</option><option value="5,5">- -</option><option value="5,2,2,2">- .</option><option value="5,2,2,2,2,2">- ..</option></select></label></div><div class="ie_colorChanger_picker color_tool"></div></div></div><div class="ranger-area"><div id="ie_strokeSlider"></div></div></div>',u=$j(t);e.append(u),eb=$j("#ie_strokeSlider").slider({range:!1,min:0,max:10,step:1,value:0,slide:function(a,b){j(b.value)},start:function(){},stop:function(a,b){j(b.value)}}),$j("#ie_stroke_style").bind("change",i);var y=$j(".ie_colorChanger_picker"),z="ie_stroke_colorPicker",A='<div class="color_block_parent" style="display:block;">';A+='<div><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" width="22" height="25" xmlns:xlink="http://www.w3.org/1999/xlink" class="svg_icon"><svg xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">		  <line fill="none" stroke="#d40000" id="svg_90" y2="24" x2="24" y1="0" x1="0"/>		  <line id="svg_92" fill="none" stroke="#d40000" y2="24" x2="0" y1="0" x1="24"/>	</svg></svg></div>',A+='<div id="'+z+'" class="color_block"></div></div>',y.append($j(A));var B=$j("#"+z);db=new sb("#"+z,getDefaultColor()),B.click(function(){"full"==pickerMode?qb($j(this)):"printable"==pickerMode&&rb($j(this),printableColorList)}),Y=$j('<div style="position:absolute; width:25px; height:25px;display:none;cursor: pointer;" class="fa img-drag-area">'),$j("#ie_preview").append(Y),Y.on("mousedown",s);var C=$j("#ie_filters"),f=$j('<div class="filter_button" >');f.append('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="50" height="50"><svg viewBox="0 0 50 50"><title>'+svgEditor.uiStrings.elementLabel.original+'</title><defs></defs><image width="50" height="50" xlink:href="" /></svg></svg>'),f.append("<span>"+svgEditor.uiStrings.elementLabel.original+"</span>"),C.append(f),f.bind("click",o);for(var h in jb){var l=$j('<div class="filter_button" >');l.append('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="50" height="50"><svg viewBox="0 0 50 50"><title>'+svgEditor.uiStrings.elementLabel[h]+"</title><defs>"+jb[h]+'</defs><image width="50" height="50" filter="url(#sample_'+h+')" xlink:href="" /></svg></svg>'),l.append("<span>"+svgEditor.uiStrings.elementLabel[h]+"</span>"),l.bind("click",{filterType:h},w),C.append(l)}var D=$j("#ie_colorChanger div:first"),f=D.append('<div><input type="radio" name="colorOption" id="radio_original" value="0" checked="checked" />'+svgEditor.uiStrings.elementLabel.original+"</div>"),E=0;for(var h in kb){E++;var l=$j('<div><input type="radio" name="colorOption" id=radio_'+h+' value="'+E+'" >'+svgEditor.uiStrings.elementLabel[h]+"</input></div>");l.append('<svg display="none" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="50" height="50"><svg viewBox="0 0 50 50"><title>'+h+"</title><defs>"+kb[h]+'</defs><image width="50" height="50" filter="url(#'+h+')" xlink:href="" /></svg></svg>'),D.append(l)}g(E),pb=$j("#ie_colorChanger").find("input"),pb.bind("change",k),$j("#tabShapes").addClass("active"),$j("#tabShapes").bind("click",m),$j("#tabFilters").bind("click",m),$j("#tabColors").bind("click",m),svgedit.browser.isTouch()&&0==svgedit.browser.isIOS()?$j("#changeImageCaption").on("touchstart",d):$j("#changeImageCaption").on("click",d),svgedit.browser.isTouch()&&0==svgedit.browser.isIOS()?$j("#removeImageCaption").on("touchstart",a):$j("#removeImageCaption").on("click",a)});var qb=function(a){$j("#ie_colorpicker").show(),$j.farbtastic("#ie_colorpicker").linkTo(function(){});var b,c=a.attr("id"),d=c.substr(ob.length,c.length-ob.length);b="ie_stroke_colorPicker"==c?db.paint:nb[d].paint;a.offset();-1==b.solidColor.search("#")?($j.farbtastic("#ie_colorpicker").setColor("#"+b.solidColor),updateColorElements(b.solidColor)):($j.farbtastic("#ie_colorpicker").setColor(b.solidColor),updateColorElements(b.solidColor.substr(1))),updateColorHexCode(),$j("#ie_colorpicker").addClass("displayblock"),$j.farbtastic("#ie_colorpicker").linkTo(function(a){a=a.replace("#",""),"ie_stroke_colorPicker"==c?(b=new $j.jGraduate.Paint(db.paint),b.solidColor=a,db.setPaint(b),h("#"+a)):(b=new $j.jGraduate.Paint(nb[d].paint),b.solidColor=a,nb[d].setPaint(b),f("#"+a,d)),updateColorHexCode()}),0==$j("#ie_colorpicker").find(".closebar_button").length&&$j("#ie_colorpicker").append('<div style="right: 5px;" class="closebar_button"><div><button onclick="closeMe(this);"><i class="fa fa-close"></i></button></div></div>')},rb=function(a,b){var c=a.attr("id"),d=c.substr(ob.length,c.length-ob.length);$(a).simpleColor({boxHeight:40,cellWidth:20,cellHeight:20,columns:10,colors:b,chooserCSS:{left:$j(a).offset().left-$j(".right-panel-property").offset().left+20},displayCSS:{border:"1px solid red"},displayColorCode:!0,livePreview:!1,onSelect:function(a){var b=new $j.jGraduate.Paint({solidColor:a});"ie_stroke_colorPicker"==c?(db.setPaint(b),h("#"+b[b.type])):(nb[d].setPaint(b),f("#"+b[b.type],d)),svgCanvas.runExtensions("elementChanged",{elems:svgCanvas.getSelectedElems()})}}),setHideOnClick($j(".simpleColorChooser"))},sb=function(a,b){var c=(new DOMParser).parseFromString('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" ><rect width="25" height="24" fill="'+b+'" opacity="100"/><image overflow="visible" width="25" height="24" xlink:href="'+jspath+'jgraduate/images/picker.gif"  transform="matrix(1 0 0 1 7.321239e-004 0)"></image><defs><linearGradient id="gradbox_"/></defs></svg>',"text/xml"),d=c.documentElement;d=$j(a)[0].appendChild(document.importNode(d,!0)),this.container=$j(a),this.rect=d.firstChild,this.defs=d.getElementsByTagName("defs")[0],this.grad=this.defs.firstChild,this.paint=new $j.jGraduate.Paint({solidColor:b}),this.type="fill",this.setPaint=function(a){this.paint=a;var b="none",c=a.type,d=a.alpha/100;switch(c){case"solidColor":b="none"!=a[c]?"#"+a[c]:a[c];break;case"linearGradient":case"radialGradient":this.defs.removeChild(this.grad),this.grad=this.defs.appendChild(a[c]);var e=this.grad.id="gradbox_"+this.type;b="url(#"+e+")"}this.rect.setAttribute("fill",b),this.rect.setAttribute("opacity",d)}},tb=function(a){var b=J(a),c="url(#"+b+")",d=V.parentNode;d.setAttribute("clip-path",c),$j(d.parentNode).find("path").length&&$j(d.parentNode).find("path").remove();var e=a.cloneNode(!0);e.setAttribute("fill","#000"),e.setAttribute("fill-opacity","0");var f=db.paint,g=f[f.type];"none"!=g&&-1==g.indexOf("#")&&(g="#"+g);var h=$j("#ie_stroke_style")[0].options[$j("#ie_stroke_style")[0].selectedIndex].value;e.setAttribute("stroke",g),e.setAttribute("stroke-width",eb.slider("value")),e.setAttribute("stroke-dasharray",h),e.setAttribute("cursor","move"),d.parentNode.appendChild(e),$j(e).on("mousedown",C),G(),Y.show(),L(10)},ub=function(){disableOther("addtimage"),$j("addtimage").addClass("active"),$j("#addtimage-panel").addClass("cbp-spmenu-open")};return{name:"imageEffect",imageLoaded:function(a){var b=160,c=90;"producttool"==toolType&&(b=160,c=160),a.naturalWidth>=a.naturalHeight?($j(a).css("width",b+"px"),$j(a).css("height","auto"),$j(a).css("margin-top",(c-a.height)/2+"px")):($j(a).css("height",c+"px"),$j(a).css("width","auto"),$j(a).css("margin-left",(b-a.width)/2+"px"))},selectedChanged:function(a){if(a){var b=svgCanvas.getSelectedElems();b&&void 0!=b[0]&&($j("#removeImageCaption,#changeImageCaption").hide(),1==b.length&&(e(b[0]),b[0].getAttribute("type")==gb.photoBox?($j("#tool_ungroup").hide(),$j("#changeImageCaption").show(),ub(),K(),showQuality(b[0].childNodes[0].childNodes[0]),"admin"!=user&&"true"==b[0].getAttribute("lockTransform")&&"true"==b[0].childNodes[0].childNodes[0].getAttribute("isAdminUploaded")&&(svgedit.browser.isChrome()?hb&&(hb=!1,$j("#uploader_buttons input[type=file]").trigger("click")):$j("#uploader_buttons input[type=file]").trigger("click")),"admin"==user&&$j("#textLabel").val(b[0].getAttribute("label")||""),$j("#imageeffectburow").show()):"image"==b[0].tagName&&(svgCanvas.getPrivateMethods().extensions.objectPanel&&svgCanvas.getPrivateMethods().extensions.objectPanel.isQRCodeSelected()?$j("#imageeffectburow").hide():$j("#imageeffectburow").show(),"g"==b[0].parentNode.parentNode.tagName&&"photobox"==b[0].parentNode.parentNode.getAttribute("type")&&"true"==b[0].parentNode.parentNode.getAttribute("lockTransform"))))}},elementChanged:function(){var a=svgCanvas.getSelectedElems();if(a.length&&void 0!=a[0]){for(var b=0;b<a.length;b++)if(a[b].getAttribute("type")==gb.photoBox){if(svgCanvas.getElem(a[b].id)){H(a[b].childNodes[0]);var c=svgCanvas.getRotationAngle(a[b]);svgedit.browser.isIE()&&0==c&&(svgCanvas.moveSelectedElements(1,0,!1,[a[b]]),svgCanvas.moveSelectedElements(-1,0,!1,[a[b]])),svgCanvas.selectorManager.requestSelector(a[b]).resize()}else{var d=a[b].childNodes[0].getAttribute("clip-path");if(d&&""!=d){d=d.replace(/"/g,"");var e=d.substring(5,d.indexOf(")"));$j("#"+e).remove()}}svgCanvas.getPrivateMethods().extensions.LayerPanel&&setTimeout(svgCanvas.getPrivateMethods().extensions.LayerPanel.update,250)}1==a.length&&(a[0].getAttribute("type")==gb.photoBox?($j("#tool_ungroup").addClass("disabled"),ub(),K(),showQuality(a[0].childNodes[0].childNodes[0]),$j("#imageeffectburow").show()):"image"==a[0].tagName&&(svgCanvas.getPrivateMethods().extensions.objectPanel&&svgCanvas.getPrivateMethods().extensions.objectPanel.isQRCodeSelected()?$j("#imageeffectburow").hide():$j("#imageeffectburow").show(),"g"==a[0].parentNode.parentNode.tagName&&"photobox"==a[0].parentNode.parentNode.getAttribute("type")&&"true"==a[0].parentNode.parentNode.getAttribute("lockTransform")))}},elementAdded:function(a){for(var b=a.elems,c=0;c<b.length;c++)if(b[c].getAttribute("type")==gb.photoBox){var d,e=b[c].childNodes[0].getAttribute("clip-path");if(e&&""!=e){e=e.replace(/"/g,"");var f=e.substring(5,e.indexOf(")"));console.log("clipPathId = "+f);for(var g=svgCanvas.findDefs(),h=g.childNodes.length;h--;)if(console.log("defs[cnt]"),console.log(g[h]),g[h]&&g[h].getAttribute("id")==f){d=g[h];break}}if(console.log("newClipPath"),console.log(d),d)d=d.cloneNode(!0);else{console.log("newClippath lasdjf;lsajf;asj;dsa j;kdsa j");var i=b[c].childNodes[1].cloneNode(!0);d=document.createElementNS("http://www.w3.org/2000/svg","clipPath"),d.setAttribute("class","clippath"),d.appendChild(i)}svgCanvas.findDefs().appendChild(d),d.id=svgCanvas.getNextId(),b[c].childNodes[0].setAttribute("clip-path","url(#"+d.id+")");var j=b[c].childNodes[0],k=j.getAttribute("filter");if(k){k=k.replace(/"/g,""),k=k.substring(5,k.indexOf(")"));var l,m=this.getfilterFromClipBoard(k),n=m.getAttribute("type");kb[n]||!q(n)?(l=m.cloneNode(!0),l.id=svgCanvas.getNextId(),svgCanvas.findDefs().appendChild(l)):l=q(n),j.setAttribute("filter","url(#"+l.id+")")}}else if("image"==b[c].tagName){var k=b[c].getAttribute("filter");if(k){k=k.replace(/"/g,""),k=k.substring(5,k.indexOf(")")),console.log("filterId = "+k);var m=this.getfilterFromClipBoard(k);console.log("filter"),console.log(m);var l,n=m.getAttribute("type");kb[n]||!q(n)?(l=m.cloneNode(!0),l.id=svgCanvas.getNextId(),svgCanvas.findDefs().appendChild(l)):l=q(n),b[c].setAttribute("filter","url(#"+l.id+")")}}},getProportionalWidthHeight:function(a,b,c,d){var e,f,g=a/b;return a>b?(e=c/g,f=c,d>e&&(e=d,f=e*g)):(e=d,f=d*g,c>f&&(f=c,e=f/g)),[f,e]},getfilterFromClipBoard:function(a){for(var b,c=svgCanvas.clipBoard,d=c.length;d--;){var e=c[d];if(e){var f=svgCanvas.clipBoardSide;f.getElementById(a)&&(b=f.getElementById(a));break}}return b},langChanged:function(){N()},drawShapeOnCanvas:function(a){B(a)},updateClipPath:function(a){H(a)},updateAllClipPath:function(){$j(svgCanvas.getContentElem()).find("g").each(function(){this.getAttribute("type")==gb.photoBox&&H(this.childNodes[0])})},mouseDown:function(){svgedit.browser.isChrome()&&(hb=!0)},loadImageinPhotobox:function(a,c,d,e){b(a,c,d,e)},removeImage:function(a){c(a)},updateStructure:function(a){O(a)},updateAllPhotoboxStructure:function(){P()}}}),svgEditor.addExtension("undoRedo",function(){function a(){c=[],d=0,e=!0,b()}function b(){d>1?$j("#tool_undo_custom").removeClass("disabled"):$j("#tool_undo_custom").addClass("disabled"),d<c.length?$j("#tool_redo_custom").removeClass("disabled"):$j("#tool_redo_custom").addClass("disabled")}var c,d,e,f;return $j().ready(function(){a(),$j("#tool_undo_custom").on("click",function(a){if(a.preventDefault(),showLoader(),d>1){e=!1;var f=100*svgCanvas.getZoom(),g=c[d-2];trace("dataStack[stackPointer-2]"),trace(g),svgCanvas.setSvgString(g),d--,"web2print"==toolType?1!=f&&svgCanvas.changeZoom({value:f}):zoomChange(f),e=!0,svgCanvas.setCurrentLayer("Layer 1"),b()}return updateMaskImage(),hideLoader(),"producttool"==toolType&&productPricingExt.calculatePriceData(!0),$j.isEmptyObject(nameNumberObject)||nameNumberObject.updateNameNumberButton(),!1}),$j("#tool_redo_custom").on("click",function(a){if(a.preventDefault(),showLoader(),d<c.length){e=!1;var f=100*svgCanvas.getZoom();trace(),svgCanvas.setSvgString(c[d]),d++,"web2print"==toolType?1!=f&&svgCanvas.changeZoom({value:f}):zoomChange(f),e=!0,svgCanvas.setCurrentLayer("Layer 1"),b()}return updateMaskImage(),hideLoader(),"producttool"==toolType&&productPricingExt.calculatePriceData(!0),$j.isEmptyObject(nameNumberObject)||nameNumberObject.updateNameNumberButton(),!1})}),{name:"undoRedo",elementChanged:function(){this.addToStack()},toolReady:function(){this.addToStack()},pageChanged:function(){this.resetStack(),this.addToStack()},elementAdded:function(){},textChanged:function(){clearTimeout(f),f=setTimeout(this.addToStack,500)},resetStack:function(){a()},isAddToStack:function(a){return"undefined"==typeof a?e:void(e=a)},getStack:function(){return c},addToStack:function(){if(e){var a;a=svgedit.browser.isWebkit()&&svgedit.browser.isMac()?svgCanvas.getSvgString():(new XMLSerializer).serializeToString(svgCanvas.getContentElem()),d>0&&c[d-1]==a||(c[d]=a,d++,b())}}}}),svgEditor.addExtension("nameNumber",function(){function countTotalColorsNew(){getsvg_str();var a=$j("#current_page").val(),b=new Array,c=findNodeWithTitleName(svgCanvas.getElem("svgcontent").childNodes,"Layer 1");if(null!=c){var d="circle,ellipse,line,path,polygon,polyline,rect,text";$j(c).find(d).each(function(a,c){if(c.hasAttribute("fill")&&"none"!=c.getAttribute("fill")?b.push(c.getAttribute("fill").toLowerCase()):"g"!=c.tagName&&b.push("#000000"),c.hasAttribute("stroke")&&"none"!=c.getAttribute("stroke")){var d=c.hasAttribute("stroke-width");0==d?b.push(c.getAttribute("stroke").toLowerCase()):c.getAttribute("stroke-width")>0&&b.push(c.getAttribute("stroke").toLowerCase())}}),b=arrayUnique(b),1==a?totalcolorsUsedNew.Front=b:2==a?totalcolorsUsedNew.Back=b:3==a?totalcolorsUsedNew.Left=b:4==a&&(totalcolorsUsedNew.Right=b),b.length>0?(displayTotalColors(b),$j(".color-count-panel").show()):($j("#totalcolorsUsedNew").empty(),$j(".color-count-panel").hide())}}function displayTotalColors(a){$j("#totalcolorsUsed").empty(),$j.each(a,function(a,b){$j("#totalcolorsUsed").append('<div style="background:'+b+'; width:24px; height:24px; float:left;margin-right:5px;" onclick="changeToSingleColors(\''+b.substring(1,b.length)+"')\">&nbsp;<div>")})}function isName(){var a=!1;return null!=document.getElementById("nameText")&&(a=!0),a}function isNumber(){var a=!1;return null!=document.getElementById("numberText")&&(a=!0),a}function num_control_btnHandler(){svgedit.browser.isTouch()?(showLoader(),setTimeout(enableDisableNumber,500),setTimeout(hideLoader,1e3)):enableDisableNumber(),svgCanvas.getPrivateMethods().extensions.undoRedo&&svgCanvas.getPrivateMethods().extensions.undoRedo.addToStack()}function name_control_btnHandler(){svgedit.browser.isTouch()?(showLoader(),setTimeout(enableDisableName,500),setTimeout(hideLoader,1e3)):enableDisableName(),svgCanvas.getPrivateMethods().extensions.undoRedo&&svgCanvas.getPrivateMethods().extensions.undoRedo.addToStack()}function changeLabelsForLanguage(){$j("#name_side option")[0].text=svgEditor.uiStrings.elementLabel.frontSide,$j("#name_side option")[1].text=svgEditor.uiStrings.elementLabel.backSide,$j("#number_side option")[0].text=svgEditor.uiStrings.elementLabel.frontSide,$j("#number_side option")[1].text=svgEditor.uiStrings.elementLabel.backSide,$j("#name_size option")[0].text=svgEditor.uiStrings.elementLabel.verySmall,$j("#name_size option")[1].text=svgEditor.uiStrings.elementLabel.small,$j("#name_size option")[2].text=svgEditor.uiStrings.elementLabel.medium,$j("#name_size option")[3].text=svgEditor.uiStrings.elementLabel.large,$j("#name_size option")[4].text=svgEditor.uiStrings.elementLabel.extraLarge,$j("#number_size option")[0].text=svgEditor.uiStrings.elementLabel.verySmall,$j("#number_size option")[1].text=svgEditor.uiStrings.elementLabel.small,$j("#number_size option")[2].text=svgEditor.uiStrings.elementLabel.medium,$j("#number_size option")[3].text=svgEditor.uiStrings.elementLabel.large,$j("#number_size option")[4].text=svgEditor.uiStrings.elementLabel.extraLarge}function getSizeArray(a){a=a||$j("#current_product_colorid").val();var b=$j("#listNameNumber").find("tr"),c=new Object;return b.length&&$j.each(b,function(b,d){var e,f=$j("#size_"+d.id+" option:selected").val();e="onlysize"==productData.type?"size"+f:"configurable"==productData.type?"size"+f+"_"+a:"quantity",c[e]=c[e]?parseInt(c[e])+1:1}),c}function hidePopups(){$j("#textNameShapeDD .shape_con").hide(),$j("#textNumberShapeDD .shape_con").hide(),$j("#name-font-selector-con").hide(),$j("#number-font-selector-con").hide(),$j("#common_upper_open_panel").hide()}function changeNameShapeValue(a){var b=svgCanvas.getElem("nameText");b&&(b.setAttribute("shapeVal",a),TextModule.addUpdateShapeText(b,b.getAttribute("text")))}function changeNumberShapeValue(a){var b=svgCanvas.getElem("numberText");b&&(b.setAttribute("shapeVal",a),TextModule.addUpdateShapeText(b,b.getAttribute("text")))}function updateSide(a){var b="";b="name"==a?$j("#name_side option:selected").val().toLowerCase():$j("#number_side option:selected").val().toLowerCase(),"front"==b&&"1"!=curSide?showSide($j("#sideButton_1")[0]):"back"==b&&"2"!=curSide&&showSide($j("#sideButton_2")[0]),$j("#common-panel").addClass("cbp-spmenu-open")}function showNameNumSetting(){hidePopups(),$j("#common-panel").addClass("cbp-spmenu-open"),$j(".sambhavNameNum").show(),$j(".align_icons").hide(),$j(".clearfix").hide(),$j("#common-panel").css("width","580px"),$j("#name_num_setting").animate({right:"0px"}),$j("#name_num_setting").animate({right:"0px"}).css("visibility","visible"),svgedit.browser.isTouch()?$j("#name_num_customList").animate({right:"0px"}).css("display","none"):$j("#name_num_customList").animate({right:"0px"}).css("visibility","hidden"),nameElem||numberElem||(manageNameForm(),manageNumberForm())}function nameNumSetting(){$j("#common-panel").addClass("cbp-spmenu-open"),$j(".sambhavNameNum").show(),$j(".clearfix").hide(),$j("#common-panel").css("width","580px"),$j("#name_num_setting").animate({right:"0px"}).css("visibility","visible"),svgedit.browser.isTouch()?$j("#name_num_customList").animate({right:"0px"}).css("display","none"):$j("#name_num_customList").animate({right:"0px"}).css("visibility","hidden")}function enableDisableName(){$j("#name_control_btn").toggleClass("on off");var a=$j("#name_control_btn").parent(),b=$j(a).find(".font-controls");$j(b).toggleClass("enable disable"),manageNameForm(),updateSizeinCartPanel()}function enableDisableNumber(){$j("#num_control_btn").toggleClass("on off");var a=$j("#num_control_btn").parent(),b=$j(a).find(".font-controls");$j(b).toggleClass("enable disable"),manageNumberForm(),updateSizeinCartPanel()}function LoadFont(a){setTimeout(showLoader,500),$j.getScript(Smm.fontDirectory+fontData[a].jsFile).done(function(){setTimeout(hideLoader,500)}).fail(function(){setTimeout(hideLoader,500)})}function showNameShapes(){updateSide("name"),"none"==$j("#textNameShapeDD .shape_con").css("display")&&hidePopups(),$j("#textNameShapeDD .shape_con").toggle()}function addNewRow(){var a=$j("#listNameNumber tr:last-child").attr("id");a++;var b="<tr id="+a+">";b+="onlysize"==productData.type||"configurable"==productData.type?'<td class="size-label"><select onchange="nameNumberObject.updateSizeinCartPanel();" data-field-index='+a+' class="listSize" name="" id="size_'+a+'" autocomplete="off" disabled="disabled"></select></td>':'<td class="size-label" style="display: none;"><select onchange="nameNumberObject.updateSizeinCartPanel();" data-field-index='+a+' class="listSize" name="" id="size_'+a+'" autocomplete="off" disabled="disabled"></select></td>',b+='<td class="name-label"><input type="text" data-field-index='+a+' class="listName" name="" id="name_'+a+'" autocomplete="off" disabled="disabled"></td><td class="number-label"> <input type="text" onKeyDown="numeric_validation(event);" data-field-index='+a+' class="listNumber" maxlength="2" name="" id="number_'+a+'" autocomplete="off" disabled="disabled"></td><td class="delete-box closebar_button"><button onclick="nameNumberObject.removeRow(this)" ontouchstart="nameNumberObject.removeRow(this)" class="remove-nnfield"><i class="fa fa-trash"></i></button></td></tr>',$j("#listNameNumber").append(b),("onlysize"==productData.type||"configurable"==productData.type)&&$j("#size_"+a).append(cloneNameNumberSize),manageFormElements(),updateSizeinCartPanel(),svgCanvas.runExtensions("forNameNumber",{}),datascrollerapi.reinitialise()}function showNumberFonts(a){""!=a.target.id&&(updateSide("number"),"none"==$j("#number-font-selector-con").css("display")&&hidePopups(),$j("#number-font-selector-con").toggle(),$j("#numberFonts").hasClass("active")?$j("#numberFonts").removeClass("active"):$j("#numberFonts").addClass("active"))}function showNameFonts(a){""!=a.target.id&&(updateSide("name"),"none"==$j("#name-font-selector-con").css("display")&&hidePopups(),$j("#name-font-selector-con").toggle(),$j("#nameFonts").hasClass("active")?$j("#nameFonts").removeClass("active"):$j("#nameFonts").addClass("active"))}function showNumberShapes(){updateSide("number"),"none"==$j("#textNumberShapeDD .shape_con").css("display")&&hidePopups(),$j("#textNumberShapeDD .shape_con").toggle()}function changeNumberShape(a){var b;b="IMG"==a.target.tagName?a.target.parentNode:a.target;var c=parseInt(b.value);changeShape(c,"numberText"),$j("#textNumberShapeDD img")[0].setAttribute("src",$j(b).find("img").attr("src"))}function changeNameShape(a){var b;b="IMG"==a.target.tagName?a.target.parentNode:a.target;var c=parseInt(b.value);changeShape(c,"nameText"),$j("#textNameShapeDD img")[0].setAttribute("src",$j(b).find("img").attr("src"))}function changeShape(a,b){var c=svgCanvas.getElem(b);if(c){if(parseInt(c.getAttribute("shapeId"))==a)return;defaultShapeVal=0,0==parseInt(c.getAttribute("shapeId"))?9==a?defaultShapeVal=45:a>0&&(defaultShapeVal=5):9==parseInt(c.getAttribute("shapeId"))?a>0&&(defaultShapeVal=5):parseInt(c.getAttribute("shapeId"))>0&&9==a&&(defaultShapeVal=45),c.setAttribute("shapeId",a),defaultShapeVal&&(c.setAttribute("shapeVal",defaultShapeVal),"nameText"==b?$j("#textNameShapeSlider").slider("value",defaultShapeVal):$j("#textNumberShapeSlider").slider("value",defaultShapeVal)),TextModule.addUpdateShapeText(c,c.getAttribute("text")),setPropertiesInpanel(c),svgCanvas.getPrivateMethods().extensions.undoRedo&&svgCanvas.getPrivateMethods().extensions.undoRedo.addToStack()}}function addNameNumberText(a,b,c){var d="";if("name"==a)if(1==b){"Back"==c?"2"!=curSide&&(d=$j("#sideButton_2")[0]):"1"!=curSide&&(d=$j("#sideButton_1")[0]);var e=9999999999;document.getElementById("nameText")&&(e=parseFloat(document.getElementById("nameText").getAttribute("shapeVal"))),""!=d&&(showSide(d),document.getElementById("nameText")&&(e=parseFloat(document.getElementById("nameText").getAttribute("shapeVal")))),9999999999==e&&(e=$j("#textNameShapeSlider").slider("value")),removeNameNumber("nameText"),$j("#nameNumber-panel").addClass("cbp-spmenu-open"),null==document.getElementById("nameText")&&null==nameElem?(nameElem=TextModule.addUpdateShapeText(null,"EXAMPLE","nameText",30,e),nameElem.setAttribute("text","EXAMPLE"),""!=$j("#name_0").val()&&$j("#name_0").focus()):nameElem&&(nameElem=TextModule.addUpdateShapeText(nameElem,nameElem.getAttribute("text")),nameElem.hasAttribute("transform")&&nameElem.setAttribute("transform",nameElem.getAttribute("transform")),""!=$j("#name_0").val()&&$j("#name_0").focus(),1==useNumber&&""==$j("#number_1").val()&&isNumber())}else removeNameNumber("nameText"),hidePopups();if("number"==a)if(1==b){"Back"==c?"2"!=curSide&&(d=$j("#sideButton_2")[0]):"1"!=curSide&&(d=$j("#sideButton_1")[0]);var e=9999999999;document.getElementById("numberText")&&(e=parseFloat(document.getElementById("numberText").getAttribute("shapeVal"))),""!=d&&(showSide(d),document.getElementById("numberText")&&(e=parseFloat(document.getElementById("numberText").getAttribute("shapeVal")))),9999999999==e&&(e=$j("#textNumberShapeSlider").slider("value")),removeNameNumber("numberText"),$j("#nameNumber-panel").addClass("cbp-spmenu-open"),null==document.getElementById("numberText")&&null==numberElem?(null!=document.getElementById("nameText")?(yPos=$j("#nameText")[0].getBBox(),yPos=yPos.y+yPos.height+80):yPos=$j("#canvasBackground").attr("height")/2,numberElem=TextModule.addUpdateShapeText(null,"00","numberText",120,e),numberElem.setAttribute("text","00"),""!=$j("#number_0").val()&&$j("#number_0").focus()):numberElem&&(numberElem=TextModule.addUpdateShapeText(numberElem,numberElem.getAttribute("text")),numberElem.hasAttribute("transform")&&numberElem.setAttribute("transform",numberElem.getAttribute("transform")),""!=$j("#number_0").val()&&$j("#number_0").focus(),1==useName&&""==$j("#name_1").val()&&isName())}else removeNameNumber("numberText"),hidePopups();svgCanvas.runExtensions("forNameNumber",{})}function changeFont(a){var b;"name-font-item"==a.target.getAttribute("class")&&(b=svgCanvas.getElem("nameText")),"number-font-item"==a.target.getAttribute("class")&&(b=svgCanvas.getElem("numberText"));var c=Raphael.fonts[a.target.getAttribute("font-name")];c?(b.setAttribute("font-family",a.target.getAttribute("font-name")),TextModule.addUpdateShapeText(b,b.getAttribute("text")),setPropertiesInpanel(b),svgCanvas.getPrivateMethods().extensions.undoRedo&&svgCanvas.getPrivateMethods().extensions.undoRedo.addToStack()):(showLoader(),$j.getScript(Smm.fontDirectory+fontData[a.target.getAttribute("font-name")].jsFile).done(function(){hideLoader(),b.setAttribute("font-family",a.target.getAttribute("font-name")),TextModule.addUpdateShapeText(b,b.getAttribute("text")),setPropertiesInpanel(b),svgCanvas.getPrivateMethods().extensions.undoRedo&&svgCanvas.getPrivateMethods().extensions.undoRedo.addToStack()}).fail(function(){hideLoader(),$j.alert("Sorry!! this font is not available.")}))}var totalcolorsUsedNew=new Array,textShapes=[],nameElem,numberElem,useName=!1,useNumber=!1,datascrollerapi,cloneNameNumberSize="";$j(document).ready(function(){textShapes=[{name:"none",id:0,image:"images/shape-none.jpg"},{name:"curve",id:9,image:"images/shape-curve.jpg"},{name:"arch",id:3,image:"images/shape-arch.jpg"},{name:"Bridge",id:2,image:"images/shape-bridge.jpg"},{name:"bulge",id:4,image:"images/shape-bulge.jpg"},{name:"bird's eye",id:5,image:"images/shape-bridseye.jpg"},{name:"pinch",id:1,image:"images/shape-pinch.jpg"},{name:"Cascade Down",id:6,image:"images/shape-cascadedown.jpg"},{name:"Cascade Up",id:7,image:"images/shape-cascadeup.jpg"},{name:"Wave",id:8,image:"images/shape-wave.jpg"}],$j("#addnamenumber").bind("mousedown",function(){svgCanvas.getSelectedElems().length&&svgCanvas.clearSelection(),showNameNumSetting()}),$j("#name_num_backBtn").bind("mousedown",function(){nameNumSetting()}),$j("#enter_custom_list_btn").on("mousedown",function(){hidePopups(),showNameNumList()}),$j("#name_num_close, #nameNumberCloseButton").on("mousedown",function(){$j(".sambhavNameNum").hide(),$j(".clearfix").show(),$j("#common-panel").removeClass("cbp-spmenu-open"),$j(".align_icons").hide(),$j("#common-panel").css("width","447px"),$j("#common-panel").css("overflow","")}),svgedit.browser.isTouch()&&0==svgedit.browser.isIOS()?($j("#num_control_btn").on("touchstart",num_control_btnHandler),$j("#name_control_btn").on("touchstart",name_control_btnHandler)):($j("#num_control_btn").on("click",num_control_btnHandler),$j("#name_control_btn").on("click",name_control_btnHandler)),$j("#textNameShapeSlider").slider({orientation:"vertical",range:!1,min:-10,max:10,step:.5,value:0,slide:function(){},start:function(){},stop:function(a,b){changeNameShapeValue(b.value)}}),$j("#textNumberShapeSlider").slider({orientation:"vertical",range:!1,min:-10,max:10,step:.5,value:0,slide:function(){},start:function(){},stop:function(a,b){changeNumberShapeValue(b.value)}});for(var a=$j("#textNameShapeDD"),b=$j("#textNameShapeDD .shape_con"),c=$j("<ul class='dropdownName select-small'>").appendTo(b),d=0;d<textShapes.length;d++)svgedit.browser.isTouch()&&0==svgedit.browser.isIOS()?$j('<li value="'+textShapes[d].id+" name="+textShapes[d].name+'" ><img style="pointer-events:none" src="'+jspath+textShapes[d].image+'"/></li>').appendTo(c).on("touchstart",changeNameShape):$j('<li value="'+textShapes[d].id+" name="+textShapes[d].name+'" ><img style="pointer-events:none" src="'+jspath+textShapes[d].image+'"/></li>').appendTo(c).on("click",changeNameShape);svgedit.browser.isTouch()&&0==svgedit.browser.isIOS()?a.on("touchstart",showNameShapes):a.on("click",showNameShapes);for(var e=$j("#textNumberShapeDD"),b=$j("#textNumberShapeDD .shape_con"),c=$j("<ul class='dropdownNumber select-small'>").appendTo(b),d=0;d<textShapes.length;d++)svgedit.browser.isTouch()&&0==svgedit.browser.isIOS()?$j('<li value="'+textShapes[d].id+" name="+textShapes[d].name+'" ><img style="pointer-events:none" src="'+jspath+textShapes[d].image+'"/></li>').appendTo(c).on("touchstart",changeNumberShape):$j('<li value="'+textShapes[d].id+" name="+textShapes[d].name+'" ><img style="pointer-events:none" src="'+jspath+textShapes[d].image+'"/></li>').appendTo(c).on("click",changeNumberShape);
svgedit.browser.isTouch()&&0==svgedit.browser.isIOS()?(e.on("touchstart",showNumberShapes),$j("#nameFonts").on("touchstart",showNameFonts),$j("#numberFonts").on("touchstart",showNumberFonts),$j("#addNewNameNumber").on("touchstart",addNewRow)):(e.on("click",showNumberShapes),$j("#nameFonts").on("click",showNameFonts),$j("#numberFonts").on("click",showNumberFonts),$j("#addNewNameNumber").on("click",addNewRow));var f=new Array;f.push(8),f.push(9),f.push(37),f.push(39),f.push(46),$j("#nameNumber-panel").on("keypress",".listNumber",function(a){var b=a.which?a.which:a.keyCode;if(this.value.length<2||-1!=f.indexOf(b)){var c=b>=48&&57>=b||-1!=f.indexOf(b);return c}return!1}),$j("#nameNumber-panel").on("paste",".listNumber",function(){return!1}),$j("#nameNumber-panel").on("drop",".listNumber",function(){return!1}),$j(".listName").live("focus",function(){if(updateSide("name"),$j(".align_icons").hide(),isName()){var a=$j(this)[0].value,b=document.getElementById("nameText");""!=a?($j(b).show(),TextModule.addUpdateShapeText(b,a)):$j(b).hide()}if(1==useNumber&&isNumber()){var c=this.id.replace("name","number"),a=$j("#"+c)[0].value,d=document.getElementById("numberText");d&&(""!=a?($j(d).show(),TextModule.addUpdateShapeText(d,a)):$j(d).hide())}}),$j(".listNumber").live("focus",function(){if(updateSide("number"),$j(".align_icons").hide(),isNumber()){var a=$j(this)[0].value,b=document.getElementById("numberText");""!=a?($j(b).show(),TextModule.addUpdateShapeText(b,a)):$j(b).hide()}if(1==useName&&isName()){var c=this.id.replace("number","name"),a=$j("#"+c)[0].value,d=document.getElementById("nameText");d&&(""!=a?($j(d).show(),TextModule.addUpdateShapeText(d,a)):$j(d).hide())}}),$j(".listName").live("keyup",function(){if(isName()){var a=$j(this)[0].value,b=svgCanvas.getElem("nameText");""!=a?($j(b).show(),TextModule.addUpdateShapeText(b,a)):$j(b).hide()}svgCanvas.runExtensions("forNameNumber",{})}),$j(".listNumber").live("keyup",function(){if(isNumber()){var a=$j(this)[0].value,b=svgCanvas.getElem("numberText");""!=a?($j(b).show(),TextModule.addUpdateShapeText(b,a)):$j(b).hide()}svgCanvas.runExtensions("forNameNumber",{})}),$j("#fill_nameText, #fill_numberText").on("mousedown",function(a){updateSide("fill_nameText"==a.currentTarget.id?"name":"number"),hidePopups(),$j("#common_upper_open_panel").show(),$j("#common_upper_open_panel").css("width","580px"),$j(".simpleColorChooser").css("width","580px"),$j(".simpleColorChooser .jspContainer").css("width","580px"),$j(".simpleColorChooser .jspContainer .jspPane").css("width","580px"),$j(".simpleColorChooser").jScrollPane()});var g=$j(".namennnumber_table_con").jScrollPane();datascrollerapi=g.data("jsp")});var removeSizeDropdown=nameNumberObject.removeSizeDropdown=function(){"onlysize"!=productData.type&&"configurable"!=productData.type?($j("#sizeTableCaption").hide(),$j("#nameTableCaption").css("width","383px"),$j(".size-label").hide()):(updateNameNumberSize(),$j("#nameTableCaption").css("width","310px"),$j("#sizeTableCaption").show(),$j(".size-label").show(),$j("#size_0").empty(),$j("#size_0").append(cloneNameNumberSize)),"0"==productData.name_number&&($j("#name_control_btn").hasClass("on")&&(removeNameNumber("nameText"),enableDisableName()),$j("#num_control_btn").hasClass("on")&&(removeNameNumber("numberText"),enableDisableNumber())),setTimeout(updateSizeinCartPanel,1e3)},getNameNumberData=nameNumberObject.getNameNumberData=function(){var a=[],b=$j("#listNameNumber").find("tr");return svgCanvas.getPrivateMethods().extensions.productPricing&&svgCanvas.getPrivateMethods().extensions.productPricing.isCalculate(!1),svgCanvas.getPrivateMethods().extensions.undoRedo&&svgCanvas.getPrivateMethods().extensions.undoRedo.isAddToStack(!1),b.length&&($j("#name_control_btn").hasClass("on")||$j("#num_control_btn").hasClass("on"))&&$j.each(b,function(b,c){var d=c.id,e=new Object;if(("onlysize"==productData.type||"configurable"==productData.type)&&(e.id=$j("#size_"+d+" option:selected").val()),e.name=$j.trim($j("#name_"+d).val()),""!=e.name){$j("#name_"+d).focus();var f=document.getElementById("nameText");f&&(e.nameData=[$j(f).find("path")[0].getAttribute("d"),$j(f).find("path")[0].getAttribute("transform")])}else e.nameData="";if(e.number=$j.trim($j("#number_"+d).val()),""!=e.number){$j("#number_"+d).focus();var g=document.getElementById("numberText");g&&(e.numberData=[$j(g).find("path")[0].getAttribute("d"),$j(g).find("path")[0].getAttribute("transform")])}else e.numberData="";a.push(e)}),svgCanvas.getPrivateMethods().extensions.productPricing&&svgCanvas.getPrivateMethods().extensions.productPricing.isCalculate(!0),svgCanvas.getPrivateMethods().extensions.undoRedo&&svgCanvas.getPrivateMethods().extensions.undoRedo.isAddToStack(!0),a},getNameCount=nameNumberObject.getNameCount=function(){var a=0,b=$j("#listNameNumber").find("tr");return b.length&&$j("#name_control_btn").hasClass("on")&&$j.each(b,function(b,c){var d=c.id;$j("#name_"+d).val()&&a++}),a},getNumberCount=nameNumberObject.getNumberCount=function(){var a=0,b=$j("#listNameNumber").find("tr");return b.length&&$j("#num_control_btn").hasClass("on")&&$j.each(b,function(b,c){var d=c.id;$j("#number_"+d).val()&&a++}),a},updateSizeinCartPanel=nameNumberObject.updateSizeinCartPanel=function(){if(nameElem||numberElem||useName||useNumber){var a=$j("#current_product_colorid").val();"onlysize"==productData.type?$j("#onlySize_").find("input").val(0):"configurable"==productData.type?$j("#colorid_"+a).find("input").val(0):$j("#quantity").val(0);var b=getSizeArray(a);$j.each(b,function(a,b){$j("#"+a).val(b)}),productPricingExt.getProductPrice()}},manageNameForm=nameNumberObject.manageNameForm=function(){var a=$j("#name_control_btn").hasClass("on");manageFormElements(),useName=!1,a&&(useName=!0);var b=$j("#name_side").val();addNameNumberText("name",a,b)},manageNumberForm=nameNumberObject.manageNumberForm=function(){var a=$j("#num_control_btn").hasClass("on");manageFormElements(),useNumber=!1,a&&(useNumber=!0);var b=$j("#number_side").val();addNameNumberText("number",a,b)},manageSize=nameNumberObject.manageSize=function(a){updateSide(a);var b,c;"name"==a?(c=$j("#name_size").val(),b=svgCanvas.getElem("nameText")):(c=$j("#number_size").val(),b=svgCanvas.getElem("numberText")),b.setAttribute("font-size",c),TextModule.addUpdateShapeText(b,b.getAttribute("text")),svgCanvas.runExtensions("forNameNumber",{}),svgCanvas.getPrivateMethods().extensions.undoRedo&&svgCanvas.getPrivateMethods().extensions.undoRedo.addToStack()},checkList=nameNumberObject.checkList=function(){var a=!0,b=$j("#name_control_btn").hasClass("on"),c=$j("#num_control_btn").hasClass("on");return b&&$j(".listNumber").each(function(){var b=$j.trim($j(this).val());""==b&&(a=!1)}),c&&$j(".listName").each(function(){var b=$j.trim($j(this).val());""==b&&(a=!1)}),a},showNameNumList=nameNumberObject.showNameNumList=function(){$j("#name_num_setting").animate({right:"580px"}).css("visibility","hidden"),svgedit.browser.isTouch()?$j("#name_num_customList").animate({right:"560px"},{complete:function(){$j("#name_num_customList").css("display","block")}}):$j("#name_num_customList").animate({right:"560px"}).css("visibility","visible")},updateNameNumberSize=nameNumberObject.updateNameNumberSize=function(a,b){var a=a||$j("#current_product_colorid").val();if("configurable"==productData.type||"onlysize"==productData.type){var c,d=$j("#listNameNumber tr:last-child").attr("id");"onlysize"==productData.type?(c=productData.allColors.size,c=Object.keys(c).map(function(a){return c[a]})):c=productData.allColors.color[a].sizes;for(var e=0;d>=e;e++){$j("#size_"+e).empty(),cloneNameNumberSize="";for(var f=0;f<c.length;f++){var g="";b&&b[e].id==c[f].optionID&&(g="selected=selected"),cloneNameNumberSize+="<option "+g+' value="'+c[f].optionID+'">'+c[f].optionName+"</option> "}$j("#size_"+e).append(cloneNameNumberSize)}currentColorId=a}},checkNameNumberSides=nameNumberObject.checkNameNumberSides=function(){2>no_of_side&&($j("#name_side option[value=Back]").remove(),$j("#number_side option[value=Back]").remove())},addNameNumberData=nameNumberObject.addNameNumberData=function(){trace("namenumberData"),trace(namenumberData);var namenumberData=$j.parseJSON(postData.namenumData),enableName=!1,enableNumber=!1,len=namenumberData.length;if(len){$j("#listNameNumber").empty();for(var i=0;len>i;i++){var tr="<tr id="+i+">";tr+="onlysize"==productData.type||"configurable"==productData.type?'<td class="size-label"><select onchange="nameNumberObject.updateSizeinCartPanel();" data-field-index='+i+' class="listSize" name="" id="size_'+i+'" autocomplete="off" ></select></td>':'<td class="size-label" style="display: none;"><select onchange="nameNumberObject.updateSizeinCartPanel();" data-field-index='+i+' class="listSize" name="" id="size_'+i+'" autocomplete="off" ></select></td>',tr+='<td class="name-label"><input type="text" data-field-index='+i+' class="listName" name="" id="name_'+i+'" autocomplete="off"></td><td class="number-label"> <input type="text" data-field-index='+i+' class="listNumber" onKeyDown="numeric_validation(event);" maxlength="2" name="" id="number_'+i+'" autocomplete="off" ></td><td class="delete-box closebar_button"><button',0==i&&(tr+=' style="display:none"'),0!=i&&(tr+=svgedit.browser.isTouch()&&0==svgedit.browser.isIOS()?' ontouchstart="nameNumberObject.removeRow(this)"':' onclick="nameNumberObject.removeRow(this)"'),tr+=' class="remove-nnfield"><i class="fa fa-trash"></i></button></td></tr>',$j("#listNameNumber").append(tr),$j("#size_"+i).on(),$j("#name_"+i).val(namenumberData[i].name),""!=namenumberData[i].name&&(enableName=!0),$j("#number_"+i).val(namenumberData[i].number),""!=namenumberData[i].number&&(enableNumber=!0)}updateNameNumberSize(currentColorId,namenumberData)}if(svgedit.browser.isTouch()?$j("#name_num_customList").animate({right:"0px"}).css("display","none"):$j("#name_num_customList").animate({right:"0px"}).css("visibility","hidden"),enableName){$j("#name_control_btn").toggleClass("on off");var parentDiv=$j("#name_control_btn").parent(),controlDiv=$j(parentDiv).find(".font-controls");$j(controlDiv).toggleClass("enable disable"),useName=!0}if(enableNumber){$j("#num_control_btn").toggleClass("on off");var parentDiv=$j("#num_control_btn").parent(),controlDiv=$j(parentDiv).find(".font-controls");$j(controlDiv).toggleClass("enable disable"),useNumber=!0}for(var i=1;2>=i;i++){var svgSide=eval("text_svg"+i);doc=svgedit.utilities.text2xml(svgSide);var nameText=doc.getElementById("nameText");if(!nameText)for(var gTags=doc.getElementsByTagName("g"),len=gTags.length,j=0;len>j;j++)if("nameText"==gTags[j].getAttribute("type")){gTags[j].setAttribute("id","nameText"),nameText=gTags[j];break}var numberText=doc.getElementById("numberText");if(!numberText)for(var gTags=doc.getElementsByTagName("g"),len=gTags.length,j=0;len>j;j++)if("numberText"==gTags[j].getAttribute("type")){gTags[j].setAttribute("id","numberText"),numberText=gTags[j];break}if(nameText&&null!=nameText){1==i?$j("#name_side").val("Front").attr("selected","selected"):$j("#name_side").val("Back").attr("selected","selected");var fontSize=nameText.getAttribute("font-size");$j("#name_size option[value='"+fontSize+"']").attr("selected","selected"),$j("#fill_nameText svg rect").attr("fill",nameText.getAttribute("fill")),$j("#selectedNameFont").css("font-family",nameText.getAttribute("font-family")).text(nameText.getAttribute("font-family"));var shapeId=nameText.getAttribute("shapeId");$j("#textNameShapeDD img")[0].setAttribute("src",jspath+getObjectFromArray(textShapes,"id",shapeId)[0].image);var shapeVal=nameText.getAttribute("shapeVal");$j("#textNameShapeSlider").slider("value",shapeVal),$j("#addNewNameNumber").attr("disabled",!1)}if(numberText&&null!=numberText){1==i?$j("#number_side").val("Front").attr("selected","selected"):$j("#number_side").val("Back").attr("selected","selected");var fontSize=numberText.getAttribute("font-size");$j("#number_size option[value='"+fontSize+"']").attr("selected","selected"),$j("#fill_numberText svg rect").attr("fill",numberText.getAttribute("fill")),$j("#selectedNumberFont").css("font-family",numberText.getAttribute("font-family")).text(numberText.getAttribute("font-family"));var shapeId=numberText.getAttribute("shapeId");$j("#textNumberShapeDD img")[0].setAttribute("src",jspath+getObjectFromArray(textShapes,"id",shapeId)[0].image);var shapeVal=numberText.getAttribute("shapeVal");$j("#textNumberShapeSlider").slider("value",shapeVal),$j("#addNewNameNumber").attr("disabled",!1)}svgCanvas.runExtensions("forNameNumber",{})}(useName||useNumber)&&(updateSizeinCartPanel(),manageFormElements())},removeRow=nameNumberObject.removeRow=function(a){$j(a).parents("tr").remove();var b=$j("#listNameNumber :first").find(".listName").val(),c=$j("#listNameNumber :first").find(".listNumber").val();if(null!=document.getElementById("nameText")){var d=svgCanvas.getElem("nameText");"EXAMPLE"!=d.getAttribute("text")&&TextModule.addUpdateShapeText(d,b)}if(null!=document.getElementById("numberText")){var e=svgCanvas.getElem("numberText");"00"!=e.getAttribute("text")&&TextModule.addUpdateShapeText(e,c)}updateSizeinCartPanel(),svgCanvas.runExtensions("forNameNumber",{}),datascrollerapi.reinitialise()},manageFormElements=nameNumberObject.manageFormElements=function(){var a=$j("#current_product_colorid").val(),b=$j("#name_control_btn").hasClass("on"),c=$j("#num_control_btn").hasClass("on");b||c?($j("#addNewNameNumber,.listSize").attr("disabled",!1),"onlysize"==productData.type?$j("#onlySize_ :input").attr("disabled",!0):"configurable"==productData.type?$j("#colorid_"+a+" :input").attr("disabled",!0):$j("#quantity").attr("disabled",!0)):($j("#addNewNameNumber,.listSize").attr("disabled",!0),"onlysize"==productData.type&&$j("#onlySize_ :input").attr("disabled",!1),"configurable"==productData.type?$j("#colorid_"+a+" :input").attr("disabled",!1):$j("#quantity").attr("disabled",!1)),b?$j(".listName").attr("disabled",!1):$j(".listName").attr("disabled",!0),c?$j(".listNumber").attr("disabled",!1):$j(".listNumber").attr("disabled",!0)},countSize=nameNumberObject.countSize=function(){var a=$j("#listNameNumber").find("select"),b=new Array,c={};$j.each(a,function(a,c){b.push(c.value)}),b.forEach(function(a){c[a]=(c[a]||0)+1}),b=arrayUnique(b);var d=$j("#current_product_colorid").val();if(d)for(var e=productData.allColors.color[d].sizes,f=0;f<e.length;f++){var g=e[f];"undefined"==typeof c[g]&&(c[g]=0),$j("#size"+g+"_"+d).val(c[g])}},removeNameNumber=nameNumberObject.removeNameNumber=function(a){if(svgCanvas.getElem(a))svgCanvas.getElem(a).parentNode.removeChild(svgCanvas.getElem(a));else{var b;b=$j(1==curSide?"#textsvg_2":"#textsvg_1");var c=b.val();if(""!=c){var d=svgedit.utilities.text2xml(c),e=d.getElementById(a);e&&(e.parentNode.removeChild(e),b.val((new XMLSerializer).serializeToString(d)))}}"nameText"==a&&(nameElem=null),"numberText"==a&&(numberElem=null),svgCanvas.runExtensions("forNameNumber",{})},resetName=nameNumberObject.resetName=function(){removeNameNumber("nameText"),$j("#fill_nameText svg rect").attr("fill",getDefaultColor()),$j("#selectedNameFont").css("font-family",first_font).text(first_font),$j("#name_side").val("Back").attr("selected","selected"),addNameNumberText("name",!0,"Back"),nameElem=svgCanvas.getElem("nameText"),nameElem.setAttribute("font-family",first_font),nameElem.setAttribute("fill",getDefaultColor()),svgCanvas.runExtensions("forNameNumber",{})},resetNumber=nameNumberObject.resetNumber=function(){removeNameNumber("numberText"),$j("#fill_numberText svg rect").attr("fill",getDefaultColor()),$j("#selectedNumberFont").css("font-family",first_font).text(first_font),$j("#number_side").val("Back").attr("selected","selected"),addNameNumberText("number",!0,"Back");var a=svgCanvas.getElem("numberText");a.setAttribute("font-family",first_font),a.setAttribute("fill",getDefaultColor()),svgCanvas.runExtensions("forNameNumber",{})},updateNameNumberButton=nameNumberObject.updateNameNumberButton=function(){for(var a,b,c=1;2>=c;c++){var d=$j("#textsvg_"+c).val();doc=svgedit.utilities.text2xml(d),a||(a=doc.getElementById("nameText")),b||(b=doc.getElementById("numberText"))}a||(a=svgCanvas.getElem("nameText")),b||(b=svgCanvas.getElem("numberText")),$j("#addNewNameNumber,.listSize").attr("disabled",!0);var e=$j("#name_control_btn").parent(),f=$j(e).find(".font-controls");a&&null!=a?($j("#name_control_btn").removeClass("off").addClass("on"),$j(f).removeClass("disable").addClass("enable"),$j(".listName").attr("disabled",!1),$j("#addNewNameNumber,.listSize").attr("disabled",!1),nameElem=a,useName=!0):($j("#name_control_btn").removeClass("on").addClass("off"),$j(f).removeClass("enable").addClass("disable"),$j(".listName").attr("disabled",!0));var g=$j("#num_control_btn").parent(),h=$j(g).find(".font-controls");b&&null!=b?($j("#num_control_btn").removeClass("off").addClass("on"),$j(h).removeClass("disable").addClass("enable"),$j(".listNumber").attr("disabled",!1),$j("#addNewNameNumber,.listSize").attr("disabled",!1),numberElem=b,useNumber=!0):($j("#num_control_btn").removeClass("on").addClass("off"),$j(h).removeClass("enable").addClass("disable"),$j(".listNumber").attr("disabled",!0))},checkNameNumber=nameNumberObject.checkNameNumber=function(){null!=document.getElementById("nameText")&&($j("#name_control_btn").removeClass("on"),$j("#name_control_btn").addClass("off"),manageNameForm()),null!=document.getElementById("numberText")&&($j("#num_control_btn").removeClass("on"),$j("#num_control_btn").addClass("off"),manageNumberForm()),manageFormElements()};return{name:"nameNumber",mouseDown:function(){},fontInitiated:function(){svgedit.browser.isTouch()&&0==svgedit.browser.isIOS()?($j(".name-font-item").on("touchstart",changeFont),$j(".number-font-item").on("touchstart",changeFont)):($j(".name-font-item").on("click",changeFont),$j(".number-font-item").on("click",changeFont)),$j("#selectedNameFont").css("font-family",first_font),$j("#selectedNameFont").text(first_font),$j("#selectedNumberFont").css("font-family",first_font),$j("#selectedNumberFont").text(first_font);for(var a=1;2>=a;a++){var b=$j("#textsvg_"+a).val();if(""!=b){doc=svgedit.utilities.text2xml(b);var c=doc.getElementById("nameText"),d=doc.getElementById("numberText");c&&null!=c&&LoadFont(c.getAttribute("font-family")),d&&null!=d&&LoadFont(d.getAttribute("font-family"))}}},forNameNumber:function(){},selectedChanged:function(){var a=svgCanvas.getSelectedElems();a.length>0&&(this.isNameNumSelected()?($j(".align_icons").hide(),$j("#transformPanel").hide(),$j("#common-panel").css("width","580px")):($j(".simpleColorChooser").css("width","447px"),$j("#common_upper_open_panel").css("width","447px"),$j(".simpleColorChooser").jScrollPane()))},elementChanged:function(){var a=svgCanvas.getSelectedElems();if(a.length>0&&this.isNameNumSelected()){$j(".align_icons").hide(),$j("#common-panel").css("width","580px");for(var b=0;b<a.length;b++)"nameText"==a[b].id?$j("#fill_nameText svg rect").attr("fill",getFill(a[b])):"numberText"==a[b].id&&$j("#fill_numberText svg rect").attr("fill",getFill(a[b]))}},isNameNumSelected:function(a){return this.isNameSelected(a)||this.isNumSelected(a)},isNameSelected:function(a){a=a||svgCanvas.getSelectedElems();var b=!1;if(a.length)for(var c=0;c<a.length;c++)if("nameText"==a[c].getAttribute("id")){b=!0;break}return b},isNumSelected:function(a){a=a||svgCanvas.getSelectedElems();var b=!1;if(a.length)for(var c=0;c<a.length;c++)if("numberText"==a[c].getAttribute("id")){b=!0;break}return b},langChanged:function(){changeLabelsForLanguage()},updatePrice:function(){if(svgCanvas.getPrivateMethods().extensions.productPricing){var a=svgCanvas.getPrivateMethods().extensions.productPricing.getCurrentPrintingMethod();$j("#num_price").text("( "+tempData.settings.currency_symbol+a.number_price+" each)"),$j("#name_price").text("( "+tempData.settings.currency_symbol+a.name_price+" each)")}},onNewDocument:function(){nameElem&&(enableDisableName(),nameElem=null),numberElem&&(enableDisableNumber(),numberElem=null)}}}),svgEditor.addExtension("guidelines",function(){function a(){var a=findNodeWithTitleName(svgCanvas.getContentElem().childNodes,"Layer 1"),b=[];return $j.each(a.childNodes,function(a,c){-1==f.indexOf(c.tagName)&&3!=c.nodeType&&h(c)&&b.push(c)}),b.push(svgCanvas.getElem("canvasBackground")),b.reverse()}var b,c,d,e="http://www.w3.org/2000/svg",f="title",g=2,h=function(a){return"none"==a.getAttribute("display")?!1:$j(a).parents("g").length>=2?"none"!=$j(a).parents("g")[$j(a).parents("g").length-2].getAttribute("display"):!0};return document.onmouseup=function(){if(d)for(;d.childNodes.length;)d.removeChild(d.childNodes[0])},{name:"guidelines",elementChanged:function(){},selectedChanged:function(){},elementTransition:function(){if("select"==svgCanvas.getMode()||"resize"==svgCanvas.getMode()){for(var a=svgCanvas.selectorManager.selectors[0].selectorRect.getBoundingClientRect(),b=[],e=[],f=c.length,h=svgCanvas.getZoom();f--;){var i,j;if("g"==c[f].tagName&&"photobox"==c[f].getAttribute("type")){var k=c[f].childNodes.length;if(!k)continue;i=svgCanvas.getStrokedBBox([c[f].childNodes[k-1]]),j=c[f].childNodes[k-1].getBoundingClientRect()}else i=svgCanvas.getStrokedBBox([c[f]]),j=c[f].getBoundingClientRect();Math.round(j.left)<=Math.round(a.left)+g&&Math.round(j.left)>=Math.round(a.left)-g&&b.push("canvasBackground"==c[f].id?i.x/h:i.x),Math.round(j.left+j.width/2)<=Math.round(a.left+a.width/2)+g&&Math.round(j.left+j.width/2)>=Math.round(a.left+a.width/2)-g&&b.push("canvasBackground"==c[f].id?(i.x+i.width/2)/h:i.x+i.width/2),Math.round(j.left+j.width)<=Math.round(a.left+a.width)+g&&Math.round(j.left+j.width)>=Math.round(a.left+a.width)-g&&b.push("canvasBackground"==c[f].id?(i.x+i.width)/h:i.x+i.width),Math.round(j.top)<=Math.round(a.top)+g&&Math.round(j.top)>=Math.round(a.top)-g&&e.push("canvasBackground"==c[f].id?Math.round(i.y/h):Math.round(i.y)),Math.round(j.top+j.height/2)<=Math.round(a.top+a.height/2)+g&&Math.round(j.top+j.height/2)>=Math.round(a.top+a.height/2)-g&&e.push("canvasBackground"==c[f].id?Math.round((i.y+i.height/2)/h):Math.round(i.y+i.height/2)),Math.round(j.top+j.height)<=Math.round(a.top+a.height)+g&&Math.round(j.top+j.height)>=Math.round(a.top+a.height)-g&&e.push("canvasBackground"==c[f].id?Math.round((i.y+i.height)/h):Math.round(i.y+i.height))}for(;d.childNodes.length;)d.removeChild(d.childNodes[0]);var l=$j("#canvasBackground").attr("width");"web2print"==toolType&&(l/=h);var m=$j("#canvasBackground").attr("height");if("web2print"==toolType&&(m=l/h),b.length)for(f=b.length;f--;){var n=svgCanvas.addSvgElementFromJson({element:"line",attr:{x1:b[f]*h,y1:0,x2:b[f]*h,y2:m,stroke:getDefaultColor(),"stroke-width":1,opacity:1,fill:"none",style:"pointer-events:none"}});d.appendChild(n)}if(e.length)for(f=e.length;f--;){var n=svgCanvas.addSvgElementFromJson({element:"line",attr:{x1:0,y1:e[f]*h,x2:l,y2:e[f]*h,stroke:getDefaultColor(),"stroke-width":1,opacity:1,fill:"none",style:"pointer-events:none"}});d.appendChild(n)}}},mouseDown:function(d){if(d.selectedElements.length){var e=a();c=$j(e).not(d.selectedElements).get(),b=[];for(var f=0;f<c.length;f++)b.push(c[f].getBoundingClientRect())}},toolReady:function(){d=document.createElementNS(e,"svg"),$j(d).attr({id:"guideLines",width:$j("#canvasBackground").attr("width"),height:$j("#canvasBackground").attr("height"),x:$j("#canvasBackground").attr("x"),y:$j("#canvasBackground").attr("y"),overflow:"hidden",xmlns:e}).appendTo(svgCanvas.getRootElem())},zoomChanged:function(){d&&(d.setAttribute("x",svgCanvas.getContentElem().getAttribute("x")),d.setAttribute("y",svgCanvas.getContentElem().getAttribute("y")),d.setAttribute("width",svgCanvas.getContentElem().getAttribute("width")),d.setAttribute("height",svgCanvas.getContentElem().getAttribute("height")))},onNewDocument:function(){}}});